{"nick":"lloydde","date":"2014-11-26T00:00:26.369Z","type":"join"}
{"nick":"trentm","date":"2014-11-26T00:03:17.898Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 250 seconds","date":"2014-11-26T00:04:50.371Z","type":"quit"}
{"nick":"lloydde","date":"2014-11-26T00:16:45.147Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 255 seconds","date":"2014-11-26T00:21:21.091Z","type":"quit"}
{"nick":"fredk","date":"2014-11-26T00:35:36.928Z","type":"join"}
{"nick":"nfitch","reason":"Quit: Leaving.","date":"2014-11-26T00:37:12.400Z","type":"quit"}
{"nick":"lloydde","date":"2014-11-26T01:01:52.277Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 250 seconds","date":"2014-11-26T01:06:22.398Z","type":"quit"}
{"nick":"trentm","reason":"Quit: Leaving.","date":"2014-11-26T01:07:41.097Z","type":"quit"}
{"nick":"pmooney","reason":"Ping timeout: 272 seconds","date":"2014-11-26T01:08:39.846Z","type":"quit"}
{"nick":"abraxas_","date":"2014-11-26T01:17:26.025Z","type":"join"}
{"nick":"fredk","reason":"Quit: Leaving.","date":"2014-11-26T01:17:28.507Z","type":"quit"}
{"nick":"ed209","reason":"Remote host closed the connection","date":"2014-11-26T01:20:00.502Z","type":"quit"}
{"nick":"ed209","date":"2014-11-26T01:20:18.045Z","type":"join"}
{"nick":"abraxas_","reason":"Ping timeout: 258 seconds","date":"2014-11-26T01:21:52.369Z","type":"quit"}
{"nick":"abraxas_","date":"2014-11-26T01:28:03.356Z","type":"join"}
{"nick":"pmooney","date":"2014-11-26T01:34:48.392Z","type":"join"}
{"nick":"pmooney","reason":"Ping timeout: 258 seconds","date":"2014-11-26T01:39:30.350Z","type":"quit"}
{"nick":"dap_1","reason":"Quit: Leaving.","date":"2014-11-26T01:47:16.071Z","type":"quit"}
{"nick":"lloydde","date":"2014-11-26T02:02:34.607Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 265 seconds","date":"2014-11-26T02:07:12.628Z","type":"quit"}
{"nick":"swills","message":"anyone knowledgable about manatee around?","date":"2014-11-26T03:02:35.643Z","type":"message"}
{"nick":"lloydde","date":"2014-11-26T03:03:28.517Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 264 seconds","date":"2014-11-26T03:08:29.532Z","type":"quit"}
{"nick":"pmooney","date":"2014-11-26T03:41:44.029Z","type":"join"}
{"nick":"pmooney","reason":"Ping timeout: 240 seconds","date":"2014-11-26T03:46:23.036Z","type":"quit"}
{"nick":"lloydde","date":"2014-11-26T04:04:11.377Z","type":"join"}
{"nick":"swills","message":"    var pgUrl = 'tcp://postgres@' + config.ip + ':' + config.postgresPort +","date":"2014-11-26T04:05:54.855Z","type":"message"}
{"nick":"swills","message":"lines like this seem to make a bad assumption","date":"2014-11-26T04:06:00.140Z","type":"message"}
{"nick":"lloydde","reason":"Ping timeout: 258 seconds","date":"2014-11-26T04:09:00.348Z","type":"quit"}
{"nick":"lloydde","date":"2014-11-26T05:05:06.573Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 264 seconds","date":"2014-11-26T05:09:41.619Z","type":"quit"}
{"nick":"marsell","reason":"Ping timeout: 244 seconds","date":"2014-11-26T06:02:32.093Z","type":"quit"}
{"nick":"marsell","date":"2014-11-26T06:02:50.143Z","type":"join"}
{"nick":"lloydde","date":"2014-11-26T06:05:50.672Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 256 seconds","date":"2014-11-26T06:10:42.626Z","type":"quit"}
{"nick":"lloydde","date":"2014-11-26T07:01:25.360Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 258 seconds","date":"2014-11-26T07:06:06.381Z","type":"quit"}
{"nick":"marsell","reason":"Quit: marsell","date":"2014-11-26T07:41:32.466Z","type":"quit"}
{"nick":"marsell","date":"2014-11-26T07:42:18.050Z","type":"join"}
{"nick":"lloydde","date":"2014-11-26T08:02:13.132Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 240 seconds","date":"2014-11-26T08:06:17.092Z","type":"quit"}
{"nick":"marsell","reason":"Quit: marsell","date":"2014-11-26T08:14:12.761Z","type":"quit"}
{"nick":"bixu_","reason":"Read error: Connection reset by peer","date":"2014-11-26T08:39:33.287Z","type":"quit"}
{"nick":"bixu_","date":"2014-11-26T08:40:04.730Z","type":"join"}
{"nick":"pmooney","date":"2014-11-26T08:44:05.117Z","type":"join"}
{"nick":"pmooney","reason":"Ping timeout: 240 seconds","date":"2014-11-26T08:48:37.085Z","type":"quit"}
{"nick":"pgale","date":"2014-11-26T09:02:49.913Z","type":"join"}
{"nick":"lloydde","date":"2014-11-26T09:03:00.144Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 240 seconds","date":"2014-11-26T09:07:17.136Z","type":"quit"}
{"nick":"lloydde","date":"2014-11-26T10:03:50.176Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 255 seconds","date":"2014-11-26T10:08:35.971Z","type":"quit"}
{"nick":"marsell","date":"2014-11-26T10:16:10.108Z","type":"join"}
{"nick":"ed209","reason":"Remote host closed the connection","date":"2014-11-26T10:20:01.081Z","type":"quit"}
{"nick":"ed209","date":"2014-11-26T10:20:18.992Z","type":"join"}
{"nick":"bixu_","reason":"Ping timeout: 245 seconds","date":"2014-11-26T10:27:22.715Z","type":"quit"}
{"nick":"abraxas_","reason":"Remote host closed the connection","date":"2014-11-26T10:55:46.969Z","type":"quit"}
{"nick":"mamash","date":"2014-11-26T11:00:38.809Z","type":"join"}
{"nick":"lloydde","date":"2014-11-26T12:05:09.416Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 258 seconds","date":"2014-11-26T12:10:05.341Z","type":"quit"}
{"nick":"abraxas_","date":"2014-11-26T12:44:47.413Z","type":"join"}
{"nick":"pgale","reason":"Quit: Leaving.","date":"2014-11-26T12:48:32.478Z","type":"quit"}
{"nick":"abraxas_","reason":"Ping timeout: 258 seconds","date":"2014-11-26T12:49:57.332Z","type":"quit"}
{"nick":"pgale","date":"2014-11-26T12:52:03.121Z","type":"join"}
{"nick":"lloydde","date":"2014-11-26T13:06:10.281Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 255 seconds","date":"2014-11-26T13:10:46.282Z","type":"quit"}
{"nick":"bixu_","date":"2014-11-26T13:32:57.961Z","type":"join"}
{"nick":"chorrell","date":"2014-11-26T13:41:52.657Z","type":"join"}
{"nick":"lloydde","date":"2014-11-26T14:06:59.927Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 264 seconds","date":"2014-11-26T14:11:53.942Z","type":"quit"}
{"nick":"manytrees","reason":"Ping timeout: 258 seconds","date":"2014-11-26T14:21:11.392Z","type":"quit"}
{"nick":"manytrees","date":"2014-11-26T14:23:01.668Z","type":"join"}
{"nick":"mamash","date":"2014-11-26T14:23:23.141Z","type":"part"}
{"nick":"abraxas_","date":"2014-11-26T14:34:11.372Z","type":"join"}
{"nick":"abraxas_","reason":"Ping timeout: 265 seconds","date":"2014-11-26T14:38:47.661Z","type":"quit"}
{"nick":"pmooney","date":"2014-11-26T14:56:26.907Z","type":"join"}
{"nick":"lloydde","date":"2014-11-26T15:08:02.745Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 245 seconds","date":"2014-11-26T15:12:22.742Z","type":"quit"}
{"nick":"pmooney","reason":"Ping timeout: 272 seconds","date":"2014-11-26T15:33:47.922Z","type":"quit"}
{"nick":"nahamu","message":"swills: what's the bad assumption?","date":"2014-11-26T15:34:33.361Z","type":"message"}
{"nick":"pgale","reason":"Ping timeout: 240 seconds","date":"2014-11-26T15:47:17.079Z","type":"quit"}
{"nick":"pmooney","date":"2014-11-26T16:00:17.865Z","type":"join"}
{"nick":"nfitch","date":"2014-11-26T16:07:29.934Z","type":"join"}
{"nick":"lloydde","date":"2014-11-26T16:08:39.087Z","type":"join"}
{"nick":"swills","message":"nahamu: that the username is postgres","date":"2014-11-26T16:09:15.877Z","type":"message"}
{"nick":"swills","message":"in my case, it's pgsql","date":"2014-11-26T16:09:19.809Z","type":"message"}
{"nick":"swills","message":"anyway, after hacking around some things, i think i have the first 2 of 3 nodes up and running","date":"2014-11-26T16:09:48.085Z","type":"message"}
{"nick":"lloydde","reason":"Ping timeout: 244 seconds","date":"2014-11-26T16:13:14.069Z","type":"quit"}
{"nick":"nfitch","message":"swills: After logging on this morning, I only see your last 3 comments about postgres and 2 of 3 nodes… I'm really curious what you're up to.","date":"2014-11-26T16:14:49.484Z","type":"message"}
{"nick":"nfitch","message":"Ah, just got a ping from another Joyent engineer.  Looks like you're trying to set up a manatee?","date":"2014-11-26T16:17:21.457Z","type":"message"}
{"nick":"swills","message":"yes","date":"2014-11-26T16:20:04.643Z","type":"message"}
{"nick":"swills","message":"i'm trying to make it work on FreeBSD","date":"2014-11-26T16:20:13.493Z","type":"message"}
{"nick":"swills","message":"we lack smf, but have everything else (zfs, dtrace, node, pgsql, etc.) so it shouldn't be too bad realy","date":"2014-11-26T16:20:45.857Z","type":"message"}
{"nick":"swills","message":"really that is, sheesh, i can spell, i swear","date":"2014-11-26T16:22:47.351Z","type":"message"}
{"nick":"abraxas_","date":"2014-11-26T16:23:04.540Z","type":"join"}
{"nick":"nfitch","message":"Ok… did you fork it?  FWIW, there are cases where Manatee goes into 'error' mode which we're actively fixing right now.","date":"2014-11-26T16:23:55.372Z","type":"message"}
{"nick":"swills","message":"well, i forgot about zones vs jails","date":"2014-11-26T16:23:56.802Z","type":"message"}
{"nick":"swills","message":"yeah","date":"2014-11-26T16:24:03.273Z","type":"message"}
{"nick":"swills","message":"i wonder what the zoneid is used for","date":"2014-11-26T16:24:08.401Z","type":"message"}
{"nick":"nfitch","message":"So there are some pretty major changes coming down the pipeline.  Configuration should remain the same, though.","date":"2014-11-26T16:25:20.929Z","type":"message"}
{"nick":"trentm","date":"2014-11-26T16:25:38.781Z","type":"join"}
{"nick":"swills","message":"ok","date":"2014-11-26T16:25:56.135Z","type":"message"}
{"nick":"nfitch","message":"You can follow the progress on this branch of Manatee:  https://github.com/joyent/manatee/tree/MANATEE-188","date":"2014-11-26T16:26:08.557Z","type":"message"}
{"nick":"swills","message":"are those changes in a branch somewhere?","date":"2014-11-26T16:26:10.981Z","type":"message"}
{"nick":"swills","message":"ah, thanks","date":"2014-11-26T16:26:16.611Z","type":"message"}
{"nick":"swills","message":"so my primary node seems OK","date":"2014-11-26T16:26:50.780Z","type":"message"}
{"nick":"swills","message":"i think","date":"2014-11-26T16:26:54.546Z","type":"message"}
{"nick":"swills","message":"my sync node is up, but something strange happened","date":"2014-11-26T16:27:02.861Z","type":"message"}
{"nick":"swills","message":"Filesystem                                                                Size    Used   Avail Capacity  Mounted on","date":"2014-11-26T16:27:16.220Z","type":"message"}
{"nick":"swills","message":"zfs8/2faf0a64-eb3b-4f19-99fe-112856350de5@1416971100943/dev/gpt/rootfs    9.7G    1.6G    7.3G    18%    /","date":"2014-11-26T16:27:19.588Z","type":"message"}
{"nick":"swills","message":"that's not what it was before manatee did it's thing","date":"2014-11-26T16:28:00.406Z","type":"message"}
{"nick":"abraxas_","reason":"Ping timeout: 264 seconds","date":"2014-11-26T16:28:05.945Z","type":"quit"}
{"nick":"swills","message":"should be","date":"2014-11-26T16:28:09.582Z","type":"message"}
{"nick":"swills","message":"Filesystem         Size    Used   Avail Capacity  Mounted on","date":"2014-11-26T16:28:09.828Z","type":"message"}
{"nick":"swills","message":"/dev/gpt/rootfs    9.7G    1.5G    7.4G    16%    /","date":"2014-11-26T16:28:10.037Z","type":"message"}
{"nick":"swills","message":"(root is on ufs, only the other stuff is on zfs)","date":"2014-11-26T16:28:22.642Z","type":"message"}
{"nick":"swills","message":"i could put it all on zfs, just didn't","date":"2014-11-26T16:28:32.416Z","type":"message"}
{"nick":"swills","message":"but i think it might have kinda mucked up the node","date":"2014-11-26T16:28:44.393Z","type":"message"}
{"nick":"nfitch","message":"Manatee relies on everything postgres related to be in a zfs snapshot.  That's how it restores from the primary to the sync… via a zfs send/receive.  See starting here: https://github.com/joyent/manatee/blob/MANATEE-188/lib/postgresMgr.js#L921","date":"2014-11-26T16:31:30.334Z","type":"message"}
{"nick":"nfitch","message":"The old code didn't change there.","date":"2014-11-26T16:31:46.484Z","type":"message"}
{"nick":"nfitch","message":"I believe it's all controlled via this config paramter: https://gist.github.com/nfitch/675e6ca06b78ed63f485#file-sitter-json-L23","date":"2014-11-26T16:32:44.723Z","type":"message"}
{"nick":"nfitch","message":"But I haven't looked deeply at that code.","date":"2014-11-26T16:32:54.403Z","type":"message"}
{"nick":"swills","message":"all the pg stuff is in a zfs snapshot","date":"2014-11-26T16:34:39.309Z","type":"message"}
{"nick":"swills","message":"but / isn't.","date":"2014-11-26T16:34:46.450Z","type":"message"}
{"nick":"swills","message":"yes, i have this:","date":"2014-11-26T16:35:47.000Z","type":"message"}
{"nick":"swills","message":"        \"snapShotterCfg\": {","date":"2014-11-26T16:35:47.280Z","type":"message"}
{"nick":"swills","message":"            \"// \": \"The manatee ZFS datset.\",","date":"2014-11-26T16:35:47.374Z","type":"message"}
{"nick":"swills","message":"            \"dataset\": \"zfs8/manatee\"","date":"2014-11-26T16:35:47.430Z","type":"message"}
{"nick":"swills","message":"        },","date":"2014-11-26T16:35:48.889Z","type":"message"}
{"nick":"swills","message":"so that getting mounted in / is really confusing to me","date":"2014-11-26T16:36:23.204Z","type":"message"}
{"nick":"nfitch","message":"Oh sorry, I mean the \"zfsClientCfg\" one: https://gist.github.com/nfitch/675e6ca06b78ed63f485#file-sitter-json-L35","date":"2014-11-26T16:36:26.970Z","type":"message"}
{"nick":"swills","message":"            \"dataset\": \"zfs8/manatee\",","date":"2014-11-26T16:37:15.580Z","type":"message"}
{"nick":"swills","message":"is what i have there too","date":"2014-11-26T16:37:18.966Z","type":"message"}
{"nick":"nfitch","message":"This may be where that is coming from: https://github.com/joyent/manatee/blob/MANATEE-188/lib/zfsClient.js#L457","date":"2014-11-26T16:40:54.319Z","type":"message"}
{"nick":"nfitch","message":"But it's strange that the zoneid is in there.","date":"2014-11-26T16:41:08.656Z","type":"message"}
{"nick":"swills","message":"yes","date":"2014-11-26T16:41:27.846Z","type":"message"}
{"nick":"swills","message":"and it's strange that it was mounted on / too","date":"2014-11-26T16:41:36.026Z","type":"message"}
{"nick":"nfitch","message":"If you have logs you may be able to trace back what ZFS actions it took by grepping for ZfsClient","date":"2014-11-26T16:41:40.230Z","type":"message"}
{"nick":"nfitch","message":"I see it logs everything at info level with that msg prefix.","date":"2014-11-26T16:42:11.985Z","type":"message"}
{"nick":"nfitch","message":"What is your full zfsClientCfg?","date":"2014-11-26T16:43:02.514Z","type":"message"}
{"nick":"swills","message":"the logs have likely scrolled away by now","date":"2014-11-26T16:44:28.718Z","type":"message"}
{"nick":"swills","message":"http://pastebin.com/raw.php?i=gz0WCC5U","date":"2014-11-26T16:45:34.217Z","type":"message"}
{"nick":"swills","message":"is my full sitter.json","date":"2014-11-26T16:45:37.075Z","type":"message"}
{"nick":"swills","message":"i left the zoneid alone because i don't have one and i didn't know what it's for","date":"2014-11-26T16:46:41.207Z","type":"message"}
{"nick":"swills","message":"note also that the uuid in that df output above isn't the zoneid listed in the config","date":"2014-11-26T16:46:53.655Z","type":"message"}
{"nick":"swills","message":"man this is weird","date":"2014-11-26T16:51:37.201Z","type":"message"}
{"nick":"swills","message":"so df shows what i pasted above","date":"2014-11-26T16:51:43.015Z","type":"message"}
{"nick":"swills","message":"zfs list shows:","date":"2014-11-26T16:51:53.826Z","type":"message"}
{"nick":"swills","message":"NAME                                                      USED  AVAIL  REFER  MOUNTPOINT","date":"2014-11-26T16:51:54.095Z","type":"message"}
{"nick":"swills","message":"zfs8                                                     81.8M   193G    96K  /zfs8","date":"2014-11-26T16:51:57.492Z","type":"message"}
{"nick":"swills","message":"zfs8/2faf0a64-eb3b-4f19-99fe-112856350de5                 168K   193G    96K  /var/manatee","date":"2014-11-26T16:52:00.561Z","type":"message"}
{"nick":"swills","message":"but then:","date":"2014-11-26T16:52:04.458Z","type":"message"}
{"nick":"swills","message":"$ sudo zfs unmount zfs8/2faf0a64-eb3b-4f19-99fe-112856350de5","date":"2014-11-26T16:52:04.691Z","type":"message"}
{"nick":"swills","message":"cannot unmount 'zfs8/2faf0a64-eb3b-4f19-99fe-112856350de5': not currently mounted","date":"2014-11-26T16:52:04.869Z","type":"message"}
{"nick":"swills","message":"and also:","date":"2014-11-26T16:52:15.929Z","type":"message"}
{"nick":"swills","message":"$ sudo mount","date":"2014-11-26T16:52:16.271Z","type":"message"}
{"nick":"swills","message":"zfs8/2faf0a64-eb3b-4f19-99fe-112856350de5@1416971100943/dev/gpt/rootfs on / (ufs, local, journaled soft-updates)","date":"2014-11-26T16:52:16.411Z","type":"message"}
{"nick":"swills","message":"i'm confused","date":"2014-11-26T16:52:22.517Z","type":"message"}
{"nick":"rmustacc","message":"In genearl, can you please use pastebin, gist, etc. rather than dropping the raw bits into the channel.","date":"2014-11-26T16:52:27.234Z","type":"message"}
{"nick":"rmustacc","message":"*genera","date":"2014-11-26T16:52:30.679Z","type":"message"}
{"nick":"rmustacc","message":"**general","date":"2014-11-26T16:52:33.670Z","type":"message"}
{"nick":"swills","message":"sure","date":"2014-11-26T16:52:38.519Z","type":"message"}
{"nick":"rmustacc","message":"Thanks","date":"2014-11-26T16:52:45.587Z","type":"message"}
{"nick":"rmustacc","message":"swills: In these cases though, what's the automount property of the dataset?","date":"2014-11-26T16:53:25.510Z","type":"message"}
{"nick":"rmustacc","message":"eg. is it in a form that's actually controlled by ZFS?","date":"2014-11-26T16:53:38.287Z","type":"message"}
{"nick":"rmustacc","message":"Not sure if that applies to FBSD.","date":"2014-11-26T16:53:45.784Z","type":"message"}
{"nick":"pgale","date":"2014-11-26T16:53:59.344Z","type":"join"}
{"nick":"swills","message":"there is an automount property","date":"2014-11-26T16:54:36.578Z","type":"message"}
{"nick":"swills","message":"http://pastebin.com/raw.php?i=2ATD7ZWa","date":"2014-11-26T16:54:41.325Z","type":"message"}
{"nick":"swills","message":"that's the output of zfs get all","date":"2014-11-26T16:54:50.931Z","type":"message"}
{"nick":"swills","message":"wait, maybe there isn't automount","date":"2014-11-26T16:55:02.810Z","type":"message"}
{"nick":"rmustacc","message":"Loooks like noauto is turned on.","date":"2014-11-26T16:55:05.504Z","type":"message"}
{"nick":"swills","message":"i didn't set that","date":"2014-11-26T16:55:31.135Z","type":"message"}
{"nick":"swills","message":"heck, i didn't even create the zfs8/2faf0a64-eb3b-4f19-99fe-112856350de5 fs","date":"2014-11-26T16:55:44.956Z","type":"message"}
{"nick":"swills","message":"it got created when it replicated it seems","date":"2014-11-26T16:55:56.152Z","type":"message"}
{"nick":"nfitch","message":"https://github.com/joyent/manatee/blob/MANATEE-188/lib/zfsClient.js#L163","date":"2014-11-26T16:56:08.429Z","type":"message"}
{"nick":"rmustacc","message":"Right, manatee will create datasets and set properties on them.","date":"2014-11-26T16:56:33.189Z","type":"message"}
{"nick":"nfitch","message":"Manatee does all sorts of things with zfs datasets.","date":"2014-11-26T16:56:45.846Z","type":"message"}
{"nick":"swills","message":"going to lunch, brb","date":"2014-11-26T16:57:31.643Z","type":"message"}
{"nick":"lloydde","date":"2014-11-26T17:09:24.928Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 264 seconds","date":"2014-11-26T17:14:17.913Z","type":"quit"}
{"nick":"yunong_","message":"@swills Do you have manatee-sitter logs?","date":"2014-11-26T17:38:56.256Z","type":"message"}
{"nick":"nfitch","message":"yunong_: He said they scrolled out.  Debugging is going to be harder with no logs.","date":"2014-11-26T17:39:47.778Z","type":"message"}
{"nick":"yunong_","message":"what's the problem they're having?","date":"2014-11-26T17:40:03.464Z","type":"message"}
{"nick":"swills","message":"yunong_: no logs, sorry","date":"2014-11-26T17:40:28.643Z","type":"message"}
{"nick":"yunong_","message":"@swills what's the symptom you're seeing?","date":"2014-11-26T17:40:42.222Z","type":"message"}
{"nick":"nfitch","message":"Filesystem                                                                Size    Used   Avail Capacity  Mounted on","date":"2014-11-26T17:40:42.654Z","type":"message"}
{"nick":"nfitch","message":"zfs8/2faf0a64-eb3b-4f19-99fe-112856350de5@1416971100943/dev/gpt/rootfs    9.7G    1.6G    7.3G    18%    /","date":"2014-11-26T17:40:42.710Z","type":"message"}
{"nick":"swills","message":"well, nothing major right now except that weird mount","date":"2014-11-26T17:40:43.853Z","type":"message"}
{"nick":"swills","message":"i have the primary and sync nodes up, that weird mount is on the sync node","date":"2014-11-26T17:42:16.689Z","type":"message"}
{"nick":"swills","message":"let me setup the async node and see what happens... and this time i'll log it all","date":"2014-11-26T17:42:26.151Z","type":"message"}
{"nick":"nfitch","message":"swills: Did you ever figure out where that uuid is coming from (2faf0a64-eb3b-4f19-99fe-112856350de5)?","date":"2014-11-26T17:42:32.772Z","type":"message"}
{"nick":"yunong_","message":"@swills is that dataset created by manatee?","date":"2014-11-26T17:42:46.047Z","type":"message"}
{"nick":"swills","message":"nfitch: nope","date":"2014-11-26T17:43:29.884Z","type":"message"}
{"nick":"swills","message":"yunong_: yes","date":"2014-11-26T17:43:32.045Z","type":"message"}
{"nick":"yunong_","message":"manatee does create temporary datasets when a standby is syncing from the primary.","date":"2014-11-26T17:44:11.642Z","type":"message"}
{"nick":"yunong_","message":"and those are prefixed by a uuid","date":"2014-11-26T17:44:22.840Z","type":"message"}
{"nick":"yunong_","message":"but I don'k know where dev/gpt/rootfs is coming from.","date":"2014-11-26T17:44:33.108Z","type":"message"}
{"nick":"swills","message":"that's the root device for my / fs","date":"2014-11-26T17:44:53.684Z","type":"message"}
{"nick":"swills","message":"or however you want to say it","date":"2014-11-26T17:45:05.091Z","type":"message"}
{"nick":"yunong_","message":"swills: can you do a `zfs list`","date":"2014-11-26T17:45:09.707Z","type":"message"}
{"nick":"swills","message":"http://pastebin.com/bNdGXGUh","date":"2014-11-26T17:45:37.866Z","type":"message"}
{"nick":"swills","message":"http://pastebin.com/yj2pAfST is what it normally should look like","date":"2014-11-26T17:46:09.781Z","type":"message"}
{"nick":"swills","message":"http://pastebin.com/C8YpHZrz is what it looks like right now after manatee did it's thing","date":"2014-11-26T17:46:30.792Z","type":"message"}
{"nick":"yunong_","message":"swills: yeah, so those uuids are most likely temporary backups manatee made","date":"2014-11-26T17:46:46.149Z","type":"message"}
{"nick":"yunong_","message":"can you also do a `zfs get mounted`","date":"2014-11-26T17:47:00.181Z","type":"message"}
{"nick":"swills","message":"http://pastebin.com/xfQzqKuh","date":"2014-11-26T17:48:11.136Z","type":"message"}
{"nick":"swills","message":"so it's not mounted, but df shows it, which is really weird","date":"2014-11-26T17:48:32.192Z","type":"message"}
{"nick":"yunong_","message":"swills: it's not mounted because they were backups.","date":"2014-11-26T17:48:52.957Z","type":"message"}
{"nick":"swills","message":"ok","date":"2014-11-26T17:49:07.627Z","type":"message"}
{"nick":"yunong_","message":"so what happens when a manatee standby rebuilds from the primary is that it first makes a backup of the current zfs dataset and moves it to a new dataset (the ones with the uuids)","date":"2014-11-26T17:49:32.992Z","type":"message"}
{"nick":"swills","message":"ah, ok","date":"2014-11-26T17:49:41.612Z","type":"message"}
{"nick":"swills","message":"so i wonder why df looks so weird","date":"2014-11-26T17:49:47.072Z","type":"message"}
{"nick":"yunong_","message":"when the rebuild finishes successfully the temporary datasets are deleted.","date":"2014-11-26T17:49:49.691Z","type":"message"}
{"nick":"swills","message":"so they are still there does that mean the rebuild didn't finish successfully?","date":"2014-11-26T17:50:14.128Z","type":"message"}
{"nick":"yunong_","message":"however -- if something interrupts the rebuild -- say a manatee crash, then the backups are left orphaned on the fs","date":"2014-11-26T17:50:15.500Z","type":"message"}
{"nick":"pgale","reason":"Quit: Leaving.","date":"2014-11-26T17:50:28.716Z","type":"quit"}
{"nick":"swills","message":"i wonder if i should delete them","date":"2014-11-26T17:50:46.672Z","type":"message"}
{"nick":"yunong_","message":"not necessarily. It means that some rebuilds failed -- but the fact that you have a mounted dataset under /zfs/manatee means there was one that was successful","date":"2014-11-26T17:50:53.119Z","type":"message"}
{"nick":"yunong_","message":"what does `manatee-stat` return?","date":"2014-11-26T17:50:56.562Z","type":"message"}
{"nick":"swills","message":"don't have that command","date":"2014-11-26T17:51:32.404Z","type":"message"}
{"nick":"yunong_","message":"sorry it should be '/$path_to_manatee/bin/manatee-adm status'","date":"2014-11-26T17:52:21.301Z","type":"message"}
{"nick":"swills","message":"returns usage info","date":"2014-11-26T17:52:44.805Z","type":"message"}
{"nick":"yunong_","message":"can you pass it the right configs?","date":"2014-11-26T17:52:54.851Z","type":"message"}
{"nick":"yunong_","message":"IIRC that should be the ZK IP and the shard name","date":"2014-11-26T17:53:04.137Z","type":"message"}
{"nick":"swills","message":"not sure what it wants actually","date":"2014-11-26T17:53:11.298Z","type":"message"}
{"nick":"yunong_","message":"both of which are in the manatee configs","date":"2014-11-26T17:53:14.952Z","type":"message"}
{"nick":"swills","message":"so i have the zk ip","date":"2014-11-26T17:54:33.791Z","type":"message"}
{"nick":"swills","message":"but what is the shard name? the node name?","date":"2014-11-26T17:54:42.336Z","type":"message"}
{"nick":"swills","message":"is that the same as the shard path?","date":"2014-11-26T17:54:52.445Z","type":"message"}
{"nick":"yunong_","message":"swills: from your config it should just be \"1\"","date":"2014-11-26T17:55:17.700Z","type":"message"}
{"nick":"yunong_","message":"although you don't have to pass a shard name to status","date":"2014-11-26T17:55:27.633Z","type":"message"}
{"nick":"yunong_","message":"it'll print out all shards if the shard name is emtpy","date":"2014-11-26T17:55:34.594Z","type":"message"}
{"nick":"swills","message":"http://pastebin.com/dD0SbvR5","date":"2014-11-26T17:56:08.301Z","type":"message"}
{"nick":"swills","message":"i'm ignoring the lack of dtrace support in node for now...","date":"2014-11-26T17:56:51.869Z","type":"message"}
{"nick":"bixu_","date":"2014-11-26T17:57:08.567Z","type":"quit"}
{"nick":"yunong_","message":"swills: https://github.com/joyent/manatee/blob/master/docs/trouble-shooting.md#manatee-adm","date":"2014-11-26T17:57:52.143Z","type":"message"}
{"nick":"yunong_","message":"so your cluster looks good for now","date":"2014-11-26T17:57:56.298Z","type":"message"}
{"nick":"yunong_","message":"you can safely delete those orphaned datasets","date":"2014-11-26T17:58:04.299Z","type":"message"}
{"nick":"swills","message":"yunong_: awesome, thanks!","date":"2014-11-26T17:58:31.935Z","type":"message"}
{"nick":"yunong_","message":"swills: no a problem -- let me know if you have any further issues. I'm ecstatic to see someone else running manatee.","date":"2014-11-26T17:59:00.215Z","type":"message"}
{"nick":"swills","message":"df is still confused, but i'm going to chalk this up to a potential freebsd bug","date":"2014-11-26T17:59:06.748Z","type":"message"}
{"nick":"swills","message":"yunong_: oh, i will bug you! :)","date":"2014-11-26T17:59:20.574Z","type":"message"}
{"nick":"yunong_","message":"swills: the trouble-shooting docs are usually a good start too. I'm sure there are bugs in the docs -- so feel free to file them","date":"2014-11-26T17:59:46.361Z","type":"message"}
{"nick":"swills","message":"we have bhyve which could serve as a replacement for kvm i think so i have long term big dreams of running all of sdc on FreeBSD! :)","date":"2014-11-26T17:59:53.875Z","type":"message"}
{"nick":"swills","message":"yunong_: will do, thanks. i need to read the docs in more detail...","date":"2014-11-26T18:00:05.173Z","type":"message"}
{"nick":"swills","message":"so now i have the primary and sync nodes working, time to setup the async node","date":"2014-11-26T18:01:20.903Z","type":"message"}
{"nick":"yunong_","message":"one more unto the breach","date":"2014-11-26T18:01:38.097Z","type":"message"}
{"nick":"swills","message":"this is all running in google cloud, ironicly","date":"2014-11-26T18:02:10.987Z","type":"message"}
{"nick":"swills","message":"ironically even","date":"2014-11-26T18:02:25.610Z","type":"message"}
{"nick":"lloydde_","date":"2014-11-26T18:10:16.284Z","type":"join"}
{"nick":"trentm1","date":"2014-11-26T18:11:05.087Z","type":"join"}
{"nick":"swills","message":"one thing i just noticed, in the sample sitter.json config, the ip of the node is not the same as the ip in the connstr in the zkCfg section","date":"2014-11-26T18:11:43.519Z","type":"message"}
{"nick":"abraxas_","date":"2014-11-26T18:11:50.715Z","type":"join"}
{"nick":"trentm","reason":"Ping timeout: 245 seconds","date":"2014-11-26T18:11:58.140Z","type":"quit"}
{"nick":"swills","message":"does this mean they should all talk to the central zk rather than the one running on the local node?","date":"2014-11-26T18:12:02.415Z","type":"message"}
{"nick":"swills","message":"or should zk run on a different set of nodes than manatee/pgsql?","date":"2014-11-26T18:12:20.439Z","type":"message"}
{"nick":"swills","message":"i guess i was expecting to run zk on each node and have each manatee talk to the local zk","date":"2014-11-26T18:12:43.238Z","type":"message"}
{"nick":"yunong_","message":"swills: they can talk to any zk in the cluster","date":"2014-11-26T18:13:18.261Z","type":"message"}
{"nick":"yunong_","message":"though you should provide manatee with all the zk ips -- the zk client will randomly pick one","date":"2014-11-26T18:13:33.610Z","type":"message"}
{"nick":"swills","message":"oh, ok","date":"2014-11-26T18:13:43.768Z","type":"message"}
{"nick":"swills","message":"the sample only shows one","date":"2014-11-26T18:13:52.529Z","type":"message"}
{"nick":"lloydde_","reason":"Ping timeout: 255 seconds","date":"2014-11-26T18:14:58.285Z","type":"quit"}
{"nick":"abraxas_","reason":"Ping timeout: 264 seconds","date":"2014-11-26T18:16:54.152Z","type":"quit"}
{"nick":"swills","message":"yunong_: is the zoneid used anywhere except the status?","date":"2014-11-26T18:17:05.642Z","type":"message"}
{"nick":"yunong_","message":"swills: let me check the source","date":"2014-11-26T18:18:38.837Z","type":"message"}
{"nick":"swills","message":"sure, sorry, i should have just done that rather than bother you","date":"2014-11-26T18:19:40.477Z","type":"message"}
{"nick":"yunong_","message":"swills: looks like it's used as an identifier for a manatee node.","date":"2014-11-26T18:20:01.021Z","type":"message"}
{"nick":"yunong_","message":"you can name it to whatever you like.","date":"2014-11-26T18:20:09.248Z","type":"message"}
{"nick":"swills","message":"oh, ok","date":"2014-11-26T18:20:57.318Z","type":"message"}
{"nick":"swills","message":"i suppose they should at least be unique, eh? :)","date":"2014-11-26T18:21:09.157Z","type":"message"}
{"nick":"yunong_","message":"yeah -- for your own sanity.","date":"2014-11-26T18:25:15.720Z","type":"message"}
{"nick":"swills","message":"probably not totally insane to just stick the hostname in there for now","date":"2014-11-26T18:26:17.296Z","type":"message"}
{"nick":"marsell","reason":"Ping timeout: 240 seconds","date":"2014-11-26T18:29:57.149Z","type":"quit"}
{"nick":"swills","message":"http://pastebin.com/4chBw2Gn","date":"2014-11-26T18:39:11.807Z","type":"message"}
{"nick":"swills","message":"boom!","date":"2014-11-26T18:39:13.089Z","type":"message"}
{"nick":"dap_","date":"2014-11-26T18:40:22.069Z","type":"join"}
{"nick":"marsell","date":"2014-11-26T18:42:39.283Z","type":"join"}
{"nick":"yunong_","message":"nice!","date":"2014-11-26T18:42:57.125Z","type":"message"}
{"nick":"swills","message":"so right now i have started the sitter/snapshotter/backupserver manually as root because we don't have smf","date":"2014-11-26T18:44:53.551Z","type":"message"}
{"nick":"swills","message":"i can create init scripts, but i wonder about what user they are running as","date":"2014-11-26T18:45:03.773Z","type":"message"}
{"nick":"swills","message":"that and a few other minor issues and i should be able to package this up","date":"2014-11-26T18:45:26.382Z","type":"message"}
{"nick":"swills","message":"interesting, on the async node i didn't have a leftover fs","date":"2014-11-26T18:46:28.443Z","type":"message"}
{"nick":"swills","message":"tho df is confused again","date":"2014-11-26T18:46:33.817Z","type":"message"}
{"nick":"dap_","message":"swills: Cool!  FYI, we're making some substantial changes to some of the guts of manatee, but they're not ready to integrate yet.  Design details are at github.com/joyent/manatee-design/, and we're working in branch MANATEE-188 of the manatee repo.","date":"2014-11-26T18:47:18.354Z","type":"message"}
{"nick":"nahamu","message":"sticking with ZK rather than switching to e.g. raft...","date":"2014-11-26T18:48:34.961Z","type":"message"}
{"nick":"dap_","message":"nahamu: one thing at a time ;)","date":"2014-11-26T18:48:44.650Z","type":"message"}
{"nick":"swills","message":"dap_: yeah, someone mentioned the branch, thanks","date":"2014-11-26T18:49:19.594Z","type":"message"}
{"nick":"dap_","message":"Cool","date":"2014-11-26T18:49:27.027Z","type":"message"}
{"nick":"swills","message":"i'm not sure what the changes will mean for me yet, haven't had time to look too closely yet","date":"2014-11-26T18:49:31.175Z","type":"message"}
{"nick":"swills","message":"i wonder if you guys have looked at consul or how it might fit in?","date":"2014-11-26T18:50:49.390Z","type":"message"}
{"nick":"yunong_","message":"it runs on go right?","date":"2014-11-26T18:51:11.681Z","type":"message"}
{"nick":"swills","message":"well, it's written in go","date":"2014-11-26T18:51:28.342Z","type":"message"}
{"nick":"swills","message":"the go runtime is just standard binaries","date":"2014-11-26T18:51:36.904Z","type":"message"}
{"nick":"nahamu","message":"if it uses any C libraries, cgo doesn't work on illumos yet...","date":"2014-11-26T18:53:09.478Z","type":"message"}
{"nick":"nahamu","message":"(\"it\" being consul... if it's pure go, it's probably fine)","date":"2014-11-26T18:53:30.121Z","type":"message"}
{"nick":"swills","message":"i don't think ot uses any external libs","date":"2014-11-26T18:53:39.946Z","type":"message"}
{"nick":"nfitch","message":"nahamu: You're a little behind the times.  We're really, really, close (and perhaps done) getting cgo working in illumos.","date":"2014-11-26T18:54:11.154Z","type":"message"}
{"nick":"nfitch","message":":)","date":"2014-11-26T18:54:17.549Z","type":"message"}
{"nick":"swills","message":"oh good","date":"2014-11-26T18:54:17.764Z","type":"message"}
{"nick":"nfitch","message":"That said, it didn't work at the time of Manta being written.","date":"2014-11-26T18:54:41.388Z","type":"message"}
{"nick":"nfitch","message":"So… zookeeper.","date":"2014-11-26T18:54:45.754Z","type":"message"}
{"nick":"swills","message":"*nod* fair enough","date":"2014-11-26T18:55:04.218Z","type":"message"}
{"nick":"swills","message":"i just found out about consul myself, but i kinda like it","date":"2014-11-26T18:55:12.514Z","type":"message"}
{"nick":"swills","message":"but then i tend to like Go stuff better than Java","date":"2014-11-26T18:55:29.376Z","type":"message"}
{"nick":"chorrell","reason":"Quit: Textual IRC Client: www.textualapp.com","date":"2014-11-26T18:56:18.323Z","type":"quit"}
{"nick":"nahamu","message":"nfitch: poor Keith. ;)","date":"2014-11-26T19:02:51.884Z","type":"message"}
{"nick":"nahamu","message":"good for the rest of us, though...","date":"2014-11-26T19:03:05.114Z","type":"message"}
{"nick":"nfitch","message":"nahamu: Indeed, watching it was painful.","date":"2014-11-26T19:03:42.002Z","type":"message"}
{"nick":"Aram","date":"2014-11-26T19:04:53.243Z","type":"join"}
{"nick":"lloydde_","date":"2014-11-26T19:11:06.282Z","type":"join"}
{"nick":"pgale","date":"2014-11-26T19:11:17.989Z","type":"join"}
{"nick":"lloydde_","reason":"Ping timeout: 255 seconds","date":"2014-11-26T19:15:16.283Z","type":"quit"}
{"nick":"pgale","reason":"Ping timeout: 240 seconds","date":"2014-11-26T19:20:54.307Z","type":"quit"}
{"nick":"pgale","date":"2014-11-26T19:29:52.932Z","type":"join"}
{"nick":"chorrell","date":"2014-11-26T19:33:43.165Z","type":"join"}
{"nick":"pgale","reason":"Quit: Leaving.","date":"2014-11-26T19:38:44.745Z","type":"quit"}
{"nick":"abraxas_","date":"2014-11-26T20:00:37.254Z","type":"join"}
{"nick":"abraxas_","reason":"Ping timeout: 265 seconds","date":"2014-11-26T20:05:31.611Z","type":"quit"}
{"nick":"lloydde","date":"2014-11-26T20:12:09.374Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 240 seconds","date":"2014-11-26T20:16:25.896Z","type":"quit"}
{"nick":"ed209","reason":"Remote host closed the connection","date":"2014-11-26T20:20:01.376Z","type":"quit"}
{"nick":"ed209","date":"2014-11-26T20:20:19.023Z","type":"join"}
{"nick":"chorrell_","date":"2014-11-26T20:28:57.638Z","type":"join"}
{"nick":"chorrell","reason":"Read error: Connection reset by peer","date":"2014-11-26T20:28:58.677Z","type":"quit"}
{"nick":"chorrell_","reason":"Client Quit","date":"2014-11-26T20:29:55.829Z","type":"quit"}
{"nick":"chorrell","date":"2014-11-26T20:30:12.079Z","type":"join"}
{"nick":"axisys","reason":"Remote host closed the connection","date":"2014-11-26T20:32:23.400Z","type":"quit"}
{"nick":"axisys","date":"2014-11-26T20:38:18.788Z","type":"join"}
{"nick":"axisys","reason":"Changing host","date":"2014-11-26T20:39:19.746Z","type":"quit"}
{"nick":"axisys","date":"2014-11-26T20:39:19.802Z","type":"join"}
{"nick":"bahamas10","reason":"Ping timeout: 272 seconds","date":"2014-11-26T20:49:11.900Z","type":"quit"}
{"nick":"bahamas10","date":"2014-11-26T20:51:06.245Z","type":"join"}
{"nick":"pmooney","reason":"Ping timeout: 272 seconds","date":"2014-11-26T20:55:31.982Z","type":"quit"}
{"nick":"chorrell","reason":"Quit: Textual IRC Client: www.textualapp.com","date":"2014-11-26T21:07:33.856Z","type":"quit"}
{"nick":"bahamas10","reason":"Ping timeout: 272 seconds","date":"2014-11-26T21:09:27.854Z","type":"quit"}
{"nick":"bahamas10","date":"2014-11-26T21:11:31.006Z","type":"join"}
{"nick":"lloydde","date":"2014-11-26T21:12:40.115Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 240 seconds","date":"2014-11-26T21:16:57.115Z","type":"quit"}
{"nick":"pmooney","date":"2014-11-26T21:21:14.257Z","type":"join"}
{"nick":"chorrell","date":"2014-11-26T21:43:20.278Z","type":"join"}
{"nick":"lloydde","date":"2014-11-26T22:13:26.279Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 255 seconds","date":"2014-11-26T22:17:58.281Z","type":"quit"}
{"nick":"chorrell","reason":"Quit: Textual IRC Client: www.textualapp.com","date":"2014-11-26T22:21:38.451Z","type":"quit"}
{"nick":"lloydde","date":"2014-11-26T23:14:17.281Z","type":"join"}
{"nick":"lloydde","reason":"Ping timeout: 255 seconds","date":"2014-11-26T23:18:43.281Z","type":"quit"}
{"nick":"abraxas_","date":"2014-11-26T23:38:28.939Z","type":"join"}
{"nick":"abraxas_","reason":"Ping timeout: 264 seconds","date":"2014-11-26T23:43:18.315Z","type":"quit"}
{"nick":"bahamas10","reason":"Ping timeout: 244 seconds","date":"2014-11-26T23:53:35.069Z","type":"quit"}
