{"nick":"paulfryzel","date":"2014-03-24T00:06:51.350Z","type":"join"}
{"nick":"chorrell","date":"2014-03-24T00:09:07.432Z","type":"join"}
{"nick":"notmatt","date":"2014-03-24T00:10:35.890Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 246 seconds","date":"2014-03-24T00:11:17.143Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T00:11:38.582Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 240 seconds","date":"2014-03-24T00:16:18.368Z","type":"quit"}
{"nick":"marsell","date":"2014-03-24T00:17:01.446Z","type":"join"}
{"nick":"therealkoopa","date":"2014-03-24T00:19:59.837Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 252 seconds","date":"2014-03-24T00:27:07.592Z","type":"quit"}
{"nick":"AvianFlu","reason":"Remote host closed the connection","date":"2014-03-24T00:44:30.984Z","type":"quit"}
{"nick":"marsell","reason":"Quit: marsell","date":"2014-03-24T00:51:40.428Z","type":"quit"}
{"nick":"nfitch","date":"2014-03-24T00:52:27.088Z","type":"join"}
{"nick":"nfitch","reason":"Ping timeout: 246 seconds","date":"2014-03-24T00:56:47.155Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T00:58:49.569Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 268 seconds","date":"2014-03-24T01:04:00.318Z","type":"quit"}
{"nick":"paulfryzel","date":"2014-03-24T01:07:34.342Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 246 seconds","date":"2014-03-24T01:11:50.108Z","type":"quit"}
{"nick":"AvianFlu","date":"2014-03-24T01:16:04.336Z","type":"join"}
{"nick":"ed209","reason":"Remote host closed the connection","date":"2014-03-24T01:20:00.706Z","type":"quit"}
{"nick":"ed209","date":"2014-03-24T01:20:08.870Z","type":"join"}
{"nick":"therealkoopa","date":"2014-03-24T01:22:33.520Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 264 seconds","date":"2014-03-24T01:30:31.343Z","type":"quit"}
{"nick":"bixu_","date":"2014-03-24T01:41:42.192Z","type":"join"}
{"nick":"bixu","reason":"Ping timeout: 240 seconds","date":"2014-03-24T01:44:18.422Z","type":"quit"}
{"nick":"chorrell","reason":"Quit: Textual IRC Client: www.textualapp.com","date":"2014-03-24T02:05:29.872Z","type":"quit"}
{"nick":"paulfryzel","date":"2014-03-24T02:08:19.606Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 240 seconds","date":"2014-03-24T02:12:38.365Z","type":"quit"}
{"nick":"nfitch","date":"2014-03-24T02:41:12.339Z","type":"join"}
{"nick":"nfitch","reason":"Ping timeout: 240 seconds","date":"2014-03-24T02:45:18.286Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T02:53:15.653Z","type":"join"}
{"nick":"fredk","date":"2014-03-24T02:55:16.189Z","type":"join"}
{"nick":"fredk","reason":"Client Quit","date":"2014-03-24T02:55:42.363Z","type":"quit"}
{"nick":"therealkoopa","reason":"Ping timeout: 240 seconds","date":"2014-03-24T02:57:37.382Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T03:01:26.548Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 264 seconds","date":"2014-03-24T03:05:55.310Z","type":"quit"}
{"nick":"paulfryzel","date":"2014-03-24T03:09:09.551Z","type":"join"}
{"nick":"therealkoopa","date":"2014-03-24T03:12:39.119Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 268 seconds","date":"2014-03-24T03:14:07.271Z","type":"quit"}
{"nick":"therealkoopa","reason":"Ping timeout: 240 seconds","date":"2014-03-24T03:16:58.820Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T03:41:02.636Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 264 seconds","date":"2014-03-24T03:45:31.318Z","type":"quit"}
{"nick":"marsell","date":"2014-03-24T03:51:35.353Z","type":"join"}
{"nick":"paulfryzel","date":"2014-03-24T04:09:53.078Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 240 seconds","date":"2014-03-24T04:13:58.823Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T04:22:41.435Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 268 seconds","date":"2014-03-24T04:27:30.225Z","type":"quit"}
{"nick":"nfitch","date":"2014-03-24T04:29:57.450Z","type":"join"}
{"nick":"notmatt","reason":"Remote host closed the connection","date":"2014-03-24T04:31:41.438Z","type":"quit"}
{"nick":"nfitch","reason":"Ping timeout: 240 seconds","date":"2014-03-24T04:34:01.389Z","type":"quit"}
{"nick":"notmatt_","date":"2014-03-24T04:35:31.533Z","type":"join"}
{"nick":"marsell","reason":"Quit: marsell","date":"2014-03-24T05:02:30.213Z","type":"quit"}
{"nick":"paulfryzel","date":"2014-03-24T05:10:39.681Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 240 seconds","date":"2014-03-24T05:14:49.453Z","type":"quit"}
{"nick":"notmatt_","reason":"Remote host closed the connection","date":"2014-03-24T05:49:10.744Z","type":"quit"}
{"nick":"ins0mnia","date":"2014-03-24T05:58:54.625Z","type":"join"}
{"nick":"AvianFlu","reason":"Remote host closed the connection","date":"2014-03-24T05:58:56.777Z","type":"quit"}
{"nick":"AvianFlu","date":"2014-03-24T05:59:26.385Z","type":"join"}
{"nick":"AvianFlu","reason":"Ping timeout: 268 seconds","date":"2014-03-24T06:04:19.251Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T06:14:07.604Z","type":"join"}
{"nick":"nfitch","date":"2014-03-24T06:18:41.409Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 240 seconds","date":"2014-03-24T06:18:49.487Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T06:22:47.541Z","type":"join"}
{"nick":"nfitch","reason":"Ping timeout: 240 seconds","date":"2014-03-24T06:22:58.354Z","type":"quit"}
{"nick":"therealkoopa","reason":"Ping timeout: 264 seconds","date":"2014-03-24T06:27:31.311Z","type":"quit"}
{"nick":"ghostbar","date":"2014-03-24T06:29:24.667Z","type":"quit"}
{"nick":"marsell","date":"2014-03-24T06:52:29.407Z","type":"join"}
{"nick":"paulfryzel","date":"2014-03-24T07:12:18.361Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 246 seconds","date":"2014-03-24T07:16:32.149Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T07:22:37.354Z","type":"join"}
{"nick":"notmatt","date":"2014-03-24T07:25:19.395Z","type":"join"}
{"nick":"notmatt","reason":"Ping timeout: 252 seconds","date":"2014-03-24T07:29:26.349Z","type":"quit"}
{"nick":"therealkoopa","reason":"Ping timeout: 246 seconds","date":"2014-03-24T07:30:32.169Z","type":"quit"}
{"nick":"bsdguru","message":"good morning guys","date":"2014-03-24T07:46:29.430Z","type":"message"}
{"nick":"bsdguru","message":"was manta having an issue this morning","date":"2014-03-24T07:46:39.623Z","type":"message"}
{"nick":"bsdguru","message":"been seeing a 6.6k 503 errors for package tarballs from manta","date":"2014-03-24T07:47:05.394Z","type":"message"}
{"nick":"bsdguru","message":"any ideas what caused the blip on manta?","date":"2014-03-24T07:53:12.554Z","type":"message"}
{"nick":"nfitch","date":"2014-03-24T08:07:31.118Z","type":"join"}
{"nick":"nfitch","reason":"Ping timeout: 268 seconds","date":"2014-03-24T08:12:35.167Z","type":"quit"}
{"nick":"paulfryzel","date":"2014-03-24T08:12:59.468Z","type":"join"}
{"nick":"bsdguru","reason":"Quit: bsdguru","date":"2014-03-24T08:15:12.969Z","type":"quit"}
{"nick":"paulfryzel","reason":"Ping timeout: 268 seconds","date":"2014-03-24T08:17:31.154Z","type":"quit"}
{"nick":"mamash","date":"2014-03-24T08:30:52.239Z","type":"join"}
{"nick":"bsdguru","date":"2014-03-24T08:31:04.406Z","type":"join"}
{"nick":"notmatt","date":"2014-03-24T09:13:21.852Z","type":"join"}
{"nick":"paulfryzel","date":"2014-03-24T09:13:43.333Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 246 seconds","date":"2014-03-24T09:17:59.248Z","type":"quit"}
{"nick":"notmatt","reason":"Ping timeout: 265 seconds","date":"2014-03-24T09:18:05.718Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T09:39:08.435Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 268 seconds","date":"2014-03-24T09:43:51.167Z","type":"quit"}
{"nick":"notmatt","date":"2014-03-24T09:49:47.421Z","type":"join"}
{"nick":"notmatt","reason":"Ping timeout: 268 seconds","date":"2014-03-24T09:54:57.146Z","type":"quit"}
{"nick":"bixu_","new_nick":"bixu","date":"2014-03-24T09:55:55.001Z","type":"nick"}
{"nick":"nfitch","date":"2014-03-24T09:56:13.841Z","type":"join"}
{"nick":"nfitch","reason":"Ping timeout: 252 seconds","date":"2014-03-24T10:00:30.071Z","type":"quit"}
{"nick":"paulfryzel","date":"2014-03-24T10:14:42.357Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 246 seconds","date":"2014-03-24T10:18:53.149Z","type":"quit"}
{"nick":"bixu_","date":"2014-03-24T10:27:50.741Z","type":"join"}
{"nick":"bixu","reason":"Ping timeout: 246 seconds","date":"2014-03-24T10:29:02.147Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T10:50:51.310Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 246 seconds","date":"2014-03-24T10:55:17.147Z","type":"quit"}
{"nick":"bixu","date":"2014-03-24T11:02:41.122Z","type":"join"}
{"nick":"bixu_","reason":"Ping timeout: 252 seconds","date":"2014-03-24T11:03:11.821Z","type":"quit"}
{"nick":"paulfryzel","date":"2014-03-24T11:15:19.404Z","type":"join"}
{"nick":"therealkoopa","date":"2014-03-24T11:15:54.664Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 268 seconds","date":"2014-03-24T11:20:03.084Z","type":"quit"}
{"nick":"therealkoopa","reason":"Ping timeout: 264 seconds","date":"2014-03-24T11:20:55.418Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T11:22:50.338Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 246 seconds","date":"2014-03-24T11:27:08.204Z","type":"quit"}
{"nick":"nfitch","date":"2014-03-24T11:45:02.100Z","type":"join"}
{"nick":"nfitch","reason":"Ping timeout: 246 seconds","date":"2014-03-24T11:49:11.111Z","type":"quit"}
{"nick":"paulfryzel","date":"2014-03-24T12:16:03.568Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 264 seconds","date":"2014-03-24T12:20:55.358Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T12:22:41.903Z","type":"join"}
{"nick":"therealkoopa","reason":"Ping timeout: 240 seconds","date":"2014-03-24T12:26:58.718Z","type":"quit"}
{"nick":"AvianFlu","date":"2014-03-24T12:44:25.979Z","type":"join"}
{"nick":"chorrell","date":"2014-03-24T13:00:31.700Z","type":"join"}
{"nick":"bixu","reason":"Ping timeout: 246 seconds","date":"2014-03-24T13:00:56.169Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T13:03:19.394Z","type":"join"}
{"nick":"paulfryzel","date":"2014-03-24T13:16:51.305Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 246 seconds","date":"2014-03-24T13:21:14.224Z","type":"quit"}
{"nick":"mamash","date":"2014-03-24T13:29:30.569Z","type":"part"}
{"nick":"bixu","date":"2014-03-24T13:33:37.047Z","type":"join"}
{"nick":"nfitch","date":"2014-03-24T13:33:49.118Z","type":"join"}
{"nick":"nfitch","reason":"Ping timeout: 268 seconds","date":"2014-03-24T13:38:48.194Z","type":"quit"}
{"nick":"paulfryzel","date":"2014-03-24T14:17:33.389Z","type":"join"}
{"nick":"paulfryzel","reason":"Ping timeout: 246 seconds","date":"2014-03-24T14:22:08.120Z","type":"quit"}
{"nick":"paulfryzel","date":"2014-03-24T14:48:29.443Z","type":"join"}
{"nick":"bsdguru","reason":"Quit: bsdguru","date":"2014-03-24T14:56:50.870Z","type":"quit"}
{"nick":"paulfryzel","reason":"Read error: Connection reset by peer","date":"2014-03-24T15:41:39.970Z","type":"quit"}
{"nick":"ryancnelson","date":"2014-03-24T15:42:01.532Z","type":"join"}
{"nick":"paulfryzel","date":"2014-03-24T15:42:04.433Z","type":"join"}
{"nick":"seldo","date":"2014-03-24T15:42:46.253Z","type":"join"}
{"nick":"seldo","reason":"Remote host closed the connection","date":"2014-03-24T15:49:23.962Z","type":"quit"}
{"nick":"nfitch","date":"2014-03-24T15:50:44.605Z","type":"join"}
{"nick":"seldo","date":"2014-03-24T15:51:28.819Z","type":"join"}
{"nick":"fredk","date":"2014-03-24T15:51:49.661Z","type":"join"}
{"nick":"seldo","reason":"Remote host closed the connection","date":"2014-03-24T15:55:28.681Z","type":"quit"}
{"nick":"seldo","date":"2014-03-24T15:55:47.242Z","type":"join"}
{"nick":"notmatt","date":"2014-03-24T16:01:38.789Z","type":"join"}
{"nick":"notmatt","reason":"Remote host closed the connection","date":"2014-03-24T16:04:09.173Z","type":"quit"}
{"nick":"chorrell","new_nick":"chorrell-away","date":"2014-03-24T16:11:51.479Z","type":"nick"}
{"nick":"dap_","date":"2014-03-24T16:18:23.747Z","type":"join"}
{"nick":"seldo","reason":"Remote host closed the connection","date":"2014-03-24T16:20:42.846Z","type":"quit"}
{"nick":"seldo","date":"2014-03-24T16:21:08.047Z","type":"join"}
{"nick":"chorrell-away","new_nick":"chorrell","date":"2014-03-24T16:22:24.668Z","type":"nick"}
{"nick":"seldo","reason":"Remote host closed the connection","date":"2014-03-24T16:24:35.581Z","type":"quit"}
{"nick":"yunong","date":"2014-03-24T16:28:55.120Z","type":"join"}
{"nick":"chorrell","new_nick":"chorrell-away","date":"2014-03-24T16:34:59.600Z","type":"nick"}
{"nick":"chorrell-away","new_nick":"chorrell","date":"2014-03-24T16:36:20.645Z","type":"nick"}
{"nick":"bsdguru","date":"2014-03-24T16:38:25.133Z","type":"join"}
{"nick":"notmatt","date":"2014-03-24T16:46:54.283Z","type":"join"}
{"nick":"chorrell","new_nick":"chorrell-away","date":"2014-03-24T17:14:23.731Z","type":"nick"}
{"nick":"yunong","reason":"Ping timeout: 246 seconds","date":"2014-03-24T17:17:29.156Z","type":"quit"}
{"nick":"yunong","date":"2014-03-24T17:18:21.969Z","type":"join"}
{"nick":"chorrell-away","new_nick":"chorrell","date":"2014-03-24T17:20:16.970Z","type":"nick"}
{"nick":"nshalman","new_nick":"nahamu_","date":"2014-03-24T17:25:09.607Z","type":"nick"}
{"nick":"nahamu","new_nick":"nshalman","date":"2014-03-24T17:25:46.318Z","type":"nick"}
{"nick":"yunong","reason":"Quit: Leaving.","date":"2014-03-24T17:25:57.074Z","type":"quit"}
{"nick":"nahamu_","new_nick":"nahamu","date":"2014-03-24T17:26:20.156Z","type":"nick"}
{"nick":"seldo","date":"2014-03-24T17:33:10.629Z","type":"join"}
{"nick":"ringzero","date":"2014-03-24T18:03:45.063Z","type":"join"}
{"nick":"ryancnelson","reason":"Quit: Leaving.","date":"2014-03-24T18:04:01.758Z","type":"quit"}
{"nick":"marsell","reason":"Ping timeout: 264 seconds","date":"2014-03-24T18:07:07.428Z","type":"quit"}
{"nick":"marsell","date":"2014-03-24T18:28:56.398Z","type":"join"}
{"nick":"bsdguru","reason":"Quit: bsdguru","date":"2014-03-24T18:32:28.846Z","type":"quit"}
{"nick":"yunong","date":"2014-03-24T18:35:00.671Z","type":"join"}
{"nick":"AvianFlu","reason":"Remote host closed the connection","date":"2014-03-24T18:50:07.540Z","type":"quit"}
{"nick":"isaacs","message":"We just saw a weird burst of 500 errors.","date":"2014-03-24T18:56:59.291Z","type":"message"}
{"nick":"seldo","message":"Hello manta folks","date":"2014-03-24T18:56:59.506Z","type":"message"}
{"nick":"isaacs","message":"any alarms going off over there?","date":"2014-03-24T18:57:03.685Z","type":"message"}
{"nick":"isaacs","message":"yunong dap_ fredk et al.","date":"2014-03-24T18:57:13.198Z","type":"message"}
{"nick":"ceejbot","date":"2014-03-24T18:57:38.911Z","type":"join"}
{"nick":"yunong","message":"isaacs: We're upgrading our metadata tier this morning -- you should see intermittent 500s for about ~30s","date":"2014-03-24T18:58:13.729Z","type":"message"}
{"nick":"isaacs","message":"yunong: can you tell us which hosts you're doing stuff on, preferrably ahead of time?","date":"2014-03-24T18:58:39.010Z","type":"message"}
{"nick":"isaacs","message":"yunong: we can easily take manta hosts out of rotation to avoid anyone seeing a 500 on a tgz request.","date":"2014-03-24T18:59:06.174Z","type":"message"}
{"nick":"isaacs","message":"but if there's a burst of download errors, we get a bunch of people complaining about it","date":"2014-03-24T18:59:34.171Z","type":"message"}
{"nick":"yunong","message":"isaacs: I'm not sure how that would help. If you're familiar with the architecture of manta, your keys are consistently hashed to a set of shards, when we upgrade a shard, it'll go off line for about 30s, which means keys that hash to that shard are unavailable.","date":"2014-03-24T18:59:48.434Z","type":"message"}
{"nick":"seldo","message":"yunong: is the interruption we saw just now a manta thing, or did something happen to us-east?","date":"2014-03-24T19:02:16.382Z","type":"message"}
{"nick":"yunong","message":"seldo: this is isolated to manta, and to be specific a subset of keys in manta.","date":"2014-03-24T19:02:43.185Z","type":"message"}
{"nick":"seldo","message":"We saw 8 minutes where our request volume dropped by half","date":"2014-03-24T19:02:43.693Z","type":"message"}
{"nick":"seldo","message":"And errors spiked across the board","date":"2014-03-24T19:02:51.538Z","type":"message"}
{"nick":"seldo","message":"Which is roughly what would happen if we lost the half of our capacity that's in us-east","date":"2014-03-24T19:03:07.655Z","type":"message"}
{"nick":"bsdguru","date":"2014-03-24T19:03:20.547Z","type":"join"}
{"nick":"ringzero","date":"2014-03-24T19:10:14.540Z","type":"quit"}
{"nick":"yunong","message":"We're pausing the manta upgrades for now. We'll be continuing upgrades in about 90 mins. I'll be send out a message to the mailing list and in this channel when we resume.","date":"2014-03-24T19:15:25.339Z","type":"message"}
{"nick":"nahamu","message":"there's a mailing list?","date":"2014-03-24T19:15:40.796Z","type":"message"}
{"nick":"nahamu","message":"or do you mean customers?","date":"2014-03-24T19:15:59.065Z","type":"message"}
{"nick":"bsdguru","message":"yunong: what was the cause of the 8 minutes of downtime a short while ago?","date":"2014-03-24T19:20:54.144Z","type":"message"}
{"nick":"yunong","message":"nahamu: sorry, we had a mailing list for beta customers. We'll be setting up a better channel for communicating upgrades going forward.","date":"2014-03-24T19:21:37.235Z","type":"message"}
{"nick":"nahamu","message":"I might be on that list.","date":"2014-03-24T19:21:59.304Z","type":"message"}
{"nick":"yunong","message":"bsdguru: If you check the IRC logs, you'll see what the outage was caused by.","date":"2014-03-24T19:22:58.838Z","type":"message"}
{"nick":"yunong","message":"bsdsguru: http://logs.libuv.org/manta/latest#18:58:13.729","date":"2014-03-24T19:24:23.296Z","type":"message"}
{"nick":"yunong","message":"Apologies on not communicating the upgrade in advance, that's something we'll be doing going forward.","date":"2014-03-24T19:34:21.200Z","type":"message"}
{"nick":"ceejbot","reason":"Remote host closed the connection","date":"2014-03-24T19:37:35.578Z","type":"quit"}
{"nick":"bsdguru","message":"also if there is some sort of guide to how manta is put together so we can gauge how service impacting a maintenance is going to be would be useful","date":"2014-03-24T19:40:42.639Z","type":"message"}
{"nick":"bsdguru","message":"understanding that doing stuff on the metadata teir takes outs out binary serving by half would be useful to understand","date":"2014-03-24T19:41:19.351Z","type":"message"}
{"nick":"nahamu","message":"https://www.usenix.org/conference/lisa13/manta-storage-system-internals","date":"2014-03-24T19:42:24.777Z","type":"message"}
{"nick":"nahamu","message":"I wonder if his slides from that are posted somewhere public...","date":"2014-03-24T19:43:23.734Z","type":"message"}
{"nick":"nahamu","message":"http://dtrace.org/blogs/dap/2013/07/03/fault-tolerance-in-manta/ has a picture that helps too","date":"2014-03-24T19:44:45.550Z","type":"message"}
{"nick":"bsdguru","message":"yeah I need to prob add that to my big picture of how the registry.npmjs.org works","date":"2014-03-24T19:49:33.057Z","type":"message"}
{"nick":"bsdguru","message":"my white board is full of the digram at the moment","date":"2014-03-24T19:49:44.362Z","type":"message"}
{"nick":"nahamu","message":"https://us-east.manta.joyent.com/mark.cavage/public/surge2013_manta_final.pdf","date":"2014-03-24T19:53:20.020Z","type":"message"}
{"nick":"nahamu","message":"Those look similar to the USENIX slides.","date":"2014-03-24T19:53:31.231Z","type":"message"}
{"nick":"nahamu","message":"see pages 18 and 21","date":"2014-03-24T19:54:33.838Z","type":"message"}
{"nick":"ringzero","date":"2014-03-24T19:54:43.784Z","type":"join"}
{"nick":"ringzero","reason":"Client Quit","date":"2014-03-24T19:55:31.087Z","type":"quit"}
{"nick":"chorrell","new_nick":"chorrell-away","date":"2014-03-24T19:57:17.298Z","type":"nick"}
{"nick":"ringzero","date":"2014-03-24T19:58:58.065Z","type":"join"}
{"nick":"quijote","date":"2014-03-24T20:06:36.718Z","type":"join"}
{"nick":"quijote","reason":"Quit: Textual IRC Client: www.textualapp.com","date":"2014-03-24T20:09:58.723Z","type":"quit"}
{"nick":"quijote","date":"2014-03-24T20:10:11.087Z","type":"join"}
{"nick":"quijote","reason":"Quit: My MacBook has gone to sleep. ZZZzzz…","date":"2014-03-24T20:15:10.790Z","type":"quit"}
{"nick":"chorrell-away","reason":"Quit: My Mac has gone to sleep. ZZZzzz…","date":"2014-03-24T20:18:00.626Z","type":"quit"}
{"nick":"yunong","message":"We are resuming upgrades to the Manta metadata tier. You'll see intermittent 500 errors. I'll give another heads up when we're done.","date":"2014-03-24T20:31:06.159Z","type":"message"}
{"nick":"nahamu","message":"yunong: I hope it goes smoothly. :)","date":"2014-03-24T20:31:42.653Z","type":"message"}
{"nick":"yunong","message":"thanks!","date":"2014-03-24T20:31:49.583Z","type":"message"}
{"nick":"chorrell","date":"2014-03-24T20:32:30.642Z","type":"join"}
{"nick":"nahamu","message":"seldo: ^","date":"2014-03-24T20:42:40.960Z","type":"message"}
{"nick":"seldo","message":"thanks","date":"2014-03-24T20:42:52.410Z","type":"message"}
{"nick":"chorrell","new_nick":"chorrell-away","date":"2014-03-24T20:44:28.782Z","type":"nick"}
{"nick":"bsdguru","message":"thanks","date":"2014-03-24T20:44:54.342Z","type":"message"}
{"nick":"bsdguru","message":"how is the maint going?","date":"2014-03-24T20:45:01.845Z","type":"message"}
{"nick":"seldo","message":"How long is this going to last?","date":"2014-03-24T20:45:40.259Z","type":"message"}
{"nick":"seldo","message":"This is causing serious service disruption to npm","date":"2014-03-24T20:45:55.463Z","type":"message"}
{"nick":"seldo","message":"This is not \"30s downtime\"","date":"2014-03-24T20:46:00.160Z","type":"message"}
{"nick":"seldo","message":"That was 13 minutes of downtime, plus the 9 minutes this morning","date":"2014-03-24T20:50:22.807Z","type":"message"}
{"nick":"seldo","message":"We get a ton of flack from users when this happens in the middle of the day","date":"2014-03-24T20:50:36.575Z","type":"message"}
{"nick":"yunong","message":"seldo: we hit an unexpected issue during the upgrade.","date":"2014-03-24T20:51:02.293Z","type":"message"}
{"nick":"seldo","message":"We have the manta hosts individually in our load balancer","date":"2014-03-24T20:51:21.534Z","type":"message"}
{"nick":"seldo","message":"Can you tell us which ones you're working on when, so we can take them out of rotation?","date":"2014-03-24T20:51:33.574Z","type":"message"}
{"nick":"yunong","message":"That won't help in this situation since we're not updating the front end web hosts.","date":"2014-03-24T20:52:08.820Z","type":"message"}
{"nick":"seldo","message":"Is there anything else we can do to mitigate this? We cannot just have half an hour of random downtime as part of routine maintenance.","date":"2014-03-24T20:53:33.282Z","type":"message"}
{"nick":"dap_","message":"Right.  Manta's strongly consistent (we choose C in CAP, not A).  There's a lot of detail here:","date":"2014-03-24T20:53:37.970Z","type":"message"}
{"nick":"dap_","message":"http://dtrace.org/blogs/dap/2013/07/03/fault-tolerance-in-manta/","date":"2014-03-24T20:53:38.325Z","type":"message"}
{"nick":"nahamu","message":"is zookeeper still part of the metadata layer or has that been ripped out already?","date":"2014-03-24T20:53:56.798Z","type":"message"}
{"nick":"dap_","message":"nahamu: it's still part of it, unfortunately.","date":"2014-03-24T20:54:04.384Z","type":"message"}
{"nick":"seldo","message":"Okay, so we should just take manta out of the critical path for serving binaries.","date":"2014-03-24T20:54:11.177Z","type":"message"}
{"nick":"yunong","message":"nahamu: ZK is still part of the metadata layer, but it's not the culprit in this case.","date":"2014-03-24T20:54:12.667Z","type":"message"}
{"nick":"dap_","message":"seldo: did you see my comment in #joyent in response to your question earlier","date":"2014-03-24T20:54:24.017Z","type":"message"}
{"nick":"dap_","message":"?","date":"2014-03-24T20:54:24.936Z","type":"message"}
{"nick":"dap_","message":"I said:","date":"2014-03-24T20:54:38.735Z","type":"message"}
{"nick":"dap_","message":"As Yunong mentioned, we were doing some upgrades to the metadata tier, and the errors are expected for that kind of upgrade.  Sorry for the disruption, and especially for not communicating that ahead of time.  We're working internally on improving that.  (Literally — we're talking about how best to handle this now.)  The vast majority of our upgrades aren't noticeable from the outside, and most of the time when it is, the period of disruption has been so bee","date":"2014-03-24T20:54:39.574Z","type":"message"}
{"nick":"dap_","message":"then:","date":"2014-03-24T20:54:41.309Z","type":"message"}
{"nick":"dap_","message":"The other piece of this is that we pitch 500s instead of blocking when things are transitioning internally.  We do this to provide better visibility into the underlying service's state — IME, it's much worse to have requests black-hole for minutes at a time than to fail frankly and fast.  But to deal with this, it's recommended that clients use retries with backoff (especially 503s).","date":"2014-03-24T20:54:46.549Z","type":"message"}
{"nick":"dap_","message":"Crap, it looks like IRC is dropping these messages, and adium isn't telling me.","date":"2014-03-24T20:55:34.409Z","type":"message"}
{"nick":"nahamu","message":"dap_: those are showing up in my client.","date":"2014-03-24T20:55:53.599Z","type":"message"}
{"nick":"dap_","message":"I'm also hearing they were cut off.","date":"2014-03-24T20:56:03.165Z","type":"message"}
{"nick":"nahamu","message":"oh, yes, that does look cut off...","date":"2014-03-24T20:56:18.152Z","type":"message"}
{"nick":"dap_","message":"Ugh.  Sorry.","date":"2014-03-24T20:56:34.806Z","type":"message"}
{"nick":"nahamu","message":"Cuts of after \"(Literally\"","date":"2014-03-24T20:56:47.656Z","type":"message"}
{"nick":"dap_","message":"What I meant to say:","date":"2014-03-24T20:57:17.741Z","type":"message"}
{"nick":"dap_","message":"https://gist.github.com/davepacheco/c09fcd2fd1e101a9ac8c","date":"2014-03-24T20:57:18.216Z","type":"message"}
{"nick":"chorrell-away","new_nick":"chorrell","date":"2014-03-24T20:57:28.417Z","type":"nick"}
{"nick":"dap_","message":"And finally: we can make improvements to reduce the impact, potentially even avoiding a read outage for these situations.  We can also consider scheduling them differently.","date":"2014-03-24T20:57:57.694Z","type":"message"}
{"nick":"dap_","message":"seldo: Another option is to build a cache over Manta that chooses the A in CAP instead of C.  (I thought that's what fast.ly did, actually.)","date":"2014-03-24T20:58:29.397Z","type":"message"}
{"nick":"seldo","message":"dap_: your original post gets truncated after \"the period of disruption has been\"","date":"2014-03-24T20:58:49.433Z","type":"message"}
{"nick":"yunong","message":"seldo: see the gist dap_ just posted.","date":"2014-03-24T20:59:03.113Z","type":"message"}
{"nick":"seldo","message":"dap_: I understand that if you pick C over A then I shouldn't be relying on manta as part of our critical path","date":"2014-03-24T21:00:04.960Z","type":"message"}
{"nick":"isaacs","message":"Choosing C rather than A is fine for writes.  But for reads, it makes basically no sense, especially if writes are guaratneed to be consistent.","date":"2014-03-24T21:00:07.269Z","type":"message"}
{"nick":"isaacs","message":"If writes are always consistent, then you can guarantee that a read from anywhere is as good as read from anywhere else, right?","date":"2014-03-24T21:00:29.674Z","type":"message"}
{"nick":"yunong","message":"isaacs: you can't have both A and C.","date":"2014-03-24T21:00:47.550Z","type":"message"}
{"nick":"seldo","message":"See, https://twitter.com/alan_hoff/status/448202693488939009 is the kind of thing I'm getting","date":"2014-03-24T21:00:57.950Z","type":"message"}
{"nick":"dap_","message":"It doesn't makes sense to distinguish between reads and writes that way.  You can't be consistent for writes and not for reads.  (What does \"consistent\" mean in the absence of reads?)","date":"2014-03-24T21:01:01.088Z","type":"message"}
{"nick":"nahamu","message":"isaacs: the bits are all consistent, but if the metadata layer can't tell you where they are, they aren't available.","date":"2014-03-24T21:01:01.379Z","type":"message"}
{"nick":"seldo","message":"And it's really driving me nuts","date":"2014-03-24T21:01:01.597Z","type":"message"}
{"nick":"dap_","message":"seldo: What can we do to help now?","date":"2014-03-24T21:01:44.543Z","type":"message"}
{"nick":"isaacs","message":"Yeah, basically, we're using Manta in the way it's sold: as an S3 replacement, a good place to store big files.","date":"2014-03-24T21:01:46.460Z","type":"message"}
{"nick":"isaacs","message":"what yoer' saying is, it's not suited to that task, and should not be depended on to serve content in production.","date":"2014-03-24T21:02:09.653Z","type":"message"}
{"nick":"nahamu","message":"I have a not-fully-formed thought:","date":"2014-03-24T21:02:28.363Z","type":"message"}
{"nick":"dap_","message":"isaacs: We've been very upfront about the architecture of Manta, including the ways it differs from S3, which include *exactly* the point about strong consistency.","date":"2014-03-24T21:02:32.976Z","type":"message"}
{"nick":"nahamu","message":"the metadata API is what lets the frontend figure out which backend has the bits.","date":"2014-03-24T21:02:44.473Z","type":"message"}
{"nick":"seldo","message":"dap_: ideally, stop going down for reads, and halt \"maintenance\" work until you're sure the disruption cannot be customer-affecting for > 1m","date":"2014-03-24T21:02:47.572Z","type":"message"}
{"nick":"nahamu","message":"what if there was a way to expose that data to a client so that I could hit a URL that encodes directly a backend server to try.","date":"2014-03-24T21:03:09.931Z","type":"message"}
{"nick":"nahamu","message":"so I mput a file, it gets dumped onto, e.g. 2 backend servers","date":"2014-03-24T21:03:33.494Z","type":"message"}
{"nick":"isaacs","message":"dap_: yes, there have been many communications about the architecture of Manta.  However, as a product, it's been sold as ostensibly a good place to serve files from.","date":"2014-03-24T21:03:37.554Z","type":"message"}
{"nick":"isaacs","message":"dap_: that needs to change Joyent's priorities wrt when and how to cause outages.","date":"2014-03-24T21:03:50.643Z","type":"message"}
{"nick":"nahamu","message":"I do some special query that spits out two urls that are able to bypass the metadata api","date":"2014-03-24T21:04:02.733Z","type":"message"}
{"nick":"isaacs","message":"dap_: either (a) state upfront \"We will break your site from time to time, so don't depend on this\", or (b) don't break my site.","date":"2014-03-24T21:04:07.631Z","type":"message"}
{"nick":"AvianFlu","date":"2014-03-24T21:04:22.846Z","type":"join"}
{"nick":"yunong","message":"nahamu: it's not the backend server that's the issue here. The metadata service was down for a specific shard in the hash ring, which means keys mapped to that shard isn't available until it's back up.","date":"2014-03-24T21:04:27.125Z","type":"message"}
{"nick":"nahamu","message":"yunong: right. If at upload time I could have generated that pair of URLS...","date":"2014-03-24T21:04:48.503Z","type":"message"}
{"nick":"nahamu","message":"then when the metadata service is down I have a way to bypass it.","date":"2014-03-24T21:05:01.002Z","type":"message"}
{"nick":"nahamu","message":"I guess permissions are tricky for that... :(","date":"2014-03-24T21:05:12.550Z","type":"message"}
{"nick":"isaacs","message":"and ideally, even if it does break my site from time to time, schedule that on a saturday night","date":"2014-03-24T21:05:16.687Z","type":"message"}
{"nick":"nahamu","message":"if you only allowed it for things that are under /public, maybe.","date":"2014-03-24T21:05:25.076Z","type":"message"}
{"nick":"dap_","message":"isaacs, seldo: To be clear, we take downtime seriously, and we've already apologized for the lack of notice, and I've said we're discussing internally how best to communicate this better.","date":"2014-03-24T21:05:33.770Z","type":"message"}
{"nick":"seldo","message":"okay, but you apologized for the lack of notice this morning, and then you did it again this afternoon","date":"2014-03-24T21:06:21.342Z","type":"message"}
{"nick":"yunong","message":"seldo: we gave notice in this channel.","date":"2014-03-24T21:06:31.864Z","type":"message"}
{"nick":"yunong","message":"please see the IRC logs.","date":"2014-03-24T21:06:39.728Z","type":"message"}
{"nick":"isaacs","message":"dap_: thanks.  i'm not personally upset, i'm just pointing out that, from a business pov, it makes no sense to be spending as much as we are on Manta, when S3 costs the same, and emails their users weeks in advance about downtime.","date":"2014-03-24T21:06:54.290Z","type":"message"}
{"nick":"seldo","message":"yunong: a notice in an IRC channel does not count as \"adequate notice\" in my book","date":"2014-03-24T21:06:56.559Z","type":"message"}
{"nick":"seldo","message":"I want an email, 24 hours in advance, so I can tell my users and reconfigure my systems to expect the change in load pattern this causes","date":"2014-03-24T21:07:25.026Z","type":"message"}
{"nick":"isaacs","message":"i mean, the takeaway seems to be that Manta is not a good fit for our use-case.","date":"2014-03-24T21:07:31.623Z","type":"message"}
{"nick":"isaacs","message":"and that's fine.","date":"2014-03-24T21:07:33.406Z","type":"message"}
{"nick":"isaacs","message":"but, i do wish i'd know that a few months ago.","date":"2014-03-24T21:07:49.693Z","type":"message"}
{"nick":"seldo","message":"question: is there more of this maintenance to do? If so, can it be halted while we scramble to change our load-balancer so we don't throw 503s for every binary?","date":"2014-03-24T21:08:40.852Z","type":"message"}
{"nick":"yunong","message":"seldo: we're going to hold off from more maintenance during business hours today.","date":"2014-03-24T21:09:06.246Z","type":"message"}
{"nick":"isaacs","message":"yunong: thank you.","date":"2014-03-24T21:09:27.318Z","type":"message"}
{"nick":"isaacs","message":"yunong: when do \"business hours\" end?","date":"2014-03-24T21:09:33.328Z","type":"message"}
{"nick":"nahamu","message":".oO(the sun never sets on the node.js empire)","date":"2014-03-24T21:10:01.899Z","type":"message"}
{"nick":"isaacs","message":"nahamu: actually it does, for an hour or so, before Japan wakes up","date":"2014-03-24T21:10:19.081Z","type":"message"}
{"nick":"nahamu","message":"isaacs: good to know. ;)","date":"2014-03-24T21:10:32.961Z","type":"message"}
{"nick":"nahamu","message":"oh... bsdguru, do you work at npm Inc now?","date":"2014-03-24T21:15:17.814Z","type":"message"}
{"nick":"chorrell","new_nick":"chorrell-away","date":"2014-03-24T21:15:31.310Z","type":"nick"}
{"nick":"dap_","message":"isaacs, seldo: Sorry again, and I know it sucks when users are angry at you about it.  The expected behavior on a 503 is to retry — it seems that would help a lot in this situation.","date":"2014-03-24T21:16:22.026Z","type":"message"}
{"nick":"nahamu","message":"dap_: does manta set a Retry-After header?","date":"2014-03-24T21:17:18.029Z","type":"message"}
{"nick":"dap_","message":"nahamu: it does not","date":"2014-03-24T21:17:41.398Z","type":"message"}
{"nick":"nahamu","message":"http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html says \"If no Retry-After is given, the client SHOULD handle the response as it would for a 500 response.\"","date":"2014-03-24T21:18:40.937Z","type":"message"}
{"nick":"dap_","message":"Yeah, but it doesn't really say what that means.  It *does* say, just before that:","date":"2014-03-24T21:19:10.134Z","type":"message"}
{"nick":"dap_","message":"The server is currently unable to handle the request due to a temporary overloading or maintenance of the server. The implication is that this is a temporary condition which will be alleviated after some delay.","date":"2014-03-24T21:19:10.637Z","type":"message"}
{"nick":"nahamu","message":"not that setting that to 1 minute would help with a 13 minute unforeseen outage...","date":"2014-03-24T21:19:29.088Z","type":"message"}
{"nick":"seldo","message":"dap_: the client *does* retry after a 503, but when the service is down for 10 minutes that really doesn't make a difference","date":"2014-03-24T21:19:59.485Z","type":"message"}
{"nick":"dap_","message":"Were you guys seeing 503s *continuously* for 13 minutes?","date":"2014-03-24T21:20:04.268Z","type":"message"}
{"nick":"seldo","message":"We just get a firestorm of retries, all of which fail","date":"2014-03-24T21:20:08.021Z","type":"message"}
{"nick":"seldo","message":"dap_: 50% of our traffic was 503s for 13 minutes","date":"2014-03-24T21:20:34.302Z","type":"message"}
{"nick":"dap_","message":"seldo: It depends on what behavior you want.  You can retry not at all, for a fixed number of minutes before giving up, or indefinitely.","date":"2014-03-24T21:20:44.179Z","type":"message"}
{"nick":"seldo","message":"dap_: retrying for 10 minutes is not something our users can be reasonably expected to do","date":"2014-03-24T21:21:20.951Z","type":"message"}
{"nick":"seldo","message":"60 seconds is pretty much the outer bound there","date":"2014-03-24T21:21:35.231Z","type":"message"}
{"nick":"seldo","message":"After that we just look broken","date":"2014-03-24T21:21:40.053Z","type":"message"}
{"nick":"seldo","message":"These are actual people, sitting at the command line, watching 503s stream past as they try to npm install stuff","date":"2014-03-24T21:21:53.333Z","type":"message"}
{"nick":"nahamu","message":"seldo: are the end users getting them from a CDN which is passing them through from Manta or do the users get directed straight to Manta itself?","date":"2014-03-24T21:22:29.607Z","type":"message"}
{"nick":"dap_","message":"That's up to you to decide.  Most of my npm uses are for builds, and if npm said it was retrying, and the build just took 10 minutes instead of a few seconds, I'd much prefer that to failing immediately.","date":"2014-03-24T21:22:32.018Z","type":"message"}
{"nick":"dap_","message":"If that's not helpful, that's okay.  I'm trying to offer options.  There are likely a lot of situations in which 500s are more transient than 13 minutes.","date":"2014-03-24T21:23:10.973Z","type":"message"}
{"nick":"mamash","date":"2014-03-24T21:26:05.051Z","type":"join"}
{"nick":"nahamu","message":"I think part of the issue here is a lack of a clear SLA.","date":"2014-03-24T21:27:01.335Z","type":"message"}
{"nick":"nahamu","message":"both for people like isaacs to use to decide whether or not to use Manta as a building block of a business","date":"2014-03-24T21:27:45.987Z","type":"message"}
{"nick":"nahamu","message":"but also for Joyent to use to help them guide when and how maintenance is done, etc.","date":"2014-03-24T21:28:10.769Z","type":"message"}
{"nick":"ryancnelson","date":"2014-03-24T21:29:21.222Z","type":"join"}
{"nick":"nahamu","message":"and from what dap_ said, it sounds like a bunch of those conversations have already started inside Joyent.","date":"2014-03-24T21:31:26.537Z","type":"message"}
{"nick":"therealkoopa","reason":"Remote host closed the connection","date":"2014-03-24T21:32:21.908Z","type":"quit"}
{"nick":"nahamu","message":"anyway, I should get going, but much love to all the Joyent and npm Inc folks!","date":"2014-03-24T21:32:46.194Z","type":"message"}
{"nick":"seldo","message":"dap_: for truly transient downtime I think we are doing okay. I'm just worried there are going to be more of these 5-10 minute gaps today.","date":"2014-03-24T21:33:53.442Z","type":"message"}
{"nick":"chorrell-away","reason":"Quit: My Mac has gone to sleep. ZZZzzz…","date":"2014-03-24T21:36:21.343Z","type":"quit"}
{"nick":"nahamu","message":"I'm hoping a/the postmortem will reveal ways to prevent them (and it would be really cool if it's the kind of thing that could be shared with people outside Joyent; I for one would find it interesting.)","date":"2014-03-24T21:37:28.690Z","type":"message"}
{"nick":"ryancnelson","date":"2014-03-24T21:38:12.214Z","type":"part"}
{"nick":"dap_","message":"seldo: we're discussing options now, but we'll check with you or someone from your team before doing anything","date":"2014-03-24T21:43:09.749Z","type":"message"}
{"nick":"seldo","message":"dap_: much appreciated, thank you","date":"2014-03-24T21:43:22.159Z","type":"message"}
{"nick":"therealkoopa","date":"2014-03-24T21:50:21.890Z","type":"join"}
{"nick":"ringzero","date":"2014-03-24T22:00:49.092Z","type":"quit"}
{"nick":"ghostbar","date":"2014-03-24T22:04:17.382Z","type":"join"}
{"nick":"ringzero","date":"2014-03-24T22:04:43.724Z","type":"join"}
{"nick":"mamash","date":"2014-03-24T22:11:53.900Z","type":"part"}
{"nick":"dap_","message":"seldo: I believe Bryan's reaching out to Isaac with details.","date":"2014-03-24T22:13:52.441Z","type":"message"}
{"nick":"seldo","message":"dap_: thanks","date":"2014-03-24T22:14:01.093Z","type":"message"}
{"nick":"therealkoopa","reason":"Remote host closed the connection","date":"2014-03-24T22:15:18.504Z","type":"quit"}
{"nick":"therealkoopa","date":"2014-03-24T22:20:52.568Z","type":"join"}
{"nick":"tjfontaine","message":"mtr or traceroute","date":"2014-03-24T22:47:14.557Z","type":"message"}
{"nick":"tjfontaine","message":"er ww","date":"2014-03-24T22:47:19.158Z","type":"message"}
{"nick":"ringzero","date":"2014-03-24T22:59:20.712Z","type":"quit"}
{"nick":"therealkoopa","reason":"Remote host closed the connection","date":"2014-03-24T23:02:34.807Z","type":"quit"}
{"nick":"AvianFlu","reason":"Remote host closed the connection","date":"2014-03-24T23:46:05.574Z","type":"quit"}
{"nick":"AvianFlu","date":"2014-03-24T23:46:35.518Z","type":"join"}
{"nick":"chorrell","date":"2014-03-24T23:47:37.748Z","type":"join"}
{"nick":"AvianFlu","reason":"Ping timeout: 264 seconds","date":"2014-03-24T23:50:55.330Z","type":"quit"}
