{"nick":"ircretary","reason":"Remote host closed the connection","date":"2013-02-04T00:00:01.281Z","type":"quit"}
{"nick":"ircretary","date":"2013-02-04T00:00:10.512Z","type":"join"}
{"nick":"roxlu","reason":"Ping timeout: 256 seconds","date":"2013-02-04T00:23:38.311Z","type":"quit"}
{"nick":"roxlu_","date":"2013-02-04T00:23:42.311Z","type":"join"}
{"nick":"isaacs","message":"ok, i'm gonna try ripping out all this high/low watermark shit.","date":"2013-02-04T00:47:44.413Z","type":"message"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-04T00:47:55.724Z","type":"quit"}
{"nick":"isaacs","message":"if there's a write pending, we return false.  if there isn't, we return true.","date":"2013-02-04T00:47:57.660Z","type":"message"}
{"nick":"isaacs","message":"period.","date":"2013-02-04T00:48:01.932Z","type":"message"}
{"nick":"loladiro","date":"2013-02-04T00:52:10.493Z","type":"join"}
{"nick":"isaacs","action":"&","date":"2013-02-04T01:16:21.994Z","type":"action"}
{"nick":"LOUDBOT","message":"DAMN YOU GMAIL FOR MAKING ME TRUST YOU THEN LETTING ME DOWN","date":"2013-02-04T01:16:22.783Z","type":"message"}
{"nick":"bnoordhuis","reason":"Ping timeout: 245 seconds","date":"2013-02-04T01:30:33.424Z","type":"quit"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-04T01:34:07.603Z","type":"quit"}
{"nick":"abraxas","date":"2013-02-04T01:36:51.397Z","type":"join"}
{"nick":"mikeal","date":"2013-02-04T01:39:09.086Z","type":"join"}
{"nick":"jmar777_","reason":"Remote host closed the connection","date":"2013-02-04T01:49:58.101Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-04T01:50:36.001Z","type":"join"}
{"nick":"jmar777","reason":"Ping timeout: 248 seconds","date":"2013-02-04T01:54:43.940Z","type":"quit"}
{"nick":"bradleymeck","reason":"Ping timeout: 245 seconds","date":"2013-02-04T02:15:08.442Z","type":"quit"}
{"nick":"bradleymeck","date":"2013-02-04T02:21:54.057Z","type":"join"}
{"nick":"bradleymeck","reason":"Quit: bradleymeck","date":"2013-02-04T03:27:40.632Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-04T03:37:18.473Z","type":"join"}
{"nick":"brson","reason":"Ping timeout: 255 seconds","date":"2013-02-04T03:38:29.517Z","type":"quit"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2013-02-04T03:53:52.594Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-04T03:54:29.125Z","type":"join"}
{"nick":"c4milo","date":"2013-02-04T03:54:59.385Z","type":"join"}
{"nick":"jmar777","reason":"Ping timeout: 248 seconds","date":"2013-02-04T03:58:59.883Z","type":"quit"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-02-04T04:13:26.395Z","type":"quit"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-04T04:14:46.074Z","type":"quit"}
{"nick":"stagas","reason":"Read error: Connection reset by peer","date":"2013-02-04T04:15:57.570Z","type":"quit"}
{"nick":"loladiro","date":"2013-02-04T04:20:27.176Z","type":"join"}
{"nick":"trevnorris","date":"2013-02-04T04:31:24.017Z","type":"join"}
{"nick":"AvianFlu","reason":"Remote host closed the connection","date":"2013-02-04T04:33:16.562Z","type":"quit"}
{"nick":"LOUDBOT","message":"http://twitter.com/LOUDBOT/status/298292777102495744 (simcop2387/##turtles)","date":"2013-02-04T04:51:55.290Z","type":"message"}
{"nick":"TheJH","date":"2013-02-04T05:04:55.782Z","type":"join"}
{"nick":"TheJH","reason":"Ping timeout: 248 seconds","date":"2013-02-04T05:13:24.745Z","type":"quit"}
{"nick":"indexzero","date":"2013-02-04T05:18:37.425Z","type":"join"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2013-02-04T05:30:34.729Z","type":"quit"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-04T05:40:42.891Z","type":"quit"}
{"nick":"mikeal","date":"2013-02-04T05:43:35.563Z","type":"join"}
{"nick":"loladiro","date":"2013-02-04T05:51:11.782Z","type":"part"}
{"nick":"isaacs","message":"hmm... we sure do call gettimeofday a lot.","date":"2013-02-04T05:51:33.627Z","type":"message"}
{"nick":"wolfeidau","reason":"Remote host closed the connection","date":"2013-02-04T05:53:37.128Z","type":"quit"}
{"nick":"isaacs","message":"at least, that's what --prof is saying","date":"2013-02-04T05:55:07.115Z","type":"message"}
{"nick":"isaacs","message":"i'm a bit skeptical of it, though..","date":"2013-02-04T05:55:27.474Z","type":"message"}
{"nick":"perezd","date":"2013-02-04T06:18:22.656Z","type":"join"}
{"nick":"trevnorris","message":"isaacs: the graph is interesting. streams2 was merged between 0.9.3 and 0.9.4. but still looks like there has been significant between .4 and .6.","date":"2013-02-04T06:22:24.219Z","type":"message"}
{"nick":"perezd","reason":"Quit: perezd","date":"2013-02-04T06:27:09.899Z","type":"quit"}
{"nick":"paddybyers","date":"2013-02-04T06:29:01.325Z","type":"join"}
{"nick":"trevnorris","message":"isaacs: been thinking. doing think those tests are appropriately representative. running the entire thing in the same script means that if one consumes additional cpu then it's forced to be slower.","date":"2013-02-04T06:32:11.431Z","type":"message"}
{"nick":"trevnorris","message":" /doing/don't","date":"2013-02-04T06:32:27.188Z","type":"message"}
{"nick":"trevnorris","message":"going to rewrite them to pipe data between two processes.","date":"2013-02-04T06:33:04.339Z","type":"message"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-04T06:45:07.338Z","type":"quit"}
{"nick":"mikeal","date":"2013-02-04T06:51:51.241Z","type":"join"}
{"nick":"trevnorris","message":"isaacs: ok. so good news. when I spawn it into two processes both v0.8 and master jump up to ~8 Gb/sec.","date":"2013-02-04T06:56:25.513Z","type":"message"}
{"nick":"trevnorris","message":"so that just means that master uses about twice the memory and 20% more cpu.","date":"2013-02-04T06:56:39.570Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: actually, scratch my comment on memory usage. at first glance looks like that might not be true.","date":"2013-02-04T07:21:06.830Z","type":"message"}
{"nick":"EhevuTov","date":"2013-02-04T07:24:51.313Z","type":"join"}
{"nick":"felixge","date":"2013-02-04T07:25:14.583Z","type":"join"}
{"nick":"felixge","reason":"Ping timeout: 276 seconds","date":"2013-02-04T07:30:12.301Z","type":"quit"}
{"nick":"rendar","date":"2013-02-04T07:31:49.460Z","type":"join"}
{"nick":"`3rdEden","date":"2013-02-04T07:34:52.989Z","type":"join"}
{"nick":"isaacs","message":"trevnorris: hm.","date":"2013-02-04T07:39:06.654Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: that is indeed interesting.","date":"2013-02-04T07:39:13.845Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: i'm deep in the thick of v8 inline frenzy right now.","date":"2013-02-04T07:39:33.595Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: yeah. just ran tcp_net_c2s and got 15.881 - v0.8; 15.888 - master","date":"2013-02-04T07:39:50.234Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: that's pretty awesome, actually","date":"2013-02-04T07:40:59.124Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: so... why does it get so much slower right when we land streams2?","date":"2013-02-04T07:41:28.724Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: i mean, saying \"it's just using more memory and more cpu\" is basically the same as saying \"it's just slower\" ;)","date":"2013-02-04T07:41:52.944Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: on both my smartos and darwin boxes, it falls from ~3.5 to ~3.0 Gb/sec","date":"2013-02-04T07:42:23.783Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: yeah. i'm still formulating an idea of why this is happening.","date":"2013-02-04T07:42:25.270Z","type":"message"}
{"nick":"trevnorris","message":"and that is on the net tests.","date":"2013-02-04T07:42:29.746Z","type":"message"}
{"nick":"isaacs","message":"kewl.","date":"2013-02-04T07:42:30.923Z","type":"message"}
{"nick":"trevnorris","message":"next i'll do the raw and see what it looks like","date":"2013-02-04T07:42:39.909Z","type":"message"}
{"nick":"isaacs","message":"k","date":"2013-02-04T07:42:43.823Z","type":"message"}
{"nick":"isaacs","message":"i still think this Writable rewrite is probably worthwhile.","date":"2013-02-04T07:42:58.303Z","type":"message"}
{"nick":"isaacs","message":"it means giving up the high/low water marks for the writable side.","date":"2013-02-04T07:43:06.133Z","type":"message"}
{"nick":"isaacs","message":"but.. oh well.","date":"2013-02-04T07:43:09.833Z","type":"message"}
{"nick":"isaacs","message":"we don't have batched writev support anyway, so saving up a bunch of bytes to write all at once doesn't make much sense anyhow.","date":"2013-02-04T07:43:30.383Z","type":"message"}
{"nick":"isaacs","message":"also, apparently, there are a bunch of things you can do with arrays that V8's inlining optimizer treats as an early return.","date":"2013-02-04T07:44:19.932Z","type":"message"}
{"nick":"isaacs","message":"which is super strange.","date":"2013-02-04T07:44:23.672Z","type":"message"}
{"nick":"isaacs","message":"buffer.push([chunk,enc,cb]) is not inlineable, but buffer.push({c:chunk,e:enc,cb:cb}) is","date":"2013-02-04T07:44:42.322Z","type":"message"}
{"nick":"trevnorris","message":"heh, that is strange.","date":"2013-02-04T07:44:42.509Z","type":"message"}
{"nick":"trevnorris","message":"hm. yeah, no good explanation for that one.","date":"2013-02-04T07:46:30.012Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: i think i need to have a test that will just pipe one stream into another.","date":"2013-02-04T07:46:49.861Z","type":"message"}
{"nick":"isaacs","message":"the trouble there is that there's really no good comparison to v0.8, since we didn't hve the base classes, then","date":"2013-02-04T07:47:12.711Z","type":"message"}
{"nick":"isaacs","message":"of course... all the inlining stuff i'm doing, it's still only amounting to about a 1% diff in the speed.","date":"2013-02-04T07:48:11.500Z","type":"message"}
{"nick":"isaacs","message":"and i'm cutting deep.","date":"2013-02-04T07:48:22.100Z","type":"message"}
{"nick":"trevnorris","message":"i think it's good. honestly I'd like to figure out how to call domain in _makeCallback w/o switching contexts.","date":"2013-02-04T07:50:25.707Z","type":"message"}
{"nick":"trevnorris","message":"(but don't have an idea about perf improvements there)","date":"2013-02-04T07:50:56.558Z","type":"message"}
{"nick":"trevnorris","message":"so what did you mean about pipe to pipe?","date":"2013-02-04T07:51:03.196Z","type":"message"}
{"nick":"piscisaureus_","date":"2013-02-04T07:53:59.140Z","type":"join"}
{"nick":"Ralt","date":"2013-02-04T07:55:40.789Z","type":"join"}
{"nick":"trevnorris","message":"isaacs: hm, interesting. realized an error in the _net_c2s test. after fixing it v0.8 jumped from 15.8 to 18.4","date":"2013-02-04T07:56:10.527Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: there ya go :)","date":"2013-02-04T07:56:19.574Z","type":"message"}
{"nick":"trevnorris","message":"pipe is still correct though.","date":"2013-02-04T07:56:33.253Z","type":"message"}
{"nick":"isaacs","message":"kewl","date":"2013-02-04T07:56:38.394Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: actually, i guess so far this has yielded a 4% diff on smartos.","date":"2013-02-04T07:56:57.394Z","type":"message"}
{"nick":"isaacs","message":"so that's worthwhile, i suppose.","date":"2013-02-04T07:57:04.564Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: goedemorgen","date":"2013-02-04T07:57:29.824Z","type":"message"}
{"nick":"trevnorris","message":"imho, it definitely is. and with those out of the way and good benchmarks we'll be able to track it more carefully through future development.","date":"2013-02-04T07:57:43.859Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: moge","date":"2013-02-04T07:58:20.001Z","type":"message"}
{"nick":"piscisaureus_","message":"goedenavond in jouw geva","date":"2013-02-04T07:59:15.408Z","type":"message"}
{"nick":"piscisaureus_","message":"l","date":"2013-02-04T07:59:16.669Z","type":"message"}
{"nick":"isaacs","message":"the thing that sucks about this \"early return\" issue in inlining is that it means you have to write your code like super old-school C.","date":"2013-02-04T07:59:30.982Z","type":"message"}
{"nick":"isaacs","message":"with var ret; and then giant if-blocks, and then at the bottom, a single \"return ret\"","date":"2013-02-04T07:59:46.662Z","type":"message"}
{"nick":"isaacs","message":"V8 should just figure out how to inline early returns.","date":"2013-02-04T08:00:04.812Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: imho, think it'd be helpful to figure out how to break things down into smaller functions.","date":"2013-02-04T08:00:34.256Z","type":"message"}
{"nick":"trevnorris","message":"v8 can inline sets of functions easily.","date":"2013-02-04T08:00:44.434Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: bijna morgen","date":"2013-02-04T08:00:49.931Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: well, that's another thing, function text has to be rather small to be inlined.","date":"2013-02-04T08:01:13.071Z","type":"message"}
{"nick":"trevnorris","message":"then if there's a deop'd part it won't affect the rest of the quick code.","date":"2013-02-04T08:01:14.153Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: like, even comments in the code will fuck it up","date":"2013-02-04T08:01:20.291Z","type":"message"}
{"nick":"trevnorris","message":"yup. know that stupid one.","date":"2013-02-04T08:01:32.657Z","type":"message"}
{"nick":"isaacs","message":"so a lot of this refactor is just moving comments outside of the fucntion body, and breaking up into small functions, and removing any tidy early return values.","date":"2013-02-04T08:02:01.451Z","type":"message"}
{"nick":"isaacs","message":"other stuff to generally uglify the code.","date":"2013-02-04T08:02:07.571Z","type":"message"}
{"nick":"isaacs","message":"it makes me sad.","date":"2013-02-04T08:02:09.220Z","type":"message"}
{"nick":"trevnorris","message":"yeah. i think it'll hit a good balance. just a few growing pains.","date":"2013-02-04T08:03:06.003Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: also with some better profiling we should be able to determine what code is absolutely necessary to uglify. and other code that just can't be.","date":"2013-02-04T08:06:09.873Z","type":"message"}
{"nick":"trevnorris","message":"(e.g. knowing that some operations must be used that will force deopt. so no point in over optimizing)","date":"2013-02-04T08:07:03.458Z","type":"message"}
{"nick":"isaacs","message":"yeah, deopts are super magical to me right now.","date":"2013-02-04T08:09:41.803Z","type":"message"}
{"nick":"isaacs","message":"i know that you'll get deopted if your data types change.","date":"2013-02-04T08:09:53.496Z","type":"message"}
{"nick":"isaacs","message":"but like.. i've got cases where i'm pretty sure that's not happening, and it's still getting deopted","date":"2013-02-04T08:10:04.506Z","type":"message"}
{"nick":"felixge","date":"2013-02-04T08:10:32.752Z","type":"join"}
{"nick":"felixge","reason":"Changing host","date":"2013-02-04T08:10:33.043Z","type":"quit"}
{"nick":"felixge","date":"2013-02-04T08:10:33.176Z","type":"join"}
{"nick":"isaacs","message":"especially in cases where it's optimizing a function, then immediately deoptimizing it","date":"2013-02-04T08:11:09.620Z","type":"message"}
{"nick":"trevnorris","message":"it does suck you in, doesn't it? ;-)","date":"2013-02-04T08:12:18.584Z","type":"message"}
{"nick":"trevnorris","message":"is it printing you out the assembly stack of the deopt?","date":"2013-02-04T08:12:44.775Z","type":"message"}
{"nick":"isaacs","message":"yeah","date":"2013-02-04T08:13:58.573Z","type":"message"}
{"nick":"isaacs","message":"which i guess, mraleph would say, tells me everything i need to know, obviously.","date":"2013-02-04T08:14:10.003Z","type":"message"}
{"nick":"isaacs","message":"but i'm a bit confused by it.","date":"2013-02-04T08:14:19.083Z","type":"message"}
{"nick":"trevnorris","message":"can you gist one for me?","date":"2013-02-04T08:14:23.566Z","type":"message"}
{"nick":"isaacs","message":"https://gist.github.com/4705572","date":"2013-02-04T08:14:53.852Z","type":"message"}
{"nick":"isaacs","message":"[optimizing: onwriteDrain / 2f775a95c7d9 - took 0.026, 0.056, 0.051 ms]","date":"2013-02-04T08:16:04.272Z","type":"message"}
{"nick":"isaacs","message":"**** DEOPT: onwriteDrain at bailout #2, address 0x0, frame size 0","date":"2013-02-04T08:16:04.408Z","type":"message"}
{"nick":"isaacs","message":"it's optimizing onwriteDrain, and then immediately deopting it repeatedly","date":"2013-02-04T08:16:15.392Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: same iwth Socket._write, socketWrite, etc.","date":"2013-02-04T08:16:44.491Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: it will help if you give a name to all the anonymous functions.","date":"2013-02-04T08:16:57.169Z","type":"message"}
{"nick":"isaacs","message":"yeah, i know","date":"2013-02-04T08:17:10.471Z","type":"message"}
{"nick":"isaacs","message":"ok, i need to get some sleep.","date":"2013-02-04T08:17:43.960Z","type":"message"}
{"nick":"trevnorris","message":"cool. see ya tomorrow.","date":"2013-02-04T08:17:51.955Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: do you have any idea why the v8 tick processor would be showing way more time spent in gettimeofday in master than in v0.8?","date":"2013-02-04T08:18:11.260Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: this makes me curious:","date":"2013-02-04T08:18:22.970Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: I have no time, sorry.","date":"2013-02-04T08:18:45.696Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: later today :-)","date":"2013-02-04T08:18:51.689Z","type":"message"}
{"nick":"isaacs","message":"   ticks parent  name","date":"2013-02-04T08:18:55.510Z","type":"message"}
{"nick":"isaacs","message":"   3107   36.8%  ___gettimeofday","date":"2013-02-04T08:18:57.260Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: you're just saying that to be clever, since the question is about gettimeofday, aren't you?","date":"2013-02-04T08:19:20.640Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: :D","date":"2013-02-04T08:19:34.249Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: np, i have no time tonight.  if you have any flashes of insight, you can use internets to send messages.","date":"2013-02-04T08:19:46.359Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: there's a reason I got up at 5:30 today ...","date":"2013-02-04T08:19:47.223Z","type":"message"}
{"nick":"isaacs","message":"i'll bet :)","date":"2013-02-04T08:19:52.069Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: indeed. async ftw","date":"2013-02-04T08:19:58.009Z","type":"message"}
{"nick":"isaacs","message":"whatever it is, i hope it's wroth seeing the sunrise","date":"2013-02-04T08:20:02.559Z","type":"message"}
{"nick":"isaacs","message":"or, does the sun rise this time of year on the north pole?","date":"2013-02-04T08:20:17.999Z","type":"message"}
{"nick":"isaacs","message":";P","date":"2013-02-04T08:20:21.219Z","type":"message"}
{"nick":"isaacs","message":"ok, the jokes are getting bad, even for me.  it's time to sleep.  g'nite.","date":"2013-02-04T08:21:04.388Z","type":"message"}
{"nick":"isaacs","action":"&","date":"2013-02-04T08:21:06.398Z","type":"action"}
{"nick":"LOUDBOT","message":"YOU DON'T DO ASS TO NOSE","date":"2013-02-04T08:21:07.213Z","type":"message"}
{"nick":"isaacs","date":"2013-02-04T08:21:14.549Z","type":"part"}
{"nick":"isaacs","date":"2013-02-04T08:21:18.209Z","type":"join"}
{"nick":"saghul","date":"2013-02-04T08:24:52.028Z","type":"join"}
{"nick":"indutny","message":"morning","date":"2013-02-04T08:25:16.872Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: slaap lekker","date":"2013-02-04T08:33:41.429Z","type":"message"}
{"nick":"piscisaureus_","reason":"Read error: Operation timed out","date":"2013-02-04T08:38:19.870Z","type":"quit"}
{"nick":"piscisaureus_","date":"2013-02-04T08:44:41.976Z","type":"join"}
{"nick":"trevnorris","message":"isaacs: just broke up raw_c2s: v0.8 - 19.627; master - 18.369","date":"2013-02-04T08:59:49.444Z","type":"message"}
{"nick":"trevnorris","message":"that's a pretty large non-js related gap that needs to be filled","date":"2013-02-04T09:00:06.067Z","type":"message"}
{"nick":"mraleph1","date":"2013-02-04T09:04:31.893Z","type":"join"}
{"nick":"mraleph","reason":"Read error: Connection reset by peer","date":"2013-02-04T09:04:55.845Z","type":"quit"}
{"nick":"paddybyers_","date":"2013-02-04T09:18:38.797Z","type":"join"}
{"nick":"paddybyers","reason":"Read error: Operation timed out","date":"2013-02-04T09:21:11.053Z","type":"quit"}
{"nick":"paddybyers_","new_nick":"paddybyers","date":"2013-02-04T09:21:11.586Z","type":"nick"}
{"nick":"EhevuTov","reason":"Quit: This computer has gone to sleep","date":"2013-02-04T09:43:06.262Z","type":"quit"}
{"nick":"trevnorris","reason":"Quit: Leaving","date":"2013-02-04T10:14:55.605Z","type":"quit"}
{"nick":"wolfeidau","date":"2013-02-04T10:17:08.595Z","type":"join"}
{"nick":"hz","date":"2013-02-04T11:25:41.448Z","type":"join"}
{"nick":"stagas","date":"2013-02-04T11:50:11.193Z","type":"join"}
{"nick":"MI6","reason":"Ping timeout: 252 seconds","date":"2013-02-04T12:27:50.067Z","type":"quit"}
{"nick":"stephank","reason":"Ping timeout: 252 seconds","date":"2013-02-04T12:27:50.586Z","type":"quit"}
{"nick":"tellnes","reason":"Remote host closed the connection","date":"2013-02-04T12:27:50.587Z","type":"quit"}
{"nick":"stephank","date":"2013-02-04T12:28:54.326Z","type":"join"}
{"nick":"tellnes","date":"2013-02-04T12:29:13.473Z","type":"join"}
{"nick":"stagas_","date":"2013-02-04T12:40:41.270Z","type":"join"}
{"nick":"stagas","reason":"Ping timeout: 245 seconds","date":"2013-02-04T12:43:21.067Z","type":"quit"}
{"nick":"stagas_","new_nick":"stagas","date":"2013-02-04T12:43:21.957Z","type":"nick"}
{"nick":"indutny","message":"piscisaureus_: hoya","date":"2013-02-04T12:53:06.202Z","type":"message"}
{"nick":"indutny","message":"I like russian developers","date":"2013-02-04T12:53:10.533Z","type":"message"}
{"nick":"indutny","message":"they just told me","date":"2013-02-04T12:53:13.794Z","type":"message"}
{"nick":"indutny","message":"\"There's a problem with Request/Response classes in node.js... we can't extend them and add our own methods\"","date":"2013-02-04T12:53:36.470Z","type":"message"}
{"nick":"indutny","message":"meh","date":"2013-02-04T12:53:39.473Z","type":"message"}
{"nick":"indutny","message":"Why people are looking at the problem from only one side","date":"2013-02-04T12:53:54.240Z","type":"message"}
{"nick":"stagas","message":"sure they can","date":"2013-02-04T12:54:20.419Z","type":"message"}
{"nick":"indutny","message":"well, there's a problem with this solution","date":"2013-02-04T12:54:40.465Z","type":"message"}
{"nick":"indutny","message":"and it'll happen pretty soon","date":"2013-02-04T12:54:50.061Z","type":"message"}
{"nick":"stagas","message":"what is that?","date":"2013-02-04T12:54:59.053Z","type":"message"}
{"nick":"indutny","message":"because extending prototypes always leads to problems","date":"2013-02-04T12:55:05.516Z","type":"message"}
{"nick":"indutny","message":"like method name clashes","date":"2013-02-04T12:55:14.973Z","type":"message"}
{"nick":"indutny","message":"and also all other modules will observe side-effects","date":"2013-02-04T12:55:27.705Z","type":"message"}
{"nick":"stagas","message":"I suppose you need to be careful and it is what you actually need to do","date":"2013-02-04T12:56:02.595Z","type":"message"}
{"nick":"indutny","message":"well","date":"2013-02-04T12:56:10.711Z","type":"message"}
{"nick":"indutny","message":"not a promotion","date":"2013-02-04T12:56:15.311Z","type":"message"}
{"nick":"indutny","message":"but I think flatiron handles this in a best way","date":"2013-02-04T12:56:21.041Z","type":"message"}
{"nick":"indutny","message":"you just extend your app","date":"2013-02-04T12:56:35.432Z","type":"message"}
{"nick":"indutny","message":"and methods of your app always have access to this.req and this.res","date":"2013-02-04T12:56:44.208Z","type":"message"}
{"nick":"stagas","message":"yeah that's one way, I usually add stuff in middleware in express so it's instance methods, a bit of an overhead but meh","date":"2013-02-04T12:58:38.912Z","type":"message"}
{"nick":"indutny","message":"well","date":"2013-02-04T12:58:54.765Z","type":"message"}
{"nick":"indutny","message":"this is another way","date":"2013-02-04T12:59:02.218Z","type":"message"}
{"nick":"Ralt","reason":"Read error: Operation timed out","date":"2013-02-04T12:59:11.099Z","type":"quit"}
{"nick":"stagas","message":"I suppose that kills the hidden classes in v8","date":"2013-02-04T12:59:31.527Z","type":"message"}
{"nick":"stagas","message":"but js allows me to do it so I do it","date":"2013-02-04T12:59:38.774Z","type":"message"}
{"nick":"stagas","message":":P","date":"2013-02-04T12:59:40.774Z","type":"message"}
{"nick":"Ralt","date":"2013-02-04T12:59:43.924Z","type":"join"}
{"nick":"indutny","message":"yes","date":"2013-02-04T13:00:14.585Z","type":"message"}
{"nick":"indutny","message":"it kills them","date":"2013-02-04T13:00:16.724Z","type":"message"}
{"nick":"indutny","message":"pretty hard","date":"2013-02-04T13:00:19.215Z","type":"message"}
{"nick":"stagas","message":"it's the compiler's problem, it should find out that I'm adding these constant stuff all the time and optimize it","date":"2013-02-04T13:01:33.050Z","type":"message"}
{"nick":"indutny","message":"well, it works :)","date":"2013-02-04T13:01:57.208Z","type":"message"}
{"nick":"indutny","message":"my visions of this thing","date":"2013-02-04T13:02:11.251Z","type":"message"}
{"nick":"indutny","message":"there's C and dynamic languages","date":"2013-02-04T13:02:17.446Z","type":"message"}
{"nick":"indutny","message":"if your code is close to C (i.e. everything is static) - its compiler job to make it as fast as possible (nearly C)","date":"2013-02-04T13:02:44.924Z","type":"message"}
{"nick":"indutny","message":"if its very dynamic - do not blame compiler","date":"2013-02-04T13:02:51.840Z","type":"message"}
{"nick":"indutny","message":"you've traded code-style for speed","date":"2013-02-04T13:03:06.179Z","type":"message"}
{"nick":"stagas","message":"yes but repeatedly adding the same x,y,z properties to object A on every instance of it is something that can be addressed, it's not random stuff","date":"2013-02-04T13:05:08.323Z","type":"message"}
{"nick":"stagas","message":"and it may be doing that already I don't know","date":"2013-02-04T13:05:42.830Z","type":"message"}
{"nick":"stagas","message":"I notice things getting faster in the browser after a bit","date":"2013-02-04T13:05:50.030Z","type":"message"}
{"nick":"stagas","message":"chrome","date":"2013-02-04T13:05:53.171Z","type":"message"}
{"nick":"indutny","message":"stagas: its ok and it works","date":"2013-02-04T13:06:00.455Z","type":"message"}
{"nick":"indutny","message":"if node wouldn't use req and res before your middleware","date":"2013-02-04T13:06:09.842Z","type":"message"}
{"nick":"indutny","message":"but actually it still might work pretty fast","date":"2013-02-04T13:06:24.700Z","type":"message"}
{"nick":"indutny","message":"but it'll use Polymorphic caches","date":"2013-02-04T13:06:31.240Z","type":"message"}
{"nick":"indutny","message":"which are a bit slower if contains multiple hidden classes","date":"2013-02-04T13:06:40.153Z","type":"message"}
{"nick":"stagas","message":"I see so it's not ideal but not entirely crap","date":"2013-02-04T13:07:00.180Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-04T13:07:11.688Z","type":"message"}
{"nick":"indutny","message":"exactly","date":"2013-02-04T13:07:13.153Z","type":"message"}
{"nick":"bnoordhuis","date":"2013-02-04T13:10:51.393Z","type":"join"}
{"nick":"stagas","message":"I recently saw a jonathan blow talk and he was advocating to never optimize anything before it's an issue, and in 99,9% of the time it's going to be ok. it just kills your work flow, makes the code harder to mantain, you introduce bugs. better to just write simple stuff","date":"2013-02-04T13:10:56.419Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-04T13:11:44.559Z","type":"message"}
{"nick":"indutny","message":"exactly","date":"2013-02-04T13:11:46.585Z","type":"message"}
{"nick":"jokester","reason":"Remote host closed the connection","date":"2013-02-04T13:17:47.082Z","type":"quit"}
{"nick":"stagas","message":"indutny: this is the talk it's very interesting he makes some valid points not just for games http://the-witness.net/news/2011/06/how-to-program-independent-games/","date":"2013-02-04T13:18:55.474Z","type":"message"}
{"nick":"hz","reason":"Ping timeout: 264 seconds","date":"2013-02-04T13:23:00.451Z","type":"quit"}
{"nick":"indutny","message":"added to bookmarks","date":"2013-02-04T13:23:50.308Z","type":"message"}
{"nick":"indutny","message":"will watch later","date":"2013-02-04T13:23:52.104Z","type":"message"}
{"nick":"indutny","message":"hopefully","date":"2013-02-04T13:23:53.795Z","type":"message"}
{"nick":"hz","date":"2013-02-04T13:31:21.466Z","type":"join"}
{"nick":"felixge","reason":"Quit: felixge","date":"2013-02-04T13:35:30.663Z","type":"quit"}
{"nick":"sgallagh","date":"2013-02-04T13:45:23.472Z","type":"join"}
{"nick":"stagas","reason":"Ping timeout: 264 seconds","date":"2013-02-04T13:55:54.186Z","type":"quit"}
{"nick":"bnoordhuis","message":"next_permutation in js is only 6x slower than the optmized c++ version","date":"2013-02-04T14:00:59.066Z","type":"message"}
{"nick":"bnoordhuis","message":"not bad, v8","date":"2013-02-04T14:01:02.265Z","type":"message"}
{"nick":"indutny","message":":)","date":"2013-02-04T14:01:54.421Z","type":"message"}
{"nick":"stagas","date":"2013-02-04T14:03:55.922Z","type":"join"}
{"nick":"loladiro","date":"2013-02-04T14:05:31.514Z","type":"join"}
{"nick":"jmar777","date":"2013-02-04T14:07:21.271Z","type":"join"}
{"nick":"stagas","reason":"Quit: ChatZilla 0.9.89-rdmsoft [XULRunner 1.9.0.17/2009122204]","date":"2013-02-04T14:33:22.203Z","type":"quit"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-02-04T14:47:58.511Z","type":"quit"}
{"nick":"loladiro","date":"2013-02-04T14:49:48.296Z","type":"join"}
{"nick":"indutny","message":"whoa","date":"2013-02-04T14:54:05.669Z","type":"message"}
{"nick":"indutny","message":"cryptostreams2 are almost working","date":"2013-02-04T14:54:14.763Z","type":"message"}
{"nick":"c4milo","date":"2013-02-04T14:55:56.448Z","type":"join"}
{"nick":"roxlu_","message":"indutny: what are cryptostreams?","date":"2013-02-04T15:02:21.938Z","type":"message"}
{"nick":"`3rdEden","new_nick":"`3E|BRB","date":"2013-02-04T15:04:44.661Z","type":"nick"}
{"nick":"c4milo_","date":"2013-02-04T15:07:59.992Z","type":"join"}
{"nick":"c4milo_","reason":"Remote host closed the connection","date":"2013-02-04T15:24:18.211Z","type":"quit"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-04T15:24:19.831Z","type":"quit"}
{"nick":"`3E|BRB","new_nick":"`3rdEden","date":"2013-02-04T15:30:57.956Z","type":"nick"}
{"nick":"felixge","date":"2013-02-04T15:34:39.434Z","type":"join"}
{"nick":"AvianFlu","date":"2013-02-04T15:43:39.980Z","type":"join"}
{"nick":"MI6","date":"2013-02-04T15:46:19.991Z","type":"join"}
{"nick":"indexzero","date":"2013-02-04T15:48:01.269Z","type":"join"}
{"nick":"stagas","date":"2013-02-04T15:48:44.388Z","type":"join"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-02-04T15:52:56.184Z","type":"quit"}
{"nick":"loladiro","date":"2013-02-04T15:57:14.598Z","type":"join"}
{"nick":"indutny","message":"roxlu_: open tls.js :)","date":"2013-02-04T16:10:20.747Z","type":"message"}
{"nick":"indutny","message":"and search for CryptoStream","date":"2013-02-04T16:10:25.183Z","type":"message"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-02-04T16:11:56.896Z","type":"quit"}
{"nick":"roxlu_","message":"indutny: does this mean libuv gets ssl? ","date":"2013-02-04T16:13:02.009Z","type":"message"}
{"nick":"indutny","message":"no, node.js","date":"2013-02-04T16:13:08.486Z","type":"message"}
{"nick":"c4milo","date":"2013-02-04T16:16:59.115Z","type":"join"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-04T16:17:14.166Z","type":"quit"}
{"nick":"c4milo","date":"2013-02-04T16:17:35.154Z","type":"join"}
{"nick":"perezd","date":"2013-02-04T16:38:23.310Z","type":"join"}
{"nick":"stagas_","date":"2013-02-04T16:43:25.248Z","type":"join"}
{"nick":"stagas","reason":"Ping timeout: 252 seconds","date":"2013-02-04T16:44:18.337Z","type":"quit"}
{"nick":"stagas_","new_nick":"stagas","date":"2013-02-04T16:44:19.857Z","type":"nick"}
{"nick":"`3rdEden","new_nick":"`3E|FOODING","date":"2013-02-04T16:53:17.004Z","type":"nick"}
{"nick":"LOUDBOT","reason":"Remote host closed the connection","date":"2013-02-04T16:55:55.490Z","type":"quit"}
{"nick":"LOUDBOT","date":"2013-02-04T16:56:03.222Z","type":"join"}
{"nick":"LOUDBOT","reason":"Remote host closed the connection","date":"2013-02-04T16:56:52.632Z","type":"quit"}
{"nick":"LOUDBOT","date":"2013-02-04T16:57:00.282Z","type":"join"}
{"nick":"isaacs","message":"indutny: tell your russian developer friends that this is exactly how Express works.","date":"2013-02-04T16:57:06.901Z","type":"message"}
{"nick":"isaacs","message":"indutny: then give them a less on hidden classes","date":"2013-02-04T16:57:13.051Z","type":"message"}
{"nick":"indutny","message":"haha","date":"2013-02-04T16:57:13.556Z","type":"message"}
{"nick":"LOUDBOT","reason":"Remote host closed the connection","date":"2013-02-04T16:57:15.153Z","type":"quit"}
{"nick":"isaacs","message":"indutny: really, it is","date":"2013-02-04T16:57:18.431Z","type":"message"}
{"nick":"LOUDBOT","date":"2013-02-04T16:57:22.271Z","type":"join"}
{"nick":"indutny","message":"well, they think express is shit","date":"2013-02-04T16:57:23.110Z","type":"message"}
{"nick":"isaacs","message":"Express extends the req and res objects all to hell","date":"2013-02-04T16:57:25.101Z","type":"message"}
{"nick":"isaacs","message":"then it'll make your point very effectively, no doubt :)","date":"2013-02-04T16:57:33.381Z","type":"message"}
{"nick":"indutny","message":":)","date":"2013-02-04T16:57:37.316Z","type":"message"}
{"nick":"isaacs","message":"s/less/lesson/","date":"2013-02-04T16:57:40.910Z","type":"message"}
{"nick":"indutny","message":"I already told them to use flatiron","date":"2013-02-04T16:57:42.548Z","type":"message"}
{"nick":"indutny","message":"though they're pretty scary PHP people","date":"2013-02-04T16:57:59.031Z","type":"message"}
{"nick":"dap","date":"2013-02-04T16:57:59.594Z","type":"join"}
{"nick":"indutny","message":"who has just ported Symfony on node.js","date":"2013-02-04T16:58:06.034Z","type":"message"}
{"nick":"indutny","message":"and that's awful","date":"2013-02-04T16:58:11.715Z","type":"message"}
{"nick":"indutny","message":"because I don't even know what Symfony is","date":"2013-02-04T16:58:16.438Z","type":"message"}
{"nick":"isaacs","message":"gah","date":"2013-02-04T16:58:30.740Z","type":"message"}
{"nick":"isaacs","message":"symfony is pretty ok, as php frameworks go","date":"2013-02-04T16:58:47.080Z","type":"message"}
{"nick":"isaacs","message":"but... php frameworks don't go very ok :)","date":"2013-02-04T16:58:53.840Z","type":"message"}
{"nick":"indutny","message":":)","date":"2013-02-04T16:59:06.138Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2013-02-04T16:59:20.536Z","type":"quit"}
{"nick":"indutny","message":"yeah, so I've found the source of the problem in CryptoStream","date":"2013-02-04T16:59:22.475Z","type":"message"}
{"nick":"indutny","message":"sometimes I was emitting 'close' event","date":"2013-02-04T16:59:29.352Z","type":"message"}
{"nick":"indutny","message":"without emitting 'end' event","date":"2013-02-04T16:59:32.789Z","type":"message"}
{"nick":"isaacs","message":"ahh","date":"2013-02-04T16:59:43.079Z","type":"message"}
{"nick":"isaacs","message":"no, 'end' is a must-have.","date":"2013-02-04T16:59:50.459Z","type":"message"}
{"nick":"indutny","message":"yes, I know","date":"2013-02-04T17:00:02.599Z","type":"message"}
{"nick":"isaacs","message":"if you don't override read() (and only use _read and push) then 'end' will definitely happen","date":"2013-02-04T17:00:09.299Z","type":"message"}
{"nick":"indutny","message":"its just someone that calls .destroy()","date":"2013-02-04T17:00:09.722Z","type":"message"}
{"nick":"isaacs","message":"ohhhh..","date":"2013-02-04T17:00:16.179Z","type":"message"}
{"nick":"isaacs","message":"that's odd","date":"2013-02-04T17:00:17.309Z","type":"message"}
{"nick":"indutny","message":"and yeah, I don't support 'end' on ._read level","date":"2013-02-04T17:00:35.270Z","type":"message"}
{"nick":"indutny","message":"and it wasn't really supported before","date":"2013-02-04T17:00:41.540Z","type":"message"}
{"nick":"ryah","message":"https://plus.google.com/u/0/101038813433650812235/posts/NAjqBW9rtSe","date":"2013-02-04T17:00:54.527Z","type":"message"}
{"nick":"indutny","message":"we ain't checking if other side has shutdown connection","date":"2013-02-04T17:00:55.282Z","type":"message"}
{"nick":"isaacs","message":"indutny: you can just push(null) to trigger the end","date":"2013-02-04T17:00:56.669Z","type":"message"}
{"nick":"isaacs","message":"indutny: it's not your responsibility to emit('end'), it's Readable's","date":"2013-02-04T17:01:06.319Z","type":"message"}
{"nick":"indutny","message":"isaacs: ah","date":"2013-02-04T17:01:06.608Z","type":"message"}
{"nick":"indutny","message":"ok","date":"2013-02-04T17:01:10.373Z","type":"message"}
{"nick":"indutny","message":"will it trigger 'end' immediately?","date":"2013-02-04T17:01:20.255Z","type":"message"}
{"nick":"isaacs","message":"indutny: you can also call the _read cb with null","date":"2013-02-04T17:01:21.658Z","type":"message"}
{"nick":"indutny","message":"I mean","date":"2013-02-04T17:01:22.215Z","type":"message"}
{"nick":"indutny","message":"can I do this","date":"2013-02-04T17:01:23.860Z","type":"message"}
{"nick":"indutny","message":"this.push(null);this.emit('close')","date":"2013-02-04T17:01:32.826Z","type":"message"}
{"nick":"isaacs","message":"indutny: well, if the user isn't reading, it'll trigger 'end' once all the bytes are read out","date":"2013-02-04T17:01:32.959Z","type":"message"}
{"nick":"isaacs","message":"indutny: yes, that's fine","date":"2013-02-04T17:01:37.648Z","type":"message"}
{"nick":"isaacs","message":"we should probably do that in Socket._destroy, too","date":"2013-02-04T17:01:51.968Z","type":"message"}
{"nick":"indutny","message":"yes, I guess so","date":"2013-02-04T17:02:32.332Z","type":"message"}
{"nick":"loladiro","date":"2013-02-04T17:02:48.442Z","type":"join"}
{"nick":"isaacs","message":"though, actually, i think it's not an issue there, because if you _read() after destroy, you'll get an ECONNRESET or an EOF anyway, right?","date":"2013-02-04T17:03:31.447Z","type":"message"}
{"nick":"indutny","message":"well","date":"2013-02-04T17:04:47.170Z","type":"message"}
{"nick":"indutny","message":"its an issue if socket is piped","date":"2013-02-04T17:04:54.906Z","type":"message"}
{"nick":"indutny","message":"into another stream","date":"2013-02-04T17:04:59.655Z","type":"message"}
{"nick":"indutny","message":"ryah: interesting reading","date":"2013-02-04T17:05:10.809Z","type":"message"}
{"nick":"loladiro","reason":"Client Quit","date":"2013-02-04T17:05:24.843Z","type":"quit"}
{"nick":"Ralt","reason":"Ping timeout: 248 seconds","date":"2013-02-04T17:05:39.889Z","type":"quit"}
{"nick":"indutny","message":"isaacs: or am I wrong?","date":"2013-02-04T17:06:26.206Z","type":"message"}
{"nick":"indutny","message":"as far as I can see stream will be unpiped if close emitted","date":"2013-02-04T17:06:33.838Z","type":"message"}
{"nick":"indutny","message":"without ending its target","date":"2013-02-04T17:06:40.027Z","type":"message"}
{"nick":"isaacs","message":"indutny: if the writer is closed, it'll be unpiped","date":"2013-02-04T17:06:54.085Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-04T17:06:59.671Z","type":"message"}
{"nick":"isaacs","message":"indutny: since writing after close is usually pointless","date":"2013-02-04T17:07:02.094Z","type":"message"}
{"nick":"indutny","message":"but unpipe doesn't end target stream","date":"2013-02-04T17:07:03.686Z","type":"message"}
{"nick":"isaacs","message":"indutny: in that case the writer IS the \"target stream\"","date":"2013-02-04T17:07:15.384Z","type":"message"}
{"nick":"indutny","message":"oh","date":"2013-02-04T17:07:26.977Z","type":"message"}
{"nick":"indutny","message":"erm","date":"2013-02-04T17:07:32.349Z","type":"message"}
{"nick":"isaacs","message":"indutny: why bother calling .end() if it's already been closed?","date":"2013-02-04T17:07:48.594Z","type":"message"}
{"nick":"indutny","message":"right","date":"2013-02-04T17:07:52.770Z","type":"message"}
{"nick":"isaacs","message":"whatever it was doing, it's done now :)","date":"2013-02-04T17:07:55.215Z","type":"message"}
{"nick":"isaacs","message":"that's what close means","date":"2013-02-04T17:07:59.284Z","type":"message"}
{"nick":"indutny","message":"this stuff is so complicated :)","date":"2013-02-04T17:08:05.324Z","type":"message"}
{"nick":"TheJH","date":"2013-02-04T17:08:08.956Z","type":"join"}
{"nick":"indutny","message":"isaacs: another thing","date":"2013-02-04T17:09:21.040Z","type":"message"}
{"nick":"indutny","message":"suppose ._write() always calls cb() synchronously","date":"2013-02-04T17:09:33.944Z","type":"message"}
{"nick":"indutny","message":"I guess .write() will always return true in such case","date":"2013-02-04T17:09:46.764Z","type":"message"}
{"nick":"indutny","message":"and no 'drain' will happen","date":"2013-02-04T17:09:53.054Z","type":"message"}
{"nick":"indutny","message":"nvm","date":"2013-02-04T17:11:53.419Z","type":"message"}
{"nick":"indutny","message":"I've one idea","date":"2013-02-04T17:11:56.997Z","type":"message"}
{"nick":"isaacs","message":"indutny: that's correct","date":"2013-02-04T17:18:31.332Z","type":"message"}
{"nick":"indutny","message":"so my idea is to queue all writes if internal openssl buffer is bigger than high watermark","date":"2013-02-04T17:20:05.787Z","type":"message"}
{"nick":"indutny","message":"does it seems to be correct to you?","date":"2013-02-04T17:20:13.243Z","type":"message"}
{"nick":"indutny","message":"no, thats too low","date":"2013-02-04T17:21:54.669Z","type":"message"}
{"nick":"tjfontaine","message":"I think he's looking to remove the hwm/lwm stuff because it overcomplicates and doesn't provide as much benefit as he hoped","date":"2013-02-04T17:22:16.359Z","type":"message"}
{"nick":"isaacs","message":"indutny: yeah, i'm thinking that the water mark stuff on writable side is maybe a bad idea.","date":"2013-02-04T17:22:56.329Z","type":"message"}
{"nick":"isaacs","message":"on the readable side, it's sort of necessary.","date":"2013-02-04T17:23:05.899Z","type":"message"}
{"nick":"isaacs","message":"but we almost always want lwm to be zero.","date":"2013-02-04T17:23:13.149Z","type":"message"}
{"nick":"indutny","message":"yep","date":"2013-02-04T17:23:18.922Z","type":"message"}
{"nick":"indutny","message":"well, I need this stuff","date":"2013-02-04T17:23:23.026Z","type":"message"}
{"nick":"indutny","message":"in tls","date":"2013-02-04T17:23:24.602Z","type":"message"}
{"nick":"isaacs","message":"and we don't actually keep reading to hwm anyway.","date":"2013-02-04T17:23:26.079Z","type":"message"}
{"nick":"indutny","message":"not exactly in this way","date":"2013-02-04T17:23:28.022Z","type":"message"}
{"nick":"isaacs","message":"right","date":"2013-02-04T17:23:30.439Z","type":"message"}
{"nick":"indutny","message":"but I need to limit possible amount of data","date":"2013-02-04T17:23:34.398Z","type":"message"}
{"nick":"indutny","message":"that's pulled into openssl","date":"2013-02-04T17:23:38.854Z","type":"message"}
{"nick":"isaacs","message":"so, i'd say, ignore hwm/lwm, and just do what makes sense for openssl.","date":"2013-02-04T17:23:45.309Z","type":"message"}
{"nick":"isaacs","message":"you should take your cue from _read or _write","date":"2013-02-04T17:23:56.639Z","type":"message"}
{"nick":"indutny","message":"k","date":"2013-02-04T17:24:02.074Z","type":"message"}
{"nick":"isaacs","message":"if _read is called, the user wants more data.  if _write is called, the user is putting more data in.","date":"2013-02-04T17:24:06.369Z","type":"message"}
{"nick":"indutny","message":"yes, that's clear to me","date":"2013-02-04T17:24:26.372Z","type":"message"}
{"nick":"isaacs","message":"call the write cb when it's done writing, or the _read cb when you are done reading, and stream.push(chunk) if stuff comes up out-of-band","date":"2013-02-04T17:24:43.058Z","type":"message"}
{"nick":"isaacs","message":"if you find that you have to touch or look at ._readableState or ._writableState, please talk to me about it.  either it means that the API is lacking, or you're doing something wrong.","date":"2013-02-04T17:25:24.503Z","type":"message"}
{"nick":"isaacs","message":"either way, one of us has to fix something :)","date":"2013-02-04T17:25:40.928Z","type":"message"}
{"nick":"indutny","message":":)","date":"2013-02-04T17:25:51.643Z","type":"message"}
{"nick":"indutny","message":"the thing is that all reads/writes are synchronous","date":"2013-02-04T17:26:03.759Z","type":"message"}
{"nick":"indutny","message":"and its pretty interesting","date":"2013-02-04T17:26:07.850Z","type":"message"}
{"nick":"isaacs","message":"yeah","date":"2013-02-04T17:28:36.206Z","type":"message"}
{"nick":"isaacs","message":"it *should* just work fine","date":"2013-02-04T17:28:48.305Z","type":"message"}
{"nick":"isaacs","message":"i mean, it's designed with that use case in mind","date":"2013-02-04T17:28:55.276Z","type":"message"}
{"nick":"mmalecki","new_nick":"mmalecki[out]","date":"2013-02-04T17:29:52.397Z","type":"nick"}
{"nick":"loladiro","date":"2013-02-04T17:30:11.303Z","type":"join"}
{"nick":"tjfontaine","message":"ugh, Uint8Array(Uint8Array([1,2,3,4])) is supposed to copy?","date":"2013-02-04T17:31:40.951Z","type":"message"}
{"nick":"txdv","reason":"Read error: Connection reset by peer","date":"2013-02-04T17:34:43.825Z","type":"quit"}
{"nick":"txdv","date":"2013-02-04T17:34:59.842Z","type":"join"}
{"nick":"TheJH","reason":"Ping timeout: 246 seconds","date":"2013-02-04T17:36:16.788Z","type":"quit"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-04T17:38:58.123Z","type":"quit"}
{"nick":"isaacs","message":"anyone have any idea what this means?","date":"2013-02-04T17:42:56.117Z","type":"message"}
{"nick":"isaacs","message":"**** DEOPT: doWrite at bailout #3, address 0x0, frame size 0 ;;; @63: gap.","date":"2013-02-04T17:42:56.466Z","type":"message"}
{"nick":"brson","date":"2013-02-04T17:46:42.062Z","type":"join"}
{"nick":"piscisaureus_","reason":"Ping timeout: 245 seconds","date":"2013-02-04T17:48:46.832Z","type":"quit"}
{"nick":"tjfontaine","message":"isaacs: gist the full blurb and the relevant block of code?","date":"2013-02-04T17:51:18.258Z","type":"message"}
{"nick":"isaacs","message":"tjfontaine: https://gist.github.com/4705572","date":"2013-02-04T17:52:27.651Z","type":"message"}
{"nick":"isaacs","message":"hm.. looks likei managed to somehow get rid of one of the gap deopts...","date":"2013-02-04T17:53:34.581Z","type":"message"}
{"nick":"isaacs","message":"MAGIC!","date":"2013-02-04T17:53:37.811Z","type":"message"}
{"nick":"isaacs","message":"hooray1","date":"2013-02-04T17:53:41.351Z","type":"message"}
{"nick":"tjfontaine","message":"heh","date":"2013-02-04T17:53:49.565Z","type":"message"}
{"nick":"isaacs","message":"tjfontaine: posted afterWrite as a comment.","date":"2013-02-04T17:54:45.970Z","type":"message"}
{"nick":"isaacs","message":"that's another one that's gapping","date":"2013-02-04T17:54:48.930Z","type":"message"}
{"nick":"wolfeida_","date":"2013-02-04T17:55:02.231Z","type":"join"}
{"nick":"brson","reason":"Ping timeout: 245 seconds","date":"2013-02-04T17:55:51.087Z","type":"quit"}
{"nick":"brson","date":"2013-02-04T17:57:17.801Z","type":"join"}
{"nick":"wolfeidau","reason":"Ping timeout: 260 seconds","date":"2013-02-04T17:57:31.253Z","type":"quit"}
{"nick":"tjfontaine","message":"oh this lead to me finding an article I hadn't read yet http://wingolog.org/archives/2011/09/05/from-ssa-to-native-code-v8s-lithium-language","date":"2013-02-04T18:00:22.218Z","type":"message"}
{"nick":"piscisaureus_","date":"2013-02-04T18:00:51.278Z","type":"join"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2013-02-04T18:01:38.901Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-04T18:02:16.997Z","type":"join"}
{"nick":"indexzero","date":"2013-02-04T18:02:21.187Z","type":"join"}
{"nick":"isaacs","message":"yeah","date":"2013-02-04T18:03:18.506Z","type":"message"}
{"nick":"isaacs","message":"i found that as wel.","date":"2013-02-04T18:03:22.536Z","type":"message"}
{"nick":"isaacs","message":"basically... what i could gather from it is that to know what \"gap\" means, i need to probably go to school some more.","date":"2013-02-04T18:03:39.118Z","type":"message"}
{"nick":"jmar777","reason":"Read error: Connection reset by peer","date":"2013-02-04T18:03:54.965Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-04T18:04:04.299Z","type":"join"}
{"nick":"tjfontaine","message":"is \"@199: gap.\" an offset or regsiter","date":"2013-02-04T18:05:09.848Z","type":"message"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-02-04T18:05:46.318Z","type":"quit"}
{"nick":"mikeal","date":"2013-02-04T18:09:52.946Z","type":"join"}
{"nick":"isaacs","message":"tjfontaine: no idea.","date":"2013-02-04T18:11:21.611Z","type":"message"}
{"nick":"isaacs","message":"well... removing a bunch of deopts here actually ended up making the benchmark slower.","date":"2013-02-04T18:11:58.291Z","type":"message"}
{"nick":"tjfontaine","message":"well it's interesting that afterWrite not only gets deopt'd but re-opt'd","date":"2013-02-04T18:12:03.728Z","type":"message"}
{"nick":"isaacs","message":"so..... i'm clearly doing the wrong thing.","date":"2013-02-04T18:12:11.431Z","type":"message"}
{"nick":"TooTallNate","date":"2013-02-04T18:12:22.945Z","type":"join"}
{"nick":"isaacs","message":"https://gist.github.com/4708444","date":"2013-02-04T18:13:01.050Z","type":"message"}
{"nick":"TooTallNate","reason":"Remote host closed the connection","date":"2013-02-04T18:13:01.241Z","type":"quit"}
{"nick":"TooTallNate","date":"2013-02-04T18:13:24.124Z","type":"join"}
{"nick":"isaacs","message":"the floating patch that i'm stashing prevents a bunch of bailouts, but i think it is probably overall not good.","date":"2013-02-04T18:13:38.890Z","type":"message"}
{"nick":"loladiro","date":"2013-02-04T18:14:42.147Z","type":"join"}
{"nick":"piscisaureus_","reason":"Quit: ~ Trillian Astra - www.trillian.im ~","date":"2013-02-04T18:15:07.911Z","type":"quit"}
{"nick":"mikeal","reason":"Ping timeout: 245 seconds","date":"2013-02-04T18:18:21.822Z","type":"quit"}
{"nick":"isaacs","message":"this still is a bit weird to me:    1494   35.3%  ___gettimeofday","date":"2013-02-04T18:18:25.507Z","type":"message"}
{"nick":"`3E|FOODING","new_nick":"`3rdEden","date":"2013-02-04T18:18:35.435Z","type":"nick"}
{"nick":"tjfontaine","message":"if you're spending more time in uv that's not something unreasonable to see","date":"2013-02-04T18:19:07.771Z","type":"message"}
{"nick":"trevnorris","date":"2013-02-04T18:22:47.010Z","type":"join"}
{"nick":"isaacs","message":"it's tricky to get a side-by-side, because the tick processor doesn't work on smartos","date":"2013-02-04T18:24:55.022Z","type":"message"}
{"nick":"isaacs","message":"but on the dtrace flamegraphs on smartos, i'm not seeing all THAT much time spent in gettimeofday","date":"2013-02-04T18:25:45.912Z","type":"message"}
{"nick":"bnoordhuis","message":"isaacs: i'm trying to rpm-ify node. rpm tells you what the system's libdir is but there's a 'hard-coded' path in lib/module.js","date":"2013-02-04T18:26:38.876Z","type":"message"}
{"nick":"bnoordhuis","message":"var paths = [path.resolve(process.execPath, '..', '..', 'lib', 'node')]; <- that one","date":"2013-02-04T18:26:50.376Z","type":"message"}
{"nick":"bnoordhuis","message":"is that for any particular reason and can it be fixed?","date":"2013-02-04T18:27:09.142Z","type":"message"}
{"nick":"isaacs","message":"hm.","date":"2013-02-04T18:27:17.061Z","type":"message"}
{"nick":"isaacs","message":"lemme look at it.  one sec.","date":"2013-02-04T18:27:21.621Z","type":"message"}
{"nick":"isaacs","message":"ah.  these are the global require() paths","date":"2013-02-04T18:27:42.921Z","type":"message"}
{"nick":"bnoordhuis","message":"yes","date":"2013-02-04T18:27:47.326Z","type":"message"}
{"nick":"isaacs","message":"those are deprecated, and only there for historical reasons.","date":"2013-02-04T18:27:52.011Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: added a `--noop` parameter last night to the benchmarks. basically just runs the test w/o any counters or output.","date":"2013-02-04T18:27:54.888Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: kewl.","date":"2013-02-04T18:28:00.560Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: i was seeing one of them deopting MakeCallback whenever the timer hit.","date":"2013-02-04T18:28:17.050Z","type":"message"}
{"nick":"bnoordhuis","message":"isaacs: so if i install npm to /usr/lib64/node_modules, it should Just Work(TM)","date":"2013-02-04T18:28:25.192Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: but, i don't think that's a major issue.","date":"2013-02-04T18:28:28.820Z","type":"message"}
{"nick":"bnoordhuis","message":"+ question mark","date":"2013-02-04T18:28:30.192Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: npm *intentionally* does not make globally installed modules require-able.","date":"2013-02-04T18:28:46.560Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: yeah. what happened was that .inc was incrementing so quickly that it overflowed the Smi to a double.","date":"2013-02-04T18:28:51.341Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: but, you do need to set the npm prefix conf.","date":"2013-02-04T18:28:56.580Z","type":"message"}
{"nick":"trevnorris","message":"which is why I did noop","date":"2013-02-04T18:28:58.388Z","type":"message"}
{"nick":"bnoordhuis","message":"isaacs: how do you do that?","date":"2013-02-04T18:29:10.249Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: drop a file called 'npmrc' in /usr/lib64/node_modules/npm/","date":"2013-02-04T18:29:30.280Z","type":"message"}
{"nick":"bnoordhuis","message":"ah okay","date":"2013-02-04T18:29:40.149Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: it should contain this line:  prefix = /usr/lib64","date":"2013-02-04T18:29:42.230Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: it can also have other configs, but please use judiciously.","date":"2013-02-04T18:29:53.829Z","type":"message"}
{"nick":"bnoordhuis","message":"understood","date":"2013-02-04T18:30:01.990Z","type":"message"}
{"nick":"bnoordhuis","message":"thanks","date":"2013-02-04T18:30:04.347Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: this is how we point stuff at %APPDATA% folder for windows","date":"2013-02-04T18:30:18.639Z","type":"message"}
{"nick":"isaacs","message":"np","date":"2013-02-04T18:30:19.689Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: is it normal to be spending 35% of our ticks in ___gettimeofday?","date":"2013-02-04T18:30:48.549Z","type":"message"}
{"nick":"bnoordhuis","message":"isaacs: depends on what you do","date":"2013-02-04T18:31:00.658Z","type":"message"}
{"nick":"bnoordhuis","message":"can you see where the calls are coming from?","date":"2013-02-04T18:31:06.451Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: in net-pipe.js","date":"2013-02-04T18:31:08.119Z","type":"message"}
{"nick":"isaacs","message":"nope","date":"2013-02-04T18:31:11.898Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: having a problem with spawning the script to test flow across two processes. can't reliably make sure the other process dies.","date":"2013-02-04T18:31:50.373Z","type":"message"}
{"nick":"bnoordhuis","message":"it's not abnormal, that's probably loop->time updates","date":"2013-02-04T18:31:51.499Z","type":"message"}
{"nick":"bnoordhuis","message":"is that on os x or smartos?","date":"2013-02-04T18:32:09.178Z","type":"message"}
{"nick":"isaacs","message":"os x","date":"2013-02-04T18:32:14.778Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: until that can be hammered out, don't want it in since it will break automated testing.","date":"2013-02-04T18:32:14.992Z","type":"message"}
{"nick":"isaacs","message":"on smartos i don't see much time being spent in that.  i mean, it's a chunk, but not THAT much","date":"2013-02-04T18:32:24.898Z","type":"message"}
{"nick":"bnoordhuis","message":"right, on smartos it should be clock_monotonic","date":"2013-02-04T18:32:28.033Z","type":"message"}
{"nick":"isaacs","message":"nowhere near 35%","date":"2013-02-04T18:32:28.528Z","type":"message"}
{"nick":"bnoordhuis","message":"err, clock_gettime(CLOCK_MONOTONIC)","date":"2013-02-04T18:32:51.842Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: ok","date":"2013-02-04T18:32:52.297Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: even that, is not showing up in the graph at all.","date":"2013-02-04T18:32:59.227Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: the __gettimeofday is showing up from timer.active(self)","date":"2013-02-04T18:33:06.747Z","type":"message"}
{"nick":"isaacs","message":"expected, since that calls Date.now()","date":"2013-02-04T18:33:13.901Z","type":"message"}
{"nick":"bnoordhuis","message":"oh, maybe libuv should use the xnu syscall (i forgot what it's called)","date":"2013-02-04T18:33:37.609Z","type":"message"}
{"nick":"bnoordhuis","message":"that's probably faster than gettimeofday","date":"2013-02-04T18:33:47.170Z","type":"message"}
{"nick":"sblom","date":"2013-02-04T18:34:13.268Z","type":"join"}
{"nick":"bnoordhuis","message":"mach_absolute_time, that's the one","date":"2013-02-04T18:34:35.180Z","type":"message"}
{"nick":"bnoordhuis","message":"hmm, i guess it should already be using that","date":"2013-02-04T18:36:27.029Z","type":"message"}
{"nick":"isaacs","message":"seems that way","date":"2013-02-04T18:37:22.654Z","type":"message"}
{"nick":"bnoordhuis","message":"isaacs: can you but a breakpoint on __gettimeofday in gdb","date":"2013-02-04T18:37:41.151Z","type":"message"}
{"nick":"bnoordhuis","message":"then try this:","date":"2013-02-04T18:37:44.434Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: we call it in int uv_cond_timedwait(uv_cond_t* cond, uv_mutex_t* mutex, uint64_t timeout) {","date":"2013-02-04T18:37:46.185Z","type":"message"}
{"nick":"bnoordhuis","message":"oh right","date":"2013-02-04T18:37:53.080Z","type":"message"}
{"nick":"bnoordhuis","message":"because os x doesn't have monotonic clocks :/","date":"2013-02-04T18:38:12.707Z","type":"message"}
{"nick":"isaacs","message":"and v8 calls it a bunch of places, so does openssl, cares","date":"2013-02-04T18:38:18.175Z","type":"message"}
{"nick":"isaacs","message":"hrm.","date":"2013-02-04T18:38:23.514Z","type":"message"}
{"nick":"bnoordhuis","message":"yes, it could be v8","date":"2013-02-04T18:38:24.347Z","type":"message"}
{"nick":"bnoordhuis","message":"but let's check","date":"2013-02-04T18:38:27.067Z","type":"message"}
{"nick":"bnoordhuis","message":"so in gdb `break __gettimeofday`","date":"2013-02-04T18:38:35.849Z","type":"message"}
{"nick":"bnoordhuis","message":"then: commands","date":"2013-02-04T18:38:41.366Z","type":"message"}
{"nick":"bnoordhuis","message":"silent","date":"2013-02-04T18:38:43.278Z","type":"message"}
{"nick":"bnoordhuis","message":"bt 5","date":"2013-02-04T18:38:47.552Z","type":"message"}
{"nick":"bnoordhuis","message":"c","date":"2013-02-04T18:38:47.861Z","type":"message"}
{"nick":"bnoordhuis","message":"end","date":"2013-02-04T18:38:48.613Z","type":"message"}
{"nick":"isaacs","message":"do i need node_g?","date":"2013-02-04T18:38:49.744Z","type":"message"}
{"nick":"bnoordhuis","message":"run","date":"2013-02-04T18:38:50.077Z","type":"message"}
{"nick":"bnoordhuis","message":"that'd be best but the release binary should work as well","date":"2013-02-04T18:39:01.952Z","type":"message"}
{"nick":"isaacs","message":"https://gist.github.com/4708631","date":"2013-02-04T18:41:24.902Z","type":"message"}
{"nick":"bnoordhuis","message":"it's always the same stack trace?","date":"2013-02-04T18:41:49.736Z","type":"message"}
{"nick":"isaacs","message":"sometimes it's this one: https://gist.github.com/4708639","date":"2013-02-04T18:42:44.621Z","type":"message"}
{"nick":"bnoordhuis","message":"right","date":"2013-02-04T18:42:55.311Z","type":"message"}
{"nick":"bnoordhuis","message":"so it's v8","date":"2013-02-04T18:42:57.209Z","type":"message"}
{"nick":"isaacs","message":"yep","date":"2013-02-04T18:43:09.411Z","type":"message"}
{"nick":"bnoordhuis","message":"seems it doesn't use mach_absolute_time :/","date":"2013-02-04T18:43:09.957Z","type":"message"}
{"nick":"isaacs","message":"indeed.  only instance of that function is in deps/uv","date":"2013-02-04T18:43:29.781Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: which stream-* branch of yours has the latest improvements?","date":"2013-02-04T18:43:31.090Z","type":"message"}
{"nick":"bnoordhuis","message":"pretty easy to fix though","date":"2013-02-04T18:43:36.002Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: um... kinda all over the map.  not sure any of this is \"improvements\" at this point.","date":"2013-02-04T18:44:03.210Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: the patient is cut up into pieces on the operating table.","date":"2013-02-04T18:44:12.300Z","type":"message"}
{"nick":"trevnorris","message":"lol ok","date":"2013-02-04T18:44:18.262Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: i'm experimenting with removing drastic amounts of functionality from stream.Writable.","date":"2013-02-04T18:44:34.790Z","type":"message"}
{"nick":"trevnorris","message":"got it.","date":"2013-02-04T18:44:44.778Z","type":"message"}
{"nick":"isaacs","message":"but i'm unsure if it's actually an improvement.  of course, it breaks like a zillion tests, which i ahven't updated right now.","date":"2013-02-04T18:44:51.970Z","type":"message"}
{"nick":"piscisaureus_","date":"2013-02-04T18:44:57.450Z","type":"join"}
{"nick":"isaacs","message":"and i'm not seeing much speed improvement... so... it's unclear if it's a win.","date":"2013-02-04T18:45:02.330Z","type":"message"}
{"nick":"mikeal","date":"2013-02-04T18:45:30.869Z","type":"join"}
{"nick":"isaacs","message":"but my suspicion is that maybe if i update Readable accordingly, then they might play nicer together?  i'm not sure, though.","date":"2013-02-04T18:45:32.389Z","type":"message"}
{"nick":"isaacs","message":"if it turns out not to be worthwhile, i'm going to shitcan the whole branch, and try a different thing.","date":"2013-02-04T18:45:46.709Z","type":"message"}
{"nick":"trevnorris","message":"understand.","date":"2013-02-04T18:46:19.849Z","type":"message"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-04T18:46:57.810Z","type":"quit"}
{"nick":"isaacs","message":"trevnorris: but, my latest stuff is on stream-writable-rewrite","date":"2013-02-04T18:47:57.578Z","type":"message"}
{"nick":"isaacs","message":"it's marginally faster.","date":"2013-02-04T18:48:05.788Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2013-02-04T18:48:15.621Z","type":"quit"}
{"nick":"isaacs","message":"averaging about 3.0Gb/sec on my machine instead of 2.8-2.9","date":"2013-02-04T18:48:20.438Z","type":"message"}
{"nick":"isaacs","message":"(on net-pipe.js)","date":"2013-02-04T18:48:25.508Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: when the tests are broken into multiple processes, the margin of regression is larger.","date":"2013-02-04T18:48:25.928Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: that's great.","date":"2013-02-04T18:48:34.978Z","type":"message"}
{"nick":"isaacs","message":"i'll care when net-pipe is back up to 3.5 on my machine :)","date":"2013-02-04T18:48:44.598Z","type":"message"}
{"nick":"isaacs","message":"then we can zoom in more.","date":"2013-02-04T18:48:51.377Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: for example: tcp_raw_c2s: master - 17.752; v0.8.17 - 19.612","date":"2013-02-04T18:49:00.473Z","type":"message"}
{"nick":"trevnorris","message":"imho we need to figure out why _raw_ tests have such a big gap.","date":"2013-02-04T18:49:25.509Z","type":"message"}
{"nick":"Ralt","date":"2013-02-04T18:50:17.426Z","type":"join"}
{"nick":"isaacs","message":"trevnorris: so, one thing i noticed was that my tcp-raw stuff had a lot of cutesy closure bs in it","date":"2013-02-04T18:51:58.615Z","type":"message"}
{"nick":"isaacs","message":"req.oncomplete = afterWrite(fn)","date":"2013-02-04T18:52:09.785Z","type":"message"}
{"nick":"isaacs","message":"etc.","date":"2013-02-04T18:52:10.685Z","type":"message"}
{"nick":"isaacs","message":"that should probably be unrolled.","date":"2013-02-04T18:52:18.735Z","type":"message"}
{"nick":"isaacs","message":"if only to rule out V8 re-optimizing closures as a culprit","date":"2013-02-04T18:53:02.275Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: here's the output of _raw_c2s with the new noop: https://gist.github.com/d6104d0e906adb870723","date":"2013-02-04T18:54:34.387Z","type":"message"}
{"nick":"trevnorris","message":"sec. let me update that w/ v0.8 as well","date":"2013-02-04T18:55:02.931Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: ok, I think those two comparisons will be helpful.","date":"2013-02-04T18:55:55.536Z","type":"message"}
{"nick":"trevnorris","message":"heh, the only thing that's optimized in the v0.8 version is noop.","date":"2013-02-04T18:56:24.622Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: ok. just removed all the benchmark noise. v0.8 does almost nothing.","date":"2013-02-04T18:57:44.469Z","type":"message"}
{"nick":"indexzero","date":"2013-02-04T19:01:22.103Z","type":"join"}
{"nick":"isaacs","message":"nice","date":"2013-02-04T19:01:49.059Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: so it looks like v8 is complaining about itself: \"Did not inline InstantiateFunction\"","date":"2013-02-04T19:08:31.476Z","type":"message"}
{"nick":"felixge","reason":"Quit: felixge","date":"2013-02-04T19:09:01.089Z","type":"quit"}
{"nick":"trevnorris","message":"indutny: know anything about ^","date":"2013-02-04T19:09:03.496Z","type":"message"}
{"nick":"felixge","date":"2013-02-04T19:09:49.948Z","type":"join"}
{"nick":"felixge","reason":"Changing host","date":"2013-02-04T19:09:50.166Z","type":"quit"}
{"nick":"felixge","date":"2013-02-04T19:09:50.299Z","type":"join"}
{"nick":"piscisaureus_","reason":"Ping timeout: 252 seconds","date":"2013-02-04T19:12:48.241Z","type":"quit"}
{"nick":"brson","reason":"Ping timeout: 246 seconds","date":"2013-02-04T19:14:37.844Z","type":"quit"}
{"nick":"isaacs","message":"hrm.  so, ripping out all these features from Writable, and using smaller more inlineable functions, net-pipe got 2% faster, but http_simple got 1.2% slower.","date":"2013-02-04T19:15:43.169Z","type":"message"}
{"nick":"brson","date":"2013-02-04T19:15:44.193Z","type":"join"}
{"nick":"indutny","message":"trevnorris: no","date":"2013-02-04T19:16:15.469Z","type":"message"}
{"nick":"indutny","message":"not really","date":"2013-02-04T19:16:16.834Z","type":"message"}
{"nick":"indutny","message":"bert is everywhere http://www.youtube.com/watch?v=tgTniHwGPuM","date":"2013-02-04T19:16:30.261Z","type":"message"}
{"nick":"trevnorris","message":"ok, worth a shot. just don't like that v8 is complaining about itself.","date":"2013-02-04T19:16:56.326Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: hm. this is a conundrum.","date":"2013-02-04T19:17:39.622Z","type":"message"}
{"nick":"indutny","message":"trevnorris: file a bug","date":"2013-02-04T19:18:13.459Z","type":"message"}
{"nick":"trevnorris","message":"indutny: yeah, good point.","date":"2013-02-04T19:18:58.711Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: what was it you said the other day about something getting fixed in v8 3.16? (i know that's so descriptive and all)","date":"2013-02-04T19:19:39.753Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: too lazy gc?","date":"2013-02-04T19:20:15.069Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: ah yeah. that's right. that ram usage was getting almost double.","date":"2013-02-04T19:20:51.751Z","type":"message"}
{"nick":"trevnorris","message":"i did notice that v0.8 was garbage collecting almost 2x's as often as on master","date":"2013-02-04T19:21:23.474Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: so is most the slowness in the _raw_ tests not going to be on the js side?","date":"2013-02-04T19:23:43.176Z","type":"message"}
{"nick":"`3rdEden","reason":"Quit: device swap","date":"2013-02-04T19:24:21.701Z","type":"quit"}
{"nick":"MI6","message":"\u0002joyent/libuv:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u00028311390\u0002 : darwin: merge uv_cond_timedwait implementation  Merge the OS X specific i - http://git.io/CafB5g","date":"2013-02-04T19:26:48.517Z","type":"message"}
{"nick":"tjfontaine","message":"bnoordhuis: missing file in that commit?","date":"2013-02-04T19:27:55.734Z","type":"message"}
{"nick":"bnoordhuis","message":"missing file?","date":"2013-02-04T19:28:17.108Z","type":"message"}
{"nick":"tjfontaine","message":"oh I see","date":"2013-02-04T19:28:21.919Z","type":"message"}
{"nick":"tjfontaine","message":"mind me not","date":"2013-02-04T19:28:26.368Z","type":"message"}
{"nick":"`3rdEden","date":"2013-02-04T19:29:05.097Z","type":"join"}
{"nick":"c4milo","date":"2013-02-04T19:33:26.105Z","type":"join"}
{"nick":"mmalecki[out]","new_nick":"mmalecki","date":"2013-02-04T19:36:46.310Z","type":"nick"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-04T19:39:01.768Z","type":"quit"}
{"nick":"felixge","reason":"Quit: felixge","date":"2013-02-04T19:41:59.784Z","type":"quit"}
{"nick":"isaacs","message":"trevnorris: it could still be \"on the js side\".  but it wouldn't be in node's lib/*.js.  it might still be in src/node.js","date":"2013-02-04T19:42:23.191Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: but that's unlikely, i think.  that file changed, but not TOO dramatically, and moving MC back to C++ doens't change things significantly.","date":"2013-02-04T19:42:44.881Z","type":"message"}
{"nick":"AvianFlu","reason":"Remote host closed the connection","date":"2013-02-04T19:43:16.799Z","type":"quit"}
{"nick":"trevnorris","message":"isaacs: ok. know of a way we could test the underlying mechanism (libuv I'd assume)?","date":"2013-02-04T19:43:20.718Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: we're looking for a 10-40% slowdown.  shaving off 0.5% for a deopt of _makeCallback, it turns out, is not relevant.","date":"2013-02-04T19:43:26.122Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: gotta run.  i'll be back in a few hours.","date":"2013-02-04T19:43:50.451Z","type":"message"}
{"nick":"trevnorris","message":"kk","date":"2013-02-04T19:43:55.743Z","type":"message"}
{"nick":"mraleph1","message":"was somebody looking for me?","date":"2013-02-04T19:46:26.109Z","type":"message"}
{"nick":"mraleph1","message":"ah I see, isaacs mentioned me.","date":"2013-02-04T19:47:43.761Z","type":"message"}
{"nick":"tjfontaine","message":"ya about understanding deopt output","date":"2013-02-04T19:47:55.594Z","type":"message"}
{"nick":"sblom","reason":"Ping timeout: 260 seconds","date":"2013-02-04T19:48:35.184Z","type":"quit"}
{"nick":"bnoordhuis","message":"https://github.com/bnoordhuis/node/compare/9a488a6...e0bffc4 <- thoughts on this? adds --libdir and --mandir switches to configure","date":"2013-02-04T19:48:37.881Z","type":"message"}
{"nick":"mraleph1","message":"isaacs: here are some tips. First: if you are running x64 build of node then deoptimization comment does not always match the real reason for deopt.","date":"2013-02-04T19:48:48.820Z","type":"message"}
{"nick":"mraleph1","message":"isaacs: the second thing tagged-to-i are conversion. it deopts if you get double that does not fit into int or something that is not a number at all.","date":"2013-02-04T19:49:47.302Z","type":"message"}
{"nick":"mraleph1","message":"isaacs: deoptimize - is a soft deopt − it happens when you reach code that was never executed before.","date":"2013-02-04T19:50:10.841Z","type":"message"}
{"nick":"tjfontaine","message":"bnoordhuis: if target_path.endswith('/'): might be an issue on win32?","date":"2013-02-04T19:50:39.396Z","type":"message"}
{"nick":"trevnorris","message":"mraleph1: v8 is deoptimizing itself (e.g. Instantiate) so nothing to worry about?","date":"2013-02-04T19:50:58.970Z","type":"message"}
{"nick":"paddybyers","reason":"Ping timeout: 248 seconds","date":"2013-02-04T19:50:59.965Z","type":"quit"}
{"nick":"bnoordhuis","message":"do people use install.py on windows?","date":"2013-02-04T19:51:00.098Z","type":"message"}
{"nick":"felixge","date":"2013-02-04T19:51:02.437Z","type":"join"}
{"nick":"felixge","reason":"Changing host","date":"2013-02-04T19:51:07.009Z","type":"quit"}
{"nick":"felixge","date":"2013-02-04T19:51:07.138Z","type":"join"}
{"nick":"mraleph1","message":"gap never deoptimizes. so if you see it — then your deopt point points to a wrong place. you need to do manual correlation between generated code and a deopt","date":"2013-02-04T19:51:08.151Z","type":"message"}
{"nick":"tjfontaine","message":"bnoordhuis: I don't know, I suppose if they do that means they're in mingw land","date":"2013-02-04T19:51:18.708Z","type":"message"}
{"nick":"tjfontaine","message":"where it wouldn't matter","date":"2013-02-04T19:51:25.790Z","type":"message"}
{"nick":"mraleph1","message":"trevnorris: why does Instantiate deopt?","date":"2013-02-04T19:51:28.287Z","type":"message"}
{"nick":"bnoordhuis","message":"tjfontaine: also, target_path is the path specified by us","date":"2013-02-04T19:51:41.567Z","type":"message"}
{"nick":"tjfontaine","message":"ah right","date":"2013-02-04T19:52:00.865Z","type":"message"}
{"nick":"mraleph1","message":"trevnorris: I guess for node.js it would be very cool is Instantiate would be implemented a little bit different, cause it is quite a hot path for object creation.","date":"2013-02-04T19:52:32.901Z","type":"message"}
{"nick":"lohkey","date":"2013-02-04T19:52:40.017Z","type":"join"}
{"nick":"trevnorris","message":"mraleph1: whoop. nm. just said couldn't be inlined.","date":"2013-02-04T19:52:40.017Z","type":"message"}
{"nick":"trevnorris","message":"mraleph1: it's just a message that isn't showing up when the test is run on v0.8","date":"2013-02-04T19:52:51.763Z","type":"message"}
{"nick":"mraleph1","message":"well, some inlining heuristics might have change, or printing. I don't think it was ever inlined anywhere.","date":"2013-02-04T19:53:27.211Z","type":"message"}
{"nick":"trevnorris","message":"cool","date":"2013-02-04T19:53:40.521Z","type":"message"}
{"nick":"mraleph1","message":"I am working on a tool that would make reading of deopt output easier, but it is not there yet.","date":"2013-02-04T19:57:32.869Z","type":"message"}
{"nick":"mraleph1","message":"Hopefully I'll get some raw version out soonish.","date":"2013-02-04T19:57:47.529Z","type":"message"}
{"nick":"bnoordhuis","message":"mraleph1: v8 uses gettimeofday in a lot of places. what happens if the system clock goes back or forward?","date":"2013-02-04T19:58:48.427Z","type":"message"}
{"nick":"mraleph1","message":"who knows.","date":"2013-02-04T19:59:15.528Z","type":"message"}
{"nick":"bnoordhuis","message":"interesting, isn't it?","date":"2013-02-04T19:59:35.115Z","type":"message"}
{"nick":"mraleph1","message":"I don't think it uses it only any essential code pats.","date":"2013-02-04T19:59:48.387Z","type":"message"}
{"nick":"mraleph1","message":"on any","date":"2013-02-04T19:59:55.464Z","type":"message"}
{"nick":"mraleph1","message":"s/only any/on any/","date":"2013-02-04T20:00:05.187Z","type":"message"}
{"nick":"bnoordhuis","message":"looks like it, only for logging","date":"2013-02-04T20:00:29.700Z","type":"message"}
{"nick":"bnoordhuis","message":"i.e. logging would be off","date":"2013-02-04T20:00:41.486Z","type":"message"}
{"nick":"mikeal","date":"2013-02-04T20:09:14.409Z","type":"join"}
{"nick":"EhevuTov","date":"2013-02-04T20:11:55.295Z","type":"join"}
{"nick":"trevnorris","message":"well poop. i'm splitting the net tests to run in multiple processes, and the gap is growing:","date":"2013-02-04T20:13:43.677Z","type":"message"}
{"nick":"trevnorris","message":"tcp_raw_c2s   master - 17.82 ; v0.8 - 19.46","date":"2013-02-04T20:13:45.000Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: have a tip where I could start looking at the non js tcp_wrap side?","date":"2013-02-04T20:14:24.875Z","type":"message"}
{"nick":"mikeal1","date":"2013-02-04T20:15:54.851Z","type":"join"}
{"nick":"mikeal","reason":"Read error: Connection reset by peer","date":"2013-02-04T20:16:16.703Z","type":"quit"}
{"nick":"jmar777","reason":"Read error: Connection reset by peer","date":"2013-02-04T20:25:51.501Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-04T20:26:20.293Z","type":"join"}
{"nick":"Ralt","reason":"Remote host closed the connection","date":"2013-02-04T20:29:54.166Z","type":"quit"}
{"nick":"mikeal1","reason":"Quit: Leaving.","date":"2013-02-04T20:33:53.136Z","type":"quit"}
{"nick":"Ralt","date":"2013-02-04T20:34:35.855Z","type":"join"}
{"nick":"mikeal","date":"2013-02-04T20:35:01.559Z","type":"join"}
{"nick":"AvianFlu","date":"2013-02-04T20:59:07.107Z","type":"join"}
{"nick":"rje`mac","reason":"Ping timeout: 276 seconds","date":"2013-02-04T21:00:27.899Z","type":"quit"}
{"nick":"rje`mac","date":"2013-02-04T21:02:06.177Z","type":"join"}
{"nick":"Ralt","reason":"Remote host closed the connection","date":"2013-02-04T21:13:42.495Z","type":"quit"}
{"nick":"piscisaureus_","date":"2013-02-04T21:21:25.116Z","type":"join"}
{"nick":"Ralt","date":"2013-02-04T21:21:29.383Z","type":"join"}
{"nick":"piscisaureus_","message":"hello","date":"2013-02-04T21:21:30.815Z","type":"message"}
{"nick":"piscisaureus_","message":"what was I supposed to be working on again?","date":"2013-02-04T21:21:35.835Z","type":"message"}
{"nick":"sgallagh","reason":"Remote host closed the connection","date":"2013-02-04T21:22:50.678Z","type":"quit"}
{"nick":"trevnorris","message":"piscisaureus_: i'm seeing a significant gap in performance using tcp_wrap directly. and I'd think that part isn't affected too much by js problems.","date":"2013-02-04T21:25:15.288Z","type":"message"}
{"nick":"piscisaureus_","message":"trevnorris: tcp_wrap is slower, or faster?","date":"2013-02-04T21:25:44.415Z","type":"message"}
{"nick":"trevnorris","message":"and i'm having a difficult time figuring out where to look for issues there.","date":"2013-02-04T21:25:45.879Z","type":"message"}
{"nick":"piscisaureus_","message":"trevnorris: btw - i can hardly believe it was that what i am supposed to be working on","date":"2013-02-04T21:26:06.232Z","type":"message"}
{"nick":"piscisaureus_","message":";)","date":"2013-02-04T21:26:09.522Z","type":"message"}
{"nick":"trevnorris","message":"piscisaureus_: slower:  master - 17.82 Gb/sec  ; v0.8 - 19.46 Gb/sec","date":"2013-02-04T21:26:18.386Z","type":"message"}
{"nick":"CoverSlide","message":"checkout, bench, log, checkout, bench, log","date":"2013-02-04T21:26:31.269Z","type":"message"}
{"nick":"trevnorris","message":"heh, doubt it.","date":"2013-02-04T21:26:32.576Z","type":"message"}
{"nick":"paddybyers","date":"2013-02-04T21:26:45.031Z","type":"join"}
{"nick":"piscisaureus_","message":"trevnorris: have you tried reverting v8 to 3.11.10?","date":"2013-02-04T21:27:25.893Z","type":"message"}
{"nick":"trevnorris","message":"piscisaureus_: there are api changes that I don't know how to fix.","date":"2013-02-04T21:27:38.131Z","type":"message"}
{"nick":"piscisaureus_","message":"trevnorris: just revert those changes too :)","date":"2013-02-04T21:27:54.143Z","type":"message"}
{"nick":"trevnorris","message":"ok, i'll give that a shot. thanks.","date":"2013-02-04T21:28:46.384Z","type":"message"}
{"nick":"trevnorris","message":"CoverSlide: problem is so far haven't found any one commit that's caused a big issue. seems to have been slowly declining.","date":"2013-02-04T21:29:10.150Z","type":"message"}
{"nick":"perezd","reason":"Quit: perezd","date":"2013-02-04T21:29:31.735Z","type":"quit"}
{"nick":"perezd","date":"2013-02-04T21:30:20.582Z","type":"join"}
{"nick":"wolfeida_","reason":"Remote host closed the connection","date":"2013-02-04T21:30:47.058Z","type":"quit"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2013-02-04T21:31:37.138Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-04T21:32:13.061Z","type":"join"}
{"nick":"TheJH","date":"2013-02-04T21:35:31.060Z","type":"join"}
{"nick":"jmar777","reason":"Ping timeout: 256 seconds","date":"2013-02-04T21:36:44.355Z","type":"quit"}
{"nick":"trevnorris","message":"isaacs: using tcp_wrap, what happens if you call handle.writeBuffer() several times in a row and pass a noop to oncomplete?","date":"2013-02-04T21:39:03.407Z","type":"message"}
{"nick":"piscisaureus_","message":"trevnorris: isaacsl: is that regression with buffers btw?","date":"2013-02-04T21:39:48.144Z","type":"message"}
{"nick":"piscisaureus_","message":"or strings?","date":"2013-02-04T21:39:57.485Z","type":"message"}
{"nick":"piscisaureus_","message":"* isaacs","date":"2013-02-04T21:40:01.019Z","type":"message"}
{"nick":"trevnorris","message":"piscisaureus_: how would it be w/ buffers? every benchmark I've written has shown buffer allocation and operations are faster.","date":"2013-02-04T21:40:46.630Z","type":"message"}
{"nick":"piscisaureus_","message":"trevnorris: that's not what I meant","date":"2013-02-04T21:41:11.593Z","type":"message"}
{"nick":"piscisaureus_","message":"trevnorris: v8 may have killed an optimization we do in write_wrap w/ strings","date":"2013-02-04T21:41:23.791Z","type":"message"}
{"nick":"piscisaureus_","message":"(namely the one that relies on v8::String::HasOnlyAsciiChars)","date":"2013-02-04T21:41:40.114Z","type":"message"}
{"nick":"trevnorris","message":"ah, interesting. don't know if this is related, but grabbing byteLength of a utf8 string takes for freakin ever.","date":"2013-02-04T21:42:14.830Z","type":"message"}
{"nick":"felixge","reason":"Read error: Connection reset by peer","date":"2013-02-04T21:42:53.141Z","type":"quit"}
{"nick":"paddybyers","reason":"Ping timeout: 244 seconds","date":"2013-02-04T21:43:03.063Z","type":"quit"}
{"nick":"felixge","date":"2013-02-04T21:43:37.236Z","type":"join"}
{"nick":"felixge","reason":"Changing host","date":"2013-02-04T21:43:37.236Z","type":"quit"}
{"nick":"felixge","date":"2013-02-04T21:43:37.236Z","type":"join"}
{"nick":"trevnorris","message":"piscisaureus_: hm. I don't see HasOnlyAsciiChars in the docs or the includes?","date":"2013-02-04T21:44:13.923Z","type":"message"}
{"nick":"trevnorris","message":"I see MayContainNonAscii","date":"2013-02-04T21:45:09.964Z","type":"message"}
{"nick":"piscisaureus_","message":"trevnorris: ah yes, the final API was \"inverted\" -> https://github.com/joyent/node/blob/master/deps/v8/include/v8.h#L1086","date":"2013-02-04T21:45:30.929Z","type":"message"}
{"nick":"trevnorris","message":"interesting.","date":"2013-02-04T21:46:10.958Z","type":"message"}
{"nick":"wolfeidau","date":"2013-02-04T21:50:11.783Z","type":"join"}
{"nick":"felixge","reason":"Quit: felixge","date":"2013-02-04T21:50:21.069Z","type":"quit"}
{"nick":"rendar","date":"2013-02-04T21:55:30.989Z","type":"quit"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-04T21:59:42.460Z","type":"quit"}
{"nick":"piscisaureus_","message":"i feel somewhat bad about the substack joke i made in my dotjs preso","date":"2013-02-04T22:07:50.347Z","type":"message"}
{"nick":"perezd","reason":"Quit: perezd","date":"2013-02-04T22:07:55.199Z","type":"quit"}
{"nick":"TooTallNate","message":"piscisaureus_: what was it?","date":"2013-02-04T22:08:21.861Z","type":"message"}
{"nick":"perezd","date":"2013-02-04T22:10:14.454Z","type":"join"}
{"nick":"piscisaureus_","message":"i dont really remember where. I would look it up for you if i could stand watching myself.","date":"2013-02-04T22:10:23.066Z","type":"message"}
{"nick":"`3rdEden","reason":"Remote host closed the connection","date":"2013-02-04T22:12:00.008Z","type":"quit"}
{"nick":"perezd","reason":"Client Quit","date":"2013-02-04T22:13:27.215Z","type":"quit"}
{"nick":"bnoordhuis","message":"piscisaureus_: but what was the joke?","date":"2013-02-04T22:13:57.416Z","type":"message"}
{"nick":"piscisaureus_","message":"iirc: \"So here's a small and totally pointless module. Like, something that substack could write.\"","date":"2013-02-04T22:14:37.100Z","type":"message"}
{"nick":"perezd","date":"2013-02-04T22:14:42.894Z","type":"join"}
{"nick":"TooTallNate","message":"piscisaureus_: woah, cool venue!","date":"2013-02-04T22:14:59.153Z","type":"message"}
{"nick":"piscisaureus_","message":"yes, that was great","date":"2013-02-04T22:15:27.093Z","type":"message"}
{"nick":"paddybyers","date":"2013-02-04T22:15:40.948Z","type":"join"}
{"nick":"Benvie","date":"2013-02-04T22:17:45.386Z","type":"quit"}
{"nick":"hz","reason":"Ping timeout: 264 seconds","date":"2013-02-04T22:18:48.452Z","type":"quit"}
{"nick":"hz","date":"2013-02-04T22:24:33.441Z","type":"join"}
{"nick":"isaacs","message":"piscisaureus_: the regressions are less bad with strings.","date":"2013-02-04T22:25:45.040Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: i watched half of your talk before yoga class.  i'll watch the rest this afternoon.  good stuff.  it's nice to see someone else talking about domains and streams2 :)","date":"2013-02-04T22:26:26.720Z","type":"message"}
{"nick":"trevnorris","message":"link? i'm just waiting for a bunch of benchmarks to run.","date":"2013-02-04T22:27:11.246Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: thanks. I actually did it because I didn't know what to tell. Obviously I like to speak about stuff I worked on myself and this was all your work :-)","date":"2013-02-04T22:27:17.128Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: but thanks for giving me something to talk about :-)","date":"2013-02-04T22:27:25.399Z","type":"message"}
{"nick":"TooTallNate","message":"http://www.youtube.com/watch?feature=player_detailpage&v=tgTniHwGPuM#t=796s","date":"2013-02-04T22:29:34.331Z","type":"message"}
{"nick":"TooTallNate","message":"^ found it","date":"2013-02-04T22:29:35.615Z","type":"message"}
{"nick":"piscisaureus_","message":"ouch","date":"2013-02-04T22:31:14.258Z","type":"message"}
{"nick":"piscisaureus_","message":"yes, that","date":"2013-02-04T22:31:17.790Z","type":"message"}
{"nick":"piscisaureus_","message":"I will just hope that nobody tells him ;-p","date":"2013-02-04T22:31:29.580Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: he'd probably be the first to agree that he writes little useless modules sometimes :)","date":"2013-02-04T22:32:03.467Z","type":"message"}
{"nick":"piscisaureus_","message":"iphew","date":"2013-02-04T22:32:14.934Z","type":"message"}
{"nick":"piscisaureus_","message":"Ok. I'm almost dying and going to sleep.","date":"2013-02-04T22:32:29.408Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: welterusten en tot morgen.","date":"2013-02-04T22:32:37.170Z","type":"message"}
{"nick":"piscisaureus_","message":"euh","date":"2013-02-04T22:32:49.564Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: ik bedoel: fijne dag nog verder","date":"2013-02-04T22:33:00.060Z","type":"message"}
{"nick":"TheJH","reason":"Ping timeout: 245 seconds","date":"2013-02-04T22:33:21.839Z","type":"quit"}
{"nick":"isaacs","message":"piscisaureus_: i dont' actually know dutch, you know :)","date":"2013-02-04T22:34:49.355Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: too bad. I actually don't know javascript. It doesn't matter.","date":"2013-02-04T22:35:13.659Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: whatever.  javascript is like dutch.  if you know any english/c, you probably can muddle through most of it.","date":"2013-02-04T22:35:45.885Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: you know if there's a way to make sure a child process doesn't get zombified?","date":"2013-02-04T22:40:14.799Z","type":"message"}
{"nick":"CoverSlide","message":"headshot?","date":"2013-02-04T22:40:48.144Z","type":"message"}
{"nick":"CoverSlide","message":"oh","date":"2013-02-04T22:40:53.000Z","type":"message"}
{"nick":"CoverSlide","message":":p","date":"2013-02-04T22:40:57.546Z","type":"message"}
{"nick":"`3rdEden","date":"2013-02-04T22:42:29.502Z","type":"join"}
{"nick":"trevnorris","message":"CoverSlide: if only it was that easy.","date":"2013-02-04T22:42:40.015Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: they should not be zombified by default.","date":"2013-02-04T22:45:17.698Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: unless you spawn with { detached: true }","date":"2013-02-04T22:45:26.150Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: that's what I figured, but seems to act up sometimes. it's nothing big though","date":"2013-02-04T22:45:59.044Z","type":"message"}
{"nick":"mmalecki","message":"each uv_write should be given a different uv_write_t, correct?","date":"2013-02-04T22:47:24.646Z","type":"message"}
{"nick":"piscisaureus_","message":"goodbye","date":"2013-02-04T22:48:05.789Z","type":"message"}
{"nick":"piscisaureus_","reason":"Quit: ~ Trillian Astra - www.trillian.im ~","date":"2013-02-04T22:48:08.372Z","type":"quit"}
{"nick":"isaacs","message":"trevnorris: you can make a last-ditch effort to child.kill('KILL') on process.on('exit')","date":"2013-02-04T22:49:22.613Z","type":"message"}
{"nick":"Benvie","date":"2013-02-04T22:49:37.881Z","type":"join"}
{"nick":"`3rdEden","reason":"Ping timeout: 248 seconds","date":"2013-02-04T22:50:44.027Z","type":"quit"}
{"nick":"trevnorris","message":"isaacs: my brain is going to explode. so i'm experimenting with changes to the benchmarks by spawning off either the client or the server depending on the test.","date":"2013-02-04T22:52:00.400Z","type":"message"}
{"nick":"trevnorris","message":"and the numbers are ridiculous. one sec and i'll get them.","date":"2013-02-04T22:52:30.603Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: well, i'd expect ahuge bump if you did that, since now you're not sharing a CPU","date":"2013-02-04T22:53:08.260Z","type":"message"}
{"nick":"qmx|away","new_nick":"qmx","date":"2013-02-04T22:53:10.408Z","type":"nick"}
{"nick":"qmx","reason":"Excess Flood","date":"2013-02-04T22:53:30.142Z","type":"quit"}
{"nick":"isaacs","message":"trevnorris: so you'll have 2 CPUs at 100%, instead of 1","date":"2013-02-04T22:53:30.280Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: and there is, but not how i'd like.","date":"2013-02-04T22:53:40.526Z","type":"message"}
{"nick":"isaacs","message":"ok","date":"2013-02-04T22:53:50.890Z","type":"message"}
{"nick":"qmx","date":"2013-02-04T22:53:55.955Z","type":"join"}
{"nick":"Ralt","reason":"Remote host closed the connection","date":"2013-02-04T22:54:30.808Z","type":"quit"}
{"nick":"trevnorris","message":"isaacs: https://gist.github.com/b25221576277c907d1a9","date":"2013-02-04T22:55:25.813Z","type":"message"}
{"nick":"trevnorris","message":"so comparing the raw tests shows that master is behind v0.8 ouside of js land","date":"2013-02-04T22:55:45.351Z","type":"message"}
{"nick":"trevnorris","message":"and then from raw to net2 shows another large drop","date":"2013-02-04T22:55:58.042Z","type":"message"}
{"nick":"trevnorris","message":"so there are regressions on two fronts.","date":"2013-02-04T22:56:05.960Z","type":"message"}
{"nick":"isaacs","message":"yessir.","date":"2013-02-04T22:56:29.038Z","type":"message"}
{"nick":"isaacs","message":"i'm interested in the lower-level ones first.","date":"2013-02-04T22:56:35.838Z","type":"message"}
{"nick":"isaacs","message":"since that can exaccerbate higher-level regressions, as a general rule of thubm","date":"2013-02-04T22:56:49.868Z","type":"message"}
{"nick":"trevnorris","message":"me too. i'd like to see the raw tests come closer.","date":"2013-02-04T22:56:57.632Z","type":"message"}
{"nick":"trevnorris","message":"but i'm not sure where to start looking for that.","date":"2013-02-04T22:57:03.361Z","type":"message"}
{"nick":"isaacs","message":"so, here's what i'll do: i'm gonna do another \"run the tests on every commit\" kind of graph","date":"2013-02-04T22:57:06.918Z","type":"message"}
{"nick":"isaacs","message":"but with raw-c2s","date":"2013-02-04T22:57:14.798Z","type":"message"}
{"nick":"isaacs","message":"and see where it slips","date":"2013-02-04T22:57:30.217Z","type":"message"}
{"nick":"trevnorris","message":"already did, twice. all the way back to v0.9.0. couldn't see a serious drop in raw tests.","date":"2013-02-04T22:58:15.469Z","type":"message"}
{"nick":"trevnorris","message":"i'll run them again to make sure, but couldn't see anything.","date":"2013-02-04T22:58:28.373Z","type":"message"}
{"nick":"isaacs","message":"k","date":"2013-02-04T22:58:50.397Z","type":"message"}
{"nick":"isaacs","message":"so you're saying that 0.9.0 is on par with master?","date":"2013-02-04T22:59:04.266Z","type":"message"}
{"nick":"isaacs","message":"0.9.0 is almost identical to 0.8.0","date":"2013-02-04T22:59:19.576Z","type":"message"}
{"nick":"trevnorris","message":"as far as the raw tests go, yeah. let me run that again to make sure.","date":"2013-02-04T22:59:21.115Z","type":"message"}
{"nick":"TooTallNate","message":"this is… good news!","date":"2013-02-04T22:59:33.270Z","type":"message"}
{"nick":"isaacs","message":"this script is in your benchmark-refactor branch?","date":"2013-02-04T22:59:37.636Z","type":"message"}
{"nick":"perezd","reason":"Quit: perezd","date":"2013-02-04T22:59:38.879Z","type":"quit"}
{"nick":"trevnorris","message":"no. i just created it. updated the last gist with it.","date":"2013-02-04T23:00:20.048Z","type":"message"}
{"nick":"isaacs","message":"awesome","date":"2013-02-04T23:00:24.526Z","type":"message"}
{"nick":"isaacs","message":"so, this is going back just using HEAD~40","date":"2013-02-04T23:01:18.945Z","type":"message"}
{"nick":"perezd","date":"2013-02-04T23:01:34.520Z","type":"join"}
{"nick":"isaacs","message":"for my tests, i did git log --first-parent to walk back over the master commits only","date":"2013-02-04T23:02:48.104Z","type":"message"}
{"nick":"isaacs","message":"and then another that just walked back over release comits","date":"2013-02-04T23:03:00.504Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: no. it's going back 10 commits at a time, 40 times.","date":"2013-02-04T23:03:00.629Z","type":"message"}
{"nick":"isaacs","message":"oh, right","date":"2013-02-04T23:03:04.664Z","type":"message"}
{"nick":"isaacs","message":"that's what i meant","date":"2013-02-04T23:03:06.614Z","type":"message"}
{"nick":"isaacs","message":"how does HEAD~10 handle merge commits?","date":"2013-02-04T23:03:18.864Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2013-02-04T23:04:19.633Z","type":"quit"}
{"nick":"trevnorris","message":"goes along the main branch, so always stays on master","date":"2013-02-04T23:04:35.986Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: check the gist again.","date":"2013-02-04T23:04:42.340Z","type":"message"}
{"nick":"trevnorris","message":"just ran the new spawn net tests against master an v0.9.0","date":"2013-02-04T23:04:53.907Z","type":"message"}
{"nick":"perezd","reason":"Client Quit","date":"2013-02-04T23:04:57.332Z","type":"quit"}
{"nick":"trevnorris","message":"you'll see the raw tests are almost exactly the same","date":"2013-02-04T23:05:02.150Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: neat","date":"2013-02-04T23:05:20.913Z","type":"message"}
{"nick":"isaacs","message":"ok","date":"2013-02-04T23:05:21.873Z","type":"message"}
{"nick":"isaacs","message":"well, v0.9.0 is consistently a bit faster.","date":"2013-02-04T23:05:56.552Z","type":"message"}
{"nick":"isaacs","message":"but just a bit","date":"2013-02-04T23:06:04.233Z","type":"message"}
{"nick":"isaacs","message":"you're right, that's not enough to explain it","date":"2013-02-04T23:06:15.512Z","type":"message"}
{"nick":"isaacs","message":"ok, i gotta go to a different cafe, and then i'll throw some cloudy machine power at this :)","date":"2013-02-04T23:06:42.952Z","type":"message"}
{"nick":"isaacs","message":"back in a bit :)","date":"2013-02-04T23:06:48.992Z","type":"message"}
{"nick":"trevnorris","message":"kk. going to keep stepping back in time.","date":"2013-02-04T23:07:22.439Z","type":"message"}
{"nick":"qmx","new_nick":"qmx|away","date":"2013-02-04T23:08:57.020Z","type":"nick"}
{"nick":"trevnorris","message":"isaacs: ok, disregard those numbers. the first child process didn't die for some reason. so all other tests were connecting to it.","date":"2013-02-04T23:16:10.498Z","type":"message"}
{"nick":"TooTallNate","message":"benchmarks are hard :\\","date":"2013-02-04T23:17:20.063Z","type":"message"}
{"nick":"trevnorris","message":"seriously. being able to control the same variables every time can be a challenge.","date":"2013-02-04T23:18:32.998Z","type":"message"}
{"nick":"hz","reason":"Disconnected by services","date":"2013-02-04T23:20:19.944Z","type":"quit"}
{"nick":"hz","date":"2013-02-04T23:20:23.649Z","type":"join"}
{"nick":"ArmyOfBruce","reason":"Ping timeout: 260 seconds","date":"2013-02-04T23:20:55.557Z","type":"quit"}
{"nick":"brucem","reason":"Quit: ZNC - http://znc.sourceforge.net","date":"2013-02-04T23:22:06.395Z","type":"quit"}
{"nick":"brucem","date":"2013-02-04T23:23:07.270Z","type":"join"}
{"nick":"indutny","message":"isaacs: yt?","date":"2013-02-04T23:30:15.592Z","type":"message"}
{"nick":"indutny","message":"isaacs: what happens when ._read() returns more data then it was requested to return? :)","date":"2013-02-04T23:30:28.222Z","type":"message"}
{"nick":"TooTallNate","message":"indutny: i believe that's fine","date":"2013-02-04T23:30:45.151Z","type":"message"}
{"nick":"TooTallNate","message":"indutny: at least, returning *less* than requested I know is fune","date":"2013-02-04T23:30:55.605Z","type":"message"}
{"nick":"TooTallNate","message":"fine","date":"2013-02-04T23:30:56.421Z","type":"message"}
{"nick":"TooTallNate","message":"not positive about the opposite :p","date":"2013-02-04T23:31:05.483Z","type":"message"}
{"nick":"indutny","message":"yeah","date":"2013-02-04T23:31:11.089Z","type":"message"}
{"nick":"indutny","message":"seems to be the same","date":"2013-02-04T23:31:14.860Z","type":"message"}
{"nick":"indutny","message":"ok, I'm still investigating what happens there :)","date":"2013-02-04T23:31:25.557Z","type":"message"}
{"nick":"mmalecki","message":"imo it should buffer","date":"2013-02-04T23:33:04.933Z","type":"message"}
{"nick":"TooTallNate","message":"mmalecki: well ya, that's what it would do until you .read() out the bytes","date":"2013-02-04T23:33:21.446Z","type":"message"}
{"nick":"trevnorris","message":"indutny: one i'll hit frequently is system noise. when I run benchmarks, have to make sure as little is running in the background as possible.","date":"2013-02-04T23:35:39.026Z","type":"message"}
{"nick":"indutny","message":"trevnorris: huh?","date":"2013-02-04T23:35:57.137Z","type":"message"}
{"nick":"trevnorris","message":"for example, you can see as large as 10% variance in the tcp tests between two runs.","date":"2013-02-04T23:36:20.622Z","type":"message"}
{"nick":"indutny","message":"yes, that's fine","date":"2013-02-04T23:36:58.407Z","type":"message"}
{"nick":"indutny","message":"you need to account deviation","date":"2013-02-04T23:37:06.562Z","type":"message"}
{"nick":"indutny","message":"its pretty statistical thing anyway","date":"2013-02-04T23:37:20.497Z","type":"message"}
{"nick":"indutny","message":"either do N runs","date":"2013-02-04T23:37:26.452Z","type":"message"}
{"nick":"indutny","message":"or run it for N times longer time","date":"2013-02-04T23:37:35.234Z","type":"message"}
{"nick":"indutny","message":"until it'll be the same between runs","date":"2013-02-04T23:37:49.972Z","type":"message"}
{"nick":"indutny","message":"or just account deviation","date":"2013-02-04T23:37:57.354Z","type":"message"}
{"nick":"trevnorris","message":"indutny: yeah. more tests you run you get a tighter confidence interval, but usually your stdev will grow.","date":"2013-02-04T23:41:17.717Z","type":"message"}
{"nick":"trevnorris","message":"but the distribution of the spread can let you know if the tests is correctly performed.","date":"2013-02-04T23:41:46.457Z","type":"message"}
{"nick":"trevnorris","message":"so a quick reference would be a comparison between median and mean.","date":"2013-02-04T23:42:41.065Z","type":"message"}
{"nick":"trevnorris","message":"if they're far off, then your spread is likely crap. but you also need to take into account a tight spread with a long tail.","date":"2013-02-04T23:43:11.406Z","type":"message"}
{"nick":"trevnorris","message":"spread == distribution","date":"2013-02-04T23:43:34.658Z","type":"message"}
{"nick":"trevnorris","message":"but you could also use the quartiles at 25, 50 and 75 to give you a better picture.","date":"2013-02-04T23:45:08.185Z","type":"message"}
{"nick":"trevnorris","message":"(have some experience with this ;-)","date":"2013-02-04T23:45:13.606Z","type":"message"}
{"nick":"AvianFlu","reason":"Remote host closed the connection","date":"2013-02-04T23:47:30.771Z","type":"quit"}
{"nick":"qmx|away","reason":"Ping timeout: 248 seconds","date":"2013-02-04T23:49:55.940Z","type":"quit"}
{"nick":"isaacs","message":"indutny: it's fine","date":"2013-02-04T23:50:59.165Z","type":"message"}
{"nick":"isaacs","message":"indutny: the size arg to _read() is advisory","date":"2013-02-04T23:51:14.635Z","type":"message"}
{"nick":"isaacs","message":"indutny: you can return anything or nothign","date":"2013-02-04T23:51:19.029Z","type":"message"}
{"nick":"isaacs","message":"indutny: the size argument to read() is a contract.","date":"2013-02-04T23:51:36.759Z","type":"message"}
{"nick":"indutny","message":"ok","date":"2013-02-04T23:52:41.332Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: re: system noise, yes, that is a problem.  that's why i prefer to run benchmarks on joyent public cloud machines, rather than my own laptop","date":"2013-02-04T23:53:23.534Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: or, at least, run them in close proximity, without touching anything","date":"2013-02-04T23:53:44.983Z","type":"message"}
{"nick":"indutny","message":"shit","date":"2013-02-04T23:53:55.525Z","type":"message"}
{"nick":"indutny","message":"this watermarks shit is so borked","date":"2013-02-04T23:54:00.184Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: is it you're own vm, or is it shared resources?","date":"2013-02-04T23:54:03.736Z","type":"message"}
{"nick":"indutny","message":"calling .read(0) won't always work because of it","date":"2013-02-04T23:54:09.969Z","type":"message"}
{"nick":"indutny","message":"and after calling cb(null, '')","date":"2013-02-04T23:54:17.217Z","type":"message"}
{"nick":"qmx|away","date":"2013-02-04T23:54:22.416Z","type":"join"}
{"nick":"indutny","message":"I need it to invoke ._read","date":"2013-02-04T23:54:24.402Z","type":"message"}
{"nick":"indutny","message":"isaacs: what do you think about adding `n=== 0 || ...` to this line https://github.com/joyent/node/blob/master/lib/_stream_readable.js#L201 ?","date":"2013-02-04T23:55:45.964Z","type":"message"}
{"nick":"indutny","message":"or should I just make highWatermark infinity?","date":"2013-02-04T23:56:09.156Z","type":"message"}
{"nick":"indutny","message":"in my stream","date":"2013-02-04T23:56:20.418Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: got it: https://gist.github.com/b25221576277c907d1a9","date":"2013-02-04T23:56:47.831Z","type":"message"}
{"nick":"trevnorris","message":"those are the key points when raw tests regressed.","date":"2013-02-04T23:56:59.758Z","type":"message"}
{"nick":"indutny","message":"oh, I can't make high watermark infinite","date":"2013-02-04T23:57:22.535Z","type":"message"}
{"nick":"indutny","message":"shit","date":"2013-02-04T23:57:23.186Z","type":"message"}
{"nick":"c4milo","date":"2013-02-04T23:57:29.076Z","type":"join"}
