{"nick":"ircretary","reason":"Remote host closed the connection","date":"2013-02-20T00:00:01.584Z","type":"quit"}
{"nick":"ircretary","date":"2013-02-20T00:00:08.597Z","type":"join"}
{"nick":"isaacs","message":"trevnorris: hm.  another case where it just cannot possibly be the issue.","date":"2013-02-20T00:06:11.110Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: i think bisect is not going to give us the answer here.","date":"2013-02-20T00:06:19.850Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: and i'm growing suspicious of your disk encryption.","date":"2013-02-20T00:06:27.190Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: just because it's an added variable.","date":"2013-02-20T00:06:37.839Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: yeah. just wonder how I can solidify that's the issue.","date":"2013-02-20T00:07:36.083Z","type":"message"}
{"nick":"isaacs","message":"i'm not sure","date":"2013-02-20T00:07:43.972Z","type":"message"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-20T00:17:22.820Z","type":"quit"}
{"nick":"mikeal","date":"2013-02-20T00:22:39.567Z","type":"join"}
{"nick":"trevnorris","message":"isaacs: know what the --gdb option is for ./configure?","date":"2013-02-20T00:23:59.313Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: nope","date":"2013-02-20T00:24:21.791Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: that's for the gdbjit stuff","date":"2013-02-20T00:26:04.582Z","type":"message"}
{"nick":"tjfontaine","message":"iirc","date":"2013-02-20T00:26:06.062Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: cool. i'm working on that make-sure-all-statistical-analysis-is-working-properly.js script.","date":"2013-02-20T00:26:09.958Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: hahah","date":"2013-02-20T00:26:19.958Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: cool. i'm going to try that out.","date":"2013-02-20T00:26:25.124Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: nice filename","date":"2013-02-20T00:26:29.937Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: I'm not sure what you expect to glean with it","date":"2013-02-20T00:26:34.377Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: i'm sure the other committers will all love it","date":"2013-02-20T00:26:34.996Z","type":"message"}
{"nick":"trevnorris","message":"=)","date":"2013-02-20T00:26:36.010Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: you might try adding -O0 or -g to CFLAGS to see if that will make it easier for you to debug","date":"2013-02-20T00:27:03.040Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: no idea, just feeling around in the dark at this point.","date":"2013-02-20T00:27:10.185Z","type":"message"}
{"nick":"trevnorris","message":"ok, i'll try that.","date":"2013-02-20T00:27:12.645Z","type":"message"}
{"nick":"tjfontaine","message":"(CFLAGS and CXXFLAGS I guess)","date":"2013-02-20T00:27:12.831Z","type":"message"}
{"nick":"tjfontaine","message":"I mean, gdbjit is probably not related to what you want at all","date":"2013-02-20T00:27:28.086Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: docs say it doesn't compact when jit. no idea what that means really.","date":"2013-02-20T00:28:04.788Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: well it's http://code.google.com/p/v8/wiki/GDBJITInterface","date":"2013-02-20T00:29:20.744Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: hm. i'm able to reproduce the error with flags like --prof. would that information help?","date":"2013-02-20T00:31:16.263Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: well, people won't wonder what that file is for. ;-)","date":"2013-02-20T00:31:30.228Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: er, I'm not sure","date":"2013-02-20T00:35:04.328Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: well. most that has told me is it's definitely when trying to open the write stream. bugger.","date":"2013-02-20T00:35:45.614Z","type":"message"}
{"nick":"trevnorris","message":"thanks for all the help btw.","date":"2013-02-20T00:35:50.997Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: for shits and giggles is it possible for you to try without luks in the mix?","date":"2013-02-20T00:36:32.737Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: hm. it's full disk encryption. know if there would be a way to emulate that out? like use a vm or something? or maybe I can run from a usb.","date":"2013-02-20T00:37:33.414Z","type":"message"}
{"nick":"tjfontaine","message":"we don't want to emulate it out really, do you have a secondary drive you could stick in and run the build and benchmark from it?","date":"2013-02-20T00:38:01.505Z","type":"message"}
{"nick":"trevnorris","message":"ugh. using -O0 i can't reproduce it.","date":"2013-02-20T00:38:21.397Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: hm, not a full other drive. think a thumb stick would work?","date":"2013-02-20T00:43:19.815Z","type":"message"}
{"nick":"tjfontaine","message":"ugh maybe, but not really an apples to apples comparison","date":"2013-02-20T00:43:42.936Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: but you do you understand why I'm kinda wary of LUKS+FS bound benchmarks?","date":"2013-02-20T00:44:25.482Z","type":"message"}
{"nick":"trevnorris","message":"nope. this is all really new to me.","date":"2013-02-20T00:44:47.837Z","type":"message"}
{"nick":"trevnorris","message":"i've been programming for the browser for many years, and just started picking this stuff up in nov. to work on node.","date":"2013-02-20T00:45:10.257Z","type":"message"}
{"nick":"tjfontaine","message":"sure","date":"2013-02-20T00:46:13.231Z","type":"message"}
{"nick":"tjfontaine","message":"well you're going through 3 layers of indirection to get to your disk","date":"2013-02-20T00:47:31.876Z","type":"message"}
{"nick":"tjfontaine","message":"fs -> lvm -> luks -> disk","date":"2013-02-20T00:47:43.700Z","type":"message"}
{"nick":"tjfontaine","message":"I mean you're running them enough times that your data is useful, it's just probably not what I would consider finding the maximum throughput for your system :)","date":"2013-02-20T00:48:17.603Z","type":"message"}
{"nick":"trevnorris","message":"sorry, what do you mean by maximum throughput?","date":"2013-02-20T00:49:08.505Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: in terms of the number of gbits you push to/from the disk, you're adding 2 more layers of cpu time to the task","date":"2013-02-20T00:50:53.838Z","type":"message"}
{"nick":"TheJH","reason":"Ping timeout: 252 seconds","date":"2013-02-20T00:51:02.607Z","type":"quit"}
{"nick":"trevnorris","message":"tjfontaine: yeah, and i'm ok with that. what i'm wondering about is why the abort?","date":"2013-02-20T00:51:37.440Z","type":"message"}
{"nick":"EhevuTov","reason":"Quit: This computer has gone to sleep","date":"2013-02-20T00:51:49.341Z","type":"quit"}
{"nick":"trevnorris","message":"i mean, i'm placing the write stream and the pipe in setTimeout's to try and remove any race condition and it's still happening. but guess it's occurring at a lower level.","date":"2013-02-20T00:52:11.008Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: well, I dunno, but so far it's the only piece I've seen that might be adding to this race","date":"2013-02-20T00:52:21.766Z","type":"message"}
{"nick":"hz","date":"2013-02-20T00:56:53.262Z","type":"quit"}
{"nick":"trevnorris","message":"yeah. ugh. just don't want to see that failure occur half the time while running my tests.","date":"2013-02-20T00:57:16.480Z","type":"message"}
{"nick":"tjfontaine","message":"well, I don't want to lose the configuration either as it's helpful, would just be better if you could reproduce it with either less optimization or more debug information","date":"2013-02-20T00:58:26.400Z","type":"message"}
{"nick":"trevnorris","message":"yeah. that's what i'm trying to do now.","date":"2013-02-20T00:58:48.877Z","type":"message"}
{"nick":"isaacs","message":"ok, fuckit.  i'mma land this benchmark-2 thing.","date":"2013-02-20T00:59:29.064Z","type":"message"}
{"nick":"isaacs","message":"otherwise we'll just bikeshed it more.","date":"2013-02-20T00:59:33.419Z","type":"message"}
{"nick":"tjfontaine","message":"it builds, ship it","date":"2013-02-20T00:59:45.814Z","type":"message"}
{"nick":"trevnorris","message":"cool w/ me","date":"2013-02-20T01:00:08.880Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: ok, just noticed something. the abort always comes between a [New Thread ...] and a [Thread ... exited]. anything?","date":"2013-02-20T01:04:43.829Z","type":"message"}
{"nick":"trevnorris","message":"(and if this incessant questioning is driving you mad, let me know)","date":"2013-02-20T01:05:15.783Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: nah, it's my job now I think :) but I'm not sure that indicates much aside from reinforcing that this is happening from an FS operation (fs ops happen on the thread pool)","date":"2013-02-20T01:05:50.849Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: you might try lowering the max thread pool size and see if that makes it more reproducible I guess","date":"2013-02-20T01:06:35.982Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: how often are you hitting it now?","date":"2013-02-20T01:06:42.463Z","type":"message"}
{"nick":"trevnorris","message":"shows up 4 times. but always aborts on the first.","date":"2013-02-20T01:07:03.213Z","type":"message"}
{"nick":"trevnorris","message":"sorry, 5 times.","date":"2013-02-20T01:07:11.326Z","type":"message"}
{"nick":"tjfontaine","message":"I'm looking to see where the thread stuff is","date":"2013-02-20T01:08:11.886Z","type":"message"}
{"nick":"tjfontaine","message":"in deps/uv/src/unix/threadpool.c has a threads[4], you might try changing that to 2","date":"2013-02-20T01:10:17.502Z","type":"message"}
{"nick":"bradleymeck","date":"2013-02-20T01:11:59.874Z","type":"join"}
{"nick":"trevnorris","message":"tjfontaine: ok, just playing around. declared the fd as volatile and got this from the dump: $1 = 12","date":"2013-02-20T01:12:12.542Z","type":"message"}
{"nick":"tjfontaine","message":"are you able to get it to fail while you're in gdb?","date":"2013-02-20T01:12:32.098Z","type":"message"}
{"nick":"tjfontaine","message":"because we might be able to get some useful information with lsof or /proc ","date":"2013-02-20T01:12:53.194Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: yeah.","date":"2013-02-20T01:13:00.235Z","type":"message"}
{"nick":"tjfontaine","message":"but 12 seems like it should be a valid fd","date":"2013-02-20T01:13:04.097Z","type":"message"}
{"nick":"trevnorris","message":"it fails in gdb.","date":"2013-02-20T01:13:22.678Z","type":"message"}
{"nick":"tjfontaine","message":"or at least an fd I would expect","date":"2013-02-20T01:13:40.430Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: did ben have you add a breakpoint before the abort?","date":"2013-02-20T01:14:37.598Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: nope.","date":"2013-02-20T01:16:34.365Z","type":"message"}
{"nick":"tjfontaine","message":"so you were just doing post mortem after it died?","date":"2013-02-20T01:17:12.948Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: pretty much. just loading the core file.","date":"2013-02-20T01:17:27.889Z","type":"message"}
{"nick":"tjfontaine","message":"basically I would say `break deps/uv/src/unix/linux/linux-core.c:224`","date":"2013-02-20T01:17:47.106Z","type":"message"}
{"nick":"qmx|away","new_nick":"qmx","date":"2013-02-20T01:17:53.353Z","type":"nick"}
{"nick":"tjfontaine","message":"which should hold the process open before the abort happens","date":"2013-02-20T01:17:59.639Z","type":"message"}
{"nick":"tjfontaine","message":"then we could see what lsof has to say about that fd","date":"2013-02-20T01:18:25.010Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: cool. have to run, but i'm trying that later.","date":"2013-02-20T01:19:03.971Z","type":"message"}
{"nick":"tjfontaine","message":"enjoy","date":"2013-02-20T01:19:12.668Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: oh, and for some reason whenever it aborts I always get \"224     ../deps/uv/src/unix/linux/linux-core.c: No such file or directory.\"","date":"2013-02-20T01:19:14.373Z","type":"message"}
{"nick":"trevnorris","message":"that doesn't make sense to me.","date":"2013-02-20T01:19:24.672Z","type":"message"}
{"nick":"tjfontaine","message":"that's because of the way node is built","date":"2013-02-20T01:19:32.216Z","type":"message"}
{"nick":"tjfontaine","message":"just run gdb from one directory inside your checkout","date":"2013-02-20T01:19:43.488Z","type":"message"}
{"nick":"trevnorris","message":"ah, ok.","date":"2013-02-20T01:19:47.722Z","type":"message"}
{"nick":"tjfontaine","message":"such that ../ is a valid path","date":"2013-02-20T01:19:49.413Z","type":"message"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033isaacs\u000f \u00037master\u000f * \u0002f1780a6\u0002 : Merge branch 'benchmark-refactor-2' (+45 more commits) - http://git.io/faRHCw","date":"2013-02-20T01:20:10.870Z","type":"message"}
{"nick":"isaacs","message":"alright, benchmark-refactor-2 landing","date":"2013-02-20T01:20:11.219Z","type":"message"}
{"nick":"isaacs","message":"--no-ff so that we can remove if necessary, since it's many commits.","date":"2013-02-20T01:20:23.910Z","type":"message"}
{"nick":"isaacs","message":"but should be fine.","date":"2013-02-20T01:20:26.112Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: just ran the breakpoint and got this: p fd -> \"$1 = 17\"","date":"2013-02-20T01:20:31.546Z","type":"message"}
{"nick":"c4milo","date":"2013-02-20T01:20:50.118Z","type":"join"}
{"nick":"tjfontaine","message":"ok, and you should see the process id and then you can use lsof to see what it has to say about that fd","date":"2013-02-20T01:21:03.559Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: not sure what i'm looking for. so many entries: http://git.io/3VgGLA","date":"2013-02-20T01:23:57.958Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: thanks. i'll try to get that script to you tomorrow.","date":"2013-02-20T01:24:18.680Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: take your time.  and a nap.  srsly. ;)","date":"2013-02-20T01:24:32.787Z","type":"message"}
{"nick":"isaacs","message":"don't want you burning out :)","date":"2013-02-20T01:24:44.346Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: heh, thanks. =)","date":"2013-02-20T01:24:44.542Z","type":"message"}
{"nick":"isaacs","message":"there might be bugs in your code that i want you to fix ;)","date":"2013-02-20T01:24:52.541Z","type":"message"}
{"nick":"trevnorris","message":"heh, i'll keep that in mind.","date":"2013-02-20T01:26:00.395Z","type":"message"}
{"nick":"tjfontaine","message":"well, if fd is 17, it doesn't appear that that file is still open","date":"2013-02-20T01:26:47.369Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: oh, and bnoordhuis had me do: '$p (int) __errno_location()' -> '$2 = -134392128'","date":"2013-02-20T01:27:33.888Z","type":"message"}
{"nick":"trevnorris","message":"no idea what that's about, but eh.","date":"2013-02-20T01:27:39.988Z","type":"message"}
{"nick":"trevnorris","message":"ok, out for real.","date":"2013-02-20T01:27:52.512Z","type":"message"}
{"nick":"trevnorris","reason":"Quit: Leaving","date":"2013-02-20T01:27:53.317Z","type":"quit"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-20T01:30:28.592Z","type":"quit"}
{"nick":"Raynos","message":"mr isaacs!","date":"2013-02-20T01:33:07.667Z","type":"message"}
{"nick":"Raynos","message":"does _read always happen in the next tick after push() === false ?","date":"2013-02-20T01:33:07.802Z","type":"message"}
{"nick":"Raynos","message":"isaacs: given a Readable stream that is source, s and a Writable stream that is a destination, w.","date":"2013-02-20T01:35:36.920Z","type":"message"}
{"nick":"Raynos","message":"Let's say I pipe data from s to w and n minutes later unpipe w from s","date":"2013-02-20T01:35:49.091Z","type":"message"}
{"nick":"Raynos","message":"What happens to the data in s's internal buffer?","date":"2013-02-20T01:35:56.536Z","type":"message"}
{"nick":"Raynos","message":"When does that get GC'd? Is there any way to nuke that memory out of the buffer?","date":"2013-02-20T01:36:11.202Z","type":"message"}
{"nick":"sblom","reason":"Quit: Leaving.","date":"2013-02-20T01:36:12.829Z","type":"quit"}
{"nick":"isaacs","message":"Raynos: so, are you saying that there's data that was not written to w yet?","date":"2013-02-20T01:36:44.156Z","type":"message"}
{"nick":"abraxas","date":"2013-02-20T01:36:46.340Z","type":"join"}
{"nick":"Raynos","message":"yes","date":"2013-02-20T01:36:49.683Z","type":"message"}
{"nick":"isaacs","message":"Raynos: once it's read() out, it's out of s's purview","date":"2013-02-20T01:36:55.497Z","type":"message"}
{"nick":"Raynos","message":"i.e. the buffer is full upto the high watermark","date":"2013-02-20T01:36:55.908Z","type":"message"}
{"nick":"Raynos","message":"and w is drained mode","date":"2013-02-20T01:36:58.779Z","type":"message"}
{"nick":"isaacs","message":"Raynos: when s is gc'ed, so is s's buffer","date":"2013-02-20T01:37:04.879Z","type":"message"}
{"nick":"Raynos","message":"I mean","date":"2013-02-20T01:37:06.608Z","type":"message"}
{"nick":"Raynos","message":"in draining mode","date":"2013-02-20T01:37:08.130Z","type":"message"}
{"nick":"isaacs","message":"right","date":"2013-02-20T01:37:11.833Z","type":"message"}
{"nick":"isaacs","message":"hte data in s's buffer will not be gc'ed until s is gc'ed, or it's read() out","date":"2013-02-20T01:37:24.955Z","type":"message"}
{"nick":"Raynos","message":"should I be ocd about s not being able to be GC'd","date":"2013-02-20T01:37:29.394Z","type":"message"}
{"nick":"Raynos","message":"im finally fixing read-stream to not suck","date":"2013-02-20T01:38:07.202Z","type":"message"}
{"nick":"isaacs","message":"why would s not be gc'ed?","date":"2013-02-20T01:38:08.620Z","type":"message"}
{"nick":"isaacs","message":"Raynos: you should probably hang onto a reference to s just to make sure you can make sure that it gets GC'ed ;P","date":"2013-02-20T01:38:25.845Z","type":"message"}
{"nick":"Raynos","message":"something is currently causing my stream to not be gc'd and this array ( https://github.com/Raynos/read-stream/blob/master/lib/queue.js#L6 ) is leaking GB's of memory","date":"2013-02-20T01:38:37.445Z","type":"message"}
{"nick":"Raynos","message":"i'm starting to dislike layers / abstractions","date":"2013-02-20T01:39:24.795Z","type":"message"}
{"nick":"isaacs","message":"Raynos: yeah, i don't really have brainspace to analyze that right now","date":"2013-02-20T01:39:25.344Z","type":"message"}
{"nick":"isaacs","message":"but yeah, that's normal","date":"2013-02-20T01:39:30.694Z","type":"message"}
{"nick":"Raynos","message":"that's fine.","date":"2013-02-20T01:39:31.809Z","type":"message"}
{"nick":"isaacs","message":"probably you should just use streams2 or something :)","date":"2013-02-20T01:39:47.414Z","type":"message"}
{"nick":"Raynos","message":"im fixing my own bugs","date":"2013-02-20T01:39:47.697Z","type":"message"}
{"nick":"Raynos","message":"> does _read always happen in the next tick after push() === false ?","date":"2013-02-20T01:39:59.819Z","type":"message"}
{"nick":"isaacs","message":"Raynos: not necessarily","date":"2013-02-20T01:43:24.324Z","type":"message"}
{"nick":"isaacs","message":"Raynos: depends on when read() happens","date":"2013-02-20T01:43:29.081Z","type":"message"}
{"nick":"Raynos","message":"then ill do process.nextTick myself","date":"2013-02-20T01:43:35.212Z","type":"message"}
{"nick":"isaacs","message":"well, if you do push() (ret false) then read(), i'tll eventually call _read synchronously","date":"2013-02-20T01:43:56.761Z","type":"message"}
{"nick":"piscisaureus_","reason":"Quit: ~ Trillian Astra - www.trillian.im ~","date":"2013-02-20T02:00:09.330Z","type":"quit"}
{"nick":"pooya","reason":"Quit: pooya","date":"2013-02-20T02:06:58.220Z","type":"quit"}
{"nick":"Benvie","date":"2013-02-20T02:11:44.689Z","type":"quit"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2013-02-20T02:18:13.274Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-20T02:18:49.312Z","type":"join"}
{"nick":"jmar777","reason":"Ping timeout: 264 seconds","date":"2013-02-20T02:23:30.136Z","type":"quit"}
{"nick":"bradleymeck","reason":"Quit: bradleymeck","date":"2013-02-20T02:26:02.182Z","type":"quit"}
{"nick":"bradleymeck","date":"2013-02-20T02:29:54.687Z","type":"join"}
{"nick":"bradleymeck","reason":"Client Quit","date":"2013-02-20T02:31:04.941Z","type":"quit"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-20T02:34:19.605Z","type":"quit"}
{"nick":"bradleymeck","date":"2013-02-20T02:36:09.034Z","type":"join"}
{"nick":"bradleymeck","reason":"Quit: bradleymeck","date":"2013-02-20T02:43:07.505Z","type":"quit"}
{"nick":"bradleymeck","date":"2013-02-20T02:46:18.451Z","type":"join"}
{"nick":"bradleymeck","reason":"Client Quit","date":"2013-02-20T02:49:51.414Z","type":"quit"}
{"nick":"Benvie","date":"2013-02-20T02:57:07.330Z","type":"join"}
{"nick":"c4milo","date":"2013-02-20T03:00:09.166Z","type":"join"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-02-20T03:02:37.687Z","type":"quit"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-20T03:18:08.693Z","type":"quit"}
{"nick":"c4milo","date":"2013-02-20T03:24:20.024Z","type":"join"}
{"nick":"dap1","reason":"Quit: Leaving.","date":"2013-02-20T03:25:20.867Z","type":"quit"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-20T03:33:09.072Z","type":"quit"}
{"nick":"brson","reason":"Quit: leaving","date":"2013-02-20T03:43:34.601Z","type":"quit"}
{"nick":"kazupon","date":"2013-02-20T03:48:00.594Z","type":"join"}
{"nick":"qmx","new_nick":"qmx|away","date":"2013-02-20T03:48:08.462Z","type":"nick"}
{"nick":"c4milo","date":"2013-02-20T03:54:07.020Z","type":"join"}
{"nick":"TooTallNate","reason":"Quit: Computer has gone to sleep.","date":"2013-02-20T03:57:40.975Z","type":"quit"}
{"nick":"wolfeidau","reason":"Remote host closed the connection","date":"2013-02-20T04:09:42.398Z","type":"quit"}
{"nick":"c4milo","reason":"Ping timeout: 248 seconds","date":"2013-02-20T04:16:35.832Z","type":"quit"}
{"nick":"indexzero_","date":"2013-02-20T04:51:49.154Z","type":"join"}
{"nick":"c4milo","date":"2013-02-20T04:53:15.504Z","type":"join"}
{"nick":"indexzero","reason":"Ping timeout: 252 seconds","date":"2013-02-20T04:54:52.523Z","type":"quit"}
{"nick":"indexzero_","new_nick":"indexzero","date":"2013-02-20T04:54:53.110Z","type":"nick"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-20T04:56:23.503Z","type":"quit"}
{"nick":"TheJH","date":"2013-02-20T05:11:36.455Z","type":"join"}
{"nick":"TooTallNate","date":"2013-02-20T05:17:24.232Z","type":"join"}
{"nick":"TheJH","reason":"Ping timeout: 276 seconds","date":"2013-02-20T05:17:30.359Z","type":"quit"}
{"nick":"mikeal","date":"2013-02-20T05:18:55.962Z","type":"join"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2013-02-20T05:40:33.400Z","type":"quit"}
{"nick":"CoverSlide","reason":"Ping timeout: 252 seconds","date":"2013-02-20T05:46:12.562Z","type":"quit"}
{"nick":"TooTallNate","reason":"Quit: Computer has gone to sleep.","date":"2013-02-20T05:51:15.541Z","type":"quit"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-20T05:51:32.019Z","type":"quit"}
{"nick":"loladiro","date":"2013-02-20T05:54:50.547Z","type":"join"}
{"nick":"indexzero","date":"2013-02-20T06:05:50.550Z","type":"join"}
{"nick":"philips_","reason":"Excess Flood","date":"2013-02-20T06:14:12.886Z","type":"quit"}
{"nick":"philips_","date":"2013-02-20T06:15:31.356Z","type":"join"}
{"nick":"toothrot","reason":"Ping timeout: 260 seconds","date":"2013-02-20T06:19:11.475Z","type":"quit"}
{"nick":"mikeal","date":"2013-02-20T06:22:15.409Z","type":"join"}
{"nick":"stagas","date":"2013-02-20T06:25:23.048Z","type":"join"}
{"nick":"mikeal","reason":"Ping timeout: 252 seconds","date":"2013-02-20T06:32:45.255Z","type":"quit"}
{"nick":"mikeal","date":"2013-02-20T06:49:26.558Z","type":"join"}
{"nick":"toothr","date":"2013-02-20T06:59:33.146Z","type":"join"}
{"nick":"toothr","reason":"Ping timeout: 260 seconds","date":"2013-02-20T07:16:35.489Z","type":"quit"}
{"nick":"trevnorris","date":"2013-02-20T07:22:52.012Z","type":"join"}
{"nick":"toothr","date":"2013-02-20T07:27:03.109Z","type":"join"}
{"nick":"kazupon","reason":"Read error: Connection reset by peer","date":"2013-02-20T08:03:35.277Z","type":"quit"}
{"nick":"kazupon","date":"2013-02-20T08:04:06.254Z","type":"join"}
{"nick":"kazupon","reason":"Read error: Connection reset by peer","date":"2013-02-20T08:07:19.222Z","type":"quit"}
{"nick":"kazupon","date":"2013-02-20T08:07:39.282Z","type":"join"}
{"nick":"toothr","reason":"Ping timeout: 248 seconds","date":"2013-02-20T08:08:01.131Z","type":"quit"}
{"nick":"rendar","date":"2013-02-20T08:08:23.461Z","type":"join"}
{"nick":"toothr","date":"2013-02-20T08:18:03.215Z","type":"join"}
{"nick":"sgallagh","date":"2013-02-20T08:20:19.733Z","type":"join"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2013-02-20T08:20:35.460Z","type":"quit"}
{"nick":"`3rdEden","date":"2013-02-20T08:32:55.987Z","type":"join"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-02-20T08:42:48.388Z","type":"quit"}
{"nick":"benoitc","reason":"Excess Flood","date":"2013-02-20T08:54:52.398Z","type":"quit"}
{"nick":"loladiro","date":"2013-02-20T08:57:26.030Z","type":"join"}
{"nick":"benoitc","date":"2013-02-20T09:05:01.407Z","type":"join"}
{"nick":"trevnorris","message":"ircretary: tell bnoordhuis updated GH-4558 with more information about the epoll problem you were helping me with.","date":"2013-02-20T09:09:44.718Z","type":"message"}
{"nick":"ircretary","message":"trevnorris: I'll be sure to tell bnoordhuis","date":"2013-02-20T09:09:45.256Z","type":"message"}
{"nick":"trevnorris","reason":"Quit: Leaving","date":"2013-02-20T09:38:08.110Z","type":"quit"}
{"nick":"kazupon","reason":"Remote host closed the connection","date":"2013-02-20T09:38:41.693Z","type":"quit"}
{"nick":"kazupon","date":"2013-02-20T09:41:13.397Z","type":"join"}
{"nick":"kazupon","reason":"Remote host closed the connection","date":"2013-02-20T09:42:07.110Z","type":"quit"}
{"nick":"indutny","message":"morning","date":"2013-02-20T09:52:27.928Z","type":"message"}
{"nick":"qmx|away","new_nick":"qmx","date":"2013-02-20T09:58:55.705Z","type":"nick"}
{"nick":"sgallagh","reason":"Ping timeout: 255 seconds","date":"2013-02-20T10:23:29.543Z","type":"quit"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-02-20T10:26:00.176Z","type":"quit"}
{"nick":"abraxas","reason":"Remote host closed the connection","date":"2013-02-20T11:10:25.224Z","type":"quit"}
{"nick":"sgallagh","date":"2013-02-20T11:17:08.540Z","type":"join"}
{"nick":"AvianFlu","reason":"Ping timeout: 255 seconds","date":"2013-02-20T11:18:56.485Z","type":"quit"}
{"nick":"benoitc","reason":"Excess Flood","date":"2013-02-20T11:55:47.465Z","type":"quit"}
{"nick":"benoitc","date":"2013-02-20T12:05:02.621Z","type":"join"}
{"nick":"hz","date":"2013-02-20T12:42:27.434Z","type":"join"}
{"nick":"stagas_","date":"2013-02-20T12:46:55.709Z","type":"join"}
{"nick":"stagas__","date":"2013-02-20T12:48:26.756Z","type":"join"}
{"nick":"stagas","reason":"Ping timeout: 256 seconds","date":"2013-02-20T12:49:40.018Z","type":"quit"}
{"nick":"stagas_","reason":"Ping timeout: 256 seconds","date":"2013-02-20T12:51:29.177Z","type":"quit"}
{"nick":"stagas__","reason":"Ping timeout: 244 seconds","date":"2013-02-20T12:53:11.046Z","type":"quit"}
{"nick":"bnoordhuis","date":"2013-02-20T12:53:21.910Z","type":"join"}
{"nick":"perezd","reason":"Ping timeout: 252 seconds","date":"2013-02-20T12:54:27.226Z","type":"quit"}
{"nick":"benoitc","reason":"Excess Flood","date":"2013-02-20T12:58:51.343Z","type":"quit"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033Bert Belder\u000f \u00037master\u000f * \u0002eb29c4b\u0002 : openssl: disable HT sidechannel attack mitigation  It used to be off befo (+1 more commits) - http://git.io/GLRz7A","date":"2013-02-20T12:58:59.680Z","type":"message"}
{"nick":"benoitc","date":"2013-02-20T13:01:04.075Z","type":"join"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u00020dcbecd\u0002 : crypto: fix uninitialized memory access in openssl  ASN1_STRING_to_UTF8() (+1 more commits) - http://git.io/comvTQ","date":"2013-02-20T13:04:07.087Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: hoya","date":"2013-02-20T13:04:48.556Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: so I did experiment","date":"2013-02-20T13:04:52.428Z","type":"message"}
{"nick":"indutny","message":"and epoll is affected by thunder effect","date":"2013-02-20T13:05:01.845Z","type":"message"}
{"nick":"indutny","message":"that I was talking about yesterday","date":"2013-02-20T13:05:06.386Z","type":"message"}
{"nick":"indutny","message":"if you're not seeing it - it most definitely mean that connection was accepted before other forks has started epoll_wait","date":"2013-02-20T13:05:36.050Z","type":"message"}
{"nick":"bnoordhuis","message":"indutny: heya","date":"2013-02-20T13:06:01.826Z","type":"message"}
{"nick":"bnoordhuis","message":"how did you test it? (executive summary please)","date":"2013-02-20T13:06:10.846Z","type":"message"}
{"nick":"indutny","message":"I've patched my fork-accept repo","date":"2013-02-20T13:06:20.989Z","type":"message"}
{"nick":"indutny","message":"and added 2s sleep() before accept call","date":"2013-02-20T13:06:27.185Z","type":"message"}
{"nick":"indutny","message":"then I added logging before accept call","date":"2013-02-20T13:06:34.730Z","type":"message"}
{"nick":"indutny","message":"and did one connection with curl","date":"2013-02-20T13:06:41.745Z","type":"message"}
{"nick":"indutny","message":"all 24 forks were notified about it","date":"2013-02-20T13:06:46.540Z","type":"message"}
{"nick":"bnoordhuis","message":"ah, like that","date":"2013-02-20T13:06:48.509Z","type":"message"}
{"nick":"indutny","message":"and have tried to accept it","date":"2013-02-20T13:06:50.112Z","type":"message"}
{"nick":"bnoordhuis","message":"yes, that would trigger it","date":"2013-02-20T13:06:53.843Z","type":"message"}
{"nick":"indutny","message":"ok, that's what I call thunder effect :)","date":"2013-02-20T13:07:16.278Z","type":"message"}
{"nick":"indutny","message":"I was thinking about adding some sort of api","date":"2013-02-20T13:07:33.403Z","type":"message"}
{"nick":"bnoordhuis","message":"it mostly works okay in practice because one thread wakes up and consumes the events before the others do","date":"2013-02-20T13:07:36.008Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-20T13:07:40.138Z","type":"message"}
{"nick":"indutny","message":"I know","date":"2013-02-20T13:07:42.568Z","type":"message"}
{"nick":"indutny","message":"so API would allow developers to \"sort of\" run accept() in epoll_wait()","date":"2013-02-20T13:08:04.821Z","type":"message"}
{"nick":"perezd","date":"2013-02-20T13:08:23.686Z","type":"join"}
{"nick":"indutny","message":"i.e. epoll_wait() will report availability of listening socket only once per incoming connection","date":"2013-02-20T13:08:29.170Z","type":"message"}
{"nick":"indutny","message":"not to every fork","date":"2013-02-20T13:08:31.770Z","type":"message"}
{"nick":"indutny","message":"this should help us balancing requests between forks","date":"2013-02-20T13:08:54.650Z","type":"message"}
{"nick":"bnoordhuis","message":"eh? you mean it's oneshot?","date":"2013-02-20T13:08:56.281Z","type":"message"}
{"nick":"indutny","message":"yes, sort of","date":"2013-02-20T13:09:02.684Z","type":"message"}
{"nick":"indutny","message":"so its like not level-triggered","date":"2013-02-20T13:09:13.606Z","type":"message"}
{"nick":"indutny","message":"and not really edge-triggered","date":"2013-02-20T13:09:19.780Z","type":"message"}
{"nick":"indutny","message":"because it notifies only one listener of many","date":"2013-02-20T13:09:27.784Z","type":"message"}
{"nick":"indutny","message":"its like epoll_wait() should wait until backlog will be non-empty","date":"2013-02-20T13:10:00.725Z","type":"message"}
{"nick":"indutny","message":"lock, if it's > 0 then decrement it and interrupt, otherwise continue, unlock","date":"2013-02-20T13:10:23.927Z","type":"message"}
{"nick":"bnoordhuis","message":"i'm not sure i follow","date":"2013-02-20T13:10:37.882Z","type":"message"}
{"nick":"indutny","message":"in other words:","date":"2013-02-20T13:10:47.775Z","type":"message"}
{"nick":"indutny","message":"1. server fd has backlog (some integer value)","date":"2013-02-20T13:10:58.130Z","type":"message"}
{"nick":"indutny","message":"2. epoll_wait() should wait until it'll be greater than zero","date":"2013-02-20T13:11:20.591Z","type":"message"}
{"nick":"indutny","message":"3. decrement it and return to user","date":"2013-02-20T13:11:33.554Z","type":"message"}
{"nick":"bnoordhuis","message":"wait, you're talking about a kernel patch?","date":"2013-02-20T13:11:51.421Z","type":"message"}
{"nick":"indutny","message":"4. user should accept connection and run epoll_wait() again","date":"2013-02-20T13:11:54.670Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-20T13:11:54.805Z","type":"message"}
{"nick":"indutny","message":"not like I want to change default behaviour","date":"2013-02-20T13:12:02.797Z","type":"message"}
{"nick":"bnoordhuis","message":"hah okay, now it starts making sense","date":"2013-02-20T13:12:03.972Z","type":"message"}
{"nick":"indutny","message":"but it could be implemented under some flags","date":"2013-02-20T13:12:16.853Z","type":"message"}
{"nick":"indutny","message":"I think listen()/accept() model doesn't really fit into all existing polling conventions","date":"2013-02-20T13:12:40.491Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: what do you think?","date":"2013-02-20T13:14:05.459Z","type":"message"}
{"nick":"indutny","message":"I mean, it should be benchmarked and performance improvement should be verified","date":"2013-02-20T13:14:27.833Z","type":"message"}
{"nick":"indutny","message":"but if it's ok... is it a good API?","date":"2013-02-20T13:14:38.331Z","type":"message"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u000257ef659\u0002 : node: code cleanup, make tick_infobox static  It's not used outside of sr - http://git.io/b_CWrQ","date":"2013-02-20T13:15:43.749Z","type":"message"}
{"nick":"bnoordhuis","message":"i don't know, guess i'd have to see it first","date":"2013-02-20T13:15:50.738Z","type":"message"}
{"nick":"indutny","message":"haha","date":"2013-02-20T13:16:25.451Z","type":"message"}
{"nick":"indutny","message":"ok","date":"2013-02-20T13:16:27.231Z","type":"message"}
{"nick":"bnoordhuis","message":"i don't quite understand how the backlog makes it different from how it currently works","date":"2013-02-20T13:16:43.829Z","type":"message"}
{"nick":"bnoordhuis","message":"i mean, when epoll_wait wakes up, it's because there's a pending connection","date":"2013-02-20T13:16:54.976Z","type":"message"}
{"nick":"bnoordhuis","message":"i.e. that connection is in the backlog","date":"2013-02-20T13:17:10.419Z","type":"message"}
{"nick":"indutny","message":"well","date":"2013-02-20T13:17:15.100Z","type":"message"}
{"nick":"indutny","message":"imagine that backlog=1","date":"2013-02-20T13:17:21.929Z","type":"message"}
{"nick":"indutny","message":"and there're 24 threads waiting for epoll_wait() to return","date":"2013-02-20T13:17:29.665Z","type":"message"}
{"nick":"indutny","message":"in my implementation only one epoll_wait() will return","date":"2013-02-20T13:17:39.594Z","type":"message"}
{"nick":"indutny","message":"and all other won't see this event","date":"2013-02-20T13:17:44.945Z","type":"message"}
{"nick":"indutny","message":"and \"some internal\" epoll's backlog counter will be decremented","date":"2013-02-20T13:18:06.227Z","type":"message"}
{"nick":"bnoordhuis","message":"are you sure EPOLLONESHOT doesn't already do that?","date":"2013-02-20T13:18:42.633Z","type":"message"}
{"nick":"bnoordhuis","action":"checks kernel tree","date":"2013-02-20T13:18:56.997Z","type":"action"}
{"nick":"indutny","message":"hm...","date":"2013-02-20T13:19:09.939Z","type":"message"}
{"nick":"indutny","message":"probably yes","date":"2013-02-20T13:20:21.304Z","type":"message"}
{"nick":"bnoordhuis","message":"a quick glance at fs/eventpoll.c suggests it does","date":"2013-02-20T13:20:36.547Z","type":"message"}
{"nick":"indutny","message":"but not exactly similar to what I've in mind","date":"2013-02-20T13:20:37.036Z","type":"message"}
{"nick":"bnoordhuis","message":"what's the difference?","date":"2013-02-20T13:21:00.834Z","type":"message"}
{"nick":"indutny","message":"well, it should be re-armed now, isn't it?","date":"2013-02-20T13:21:25.211Z","type":"message"}
{"nick":"indutny","message":"and that means other listeners won't see any connections before it","date":"2013-02-20T13:21:37.090Z","type":"message"}
{"nick":"indutny","message":"which will definitely result in performance loss","date":"2013-02-20T13:21:45.035Z","type":"message"}
{"nick":"indutny","message":"oh, btw","date":"2013-02-20T13:21:50.081Z","type":"message"}
{"nick":"indutny","message":"I forgot to mention, I've tried calling blocking accept() in off-thread in libuv","date":"2013-02-20T13:22:09.690Z","type":"message"}
{"nick":"indutny","message":"and performance was awful","date":"2013-02-20T13:22:13.430Z","type":"message"}
{"nick":"indutny","message":"I suppose that was because of synchronization","date":"2013-02-20T13:22:20.544Z","type":"message"}
{"nick":"bnoordhuis","message":"did you profile it? :)","date":"2013-02-20T13:22:40.143Z","type":"message"}
{"nick":"indutny","message":"no, it wasn't really fully working","date":"2013-02-20T13:23:05.875Z","type":"message"}
{"nick":"indutny","message":"there were a lot of subtle problems with it","date":"2013-02-20T13:23:13.032Z","type":"message"}
{"nick":"indutny","message":"like closing socket","date":"2013-02-20T13:23:22.740Z","type":"message"}
{"nick":"indutny","message":"to fully implement it - uv_thread_cancel should be used","date":"2013-02-20T13:23:38.556Z","type":"message"}
{"nick":"indutny","message":"otherwise there're will be either races","date":"2013-02-20T13:23:47.445Z","type":"message"}
{"nick":"bnoordhuis","message":"hmm, seems registry.npmjs.org is down","date":"2013-02-20T13:23:52.649Z","type":"message"}
{"nick":"indutny","message":"or undefined behaviour","date":"2013-02-20T13:23:52.822Z","type":"message"}
{"nick":"indutny","message":"great","date":"2013-02-20T13:23:59.281Z","type":"message"}
{"nick":"indutny","message":"glad, I've a mirror for it","date":"2013-02-20T13:24:07.279Z","type":"message"}
{"nick":"bnoordhuis","message":"ah, thread cancellation - talk about brain damage","date":"2013-02-20T13:24:20.340Z","type":"message"}
{"nick":"indutny","message":"http://isaacs.iriscouch.com/_utils/","date":"2013-02-20T13:24:22.588Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: well, it should be quite safe here","date":"2013-02-20T13:24:30.578Z","type":"message"}
{"nick":"indutny","message":"it will just terminate accept() call","date":"2013-02-20T13:24:40.110Z","type":"message"}
{"nick":"bnoordhuis","message":"oh, no doubt. accept() is a cancellation point","date":"2013-02-20T13:24:48.266Z","type":"message"}
{"nick":"indutny","message":"heh","date":"2013-02-20T13:24:56.891Z","type":"message"}
{"nick":"indutny","message":"its rather complex thing","date":"2013-02-20T13:25:03.562Z","type":"message"}
{"nick":"indutny","message":"and I'm afraid trying to make it work is not worth it","date":"2013-02-20T13:25:11.054Z","type":"message"}
{"nick":"bnoordhuis","message":"still, almost all pthreads implementations have or have had bugs in their cancellation code","date":"2013-02-20T13:25:11.216Z","type":"message"}
{"nick":"indutny","message":"well, anyway","date":"2013-02-20T13:25:21.295Z","type":"message"}
{"nick":"indutny","message":"I'm not working with it anymore","date":"2013-02-20T13:25:35.497Z","type":"message"}
{"nick":"indutny","message":"https://github.com/indutny/libuv/compare/feature-accept-thread","date":"2013-02-20T13:25:50.929Z","type":"message"}
{"nick":"indutny","message":"but if you're interested ^","date":"2013-02-20T13:25:54.295Z","type":"message"}
{"nick":"bnoordhuis","message":"indutny: that reminds me, openssl performance","date":"2013-02-20T13:26:20.141Z","type":"message"}
{"nick":"indutny","message":"heh","date":"2013-02-20T13:26:24.184Z","type":"message"}
{"nick":"indutny","message":"btw, I've updated openssl in master","date":"2013-02-20T13:26:28.747Z","type":"message"}
{"nick":"bnoordhuis","message":"yeah, i noticed","date":"2013-02-20T13:26:34.243Z","type":"message"}
{"nick":"indutny","message":"and do you mean tls.js performance?","date":"2013-02-20T13:26:41.557Z","type":"message"}
{"nick":"indutny","message":"or openssl?","date":"2013-02-20T13:26:43.502Z","type":"message"}
{"nick":"bnoordhuis","message":"both","date":"2013-02-20T13:26:46.802Z","type":"message"}
{"nick":"indutny","message":"great","date":"2013-02-20T13:26:51.975Z","type":"message"}
{"nick":"indutny","message":"and what's up with openssl?","date":"2013-02-20T13:26:58.212Z","type":"message"}
{"nick":"bnoordhuis","message":"you were experimenting with moving stuff to the threadpool right?","date":"2013-02-20T13:26:58.976Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-20T13:27:16.064Z","type":"message"}
{"nick":"indutny","message":"but","date":"2013-02-20T13:27:20.116Z","type":"message"}
{"nick":"indutny","message":"it's hard to tell whether it helped or not","date":"2013-02-20T13:27:28.606Z","type":"message"}
{"nick":"indutny","message":"because","date":"2013-02-20T13:27:29.547Z","type":"message"}
{"nick":"indutny","message":"I do everything in C++ land","date":"2013-02-20T13:27:36.402Z","type":"message"}
{"nick":"indutny","message":"and also","date":"2013-02-20T13:27:45.801Z","type":"message"}
{"nick":"indutny","message":"using my own BIO implementation","date":"2013-02-20T13:27:52.589Z","type":"message"}
{"nick":"indutny","message":"so... if we'll just move our code around and off-load work to threads","date":"2013-02-20T13:28:08.482Z","type":"message"}
{"nick":"indutny","message":"that might not help much","date":"2013-02-20T13:28:16.460Z","type":"message"}
{"nick":"indutny","message":"I guess we should just make tlsnappy as stable as possible","date":"2013-02-20T13:28:32.616Z","type":"message"}
{"nick":"indutny","message":"and then eventually replace tls.js with it","date":"2013-02-20T13:28:37.942Z","type":"message"}
{"nick":"bnoordhuis","message":"offloading computation to other cores should have a positive impact, i imagine","date":"2013-02-20T13:29:01.926Z","type":"message"}
{"nick":"indutny","message":"well","date":"2013-02-20T13:29:10.502Z","type":"message"}
{"nick":"indutny","message":"it depends","date":"2013-02-20T13:29:11.797Z","type":"message"}
{"nick":"bnoordhuis","message":"the problem now is that crypt/decrypt blocks the main thread for lengthy periods of time","date":"2013-02-20T13:29:25.907Z","type":"message"}
{"nick":"indutny","message":"you still need a couple of cores to get good rps","date":"2013-02-20T13:29:33.707Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: yes, this adds variance to response times","date":"2013-02-20T13:29:47.217Z","type":"message"}
{"nick":"bnoordhuis","message":"it's something i'd like to address in v0.12","date":"2013-02-20T13:31:02.390Z","type":"message"}
{"nick":"bnoordhuis","message":"i just don't know how yet :/","date":"2013-02-20T13:31:06.641Z","type":"message"}
{"nick":"indutny","message":"haha","date":"2013-02-20T13:31:10.532Z","type":"message"}
{"nick":"indutny","message":"well, listen to me","date":"2013-02-20T13:31:15.428Z","type":"message"}
{"nick":"indutny","message":"it would be simplier to just pull tlsnappy in","date":"2013-02-20T13:31:20.590Z","type":"message"}
{"nick":"indutny","message":"the code is pretty good ;)","date":"2013-02-20T13:31:25.595Z","type":"message"}
{"nick":"bnoordhuis","message":"what does tlsnappy do that src/node_crypto.cc doesn't?","date":"2013-02-20T13:31:39.255Z","type":"message"}
{"nick":"indutny","message":"off-loading work to threads","date":"2013-02-20T13:31:53.806Z","type":"message"}
{"nick":"indutny","message":"cycling clearOut/encOut in threads","date":"2013-02-20T13:32:05.368Z","type":"message"}
{"nick":"bnoordhuis","message":"right","date":"2013-02-20T13:32:32.610Z","type":"message"}
{"nick":"indutny","message":"everything else is the same","date":"2013-02-20T13:32:45.065Z","type":"message"}
{"nick":"indutny","message":"except I haven't started working on SNI support yet","date":"2013-02-20T13:32:55.449Z","type":"message"}
{"nick":"bnoordhuis","message":"the major issue i see is that you cannot really divine how many threads you should have","date":"2013-02-20T13:33:03.879Z","type":"message"}
{"nick":"bnoordhuis","message":"say you're running on a 16 core machine","date":"2013-02-20T13:33:11.161Z","type":"message"}
{"nick":"bnoordhuis","message":"how many cores are actually available for work?","date":"2013-02-20T13:33:20.284Z","type":"message"}
{"nick":"jmar777","date":"2013-02-20T13:33:42.064Z","type":"join"}
{"nick":"bnoordhuis","message":"maybe we should make it a requirement that node is the only process besides init running on your machine :)","date":"2013-02-20T13:33:42.399Z","type":"message"}
{"nick":"indutny","message":"heh","date":"2013-02-20T13:33:45.009Z","type":"message"}
{"nick":"indutny","message":"yes, context switching","date":"2013-02-20T13:34:01.449Z","type":"message"}
{"nick":"indutny","message":"bad thing","date":"2013-02-20T13:34:04.366Z","type":"message"}
{"nick":"bnoordhuis","message":"yeah, balls","date":"2013-02-20T13:34:35.508Z","type":"message"}
{"nick":"bnoordhuis","message":"you could do some ad-hoc sampling with getrusage","date":"2013-02-20T13:34:46.341Z","type":"message"}
{"nick":"bnoordhuis","message":"but that won't be 100% accurate","date":"2013-02-20T13:34:59.695Z","type":"message"}
{"nick":"bnoordhuis","message":"something to ponder while i do the groceries","date":"2013-02-20T13:35:34.563Z","type":"message"}
{"nick":"indutny","message":"unforunatelly, I'm unable to benchmark tlsnappy","date":"2013-02-20T13:35:59.829Z","type":"message"}
{"nick":"indutny","message":"as I don't have any box for doing it","date":"2013-02-20T13:36:04.909Z","type":"message"}
{"nick":"indutny","message":"also, benchmarking https server is quite hard","date":"2013-02-20T13:36:27.499Z","type":"message"}
{"nick":"bnoordhuis","message":"joyent can set you up with machines right?","date":"2013-02-20T13:37:01.821Z","type":"message"}
{"nick":"bnoordhuis","message":"though you'll have to make sure they're physical machines, not virtualized","date":"2013-02-20T13:37:21.205Z","type":"message"}
{"nick":"indutny","message":"нуы","date":"2013-02-20T13:38:10.296Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-20T13:38:11.123Z","type":"message"}
{"nick":"indutny","message":"exactly","date":"2013-02-20T13:38:12.413Z","type":"message"}
{"nick":"indutny","message":"it seems to be pretty important for unknown reason","date":"2013-02-20T13:38:29.321Z","type":"message"}
{"nick":"indutny","message":"probably because openssl is using a lot of inlined assembly","date":"2013-02-20T13:38:39.829Z","type":"message"}
{"nick":"indutny","message":"and context switching kills cache","date":"2013-02-20T13:38:51.997Z","type":"message"}
{"nick":"indutny","message":"miserably","date":"2013-02-20T13:38:55.085Z","type":"message"}
{"nick":"indutny","message":"but that's not something I'm sure in","date":"2013-02-20T13:39:09.109Z","type":"message"}
{"nick":"indutny","message":"the thing is that I wasn't able to load 24-core smartos thing","date":"2013-02-20T13:39:22.837Z","type":"message"}
{"nick":"indutny","message":"load was around 30-40%","date":"2013-02-20T13:39:40.045Z","type":"message"}
{"nick":"indutny","message":"of possible maximum","date":"2013-02-20T13:39:45.755Z","type":"message"}
{"nick":"bnoordhuis","message":"duly noted","date":"2013-02-20T13:40:54.456Z","type":"message"}
{"nick":"bnoordhuis","message":"threads are hard, let's go shopping","date":"2013-02-20T13:41:10.397Z","type":"message"}
{"nick":"bnoordhuis","action":"is off to the supermarket","date":"2013-02-20T13:41:14.276Z","type":"action"}
{"nick":"CoverSlide","date":"2013-02-20T13:41:21.261Z","type":"join"}
{"nick":"indutny","message":"yes","date":"2013-02-20T13:42:40.433Z","type":"message"}
{"nick":"txdv","message":"he is here","date":"2013-02-20T13:43:07.449Z","type":"message"}
{"nick":"txdv","message":"And he is gone","date":"2013-02-20T13:43:12.431Z","type":"message"}
{"nick":"txdv","message":"bnoordhuis: do you have time?","date":"2013-02-20T13:43:22.109Z","type":"message"}
{"nick":"bnoordhuis","message":"not now but i'm back in an hour or so","date":"2013-02-20T13:43:46.766Z","type":"message"}
{"nick":"indutny","message":"txdv: closest groceries to ben are in another city","date":"2013-02-20T13:48:26.647Z","type":"message"}
{"nick":"indutny","message":"and since ben is using his bike to get there it takes a lot of time","date":"2013-02-20T13:48:40.163Z","type":"message"}
{"nick":"txdv","message":"so dutch","date":"2013-02-20T13:48:49.026Z","type":"message"}
{"nick":"indutny","message":"thankfuly netherlands is small","date":"2013-02-20T13:48:55.295Z","type":"message"}
{"nick":"indutny","message":"and cities are close to each other","date":"2013-02-20T13:48:59.359Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: is it like 40 km from you to AMS?","date":"2013-02-20T13:49:38.563Z","type":"message"}
{"nick":"txdv","message":"what the fuck","date":"2013-02-20T13:50:10.216Z","type":"message"}
{"nick":"indutny","message":"txdv: https://maps.google.com/maps?q=gouda&hl=en&ll=52.012254,4.708672&spn=0.029267,0.181789&sll=37.0625,-95.677068&sspn=42.310334,93.076172&hnear=Gouda,+South+Holland,+The+Netherlands&t=m&z=13&layer=c&cbll=52.012237,4.70871&panoid=SfqreGqpfhy8Caou_glHlQ&cbp=11,264.31,,0,7.14","date":"2013-02-20T13:51:12.435Z","type":"message"}
{"nick":"txdv","message":"what is this","date":"2013-02-20T13:51:43.409Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: please explain it to me once you'll return","date":"2013-02-20T13:51:50.035Z","type":"message"}
{"nick":"indutny","message":"txdv: idk","date":"2013-02-20T13:51:51.658Z","type":"message"}
{"nick":"indutny","message":"the most scariest thing is that cars are almost in cannal","date":"2013-02-20T13:52:01.731Z","type":"message"}
{"nick":"CoverSlide","message":"a city cheese was named after?","date":"2013-02-20T13:52:07.766Z","type":"message"}
{"nick":"indutny","message":"canal*","date":"2013-02-20T13:52:11.836Z","type":"message"}
{"nick":"indutny","message":"CoverSlide: yes!","date":"2013-02-20T13:52:15.232Z","type":"message"}
{"nick":"indutny","message":"you know that cheese too?","date":"2013-02-20T13:52:21.072Z","type":"message"}
{"nick":"txdv","message":"one bad move and you break your car","date":"2013-02-20T13:52:22.319Z","type":"message"}
{"nick":"indutny","message":"txdv: yeah, obviously","date":"2013-02-20T13:52:28.687Z","type":"message"}
{"nick":"txdv","message":"NO, IT IS NOT OBVIOUS","date":"2013-02-20T13:52:36.942Z","type":"message"}
{"nick":"LOUDBOT","message":"WHY PROVE A POINT THAT EVERYONE ALREADY UNDERSTANDS, YOU IDIOT?","date":"2013-02-20T13:52:37.348Z","type":"message"}
{"nick":"txdv","message":"that markov chain is good","date":"2013-02-20T13:52:49.536Z","type":"message"}
{"nick":"CoverSlide","message":"I'm no cheese expert, but I generally am a fan of most cheeses","date":"2013-02-20T13:53:06.175Z","type":"message"}
{"nick":"txdv","message":"everything with > 10% fat","date":"2013-02-20T13:53:19.827Z","type":"message"}
{"nick":"CoverSlide","message":"I don't think it's a markov chain","date":"2013-02-20T13:53:26.825Z","type":"message"}
{"nick":"CoverSlide","message":"it's just a database of things people have said loudly","date":"2013-02-20T13:54:50.365Z","type":"message"}
{"nick":"CoverSlide","action":"&","date":"2013-02-20T13:54:59.799Z","type":"action"}
{"nick":"LOUDBOT","message":"THERE'S NO LOUDS LIKE APEIRON LOUDS, THEY'RE THE BEST LOUDS THAT I KNOW","date":"2013-02-20T13:55:00.200Z","type":"message"}
{"nick":"CoverSlide","message":"LOUDBOT: whosaid","date":"2013-02-20T13:55:11.848Z","type":"message"}
{"nick":"LOUDBOT","message":"bucknkd in ##church-of-loudbot on freenode","date":"2013-02-20T13:55:12.099Z","type":"message"}
{"nick":"bnoordhuis","reason":"Ping timeout: 248 seconds","date":"2013-02-20T13:58:59.894Z","type":"quit"}
{"nick":"qmx","new_nick":"qmx|brb","date":"2013-02-20T14:06:41.254Z","type":"nick"}
{"nick":"toothr","new_nick":"toothrot","date":"2013-02-20T14:18:11.768Z","type":"nick"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2013-02-20T14:24:53.007Z","type":"quit"}
{"nick":"bnoordhuis","date":"2013-02-20T14:25:02.107Z","type":"join"}
{"nick":"jmar777","date":"2013-02-20T14:25:29.175Z","type":"join"}
{"nick":"jmar777","reason":"Ping timeout: 260 seconds","date":"2013-02-20T14:30:09.999Z","type":"quit"}
{"nick":"bnoordhuis","reason":"Ping timeout: 248 seconds","date":"2013-02-20T14:33:37.110Z","type":"quit"}
{"nick":"stagas","date":"2013-02-20T14:37:17.289Z","type":"join"}
{"nick":"csaoh","date":"2013-02-20T14:46:54.009Z","type":"join"}
{"nick":"jmar777","date":"2013-02-20T14:47:36.285Z","type":"join"}
{"nick":"qmx|brb","new_nick":"qmx","date":"2013-02-20T14:52:58.011Z","type":"nick"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2013-02-20T14:54:04.961Z","type":"quit"}
{"nick":"qmx","new_nick":"qmx|away","date":"2013-02-20T14:59:01.663Z","type":"nick"}
{"nick":"txdv","message":"hm","date":"2013-02-20T15:00:53.705Z","type":"message"}
{"nick":"txdv","message":"one hour is over","date":"2013-02-20T15:00:56.453Z","type":"message"}
{"nick":"txdv","message":"where is bnoord","date":"2013-02-20T15:01:00.064Z","type":"message"}
{"nick":"stagas_","date":"2013-02-20T15:03:24.767Z","type":"join"}
{"nick":"stagas","reason":"Ping timeout: 256 seconds","date":"2013-02-20T15:04:34.387Z","type":"quit"}
{"nick":"stagas_","new_nick":"stagas","date":"2013-02-20T15:04:48.842Z","type":"nick"}
{"nick":"erickt","date":"2013-02-20T15:09:56.263Z","type":"join"}
{"nick":"erickt","reason":"Client Quit","date":"2013-02-20T15:10:32.314Z","type":"quit"}
{"nick":"erickt","date":"2013-02-20T15:10:56.851Z","type":"join"}
{"nick":"TheJH","date":"2013-02-20T15:19:22.279Z","type":"join"}
{"nick":"erickt_","date":"2013-02-20T15:23:21.476Z","type":"join"}
{"nick":"erickt","reason":"Ping timeout: 276 seconds","date":"2013-02-20T15:23:39.816Z","type":"quit"}
{"nick":"erickt_","new_nick":"erickt","date":"2013-02-20T15:23:40.513Z","type":"nick"}
{"nick":"bnoordhuis","date":"2013-02-20T15:24:48.108Z","type":"join"}
{"nick":"loladiro","date":"2013-02-20T15:25:21.125Z","type":"join"}
{"nick":"bnoordhuis","message":"back","date":"2013-02-20T15:25:39.199Z","type":"message"}
{"nick":"bnoordhuis","message":"hm, i guess you can't rely on os x to keep a connection alive when you're afk","date":"2013-02-20T15:26:16.442Z","type":"message"}
{"nick":"bnoordhuis","message":"txdv: you were saying?","date":"2013-02-20T15:27:59.516Z","type":"message"}
{"nick":"txdv","message":"https://github.com/joyent/libuv/pull/712, https://github.com/joyent/libuv/pull/710","date":"2013-02-20T15:28:37.987Z","type":"message"}
{"nick":"txdv","message":"very simple commits","date":"2013-02-20T15:28:41.890Z","type":"message"}
{"nick":"txdv","message":"and review https://github.com/joyent/libuv/pull/709, https://github.com/joyent/libuv/pull/708","date":"2013-02-20T15:29:25.388Z","type":"message"}
{"nick":"bnoordhuis","message":"actually, i was thinking of changing the types of timeout and repeat to uint64_t","date":"2013-02-20T15:31:24.966Z","type":"message"}
{"nick":"bnoordhuis","message":"negative timeouts / repeats don't make sense anyway","date":"2013-02-20T15:31:38.909Z","type":"message"}
{"nick":"bnoordhuis","message":"i guess we can do that before v0.10","date":"2013-02-20T15:31:44.520Z","type":"message"}
{"nick":"txdv","message":"do it now","date":"2013-02-20T15:31:49.239Z","type":"message"}
{"nick":"txdv","message":"so i can adjust","date":"2013-02-20T15:31:50.837Z","type":"message"}
{"nick":"bnoordhuis","message":"adjust to what?","date":"2013-02-20T15:32:31.970Z","type":"message"}
{"nick":"bnoordhuis","message":"or adjust in a general sense","date":"2013-02-20T15:32:37.942Z","type":"message"}
{"nick":"benoitc","reason":"Excess Flood","date":"2013-02-20T15:36:19.869Z","type":"quit"}
{"nick":"MI61","message":"\u0002joyent/libuv:\u0002 \u00033Andrius Bentkus\u000f \u00037master\u000f * \u00026bf1a56\u0002 : Return the errorcode provided by uv_set_artificial_error.  This reduces t (+1 more commits) - http://git.io/xdwhYg","date":"2013-02-20T15:37:05.382Z","type":"message"}
{"nick":"erickt","reason":"Quit: erickt","date":"2013-02-20T15:38:18.631Z","type":"quit"}
{"nick":"benoitc","date":"2013-02-20T15:40:07.213Z","type":"join"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-02-20T15:51:33.495Z","type":"quit"}
{"nick":"loladiro","date":"2013-02-20T15:52:15.816Z","type":"join"}
{"nick":"loladiro","reason":"Client Quit","date":"2013-02-20T15:54:51.571Z","type":"quit"}
{"nick":"AvianFlu","date":"2013-02-20T15:57:05.690Z","type":"join"}
{"nick":"c4milo","date":"2013-02-20T16:00:50.308Z","type":"join"}
{"nick":"MI61","message":"\u0002joyent/libuv:\u0002 \u00033bnoordhuis\u000f created branch bert-belder-review-this - http://git.io/q3TFUQ","date":"2013-02-20T16:07:37.269Z","type":"message"}
{"nick":"MI61","message":"\u0002joyent/libuv:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u00027048a80\u0002 : doc: document _LARGEFILE_SOURCE + _FILE_OFFSET_BITS (+3 more commits) - http://git.io/mMbnjA","date":"2013-02-20T16:12:48.491Z","type":"message"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-20T16:13:41.963Z","type":"quit"}
{"nick":"indutny","message":"so","date":"2013-02-20T16:14:54.803Z","type":"message"}
{"nick":"indutny","message":"hoya","date":"2013-02-20T16:14:55.770Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: so that epoll_ctl EPERM thing","date":"2013-02-20T16:15:42.311Z","type":"message"}
{"nick":"indutny","message":"its odd","date":"2013-02-20T16:15:46.518Z","type":"message"}
{"nick":"indutny","message":"but I've checked my kernel's source","date":"2013-02-20T16:15:51.442Z","type":"message"}
{"nick":"indutny","message":"and apparently this may happen only if file descriptor isn't supporting epoll","date":"2013-02-20T16:16:05.967Z","type":"message"}
{"nick":"indutny","message":"which odd","date":"2013-02-20T16:16:09.847Z","type":"message"}
{"nick":"indutny","message":"because I know it was closed","date":"2013-02-20T16:16:13.756Z","type":"message"}
{"nick":"indutny","message":"I guess some race is happening in kernel","date":"2013-02-20T16:16:25.152Z","type":"message"}
{"nick":"txdv","message":"bnoordhuis: adjust the commit","date":"2013-02-20T16:16:58.660Z","type":"message"}
{"nick":"perezd","reason":"Quit: perezd","date":"2013-02-20T16:18:24.713Z","type":"quit"}
{"nick":"txdv","message":"i mean so I can adjust the timer commit","date":"2013-02-20T16:20:11.715Z","type":"message"}
{"nick":"bnoordhuis","message":"indutny: looks like it","date":"2013-02-20T16:23:58.788Z","type":"message"}
{"nick":"bnoordhuis","message":"i'm not able to reproduce it but it sounds like the struct file has been half torn down","date":"2013-02-20T16:24:24.864Z","type":"message"}
{"nick":"`3rdEden","new_nick":"`3E|AFK","date":"2013-02-20T16:25:22.328Z","type":"nick"}
{"nick":"indutny","message":"3.5.0 kernel","date":"2013-02-20T16:26:37.355Z","type":"message"}
{"nick":"indutny","message":"reproducible almost every time","date":"2013-02-20T16:26:42.467Z","type":"message"}
{"nick":"indutny","message":"obviously","date":"2013-02-20T16:26:52.134Z","type":"message"}
{"nick":"indutny","message":"interesting thing","date":"2013-02-20T16:26:56.842Z","type":"message"}
{"nick":"indutny","message":"is that this code hasn't really changed","date":"2013-02-20T16:27:02.384Z","type":"message"}
{"nick":"indutny","message":"so I guess the problem is somewhere outside","date":"2013-02-20T16:27:09.341Z","type":"message"}
{"nick":"dap","date":"2013-02-20T16:34:07.109Z","type":"join"}
{"nick":"bnoordhuis","message":"indutny: 32 or 64 bits?","date":"2013-02-20T16:34:47.617Z","type":"message"}
{"nick":"indutny","message":"64","date":"2013-02-20T16:35:51.037Z","type":"message"}
{"nick":"mikeal","date":"2013-02-20T16:35:58.693Z","type":"join"}
{"nick":"bnoordhuis","message":"hm, same as me","date":"2013-02-20T16:36:35.763Z","type":"message"}
{"nick":"bnoordhuis","message":"curious then that it never happens here","date":"2013-02-20T16:36:43.488Z","type":"message"}
{"nick":"bnoordhuis","message":"have you tried upgrading your kernel?","date":"2013-02-20T16:36:54.941Z","type":"message"}
{"nick":"mikeal","reason":"Client Quit","date":"2013-02-20T16:37:57.041Z","type":"quit"}
{"nick":"indutny","message":"nope","date":"2013-02-20T16:38:53.872Z","type":"message"}
{"nick":"indutny","message":"I thought it would be cool to test it","date":"2013-02-20T16:38:58.765Z","type":"message"}
{"nick":"isaacs","message":"good morning","date":"2013-02-20T16:39:05.410Z","type":"message"}
{"nick":"indutny","message":"but I can do it a little bit later today","date":"2013-02-20T16:39:07.911Z","type":"message"}
{"nick":"indutny","message":"morning man","date":"2013-02-20T16:39:08.707Z","type":"message"}
{"nick":"bnoordhuis","message":"morning isaac","date":"2013-02-20T16:39:12.955Z","type":"message"}
{"nick":"bnoordhuis","message":"indutny: yes, it's good that you can reproduce it","date":"2013-02-20T16:39:23.676Z","type":"message"}
{"nick":"bnoordhuis","message":"but upgrading is a good way to check if it's a kernel bug","date":"2013-02-20T16:39:41.492Z","type":"message"}
{"nick":"bnoordhuis","message":"you can install kernels side-by-side btw","date":"2013-02-20T16:39:48.751Z","type":"message"}
{"nick":"bnoordhuis","message":"(but you probably knew that)","date":"2013-02-20T16:39:54.283Z","type":"message"}
{"nick":"bnoordhuis","action":"is off to dinner","date":"2013-02-20T16:40:29.948Z","type":"action"}
{"nick":"indutny","message":"yes, I knew that","date":"2013-02-20T16:41:00.991Z","type":"message"}
{"nick":"mikeal","date":"2013-02-20T16:41:56.630Z","type":"join"}
{"nick":"bnoordhuis","reason":"Ping timeout: 248 seconds","date":"2013-02-20T16:44:49.124Z","type":"quit"}
{"nick":"brucem","message":"https://github.com/mozilla/rust/pull/5022 Rust comparing themselves to Node 0.6","date":"2013-02-20T16:46:37.729Z","type":"message"}
{"nick":"sgallagh","reason":"Remote host closed the connection","date":"2013-02-20T16:48:30.220Z","type":"quit"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-20T17:02:11.756Z","type":"quit"}
{"nick":"indexzero","date":"2013-02-20T17:03:14.581Z","type":"join"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033isaacs\u000f \u00037master\u000f * \u0002053e02e\u0002 : benchmark: Fix alignment issues on --html compare output - http://git.io/IaP-bw","date":"2013-02-20T17:17:43.384Z","type":"message"}
{"nick":"isaacs","message":"I'm going to dig into this more today, but it seems like there are three main areas where we're still slower than v0.8","date":"2013-02-20T17:19:37.047Z","type":"message"}
{"nick":"isaacs","message":"http://static.izs.me/node-not-fast-yet.html","date":"2013-02-20T17:19:40.089Z","type":"message"}
{"nick":"isaacs","message":"1. net with buffers (raw using tcp_wrap and js style using lib/net)","date":"2013-02-20T17:20:00.475Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2013-02-20T17:20:06.112Z","type":"quit"}
{"nick":"isaacs","message":"2. http simple, everything except large buffer messages","date":"2013-02-20T17:20:44.636Z","type":"message"}
{"nick":"isaacs","message":"3. cluster, everything across the board","date":"2013-02-20T17:20:51.045Z","type":"message"}
{"nick":"indutny","message":"and https is a little bit slower too, actually","date":"2013-02-20T17:21:02.074Z","type":"message"}
{"nick":"indutny","message":"but not that much","date":"2013-02-20T17:21:06.441Z","type":"message"}
{"nick":"isaacs","message":"indutny: did oyu say you were looking into cluster performance yesterday?","date":"2013-02-20T17:21:06.746Z","type":"message"}
{"nick":"indutny","message":"oh, yes","date":"2013-02-20T17:21:13.298Z","type":"message"}
{"nick":"isaacs","message":"indutny: yeah, probably because a) http is slower, and b) tls is WAY FASTER!","date":"2013-02-20T17:21:16.166Z","type":"message"}
{"nick":"indutny","message":"but not what you think","date":"2013-02-20T17:21:17.032Z","type":"message"}
{"nick":"isaacs","message":"oh, ok","date":"2013-02-20T17:21:19.505Z","type":"message"}
{"nick":"indutny","message":"I was looking into balancing of requests","date":"2013-02-20T17:21:33.112Z","type":"message"}
{"nick":"indutny","message":"and how to make it work more evenly","date":"2013-02-20T17:21:39.448Z","type":"message"}
{"nick":"indutny","message":"though, I don't have any results","date":"2013-02-20T17:21:44.671Z","type":"message"}
{"nick":"indutny","message":"yet","date":"2013-02-20T17:21:51.197Z","type":"message"}
{"nick":"isaacs","message":"ahh","date":"2013-02-20T17:21:53.464Z","type":"message"}
{"nick":"isaacs","message":"so not higher performance, necessarily, but more balanced performance.","date":"2013-02-20T17:22:01.166Z","type":"message"}
{"nick":"isaacs","message":"indutny: someone was telling me that v0.8 added 1ms of latency to all requests in cluster.","date":"2013-02-20T17:22:13.285Z","type":"message"}
{"nick":"isaacs","message":"i bet if we could take that out, we'd get a lot more q/s","date":"2013-02-20T17:22:20.651Z","type":"message"}
{"nick":"tjfontaine","message":"well I guess if you're more accurately spread out on cores you would as a byproduct get better performance","date":"2013-02-20T17:22:38.446Z","type":"message"}
{"nick":"indutny","message":"1ms???","date":"2013-02-20T17:22:45.575Z","type":"message"}
{"nick":"indutny","message":"you kidding","date":"2013-02-20T17:22:51.106Z","type":"message"}
{"nick":"isaacs","message":"indutny: nope","date":"2013-02-20T17:22:54.054Z","type":"message"}
{"nick":"indutny","message":"how it possible to measure this","date":"2013-02-20T17:22:58.290Z","type":"message"}
{"nick":"indutny","message":"difference","date":"2013-02-20T17:23:01.231Z","type":"message"}
{"nick":"indutny","message":"its statistically irrelevant","date":"2013-02-20T17:23:10.838Z","type":"message"}
{"nick":"isaacs","message":"they have services that routinely have 1ms of latency, over thousands of requests.","date":"2013-02-20T17:23:16.285Z","type":"message"}
{"nick":"isaacs","message":"now they routinely have 2ms","date":"2013-02-20T17:23:19.714Z","type":"message"}
{"nick":"indutny","message":"oh god","date":"2013-02-20T17:23:26.202Z","type":"message"}
{"nick":"isaacs","message":"that's like an extra 1000 q/s, man :)","date":"2013-02-20T17:23:38.933Z","type":"message"}
{"nick":"indutny","message":"haha","date":"2013-02-20T17:23:44.549Z","type":"message"}
{"nick":"indutny","message":"well, I believe you","date":"2013-02-20T17:23:49.539Z","type":"message"}
{"nick":"indutny","message":"but anyway it's scary","date":"2013-02-20T17:23:56.508Z","type":"message"}
{"nick":"isaacs","message":"i think it might be our load-balancing shenanigans.","date":"2013-02-20T17:24:10.293Z","type":"message"}
{"nick":"indutny","message":"it might be usleep(1)","date":"2013-02-20T17:24:24.393Z","type":"message"}
{"nick":"isaacs","message":"but yes, cluster right now does not scale anywhere near linearly to the number of workers used","date":"2013-02-20T17:24:25.052Z","type":"message"}
{"nick":"indutny","message":"in libuv","date":"2013-02-20T17:24:28.314Z","type":"message"}
{"nick":"isaacs","message":"that would make sense","date":"2013-02-20T17:24:34.062Z","type":"message"}
{"nick":"isaacs","message":"holy crap","date":"2013-02-20T17:25:23.412Z","type":"message"}
{"nick":"isaacs","message":"    if (stream->type == UV_TCP && (stream->flags & UV_TCP_SINGLE_ACCEPT)) {","date":"2013-02-20T17:25:25.737Z","type":"message"}
{"nick":"isaacs","message":"      /* Give other processes a chance to accept connections. */","date":"2013-02-20T17:25:25.871Z","type":"message"}
{"nick":"isaacs","message":"      struct timespec timeout = { 0, 1 };","date":"2013-02-20T17:25:25.871Z","type":"message"}
{"nick":"isaacs","message":"      nanosleep(&timeout, NULL);","date":"2013-02-20T17:25:25.872Z","type":"message"}
{"nick":"isaacs","message":"    }","date":"2013-02-20T17:25:27.989Z","type":"message"}
{"nick":"isaacs","message":"yep","date":"2013-02-20T17:25:30.481Z","type":"message"}
{"nick":"isaacs","message":"that's the only place where we sleep","date":"2013-02-20T17:25:42.752Z","type":"message"}
{"nick":"indutny","message":"nah","date":"2013-02-20T17:25:46.320Z","type":"message"}
{"nick":"isaacs","message":"(afaict)","date":"2013-02-20T17:25:47.221Z","type":"message"}
{"nick":"isaacs","message":"outside of tests and stuff","date":"2013-02-20T17:25:55.162Z","type":"message"}
{"nick":"indutny","message":"that's total shit","date":"2013-02-20T17:25:56.262Z","type":"message"}
{"nick":"indutny","message":"its only in master","date":"2013-02-20T17:26:01.576Z","type":"message"}
{"nick":"indutny","message":"0.8 should not be affected by this","date":"2013-02-20T17:26:08.014Z","type":"message"}
{"nick":"indutny","message":"and btw, this is disabled by default","date":"2013-02-20T17:26:13.080Z","type":"message"}
{"nick":"isaacs","message":"oh, right","date":"2013-02-20T17:26:13.221Z","type":"message"}
{"nick":"isaacs","message":"ok","date":"2013-02-20T17:26:40.087Z","type":"message"}
{"nick":"indutny","message":"so....","date":"2013-02-20T17:26:45.057Z","type":"message"}
{"nick":"indutny","message":"idk :)","date":"2013-02-20T17:26:47.493Z","type":"message"}
{"nick":"indutny","message":"probably","date":"2013-02-20T17:26:52.762Z","type":"message"}
{"nick":"isaacs","message":"and v0.8 has eio and ev, which have all kinds of crazy sleep scheduler bs","date":"2013-02-20T17:26:53.915Z","type":"message"}
{"nick":"indutny","message":"its just bad distribution","date":"2013-02-20T17:26:57.004Z","type":"message"}
{"nick":"isaacs","message":"yeah","date":"2013-02-20T17:26:59.250Z","type":"message"}
{"nick":"isaacs","message":"it's always tempting to go look for a silver bullet or a thing to \"blame\" when sometimes it's just that your program needs to do less stuff and be smarter.","date":"2013-02-20T17:29:58.991Z","type":"message"}
{"nick":"isaacs","message":"it's interesting to me that now net is consistently faster, except when buffers are used.","date":"2013-02-20T17:30:39.943Z","type":"message"}
{"nick":"isaacs","message":"then we're about 10% slower, both in the raw and lib/net.js tests","date":"2013-02-20T17:31:01.229Z","type":"message"}
{"nick":"indutny","message":"brb","date":"2013-02-20T17:31:21.236Z","type":"message"}
{"nick":"tjfontaine","message":"isaacs: I forget did ben do an analysis of memory allocation on v0.8 vs master? I know he mentioned at one time it seemed like we were fighting more with the slab allocator than before","date":"2013-02-20T17:32:27.551Z","type":"message"}
{"nick":"isaacs","message":"hm.  that shouldln't affect the raw tests much, though","date":"2013-02-20T17:32:53.826Z","type":"message"}
{"nick":"isaacs","message":"it's very consistent","date":"2013-02-20T17:32:56.264Z","type":"message"}
{"nick":"tjfontaine","message":"fair enough","date":"2013-02-20T17:33:27.376Z","type":"message"}
{"nick":"isaacs","message":"and there is some jitter on the tests, but not enough to account for the 5-10% diff","date":"2013-02-20T17:33:38.217Z","type":"message"}
{"nick":"isaacs","message":"ok, commute time","date":"2013-02-20T17:34:11.239Z","type":"message"}
{"nick":"isaacs","message":"bbiab","date":"2013-02-20T17:34:12.857Z","type":"message"}
{"nick":"brson","date":"2013-02-20T17:36:45.116Z","type":"join"}
{"nick":"bnoordhuis","date":"2013-02-20T17:37:00.161Z","type":"join"}
{"nick":"indexzero","date":"2013-02-20T17:39:25.885Z","type":"join"}
{"nick":"tjfontaine","message":"bnoordhuis: btw I don't know if you saw in the logs, but it might help you with that EPERM race, trevor is using luks full disk encryption","date":"2013-02-20T17:39:27.062Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2013-02-20T17:44:34.554Z","type":"quit"}
{"nick":"bnoordhuis","message":"tjfontaine: indutny too?","date":"2013-02-20T17:44:55.575Z","type":"message"}
{"nick":"tjfontaine","message":"that I don't know","date":"2013-02-20T17:45:59.835Z","type":"message"}
{"nick":"stagas_","date":"2013-02-20T17:47:03.191Z","type":"join"}
{"nick":"mikeal","date":"2013-02-20T17:47:17.611Z","type":"join"}
{"nick":"tjfontaine","message":"ugh, I forgot that v0.8 doesn't have the tap progress output","date":"2013-02-20T17:47:26.283Z","type":"message"}
{"nick":"bnoordhuis","message":"do you need it? we can back-port it","date":"2013-02-20T17:47:44.792Z","type":"message"}
{"nick":"tjfontaine","message":"ya, kinda helpful for the jenkins stuff, I presume v0.8 will receive updates for a while yet","date":"2013-02-20T17:48:12.924Z","type":"message"}
{"nick":"stagas","reason":"Ping timeout: 256 seconds","date":"2013-02-20T17:48:25.433Z","type":"quit"}
{"nick":"stagas_","new_nick":"stagas","date":"2013-02-20T17:48:29.948Z","type":"nick"}
{"nick":"mikeal","reason":"Client Quit","date":"2013-02-20T17:51:15.019Z","type":"quit"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033Timothy J Fontaine\u000f \u00037v0.8\u000f * \u00029d45b94\u0002 : test: add TAP output to the test runner  This is a back-port of commit 14 - http://git.io/GIRwNg","date":"2013-02-20T17:51:57.975Z","type":"message"}
{"nick":"tjfontaine","message":"bnoordhuis: thanks","date":"2013-02-20T17:52:12.452Z","type":"message"}
{"nick":"stagas_","date":"2013-02-20T17:52:17.309Z","type":"join"}
{"nick":"bnoordhuis","message":"my pleasure","date":"2013-02-20T17:52:37.161Z","type":"message"}
{"nick":"csaoh","reason":"Quit: csaoh","date":"2013-02-20T17:52:46.088Z","type":"quit"}
{"nick":"stagas","reason":"Ping timeout: 256 seconds","date":"2013-02-20T17:53:31.432Z","type":"quit"}
{"nick":"stagas_","new_nick":"stagas","date":"2013-02-20T17:53:42.149Z","type":"nick"}
{"nick":"brson","reason":"Remote host closed the connection","date":"2013-02-20T17:54:38.442Z","type":"quit"}
{"nick":"loladiro","date":"2013-02-20T17:56:08.573Z","type":"join"}
{"nick":"pooya_","date":"2013-02-20T18:00:48.923Z","type":"join"}
{"nick":"stagas","reason":"Ping timeout: 244 seconds","date":"2013-02-20T18:01:38.118Z","type":"quit"}
{"nick":"stagas","date":"2013-02-20T18:04:37.141Z","type":"join"}
{"nick":"trevnorris","date":"2013-02-20T18:04:59.967Z","type":"join"}
{"nick":"hz","reason":"Ping timeout: 264 seconds","date":"2013-02-20T18:05:36.436Z","type":"quit"}
{"nick":"hz","date":"2013-02-20T18:05:47.474Z","type":"join"}
{"nick":"txdv","message":"bnoordhuis: how as SF?","date":"2013-02-20T18:06:26.124Z","type":"message"}
{"nick":"pooya_","reason":"Quit: pooya_","date":"2013-02-20T18:07:17.557Z","type":"quit"}
{"nick":"trevnorris","message":"indutny: so, kernel bug eh?","date":"2013-02-20T18:09:40.349Z","type":"message"}
{"nick":"pooya","date":"2013-02-20T18:10:15.419Z","type":"join"}
{"nick":"`3E|AFK","new_nick":"`3rdEden","date":"2013-02-20T18:15:01.663Z","type":"nick"}
{"nick":"bnoordhuis","message":"txdv: nice weather, friendly people. i just wish american beer and coffee are more decent","date":"2013-02-20T18:18:25.589Z","type":"message"}
{"nick":"txdv","message":"fuck yeah, and it is the center of high soft tech","date":"2013-02-20T18:19:15.125Z","type":"message"}
{"nick":"txdv","message":"did ou go there because of oracle?","date":"2013-02-20T18:20:00.145Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: if the EPERM thing is a kernel bug, anything that can be done on our side?","date":"2013-02-20T18:20:32.342Z","type":"message"}
{"nick":"tjfontaine","message":"hrm make test for libuv on smartos is broken atm, something to do with how we link to libuv.so \"ld: fatal: relocations remain against allocatable but non-writable sections\"","date":"2013-02-20T18:21:00.385Z","type":"message"}
{"nick":"bnoordhuis","message":"txdv: no, we had an all-hands meeting. figuring out how to become millionaires in the least amount of time","date":"2013-02-20T18:21:08.067Z","type":"message"}
{"nick":"bnoordhuis","message":"tjfontaine: oh that. it's a sunos ld quirk but it's easy to fix","date":"2013-02-20T18:21:33.039Z","type":"message"}
{"nick":"tjfontaine","message":"ok, which way is the right way?","date":"2013-02-20T18:21:47.318Z","type":"message"}
{"nick":"txdv","message":"do you own a house in NL?","date":"2013-02-20T18:21:48.728Z","type":"message"}
{"nick":"mikeal","date":"2013-02-20T18:21:59.303Z","type":"join"}
{"nick":"tjfontaine","message":"oh -Wl,-z,textoff?","date":"2013-02-20T18:22:01.448Z","type":"message"}
{"nick":"bnoordhuis","message":"yes, i think that's the one","date":"2013-02-20T18:22:10.890Z","type":"message"}
{"nick":"bnoordhuis","message":"it's not really the correct fix but meh","date":"2013-02-20T18:22:17.339Z","type":"message"}
{"nick":"tjfontaine","message":"the correct fix is for smartos to use a saner compiler chain :P","date":"2013-02-20T18:22:41.019Z","type":"message"}
{"nick":"bnoordhuis","message":"indeed :)","date":"2013-02-20T18:22:51.146Z","type":"message"}
{"nick":"bnoordhuis","message":"txdv: yes","date":"2013-02-20T18:22:52.858Z","type":"message"}
{"nick":"txdv","message":"bnoordhuis: you are a millionaire","date":"2013-02-20T18:23:11.159Z","type":"message"}
{"nick":"txdv","message":"I think you want to become a multi millionaire","date":"2013-02-20T18:23:23.637Z","type":"message"}
{"nick":"bnoordhuis","message":"yes, that","date":"2013-02-20T18:23:31.239Z","type":"message"}
{"nick":"bnoordhuis","message":"and in euros, not yen","date":"2013-02-20T18:23:34.092Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: we could swallow the EPERM in linux-core.c but, well","date":"2013-02-20T18:23:54.475Z","type":"message"}
{"nick":"trevnorris","message":"don't know that much in that area, but seems potentially dangerous.","date":"2013-02-20T18:24:14.399Z","type":"message"}
{"nick":"bnoordhuis","message":"indeed","date":"2013-02-20T18:24:20.078Z","type":"message"}
{"nick":"bnoordhuis","message":"i'm not comfortable suppressing errors until i fully understand what's going on","date":"2013-02-20T18:24:34.562Z","type":"message"}
{"nick":"trevnorris","message":"hm. do we know why the error is appearing in the first place?","date":"2013-02-20T18:25:19.402Z","type":"message"}
{"nick":"tjfontaine","message":"on the plus side, libuv is a freaking speed demon to compile","date":"2013-02-20T18:25:20.609Z","type":"message"}
{"nick":"txdv","message":"who changed the test makefile system","date":"2013-02-20T18:26:10.531Z","type":"message"}
{"nick":"bnoordhuis","message":"i did","date":"2013-02-20T18:26:24.888Z","type":"message"}
{"nick":"txdv","message":"it is now parallel and so much faster (compiles only the changed tests)","date":"2013-02-20T18:26:52.010Z","type":"message"}
{"nick":"bnoordhuis","message":"tjfontaine: re that error you're seeing, it might mean some files are compiled without -fPIC","date":"2013-02-20T18:26:56.648Z","type":"message"}
{"nick":"txdv","message":"fucking A","date":"2013-02-20T18:26:57.871Z","type":"message"}
{"nick":"bnoordhuis","message":"supports out-of-tree builds too now :)","date":"2013-02-20T18:27:13.741Z","type":"message"}
{"nick":"trevnorris","message":"iirc you said it's because uv is trying to epoll a file that can't be epoll'd.","date":"2013-02-20T18:27:20.785Z","type":"message"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-20T18:27:21.098Z","type":"quit"}
{"nick":"TooTallNate","date":"2013-02-20T18:27:49.781Z","type":"join"}
{"nick":"bnoordhuis","message":"trevnorris: yeah, but indutny mentioned he sees a close before epoll_ctl so the error should be EBADF, not EPERM","date":"2013-02-20T18:27:51.104Z","type":"message"}
{"nick":"bnoordhuis","message":"if it really were a non-epollable fd, you'd see it in /proc/<pid>/fd/","date":"2013-02-20T18:28:26.769Z","type":"message"}
{"nick":"trevnorris","message":"yeah. pausing the process on abort in gdb, can't find the fd either.","date":"2013-02-20T18:29:01.450Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: thanks for the gdb training btw. felt so powerful to be able to analyze things that way. =)","date":"2013-02-20T18:30:43.792Z","type":"message"}
{"nick":"mikeal","reason":"Ping timeout: 240 seconds","date":"2013-02-20T18:31:05.171Z","type":"quit"}
{"nick":"bnoordhuis","message":"you're welcome :)","date":"2013-02-20T18:31:21.512Z","type":"message"}
{"nick":"tjfontaine","message":"bnoordhuis: ya, I'm not seeing any of them compile with fPIC","date":"2013-02-20T18:32:25.574Z","type":"message"}
{"nick":"c4milo","date":"2013-02-20T18:32:29.008Z","type":"join"}
{"nick":"tjfontaine","message":"oh make is just static","date":"2013-02-20T18:32:49.562Z","type":"message"}
{"nick":"tjfontaine","action":"make libuv.so","date":"2013-02-20T18:33:03.713Z","type":"action"}
{"nick":"txdv","message":"who added the makfile target for libuv.so","date":"2013-02-20T18:33:35.074Z","type":"message"}
{"nick":"tjfontaine","message":"ok, so don't run make && make test, that breaks things","date":"2013-02-20T18:33:43.653Z","type":"message"}
{"nick":"tjfontaine","message":"make libuv.so && make test is ok though","date":"2013-02-20T18:33:57.864Z","type":"message"}
{"nick":"bnoordhuis","message":"i guess i should fix that","date":"2013-02-20T18:34:47.235Z","type":"message"}
{"nick":"tjfontaine","message":"I may be investing some time in a tap output for libuv as well, unless you're interested in throwing that together too :)","date":"2013-02-20T18:36:08.114Z","type":"message"}
{"nick":"bnoordhuis","message":"i'll happily leave that to you :)","date":"2013-02-20T18:37:30.886Z","type":"message"}
{"nick":"txdv","message":"bnoordhuis: ","date":"2013-02-20T18:39:06.367Z","type":"message"}
{"nick":"txdv","message":"did you modify this commit?","date":"2013-02-20T18:39:11.217Z","type":"message"}
{"nick":"txdv","message":"https://github.com/joyent/libuv/commit/6bf1a56e9d60737ef26509d9e304c03e008972d4","date":"2013-02-20T18:39:11.606Z","type":"message"}
{"nick":"tjfontaine","message":"bnoordhuis: aside from eating kittens and killing babies, what can go wrong with running libuv tests as root? :)","date":"2013-02-20T18:39:37.154Z","type":"message"}
{"nick":"bnoordhuis","message":"txdv: yes. even less lines of code","date":"2013-02-20T18:39:40.993Z","type":"message"}
{"nick":"txdv","message":"so no { } if you have a one liner?","date":"2013-02-20T18:40:00.546Z","type":"message"}
{"nick":"bnoordhuis","message":"tjfontaine: probably nothing but i can't vouch for that","date":"2013-02-20T18:40:05.947Z","type":"message"}
{"nick":"tjfontaine","message":"nod","date":"2013-02-20T18:40:21.034Z","type":"message"}
{"nick":"bnoordhuis","message":"txdv: that's correct","date":"2013-02-20T18:40:21.373Z","type":"message"}
{"nick":"txdv","message":"and I thought you like K&R","date":"2013-02-20T18:40:48.737Z","type":"message"}
{"nick":"bnoordhuis","message":"i like my code flat and brief","date":"2013-02-20T18:41:49.145Z","type":"message"}
{"nick":"txdv","message":"bnoordhuis: one argument one line in the header files too?","date":"2013-02-20T18:45:25.767Z","type":"message"}
{"nick":"bnoordhuis","message":"txdv: yes. we don't do that everywhere but i patch that up whenever i come across it","date":"2013-02-20T18:46:52.579Z","type":"message"}
{"nick":"bnoordhuis","message":"(and have reason to touch that code)","date":"2013-02-20T18:47:04.841Z","type":"message"}
{"nick":"txdv","message":"lazy evaluation","date":"2013-02-20T18:53:44.058Z","type":"message"}
{"nick":"txdv","message":"bnoordhuis: did you want to change something on the timers api?","date":"2013-02-20T18:54:08.018Z","type":"message"}
{"nick":"MI61","message":"\u0002joyent/libuv:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u0002fd24a69\u0002 : build: fix shared-after-static build  Executing `make libuv.so` after `ma - http://git.io/lXf4Zw","date":"2013-02-20T18:54:58.314Z","type":"message"}
{"nick":"bnoordhuis","message":"tjfontaine: ^","date":"2013-02-20T18:55:06.972Z","type":"message"}
{"nick":"bnoordhuis","message":"txdv: you mean the int64-to-uint64 thing? already did","date":"2013-02-20T18:55:28.544Z","type":"message"}
{"nick":"tjfontaine","message":"bnoordhuis: thanks","date":"2013-02-20T18:56:25.360Z","type":"message"}
{"nick":"txdv","message":"bnoordhuis: rereview https://github.com/joyent/libuv/pull/708","date":"2013-02-20T18:57:20.083Z","type":"message"}
{"nick":"mikeal","date":"2013-02-20T18:58:27.908Z","type":"join"}
{"nick":"txdv","message":"in timer the values are now uint64_t?","date":"2013-02-20T18:59:36.404Z","type":"message"}
{"nick":"bnoordhuis","message":"txdv: yes","date":"2013-02-20T19:01:09.420Z","type":"message"}
{"nick":"bnoordhuis","message":"we'll change that again when the universe starts imploding and time reverses","date":"2013-02-20T19:01:51.258Z","type":"message"}
{"nick":"txdv","message":"i think u adds a few thousand years","date":"2013-02-20T19:02:17.135Z","type":"message"}
{"nick":"bnoordhuis","message":"yeah. it's still not big enough for the aforementioned event though","date":"2013-02-20T19:02:52.436Z","type":"message"}
{"nick":"bnoordhuis","message":"that starts, conservatively, 10**70 years from now","date":"2013-02-20T19:03:08.254Z","type":"message"}
{"nick":"mikeal","reason":"Ping timeout: 272 seconds","date":"2013-02-20T19:03:32.976Z","type":"quit"}
{"nick":"txdv","message":"there is a problem","date":"2013-02-20T19:04:07.527Z","type":"message"}
{"nick":"txdv","message":"if you make uv_timer_get_repeat return a uint64_t, there is no way to check for errors","date":"2013-02-20T19:04:21.136Z","type":"message"}
{"nick":"txdv","message":"as for, is the handle, that the user has supplied, a valid timer handle?","date":"2013-02-20T19:04:37.825Z","type":"message"}
{"nick":"bnoordhuis","message":"meh. just assert if handle->type != UV_TIMER","date":"2013-02-20T19:05:36.737Z","type":"message"}
{"nick":"indexzero","date":"2013-02-20T19:10:22.134Z","type":"join"}
{"nick":"Raynos","message":"isaacs, TooTallNate: ping","date":"2013-02-20T19:12:31.348Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: yo","date":"2013-02-20T19:12:46.403Z","type":"message"}
{"nick":"brson","date":"2013-02-20T19:13:22.510Z","type":"join"}
{"nick":"Raynos","message":"TooTallNate: https://github.com/isaacs/readable-stream/pull/48","date":"2013-02-20T19:14:28.860Z","type":"message"}
{"nick":"Raynos","message":"can we merge and version bump that?","date":"2013-02-20T19:14:37.075Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: any way  to figure out where in the kernel the EPERM is being returned?","date":"2013-02-20T19:14:43.500Z","type":"message"}
{"nick":"stagas_","date":"2013-02-20T19:15:03.271Z","type":"join"}
{"nick":"TooTallNate","message":"Raynos: oh shoot!","date":"2013-02-20T19:15:03.944Z","type":"message"}
{"nick":"TooTallNate","message":"good catch","date":"2013-02-20T19:15:07.195Z","type":"message"}
{"nick":"TooTallNate","message":"ya one sec","date":"2013-02-20T19:15:10.635Z","type":"message"}
{"nick":"stagas_","reason":"Client Quit","date":"2013-02-20T19:15:26.063Z","type":"quit"}
{"nick":"stagas","reason":"Ping timeout: 260 seconds","date":"2013-02-20T19:16:00.013Z","type":"quit"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033isaacs\u000f \u00037master\u000f * \u0002053e02e\u0002 : benchmark: Fix alignment issues on --html compare output (+2 more commits) - http://git.io/vnKnIw","date":"2013-02-20T19:16:42.666Z","type":"message"}
{"nick":"MI61","message":"\u0002joyent/libuv:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u0002fd24a69\u0002 : build: fix shared-after-static build  Executing `make libuv.so` after `ma (+2 more commits) - http://git.io/0iNscg","date":"2013-02-20T19:17:11.696Z","type":"message"}
{"nick":"isaacs","message":"didn't push commits, just testing web hooks","date":"2013-02-20T19:17:34.001Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: yes","date":"2013-02-20T19:17:54.367Z","type":"message"}
{"nick":"indutny","message":"that's what I've seen in a couple of straces","date":"2013-02-20T19:18:03.336Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: minor buffer improvement: https://github.com/joyent/node/pull/4811","date":"2013-02-20T19:18:09.655Z","type":"message"}
{"nick":"isaacs","message":"TooTallNate: lgtm","date":"2013-02-20T19:18:13.899Z","type":"message"}
{"nick":"isaacs","message":"Raynos: ^","date":"2013-02-20T19:18:15.993Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: published as v0.3.1","date":"2013-02-20T19:18:26.201Z","type":"message"}
{"nick":"Raynos","message":"thanks :)","date":"2013-02-20T19:18:33.708Z","type":"message"}
{"nick":"TooTallNate","message":"np","date":"2013-02-20T19:19:26.377Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: so removing the coerce() just prevents a Math.ceil if it's not a good number, gith?","date":"2013-02-20T19:20:07.284Z","type":"message"}
{"nick":"isaacs","message":"s/gith/right/","date":"2013-02-20T19:20:10.958Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: either by reading the source or putting a retprobe (return probe) on the syscall with systemtap","date":"2013-02-20T19:20:48.422Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: the relevant file is fs/eventpoll.c","date":"2013-02-20T19:21:03.720Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: yeah. it's exactly the same check, except simplified enough to fit inline.","date":"2013-02-20T19:21:22.218Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: cool. thanks.","date":"2013-02-20T19:21:30.127Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: testing now.","date":"2013-02-20T19:21:50.188Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: well, 3.5 only return EPERM once in eventpoll.c. at least it was easy to find.","date":"2013-02-20T19:22:56.726Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: yeah. that code hasn't changed much in recent times either","date":"2013-02-20T19:23:52.010Z","type":"message"}
{"nick":"bnoordhuis","message":"i mean, it's still the same in 3.8","date":"2013-02-20T19:24:00.991Z","type":"message"}
{"nick":"trevnorris","message":"ah, ok.","date":"2013-02-20T19:24:07.076Z","type":"message"}
{"nick":"bnoordhuis","message":"that's why i'm suspecting that it's a partially (de)constructed struct file","date":"2013-02-20T19:24:22.879Z","type":"message"}
{"nick":"trevnorris","message":"so the only way it can get past returning EBADF is that the file must exist, right?","date":"2013-02-20T19:24:23.148Z","type":"message"}
{"nick":"bnoordhuis","message":"well, that the file descriptor is open","date":"2013-02-20T19:24:54.897Z","type":"message"}
{"nick":"trevnorris","message":"ok, and indutny used strace to verify that the fd was still open until abort i think.","date":"2013-02-20T19:25:40.266Z","type":"message"}
{"nick":"tjfontaine","message":"nah, that it closed before the abort","date":"2013-02-20T19:25:58.897Z","type":"message"}
{"nick":"indutny","message":"nope","date":"2013-02-20T19:26:06.296Z","type":"message"}
{"nick":"indutny","message":"it was closed","date":"2013-02-20T19:26:08.854Z","type":"message"}
{"nick":"indutny","message":"I seen close() call","date":"2013-02-20T19:26:12.739Z","type":"message"}
{"nick":"indutny","message":"and there was no such fd in /proc/","date":"2013-02-20T19:26:20.145Z","type":"message"}
{"nick":"bnoordhuis","message":"indutny: did you strace with -f ?","date":"2013-02-20T19:26:25.862Z","type":"message"}
{"nick":"indutny","message":"nope","date":"2013-02-20T19:26:29.253Z","type":"message"}
{"nick":"indutny","message":"should I?","date":"2013-02-20T19:26:31.207Z","type":"message"}
{"nick":"indutny","message":"it doesn't matter that much, actually","date":"2013-02-20T19:26:39.184Z","type":"message"}
{"nick":"bnoordhuis","message":"yes, -f also traces threads","date":"2013-02-20T19:26:40.335Z","type":"message"}
{"nick":"bnoordhuis","message":"but the fd should still be visible in /proc","date":"2013-02-20T19:26:47.175Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-20T19:26:50.311Z","type":"message"}
{"nick":"indutny","message":"obviously","date":"2013-02-20T19:26:51.450Z","type":"message"}
{"nick":"trevnorris","message":"for my own learning, indutny what's the strace params that you used?","date":"2013-02-20T19:27:08.841Z","type":"message"}
{"nick":"indutny","message":"just strace :)","date":"2013-02-20T19:27:16.004Z","type":"message"}
{"nick":"indutny","message":"usually that's how it works","date":"2013-02-20T19:27:29.605Z","type":"message"}
{"nick":"indutny","message":"but `man strace` may unveil many other flags","date":"2013-02-20T19:27:35.885Z","type":"message"}
{"nick":"indutny","message":"which ben should be more aware of than I do","date":"2013-02-20T19:27:42.883Z","type":"message"}
{"nick":"trevnorris","message":"indutny: so, how would it get past the EBADF check if the fd was closed? race condition with threads?","date":"2013-02-20T19:29:32.066Z","type":"message"}
{"nick":"bnoordhuis","message":"why is simple/test-http-full-response broken?","date":"2013-02-20T19:29:32.631Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: ?","date":"2013-02-20T19:29:43.202Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: works for me","date":"2013-02-20T19:29:46.866Z","type":"message"}
{"nick":"isaacs","message":"what are you seeing?","date":"2013-02-20T19:29:50.272Z","type":"message"}
{"nick":"indutny","message":"trevnorris: should be","date":"2013-02-20T19:29:56.493Z","type":"message"}
{"nick":"bnoordhuis","message":"Error: socket hang up at createHangUpError (http.js:1383:15) at ServerResponse.OutgoingMessage._writeRaw (http.js:499:26)","date":"2013-02-20T19:29:57.361Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: yes it is","date":"2013-02-20T19:29:59.978Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: are you testing on osx?","date":"2013-02-20T19:30:04.404Z","type":"message"}
{"nick":"bnoordhuis","message":"yes","date":"2013-02-20T19:30:07.116Z","type":"message"}
{"nick":"indutny","message":"yep","date":"2013-02-20T19:30:09.957Z","type":"message"}
{"nick":"indutny","message":"because of `ab`","date":"2013-02-20T19:30:12.382Z","type":"message"}
{"nick":"isaacs","message":"oh, jesus.","date":"2013-02-20T19:30:14.137Z","type":"message"}
{"nick":"isaacs","message":" // This test requires the program 'ab'","date":"2013-02-20T19:30:17.162Z","type":"message"}
{"nick":"bnoordhuis","message":"awg","date":"2013-02-20T19:30:21.839Z","type":"message"}
{"nick":"isaacs","message":"k, that's stupid.  we have wrk now.","date":"2013-02-20T19:30:22.962Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: i'll have a PR today to fix it","date":"2013-02-20T19:30:45.922Z","type":"message"}
{"nick":"bnoordhuis","message":"okay, cool","date":"2013-02-20T19:30:52.611Z","type":"message"}
{"nick":"bnoordhuis","message":"did that wrk guy land your sunos PR?","date":"2013-02-20T19:31:00.165Z","type":"message"}
{"nick":"indutny","message":"hopefuly that was not a public relations","date":"2013-02-20T19:31:02.616Z","type":"message"}
{"nick":"indutny","message":"we're doing a lot of PR here","date":"2013-02-20T19:31:14.182Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: no, he did a different hting, which works with sunos 5.10, apparently, but not 5.11","date":"2013-02-20T19:31:15.377Z","type":"message"}
{"nick":"indutny","message":"at #libuv","date":"2013-02-20T19:31:15.807Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: i sent him another pull req with 2 more commits to make it work on 5.11","date":"2013-02-20T19:31:24.222Z","type":"message"}
{"nick":"isaacs","message":"(aka illumos, smartos, etc.)","date":"2013-02-20T19:31:28.161Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: it's effectively the same as what we already have, modulo some cosmetic differences.","date":"2013-02-20T19:31:47.267Z","type":"message"}
{"nick":"bnoordhuis","message":"okay, nice.","date":"2013-02-20T19:32:14.604Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: i've been meaning to pull in my wrk branch with wg's master and those 2 patches, but haven't gotten to it yet.","date":"2013-02-20T19:32:17.832Z","type":"message"}
{"nick":"isaacs","message":"better to be on the upsream","date":"2013-02-20T19:32:23.151Z","type":"message"}
{"nick":"`3rdEden","reason":"Quit: brb due to reasons","date":"2013-02-20T19:32:35.761Z","type":"quit"}
{"nick":"indutny","message":"btw","date":"2013-02-20T19:33:01.706Z","type":"message"}
{"nick":"indutny","message":"any openssl problems after update?","date":"2013-02-20T19:33:06.620Z","type":"message"}
{"nick":"indutny","message":"does everything works fine for you guys?","date":"2013-02-20T19:33:11.981Z","type":"message"}
{"nick":"indutny","message":"I mean tests, and some stuff like npm","date":"2013-02-20T19:33:18.047Z","type":"message"}
{"nick":"tjfontaine","message":"that was v0.8 branch?","date":"2013-02-20T19:33:33.245Z","type":"message"}
{"nick":"indutny","message":"0.9","date":"2013-02-20T19:33:42.725Z","type":"message"}
{"nick":"trevnorris","message":"indutny: not that you haven't helped me out enough, but mind giving a small explanation bout the last few lines: http://git.io/J9BYCA","date":"2013-02-20T19:33:58.229Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: how do you think it should handle the need for `make wrk` in the test?  should we just make wrk a prereq of the test: target?","date":"2013-02-20T19:34:10.784Z","type":"message"}
{"nick":"trevnorris","message":"specifically what's going on in PID 8150","date":"2013-02-20T19:34:17.854Z","type":"message"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033Trevor Norris\u000f \u00037master\u000f * \u0002d69a26b\u0002 : buffer: check logic simplification  Checks have been simplified and optim - http://git.io/JHhRrQ","date":"2013-02-20T19:34:53.848Z","type":"message"}
{"nick":"indutny","message":"well, its just syscalls","date":"2013-02-20T19:34:55.157Z","type":"message"}
{"nick":"Raynos","message":"for streams2, whats the motivation to set a lwm higher then 0?","date":"2013-02-20T19:35:06.140Z","type":"message"}
{"nick":"indutny","message":"it has received SIGABORT signal","date":"2013-02-20T19:35:10.119Z","type":"message"}
{"nick":"indutny","message":"interrupted thread","date":"2013-02-20T19:35:12.541Z","type":"message"}
{"nick":"indutny","message":"and killed it","date":"2013-02-20T19:35:17.282Z","type":"message"}
{"nick":"indutny","message":"and close(16) was called right before it","date":"2013-02-20T19:35:55.746Z","type":"message"}
{"nick":"bnoordhuis","message":"isaacs: i think that's what i'd do","date":"2013-02-20T19:36:04.748Z","type":"message"}
{"nick":"tjfontaine","message":"indutny: fwiw I'm getting this on smartos on master https://gist.github.com/tjfontaine/4998602","date":"2013-02-20T19:37:02.558Z","type":"message"}
{"nick":"bnoordhuis","message":"bloody hell, there's a mouse in my living room","date":"2013-02-20T19:37:09.808Z","type":"message"}
{"nick":"tjfontaine","message":"bnoordhuis: is it cute?","date":"2013-02-20T19:37:15.360Z","type":"message"}
{"nick":"bnoordhuis","action":"gets the bb gun","date":"2013-02-20T19:37:15.670Z","type":"action"}
{"nick":"benoitc","reason":"Excess Flood","date":"2013-02-20T19:37:31.298Z","type":"quit"}
{"nick":"trevnorris","message":"indutny: oh, way. so close is called on the fd, then resumes epoll_ctl afterwards.","date":"2013-02-20T19:37:33.921Z","type":"message"}
{"nick":"indutny","message":"tjfontaine: huh?","date":"2013-02-20T19:37:35.617Z","type":"message"}
{"nick":"bnoordhuis","message":"tjfontaine: it won't be after i'm done with it","date":"2013-02-20T19:37:49.922Z","type":"message"}
{"nick":"indutny","message":"trevnorris: is it happening before openssl update?","date":"2013-02-20T19:37:52.764Z","type":"message"}
{"nick":"tjfontaine","message":"indutny: I'll roll back and find out","date":"2013-02-20T19:38:04.994Z","type":"message"}
{"nick":"indutny","message":"thanks","date":"2013-02-20T19:38:12.306Z","type":"message"}
{"nick":"trevnorris","message":"indutny: i created a special test that forces the watermarks to be set to null. happens from the first time the test is supported (around 0.9.4).","date":"2013-02-20T19:38:24.465Z","type":"message"}
{"nick":"indutny","message":"what test are you talking about?","date":"2013-02-20T19:38:48.682Z","type":"message"}
{"nick":"trevnorris","message":"generating the Abort from test-http-get-pipeline-problem","date":"2013-02-20T19:39:15.158Z","type":"message"}
{"nick":"isaacs","message":"Raynos: you know... i thought there was one, and it seemed like a good idea at the time, but maybe LWM is just stupid.","date":"2013-02-20T19:39:25.969Z","type":"message"}
{"nick":"isaacs","message":"Raynos: since we end up setting it to 0 all the time anyway","date":"2013-02-20T19:39:35.296Z","type":"message"}
{"nick":"isaacs","message":"Raynos: but maybe, you wantto buffer up a certain amount of data before you start doing stuff?","date":"2013-02-20T19:39:50.297Z","type":"message"}
{"nick":"Raynos","message":"well","date":"2013-02-20T19:39:54.975Z","type":"message"}
{"nick":"Raynos","message":"what I thought was","date":"2013-02-20T19:39:57.157Z","type":"message"}
{"nick":"Raynos","message":"hwm is stop pushing stuff into the buffer","date":"2013-02-20T19:40:04.072Z","type":"message"}
{"nick":"benoitc","date":"2013-02-20T19:40:09.554Z","type":"join"}
{"nick":"isaacs","message":"Raynos: or, in theory, you could use that to buffer up some data and make one big write instead of a lot of little ones, but we still make a lot of little writes anyway","date":"2013-02-20T19:40:11.947Z","type":"message"}
{"nick":"Raynos","message":"and lwm is \"buffer is halfway empty, pre-emptively start reading again\"","date":"2013-02-20T19:40:13.434Z","type":"message"}
{"nick":"isaacs","message":"right","date":"2013-02-20T19:40:26.795Z","type":"message"}
{"nick":"Raynos","message":"but its not","date":"2013-02-20T19:40:30.391Z","type":"message"}
{"nick":"isaacs","message":"but we just treat hwm as \"pleae try to be buffered up to this amount\"","date":"2013-02-20T19:40:36.213Z","type":"message"}
{"nick":"Raynos","message":"lwm is \"buffer is halfway full, writer start consuming\"","date":"2013-02-20T19:40:39.704Z","type":"message"}
{"nick":"isaacs","message":"in practice, that's actually what you want.","date":"2013-02-20T19:40:43.203Z","type":"message"}
{"nick":"isaacs","message":"lwm is \"we have enough for you to start consuming this now\"","date":"2013-02-20T19:40:54.825Z","type":"message"}
{"nick":"isaacs","message":"in practice, you want that to be 0, pretty much always.","date":"2013-02-20T19:41:01.275Z","type":"message"}
{"nick":"isaacs","message":"if you have ANY data, you're readable, period.","date":"2013-02-20T19:41:05.754Z","type":"message"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-02-20T19:41:23.799Z","type":"quit"}
{"nick":"isaacs","message":"we can probably replace hwm/lwm with just \"bufferTarget\" or something more explanatory.","date":"2013-02-20T19:41:28.786Z","type":"message"}
{"nick":"Raynos","message":"also 16000 objects is a silly default for objectMode, I'm writing Raynos/read-stream and defaulting hwm to 100. Any opinions on what's a sensible default for objects?","date":"2013-02-20T19:41:29.133Z","type":"message"}
{"nick":"isaacs","message":"yeah, for srs.","date":"2013-02-20T19:41:35.674Z","type":"message"}
{"nick":"isaacs","message":"the defaults make sense for bytes/strings, but NOT for objects.","date":"2013-02-20T19:41:50.246Z","type":"message"}
{"nick":"Raynos","message":"lwm is useful for zip no?","date":"2013-02-20T19:41:51.685Z","type":"message"}
{"nick":"isaacs","message":"they're insanely high","date":"2013-02-20T19:41:53.339Z","type":"message"}
{"nick":"isaacs","message":"why is it useful for zip?","date":"2013-02-20T19:42:01.664Z","type":"message"}
{"nick":"Raynos","message":"zip shouldn't start trying to compress the data","date":"2013-02-20T19:42:09.440Z","type":"message"}
{"nick":"Raynos","message":"until it has at least N","date":"2013-02-20T19:42:12.500Z","type":"message"}
{"nick":"Raynos","message":"i would assume that compression is more efficient with larger chunks at a time","date":"2013-02-20T19:42:26.033Z","type":"message"}
{"nick":"trevnorris","message":"indutny: just to double check. the fd's for two pids aren't going to be the same in this case, right?","date":"2013-02-20T19:42:33.575Z","type":"message"}
{"nick":"isaacs","message":"Raynos: no, that's handled all by the underlying layer anyway","date":"2013-02-20T19:42:34.384Z","type":"message"}
{"nick":"Raynos","message":"I feel that lwm isn't something a source should set, its something the consumer should set","date":"2013-02-20T19:42:38.506Z","type":"message"}
{"nick":"isaacs","message":"Raynos: and we write it one byte at a time, if that's what you write to us anyway","date":"2013-02-20T19:42:46.345Z","type":"message"}
{"nick":"Raynos","message":"the consumer should care about the minimum amount of data it wants in one chunk","date":"2013-02-20T19:42:49.392Z","type":"message"}
{"nick":"isaacs","message":"right","date":"2013-02-20T19:42:52.504Z","type":"message"}
{"nick":"isaacs","message":"Raynos: well, i mean, you set all of them.","date":"2013-02-20T19:43:03.734Z","type":"message"}
{"nick":"isaacs","message":"Raynos: but the default should always be zero.","date":"2013-02-20T19:43:09.234Z","type":"message"}
{"nick":"isaacs","message":"but it's a feature we don't really need.","date":"2013-02-20T19:43:13.953Z","type":"message"}
{"nick":"isaacs","message":"like, if you don't want to read, don't read.","date":"2013-02-20T19:43:18.004Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: some buffer.copy benchmarks would be rad.","date":"2013-02-20T19:44:22.533Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: [pid  8150] epoll_ctl(5, EPOLL_CTL_DEL, 16, {EPOLLIN, {u32=16, u64=16}} <unfinished ...>","date":"2013-02-20T19:44:29.604Z","type":"message"}
{"nick":"bnoordhuis","message":"[pid  8153] <... open resumed> )        = 16","date":"2013-02-20T19:44:32.609Z","type":"message"}
{"nick":"bnoordhuis","message":"[pid  8150] <... epoll_ctl resumed> )   = -1 EPERM (Operation not permitted)","date":"2013-02-20T19:44:35.130Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: we have an insane number of buffer.writeSomeType() and buffer.readSomeType() tests.","date":"2013-02-20T19:44:42.137Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: but not buffer.copy, which we do a LOT","date":"2013-02-20T19:44:48.603Z","type":"message"}
{"nick":"bnoordhuis","message":"EPERM on EPOLL_CTL_DEL, that's mighty odd","date":"2013-02-20T19:44:48.794Z","type":"message"}
{"nick":"tjfontaine","message":"indutny: this is probably related to the systems openssl missing the ca chain","date":"2013-02-20T19:46:03.450Z","type":"message"}
{"nick":"tjfontaine","message":"indutny: so mind it not","date":"2013-02-20T19:46:07.686Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: for example, this 4811 PR... showing a slight decrease in buffer benchmarks (less than jitter, probably just my fans turned on or something)","date":"2013-02-20T19:46:21.846Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: but a slight *increase* in http benchmarks (which is what actually matters anyway), owing mostly (i presume) to making copy faster.","date":"2013-02-20T19:46:50.096Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: so, i'm landing it :)","date":"2013-02-20T19:47:00.531Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: thanks.","date":"2013-02-20T19:47:15.367Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: here are the tests I created previously: https://github.com/trevnorris/node-timer/blob/master/suit/buffer/buffer_copy.js","date":"2013-02-20T19:48:03.372Z","type":"message"}
{"nick":"loladiro","date":"2013-02-20T19:48:11.049Z","type":"join"}
{"nick":"trevnorris","message":"wait. the names on those don't make sense. i need to revisit them.","date":"2013-02-20T19:50:00.551Z","type":"message"}
{"nick":"trevnorris","message":"anyways. i can throw in a pr for buffer copy tests.","date":"2013-02-20T19:50:12.747Z","type":"message"}
{"nick":"indutny","message":"trevnorris: ok :)","date":"2013-02-20T19:50:35.654Z","type":"message"}
{"nick":"indutny","message":"trevnorris: I'm asking because I've run `make test` on smartos","date":"2013-02-20T19:50:46.518Z","type":"message"}
{"nick":"trevnorris","message":"indutny: ah, yeah. i'll attach the test that I'm currently using. maybe you can reproduce. one sec.","date":"2013-02-20T19:51:18.246Z","type":"message"}
{"nick":"trevnorris","message":"indutny: here's the test: https://gist.github.com/trevnorris/4998562","date":"2013-02-20T19:52:17.627Z","type":"message"}
{"nick":"trevnorris","message":"if you could reproduce the abort i would feel a lot more sane.","date":"2013-02-20T19:52:33.715Z","type":"message"}
{"nick":"EhevuTov","date":"2013-02-20T19:52:40.983Z","type":"join"}
{"nick":"bnoordhuis","message":"trevnorris: re https://gist.github.com/trevnorris/4998562/raw/bf7262f31bfd3e716633a29e50d0faf8c562cb77/http-test.log <- do you have the complete log?","date":"2013-02-20T19:52:53.190Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: sure. let me throw it up.","date":"2013-02-20T19:53:16.333Z","type":"message"}
{"nick":"bnoordhuis","message":"i think i know what's happening","date":"2013-02-20T19:54:10.480Z","type":"message"}
{"nick":"txdv","message":"bnoordhuis: review the udp commit please, I am too tired to finish the timers today","date":"2013-02-20T19:54:31.581Z","type":"message"}
{"nick":"bnoordhuis","message":"[pid  8153] open(\"/etc/hosts\", O_RDONLY|O_CLOEXEC <unfinished ...> <- that happens right before the epoll_ctl call in another thread","date":"2013-02-20T19:54:32.620Z","type":"message"}
{"nick":"bnoordhuis","message":"and the fd it creates is #16, the same one epoll_ctl is barfing on","date":"2013-02-20T19:54:50.867Z","type":"message"}
{"nick":"bnoordhuis","message":"ah, thread race - my old foo","date":"2013-02-20T19:55:01.251Z","type":"message"}
{"nick":"tjfontaine","message":"indutny: I think you're getting me and trevnorris mixed up sometimes, :)","date":"2013-02-20T19:55:32.100Z","type":"message"}
{"nick":"bnoordhuis","message":"i guess the only thing to do is ignore all epoll_ctl errors there","date":"2013-02-20T19:55:42.952Z","type":"message"}
{"nick":"bnoordhuis","message":"it's always so obvious in hindsight, isn't it?","date":"2013-02-20T19:56:29.855Z","type":"message"}
{"nick":"kuebk","date":"2013-02-20T19:56:46.839Z","type":"join"}
{"nick":"trevnorris","message":"bnoordhuis: so is this a kernel problem or a libuv problem?","date":"2013-02-20T19:57:28.539Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: a libuv problem","date":"2013-02-20T19:57:39.022Z","type":"message"}
{"nick":"bnoordhuis","message":"one that's easily fixed though","date":"2013-02-20T19:57:43.813Z","type":"message"}
{"nick":"`3rdEden","date":"2013-02-20T19:57:45.431Z","type":"join"}
{"nick":"trevnorris","message":"coolio.","date":"2013-02-20T19:58:10.839Z","type":"message"}
{"nick":"mikeal","date":"2013-02-20T19:58:58.200Z","type":"join"}
{"nick":"isaacs","message":"bnoordhuis: beat me to it :)","date":"2013-02-20T19:59:21.250Z","type":"message"}
{"nick":"mikeal","reason":"Read error: Connection reset by peer","date":"2013-02-20T19:59:22.989Z","type":"quit"}
{"nick":"isaacs","message":"bnoordhuis: i'd added the pr/* refs to my node-master git checkout, and it took about 20 minutes to download all the pr refs","date":"2013-02-20T19:59:55.434Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: [pid  8150] epoll_ctl(5, EPOLL_CTL_ADD, 15, {EPOLLOUT, {u32=15, u64=15}}) = 0 is the last added","date":"2013-02-20T20:01:12.568Z","type":"message"}
{"nick":"trevnorris","message":"but after is [pid  8150] epoll_wait(5, {{EPOLLIN, {u32=8, u64=8}}, {EPOLLIN, {u32=16, u64=16}}, ","date":"2013-02-20T20:01:16.926Z","type":"message"}
{"nick":"trevnorris","message":"so is that adding an epoll for an fd that hasn't been created yet?","date":"2013-02-20T20:01:34.791Z","type":"message"}
{"nick":"mikeal","date":"2013-02-20T20:02:37.198Z","type":"join"}
{"nick":"brson","reason":"Ping timeout: 255 seconds","date":"2013-02-20T20:03:38.453Z","type":"quit"}
{"nick":"bnoordhuis","message":"trevnorris: no, that's epoll_wait - wait until events happen on the watched file descriptors","date":"2013-02-20T20:03:59.082Z","type":"message"}
{"nick":"bnoordhuis","message":"fd 5 is the epoll fd here","date":"2013-02-20T20:04:15.299Z","type":"message"}
{"nick":"brson","date":"2013-02-20T20:04:20.049Z","type":"join"}
{"nick":"bnoordhuis","message":"8 and 16 are events that are (presumably) readable because they have EPOLLIN set","date":"2013-02-20T20:05:06.895Z","type":"message"}
{"nick":"bnoordhuis","message":"s/events/fds/","date":"2013-02-20T20:05:13.585Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2013-02-20T20:05:23.627Z","type":"quit"}
{"nick":"trevnorris","message":"bnoordhuis: ok, are fd's always created in assending order? (e.g. 1, 2, 3, ...)","date":"2013-02-20T20:05:52.169Z","type":"message"}
{"nick":"Raynos","message":"any suggested fix for this? (https://github.com/isaacs/readable-stream/issues/49), TooTallNate, isaacs","date":"2013-02-20T20:06:14.574Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: yes, except that holes are filled","date":"2013-02-20T20:06:38.474Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: if you open 1,2,3,4,5,6 then close 5, then open a new one, it's 5, not 7","date":"2013-02-20T20:06:49.720Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: i was planning on floating patches on top of readable-stream","date":"2013-02-20T20:06:55.116Z","type":"message"}
{"nick":"trevnorris","message":"dude, it was a complete fluke that i got that strace. haven't been able to reproduce it since.","date":"2013-02-20T20:06:56.216Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: because posix is OCD sometimes","date":"2013-02-20T20:06:57.880Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: to support v0.8.x","date":"2013-02-20T20:07:01.239Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: so patch welcome :)","date":"2013-02-20T20:07:13.285Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: often introducing strace or gdb makes things disappear","date":"2013-02-20T20:07:25.159Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: ok, make sense.","date":"2013-02-20T20:07:30.308Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: yeah, thought that's what would happen, but the stars aligned and I reproduced it the first time. haven't been able to since.","date":"2013-02-20T20:08:03.920Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: good thing you kept the log :P","date":"2013-02-20T20:09:12.960Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: ok. here's a really strange one. just figured out that I can reproduce it almost every time if the file is open in vim.","date":"2013-02-20T20:09:53.472Z","type":"message"}
{"nick":"trevnorris","message":"if I close the file then I can't reproduce it.","date":"2013-02-20T20:09:59.279Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: the new fd is always the lowest one available","date":"2013-02-20T20:10:10.234Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: if you have fds 0-10, you close fd 2, then open a new file, it'll use fd 2","date":"2013-02-20T20:10:30.908Z","type":"message"}
{"nick":"tjfontaine","message":"trevnorris: does strace confirm it's eperm?","date":"2013-02-20T20:10:36.319Z","type":"message"}
{"nick":"bnoordhuis","message":"it's per process so when you have more than one thread it's unpredictable","date":"2013-02-20T20:11:05.002Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: fwiw i did this last week but we decided it shouldn't go into node-core https://github.com/TooTallNate/node/compare/fix/readable-v0.8.x","date":"2013-02-20T20:11:47.486Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine, bnoordhuis: here's a more complete log: http://git.io/2Dre3Q","date":"2013-02-20T20:12:22.534Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: yeah. it's eperm.","date":"2013-02-20T20:12:31.152Z","type":"message"}
{"nick":"AvianFlu_","date":"2013-02-20T20:12:37.254Z","type":"join"}
{"nick":"AvianFlu","reason":"Read error: Connection reset by peer","date":"2013-02-20T20:12:50.426Z","type":"quit"}
{"nick":"bnoordhuis","message":"yeah, it's trying to delete fd 12 from the epoll set","date":"2013-02-20T20:13:29.802Z","type":"message"}
{"nick":"bnoordhuis","message":"but that's a regular file descriptor refering to /etc/hosts by then","date":"2013-02-20T20:13:40.930Z","type":"message"}
{"nick":"benoitc","reason":"Excess Flood","date":"2013-02-20T20:13:56.571Z","type":"quit"}
{"nick":"bnoordhuis","message":"simple/test-http-destroyed-socket-write is failing for me on linux","date":"2013-02-20T20:14:36.051Z","type":"message"}
{"nick":"bnoordhuis","message":"as is simple/test-http-agent-destroyed-socket.js","date":"2013-02-20T20:15:01.292Z","type":"message"}
{"nick":"indutny","message":"tjfontaine: yes","date":"2013-02-20T20:15:14.636Z","type":"message"}
{"nick":"indutny","message":"tjfontaine: you're both on T","date":"2013-02-20T20:15:20.668Z","type":"message"}
{"nick":"tjfontaine","message":"gonna have to use tj :P","date":"2013-02-20T20:15:29.421Z","type":"message"}
{"nick":"bnoordhuis","message":"let me do a clean rebuild first, just in case","date":"2013-02-20T20:15:32.674Z","type":"message"}
{"nick":"tjfontaine","message":"and our lengths are the same","date":"2013-02-20T20:15:35.644Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: have you seen private chat?","date":"2013-02-20T20:15:54.150Z","type":"message"}
{"nick":"bnoordhuis","message":"i have now","date":"2013-02-20T20:16:15.393Z","type":"message"}
{"nick":"Raynos","message":"TooTallNate: https://github.com/isaacs/readable-stream/pull/50","date":"2013-02-20T20:16:50.724Z","type":"message"}
{"nick":"Raynos","message":"tests pass again now","date":"2013-02-20T20:16:56.492Z","type":"message"}
{"nick":"TooTallNate","message":"awesome","date":"2013-02-20T20:17:43.820Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: while you're at it… i know i didn't pull all the tests from node-master","date":"2013-02-20T20:17:55.899Z","type":"message"}
{"nick":"Raynos","message":":D","date":"2013-02-20T20:18:01.907Z","type":"message"}
{"nick":"TooTallNate","message":"if you feel like copything them over that'd be baller :)","date":"2013-02-20T20:18:07.661Z","type":"message"}
{"nick":"TooTallNate","message":"copying","date":"2013-02-20T20:18:16.697Z","type":"message"}
{"nick":"TooTallNate","message":"that is","date":"2013-02-20T20:18:20.293Z","type":"message"}
{"nick":"EhevuTov","reason":"Quit: This computer has gone to sleep","date":"2013-02-20T20:18:30.110Z","type":"quit"}
{"nick":"trevnorris","message":"bnoordhuis: after EPERM is thrown, how can it \"<... read resumed> \"127.0.0.1\\tlocalhost\\n127.0.1.1\\tmo\"..., 4096) = 252\" on the same fd?","date":"2013-02-20T20:19:07.424Z","type":"message"}
{"nick":"trevnorris","message":"it looks like it's still getting information.","date":"2013-02-20T20:19:29.979Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: because that's another thread doing it","date":"2013-02-20T20:19:37.060Z","type":"message"}
{"nick":"bnoordhuis","message":"what happens is that thread #1 closes the fd, thread #2 opens a file and gets that fd assigned, #1 tries to EPOLL_CTL_DEL it and gets the EPERM error","date":"2013-02-20T20:20:10.991Z","type":"message"}
{"nick":"EhevuTov","date":"2013-02-20T20:20:21.561Z","type":"join"}
{"nick":"tjfontaine","message":"ugh.","date":"2013-02-20T20:20:26.369Z","type":"message"}
{"nick":"bnoordhuis","message":"i should mention that when you close a fd, it's automatically removed from any epoll sets","date":"2013-02-20T20:20:42.742Z","type":"message"}
{"nick":"bnoordhuis","message":"but libuv can't always know that","date":"2013-02-20T20:20:48.924Z","type":"message"}
{"nick":"trevnorris","message":"ah, ok.","date":"2013-02-20T20:21:01.259Z","type":"message"}
{"nick":"Raynos","message":"TooTallNate: doing so","date":"2013-02-20T20:21:15.168Z","type":"message"}
{"nick":"trevnorris","message":"man, threads make life a lot more complicated.","date":"2013-02-20T20:21:16.469Z","type":"message"}
{"nick":"bnoordhuis","message":"they do","date":"2013-02-20T20:21:21.447Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: oh shit","date":"2013-02-20T20:21:31.208Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: so its like crashing in the middle of open()/accept() ?","date":"2013-02-20T20:21:47.874Z","type":"message"}
{"nick":"benoitc","date":"2013-02-20T20:23:09.741Z","type":"join"}
{"nick":"bnoordhuis","message":"indutny: kind of. the strace output makes it look like the open happens after epoll_ctl","date":"2013-02-20T20:23:33.955Z","type":"message"}
{"nick":"indutny","message":"interesting","date":"2013-02-20T20:23:45.443Z","type":"message"}
{"nick":"bnoordhuis","message":"but in reality, it's more or less concurrent with the open finishing just before the epoll_ctl","date":"2013-02-20T20:23:56.262Z","type":"message"}
{"nick":"indutny","message":"but this doesn't explain while fd doesn't support epoll","date":"2013-02-20T20:23:58.237Z","type":"message"}
{"nick":"bnoordhuis","message":"well, it refers to a regular file","date":"2013-02-20T20:24:06.083Z","type":"message"}
{"nick":"indutny","message":"and?","date":"2013-02-20T20:24:09.837Z","type":"message"}
{"nick":"indutny","message":"it should support it","date":"2013-02-20T20:24:14.229Z","type":"message"}
{"nick":"bnoordhuis","message":"those are indeed not pollable","date":"2013-02-20T20:24:14.370Z","type":"message"}
{"nick":"indutny","message":"huh?","date":"2013-02-20T20:24:20.250Z","type":"message"}
{"nick":"indutny","message":"oh","date":"2013-02-20T20:24:49.213Z","type":"message"}
{"nick":"indutny","message":"right","date":"2013-02-20T20:24:51.883Z","type":"message"}
{"nick":"trevnorris","message":"indutny: here's the complete strace from the moment the socket is opened that causes the abort(): http://git.io/ROsomQ","date":"2013-02-20T20:25:15.204Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: in the current trace, fstat() is returning EPERM. that have to do with epoll?","date":"2013-02-20T20:26:43.207Z","type":"message"}
{"nick":"indexzero","date":"2013-02-20T20:27:01.899Z","type":"join"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u0002ce7b100\u0002 : deps: upgrade libuv to dafc20f - http://git.io/VrnyWw","date":"2013-02-20T20:29:12.041Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: no, that's just a regular error","date":"2013-02-20T20:29:13.465Z","type":"message"}
{"nick":"MI61","message":"\u0002joyent/libuv:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u000226fa6f8\u0002 : linux: fix abort() on epoll_ctl() race condition  Don't check the return  - http://git.io/aOR9bQ","date":"2013-02-20T20:29:21.003Z","type":"message"}
{"nick":"bnoordhuis","message":"ey, the commit hash is wrong","date":"2013-02-20T20:29:36.338Z","type":"message"}
{"nick":"bnoordhuis","message":"sorry, force push coming up","date":"2013-02-20T20:29:43.111Z","type":"message"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u00026ad7926\u0002 : deps: upgrade libuv to 26fa6f8 - http://git.io/HhClmw","date":"2013-02-20T20:30:16.985Z","type":"message"}
{"nick":"trevnorris","message":"so the EPERM isn't causing the SIGABRT?","date":"2013-02-20T20:30:34.305Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: rebase and recompile, it should be fixed now","date":"2013-02-20T20:31:13.237Z","type":"message"}
{"nick":"indutny","message":"kewl","date":"2013-02-20T20:31:52.228Z","type":"message"}
{"nick":"indutny","message":"thanks ben","date":"2013-02-20T20:31:55.463Z","type":"message"}
{"nick":"trevnorris","message":"ah, mother. bnoordhuis ok. i see. didn't take enough notice to how the lines between pids are all intermingled.","date":"2013-02-20T20:32:41.762Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: thanks. you can probably close 4558 now too.","date":"2013-02-20T20:33:50.004Z","type":"message"}
{"nick":"bnoordhuis","message":"already have :)","date":"2013-02-20T20:34:00.373Z","type":"message"}
{"nick":"trevnorris","message":"oh, heh.","date":"2013-02-20T20:34:10.757Z","type":"message"}
{"nick":"TheJH","reason":"Read error: Operation timed out","date":"2013-02-20T20:34:31.778Z","type":"quit"}
{"nick":"trevnorris","message":"awesome. just ran it 100 times. it's good. thanks a ton.","date":"2013-02-20T20:35:25.789Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: think this is worth changing: https://github.com/trevnorris/node/compare/minor-cleanups","date":"2013-02-20T20:38:15.960Z","type":"message"}
{"nick":"bradleymeck","date":"2013-02-20T20:39:20.971Z","type":"join"}
{"nick":"piscisaureus_","date":"2013-02-20T20:40:17.991Z","type":"join"}
{"nick":"piscisaureus_","message":"how do people learn wix?","date":"2013-02-20T20:40:38.732Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: hm, that check looks bogus to me. lenght == Buffer::Length(buf) so that means it's never > Buffer::kMaxLength","date":"2013-02-20T20:41:28.184Z","type":"message"}
{"nick":"bnoordhuis","message":"or INT_MAX, for that matter","date":"2013-02-20T20:41:33.492Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: oh, lol. you're right.","date":"2013-02-20T20:41:56.603Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: and is there a 1 liner of why isn't necessary to \"new char\" on every call to WriteBuffer? that method is being called a lot in http and net.","date":"2013-02-20T20:43:12.871Z","type":"message"}
{"nick":"trevnorris","message":" /isn't/it's/","date":"2013-02-20T20:43:25.639Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: come again?","date":"2013-02-20T20:43:54.884Z","type":"message"}
{"nick":"bnoordhuis","message":"oh, i see what you mean (i think)","date":"2013-02-20T20:44:41.802Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: there's a \"char* storage = new char[sizeof(WriteWrap)];\", and while I see where it's used. i thought that \"new char\" is essentially a malloc, and that's going to be an expensive task for something called so often.","date":"2013-02-20T20:44:47.262Z","type":"message"}
{"nick":"bnoordhuis","message":"yeah, but you can't get around it","date":"2013-02-20T20:44:59.639Z","type":"message"}
{"nick":"trevnorris","message":":(","date":"2013-02-20T20:45:06.022Z","type":"message"}
{"nick":"trevnorris","message":"ok","date":"2013-02-20T20:45:08.591Z","type":"message"}
{"nick":"bnoordhuis","message":"the WriteWrap needs to be stored somewhere","date":"2013-02-20T20:45:33.942Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: guess I was naively thinking something like how we pool buffers.","date":"2013-02-20T20:45:58.967Z","type":"message"}
{"nick":"bnoordhuis","message":"WriteWrap don't have a fixed size","date":"2013-02-20T20:46:20.585Z","type":"message"}
{"nick":"bnoordhuis","message":"*WriteWraps","date":"2013-02-20T20:46:29.589Z","type":"message"}
{"nick":"bnoordhuis","message":"but i guess you could cache them in a buddy list or somethig","date":"2013-02-20T20:46:49.972Z","type":"message"}
{"nick":"bnoordhuis","message":"or a first-fit kind of list","date":"2013-02-20T20:47:09.432Z","type":"message"}
{"nick":"trevnorris","message":"ok, so sideof(<someclass>) isn't always the same size?","date":"2013-02-20T20:47:51.324Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: look closely at the code :)","date":"2013-02-20T20:48:04.443Z","type":"message"}
{"nick":"bnoordhuis","message":"what it does is new a WriteWrap + variable storage","date":"2013-02-20T20:48:16.604Z","type":"message"}
{"nick":"bnoordhuis","message":"oh, maybe not in WriteBuffer","date":"2013-02-20T20:48:40.387Z","type":"message"}
{"nick":"bnoordhuis","message":"but it does that elsewhere in stream_wrap.cc","date":"2013-02-20T20:48:46.614Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: wht if we'll allocate WriteWraps in zones?","date":"2013-02-20T20:48:55.723Z","type":"message"}
{"nick":"indutny","message":"and kill them all at once","date":"2013-02-20T20:48:59.931Z","type":"message"}
{"nick":"indutny","message":"sort of \"slab buffer\"","date":"2013-02-20T20:49:14.214Z","type":"message"}
{"nick":"indutny","message":"so its like 1mb chunk","date":"2013-02-20T20:49:33.660Z","type":"message"}
{"nick":"indutny","message":"and we'll allocate data sequentially","date":"2013-02-20T20:49:40.040Z","type":"message"}
{"nick":"bnoordhuis","message":"that could work","date":"2013-02-20T20:49:57.105Z","type":"message"}
{"nick":"indutny","message":"and then remove that chunk after all writewraps ended","date":"2013-02-20T20:49:57.403Z","type":"message"}
{"nick":"indutny","message":"this is how v8 and all others allocating memory","date":"2013-02-20T20:50:08.323Z","type":"message"}
{"nick":"indutny","message":"pretty fast method","date":"2013-02-20T20:50:15.721Z","type":"message"}
{"nick":"indutny","message":"though, we're solving our problems at the price of memory overhead","date":"2013-02-20T20:50:28.098Z","type":"message"}
{"nick":"bnoordhuis","message":"yep","date":"2013-02-20T20:50:32.112Z","type":"message"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-20T20:50:39.961Z","type":"quit"}
{"nick":"bnoordhuis","message":"and it has the same issue as the regular slab allocator","date":"2013-02-20T20:50:41.595Z","type":"message"}
{"nick":"bnoordhuis","message":"if one writewrap lags behind, the whole chunk / zone is tied up","date":"2013-02-20T20:50:58.485Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-20T20:51:12.581Z","type":"message"}
{"nick":"indutny","message":"that's the deal","date":"2013-02-20T20:51:18.802Z","type":"message"}
{"nick":"indutny","message":"so","date":"2013-02-20T20:51:24.883Z","type":"message"}
{"nick":"indutny","message":"on other hand we have free list","date":"2013-02-20T20:51:30.604Z","type":"message"}
{"nick":"indutny","message":"but it's essentially the same thing as malloc()","date":"2013-02-20T20:51:39.311Z","type":"message"}
{"nick":"indutny","message":"and should not be much faster than it","date":"2013-02-20T20:51:48.024Z","type":"message"}
{"nick":"brson","reason":"Remote host closed the connection","date":"2013-02-20T20:54:13.368Z","type":"quit"}
{"nick":"trevnorris","message":"excuse my c++ newbness, but can someone explain \"new (storage) WriteWrap()\"? I don't get the \"(storage)\" part.","date":"2013-02-20T20:54:23.882Z","type":"message"}
{"nick":"bnoordhuis","message":"the mouse is sitting right in front of me...","date":"2013-02-20T20:56:10.971Z","type":"message"}
{"nick":"bnoordhuis","message":"curses!","date":"2013-02-20T20:56:27.812Z","type":"message"}
{"nick":"bnoordhuis","message":"nearly had it","date":"2013-02-20T20:56:30.904Z","type":"message"}
{"nick":"bnoordhuis","message":"trevnorris: it's placement new","date":"2013-02-20T20:57:52.669Z","type":"message"}
{"nick":"bnoordhuis","message":"it says \"create a new object at this location\"","date":"2013-02-20T20:58:05.978Z","type":"message"}
{"nick":"bnoordhuis","message":"in this case wherever storage points t","date":"2013-02-20T20:58:12.540Z","type":"message"}
{"nick":"bnoordhuis","message":"*to","date":"2013-02-20T20:58:13.983Z","type":"message"}
{"nick":"trevnorris","message":"cool. thanks.","date":"2013-02-20T20:58:34.179Z","type":"message"}
{"nick":"trevnorris","message":"i google what I can, but when you don't know the name search engines kind of suck.","date":"2013-02-20T21:00:21.459Z","type":"message"}
{"nick":"bradleymeck_","date":"2013-02-20T21:00:23.652Z","type":"join"}
{"nick":"indutny","message":"well","date":"2013-02-20T21:02:57.152Z","type":"message"}
{"nick":"indutny","message":"its called other way","date":"2013-02-20T21:03:00.096Z","type":"message"}
{"nick":"indutny","message":"\"When you don't know what to search, search engines can't find anything\"","date":"2013-02-20T21:03:09.488Z","type":"message"}
{"nick":"bradleymeck","reason":"Ping timeout: 272 seconds","date":"2013-02-20T21:03:14.815Z","type":"quit"}
{"nick":"bradleymeck_","new_nick":"bradleymeck","date":"2013-02-20T21:03:14.966Z","type":"nick"}
{"nick":"AvianFlu_","new_nick":"AvianFlu","date":"2013-02-20T21:04:49.904Z","type":"nick"}
{"nick":"trevnorris","message":"indutny: so you were saying that chunking isn't going to be much faster than malloc'ing every time?","date":"2013-02-20T21:05:20.590Z","type":"message"}
{"nick":"indutny","message":"define \"chunking\"","date":"2013-02-20T21:05:39.719Z","type":"message"}
{"nick":"indutny","message":"I said maintaining freelist won't be faster than malloc","date":"2013-02-20T21:05:53.133Z","type":"message"}
{"nick":"indutny","message":"because that's what malloc does","date":"2013-02-20T21:05:57.632Z","type":"message"}
{"nick":"trevnorris","message":"oh, got it.","date":"2013-02-20T21:06:17.416Z","type":"message"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u0002b353869\u0002 : stream_wrap: remove superfluous buffer len check  It's a buffer so it's n - http://git.io/zmcFjw","date":"2013-02-20T21:09:09.410Z","type":"message"}
{"nick":"bnoordhuis","message":"indutny: yes, but malloc() has to lock everything","date":"2013-02-20T21:09:24.015Z","type":"message"}
{"nick":"indutny","message":"meh","date":"2013-02-20T21:09:31.207Z","type":"message"}
{"nick":"indutny","message":"spin locks","date":"2013-02-20T21:09:32.695Z","type":"message"}
{"nick":"bnoordhuis","message":"no, full blown mutexes","date":"2013-02-20T21:09:40.039Z","type":"message"}
{"nick":"indutny","message":"its not that much","date":"2013-02-20T21:09:42.080Z","type":"message"}
{"nick":"indutny","message":"huh, really?","date":"2013-02-20T21:09:46.006Z","type":"message"}
{"nick":"indutny","message":"is it spinning too much?","date":"2013-02-20T21:09:59.788Z","type":"message"}
{"nick":"bnoordhuis","message":"well, yes and no","date":"2013-02-20T21:10:02.602Z","type":"message"}
{"nick":"indutny","message":"hm...","date":"2013-02-20T21:10:14.519Z","type":"message"}
{"nick":"bnoordhuis","message":"it tries thread-local arenas first, then falls back to global allocs protected by a mutex","date":"2013-02-20T21:10:20.340Z","type":"message"}
{"nick":"indutny","message":"well, like everyone does :)","date":"2013-02-20T21:10:29.032Z","type":"message"}
{"nick":"indutny","message":"ok","date":"2013-02-20T21:10:37.221Z","type":"message"}
{"nick":"indutny","message":"I just thought it is using spin locks","date":"2013-02-20T21:10:44.326Z","type":"message"}
{"nick":"indutny","message":"but still I'm not convinced that maintaining our own free-list will help us much","date":"2013-02-20T21:11:05.330Z","type":"message"}
{"nick":"bnoordhuis","message":"only one way to find out","date":"2013-02-20T21:12:35.179Z","type":"message"}
{"nick":"trevnorris","message":"doesn't every, um, ~net connection have it's own StreamWrap instance?","date":"2013-02-20T21:13:57.657Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-20T21:13:58.020Z","type":"message"}
{"nick":"indutny","message":"lay down and watch how others implement it","date":"2013-02-20T21:14:03.732Z","type":"message"}
{"nick":"indutny","message":"trevnorris: yes","date":"2013-02-20T21:14:09.878Z","type":"message"}
{"nick":"trevnorris","message":"ok","date":"2013-02-20T21:14:53.725Z","type":"message"}
{"nick":"trevnorris","message":"bnoordhuis: line 312 stream_wrap.cc. can't NewFromUnsigned be passed node_isolate?","date":"2013-02-20T21:16:01.590Z","type":"message"}
{"nick":"bnoordhuis","message":"oh, i guess","date":"2013-02-20T21:16:26.370Z","type":"message"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033Ben Noordhuis\u000f \u00037master\u000f * \u00029d10bf5\u0002 : stream_wrap: remove superfluous buffer len check  It's a buffer so it's n - http://git.io/6DCkvQ","date":"2013-02-20T21:17:50.974Z","type":"message"}
{"nick":"mikeal","date":"2013-02-20T21:21:24.582Z","type":"join"}
{"nick":"dsantiago","reason":"Ping timeout: 248 seconds","date":"2013-02-20T21:25:08.723Z","type":"quit"}
{"nick":"`3rdEden","reason":"Remote host closed the connection","date":"2013-02-20T21:25:09.628Z","type":"quit"}
{"nick":"mikeal","reason":"Ping timeout: 276 seconds","date":"2013-02-20T21:26:39.443Z","type":"quit"}
{"nick":"`3rdEden","date":"2013-02-20T21:33:33.187Z","type":"join"}
{"nick":"kuebk","date":"2013-02-20T21:37:49.086Z","type":"quit"}
{"nick":"EhevuTov","reason":"Quit: This computer has gone to sleep","date":"2013-02-20T21:47:14.283Z","type":"quit"}
{"nick":"EhevuTov","date":"2013-02-20T21:47:40.700Z","type":"join"}
{"nick":"EhevuTov","reason":"Ping timeout: 255 seconds","date":"2013-02-20T21:52:05.459Z","type":"quit"}
{"nick":"mikeal","date":"2013-02-20T21:52:13.070Z","type":"join"}
{"nick":"piscisaureus_","reason":"Ping timeout: 276 seconds","date":"2013-02-20T21:54:18.814Z","type":"quit"}
{"nick":"mikeal","reason":"Ping timeout: 240 seconds","date":"2013-02-20T21:56:34.923Z","type":"quit"}
{"nick":"MI61","message":"\u0002joyent/node:\u0002 \u00033isaacs\u000f \u00037master\u000f * \u0002bbcb8b3\u0002 : path: Do not coerce paths to strings on Windows  Fix #4795 - http://git.io/dumBDg","date":"2013-02-20T22:04:49.849Z","type":"message"}
{"nick":"piscisaureus_","date":"2013-02-20T22:05:11.514Z","type":"join"}
{"nick":"mikeal","date":"2013-02-20T22:14:16.040Z","type":"join"}
{"nick":"wavded","date":"2013-02-20T22:19:38.147Z","type":"join"}
{"nick":"dsantiago","date":"2013-02-20T22:20:39.643Z","type":"join"}
{"nick":"wavded","reason":"Remote host closed the connection","date":"2013-02-20T22:21:23.754Z","type":"quit"}
{"nick":"wavded","date":"2013-02-20T22:21:35.296Z","type":"join"}
{"nick":"tjfontaine","message":"oh set process title is a noop on sunos, that's what the test fails","date":"2013-02-20T22:24:30.803Z","type":"message"}
{"nick":"tjfontaine","message":"is there a mechanism already in libuv test suite to skip tests based on platform?","date":"2013-02-20T22:25:02.971Z","type":"message"}
{"nick":"dsantiago","reason":"Ping timeout: 244 seconds","date":"2013-02-20T22:25:39.163Z","type":"quit"}
{"nick":"bnoordhuis","reason":"Ping timeout: 264 seconds","date":"2013-02-20T22:26:30.163Z","type":"quit"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-20T22:31:30.574Z","type":"quit"}
{"nick":"`3rdEden","reason":"Remote host closed the connection","date":"2013-02-20T22:46:07.321Z","type":"quit"}
{"nick":"wavded","reason":"Remote host closed the connection","date":"2013-02-20T22:47:22.928Z","type":"quit"}
{"nick":"wavded","date":"2013-02-20T22:50:31.602Z","type":"join"}
{"nick":"rendar","reason":"Quit: w hz","date":"2013-02-20T22:50:54.139Z","type":"quit"}
{"nick":"wavded","reason":"Remote host closed the connection","date":"2013-02-20T22:51:24.639Z","type":"quit"}
{"nick":"dsantiago","date":"2013-02-20T22:52:38.330Z","type":"join"}
{"nick":"trevnorris","message":"isaacs: \"this._events = this._events || null;\" <- when would this be defined?","date":"2013-02-20T22:55:23.975Z","type":"message"}
{"nick":"trevnorris","message":"well, nm. of course subclassing","date":"2013-02-20T22:56:36.481Z","type":"message"}
{"nick":"brson","date":"2013-02-20T22:56:39.072Z","type":"join"}
{"nick":"isaacs","message":"trevnorris: yep.","date":"2013-02-20T23:00:28.379Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: broke that briefly around 0.8.11 or something","date":"2013-02-20T23:00:38.564Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: the release that lived only a single day :)","date":"2013-02-20T23:00:48.716Z","type":"message"}
{"nick":"trevnorris","message":"i love that emit will throw an error about an error.","date":"2013-02-20T23:00:52.283Z","type":"message"}
{"nick":"trevnorris","message":"ah, that's what that was all about.","date":"2013-02-20T23:00:56.242Z","type":"message"}
{"nick":"hz","date":"2013-02-20T23:02:08.405Z","type":"quit"}
{"nick":"Raynos","message":"TooTallNate: added those tests o/","date":"2013-02-20T23:09:36.571Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: thanks dude! I'll pull in a bit when I get a second","date":"2013-02-20T23:09:59.595Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: so is \"if (!this._events.removeListener) {\" if someone did a \"<event>.on('removeListener', ...\"?","date":"2013-02-20T23:12:30.083Z","type":"message"}
{"nick":"trevnorris","message":"oh, I see it. nm.","date":"2013-02-20T23:13:20.515Z","type":"message"}
{"nick":"tjfontaine","message":"here's an interestingly racey test https://gist.github.com/tjfontaine/5000576","date":"2013-02-20T23:13:33.623Z","type":"message"}
{"nick":"trevnorris","message":"is it easily reproducible?","date":"2013-02-20T23:15:09.256Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: yeah","date":"2013-02-20T23:15:33.131Z","type":"message"}
{"nick":"tjfontaine","message":"at least on smartos","date":"2013-02-20T23:15:50.292Z","type":"message"}
{"nick":"isaacs","message":"yep, that's a race","date":"2013-02-20T23:16:08.948Z","type":"message"}
{"nick":"isaacs","message":"one second..","date":"2013-02-20T23:16:12.814Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: i see you added an optimizer for events that will only assign the function if it's the only one.","date":"2013-02-20T23:36:04.517Z","type":"message"}
{"nick":"trevnorris","message":"other than simplifying the logic, if I can show it would speed EventEmitter up, would you be game just always placing it into an array?","date":"2013-02-20T23:37:01.006Z","type":"message"}
{"nick":"Raynos","message":"TooTallNate: also need to update readable-stream with master again to pull in some bug fixes :D. ill PR that too and other stuff too","date":"2013-02-20T23:37:08.360Z","type":"message"}
{"nick":"AvianFlu","reason":"Ping timeout: 240 seconds","date":"2013-02-20T23:37:34.832Z","type":"quit"}
{"nick":"Raynos","message":"TooTallNate: how do I merge changes from master into readable-stream properly. I don't know enough about git >.<","date":"2013-02-20T23:39:15.673Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: i've just been `cp ~/node/lib/_stream_* ~/readable-stream/lib`","date":"2013-02-20T23:39:43.248Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: and then fixing the broken require() calls","date":"2013-02-20T23:39:52.928Z","type":"message"}
{"nick":"Raynos","message":"then you need to manually fix everything","date":"2013-02-20T23:39:54.683Z","type":"message"}
{"nick":"Raynos","message":"and also reapply patches","date":"2013-02-20T23:40:02.218Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: ya it's a PITA, something automated would be better :)","date":"2013-02-20T23:40:06.947Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: just pulled your patches so far","date":"2013-02-20T23:43:09.362Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: update to the v0.9.10's code ideally","date":"2013-02-20T23:43:24.039Z","type":"message"}
{"nick":"Raynos","message":"There is more to come!","date":"2013-02-20T23:43:26.308Z","type":"message"}
{"nick":"Raynos","message":"I updated to master","date":"2013-02-20T23:43:30.688Z","type":"message"}
{"nick":"Raynos","message":"or whatever is on master","date":"2013-02-20T23:43:34.167Z","type":"message"}
{"nick":"Raynos","message":"all tests pass","date":"2013-02-20T23:43:41.796Z","type":"message"}
{"nick":"TooTallNate","message":"ya i'm sure it's fine","date":"2013-02-20T23:43:47.665Z","type":"message"}
{"nick":"Raynos","message":"more bug fixes to come >_>","date":"2013-02-20T23:45:42.772Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: is this Buffer thing in node-core?","date":"2013-02-20T23:46:01.055Z","type":"message"}
{"nick":"Raynos","message":"nope","date":"2013-02-20T23:46:07.152Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: why doesn't browserify assume Buffer is a global like in node?","date":"2013-02-20T23:46:09.868Z","type":"message"}
{"nick":"Raynos","message":"because that's stupid, and people shouldn't globals","date":"2013-02-20T23:46:20.715Z","type":"message"}
{"nick":"TooTallNate","message":"well… node doesn't think so","date":"2013-02-20T23:46:39.902Z","type":"message"}
{"nick":"TooTallNate","message":"not about Buffer at least","date":"2013-02-20T23:46:43.149Z","type":"message"}
{"nick":"TooTallNate","message":"it's a \"primitive\"","date":"2013-02-20T23:46:46.568Z","type":"message"}
{"nick":"Raynos","message":"well yeah but I want to use readable-stream in browsers. I'd rather patch readable-stream then browserify","date":"2013-02-20T23:48:23.316Z","type":"message"}
{"nick":"Raynos","message":"TooTallNate, isaacs: https://gist.github.com/Raynos/5000773","date":"2013-02-20T23:48:52.699Z","type":"message"}
{"nick":"Raynos","message":"I think ^ is a bug with Readable","date":"2013-02-20T23:49:01.047Z","type":"message"}
{"nick":"TooTallNate","message":"Raynos: what's this? https://github.com/substack/node-browserify/pull/124","date":"2013-02-20T23:50:03.833Z","type":"message"}
{"nick":"Raynos","message":"that's requiring buffer in assert module. That's not assigning Buffer to a global","date":"2013-02-20T23:50:41.308Z","type":"message"}
{"nick":"TooTallNate","message":"oh","date":"2013-02-20T23:51:59.473Z","type":"message"}
{"nick":"TooTallNate","message":"well in any case… i thought browserify was supposed to run node code","date":"2013-02-20T23:52:15.711Z","type":"message"}
{"nick":"TooTallNate","message":"in the browser","date":"2013-02-20T23:52:19.820Z","type":"message"}
{"nick":"Raynos","message":"to an extent. but substack doesn't globals ( https://github.com/substack/node-browserify/pull/162 )","date":"2013-02-20T23:54:17.446Z","type":"message"}
{"nick":"Raynos","message":"We just PR require(\"buffer\") onto everything","date":"2013-02-20T23:54:26.899Z","type":"message"}
{"nick":"Raynos","message":"if you really don't want it you can remove it and I can ಠ_ಠ","date":"2013-02-20T23:55:02.795Z","type":"message"}
{"nick":"TooTallNate","message":"typical substack","date":"2013-02-20T23:55:33.980Z","type":"message"}
{"nick":"bnoordhuis","date":"2013-02-20T23:56:19.232Z","type":"join"}
{"nick":"isaacs","message":"bnoordhuis: why are we setting the buffer as a hidden value in streamwrap::WriteBuffer?","date":"2013-02-20T23:56:38.321Z","type":"message"}
