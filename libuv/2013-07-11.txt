{"nick":"ircretary","reason":"Remote host closed the connection","date":"2013-07-11T00:00:01.416Z","type":"quit"}
{"nick":"trevnorris","message":"tjfontaine: heh, thanks for the clarification.","date":"2013-07-11T00:00:06.879Z","type":"message"}
{"nick":"ircretary","date":"2013-07-11T00:00:08.153Z","type":"join"}
{"nick":"tjfontaine","message":"heh","date":"2013-07-11T00:00:32.956Z","type":"message"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-07-11T00:01:10.087Z","type":"quit"}
{"nick":"c4milo","date":"2013-07-11T00:02:04.912Z","type":"join"}
{"nick":"qard1","reason":"Quit: Leaving.","date":"2013-07-11T00:14:49.691Z","type":"quit"}
{"nick":"kazupon","date":"2013-07-11T00:15:06.708Z","type":"join"}
{"nick":"trevnorris","message":"dammit. I can't inherit from TCPWrap, and I can't find a way to get access to the protected members \"object()\" and \"persistent()\"","date":"2013-07-11T00:17:07.711Z","type":"message"}
{"nick":"trevnorris","message":"freakin class inheritance.","date":"2013-07-11T00:17:13.912Z","type":"message"}
{"nick":"TooTallNate","date":"2013-07-11T00:22:08.705Z","type":"join"}
{"nick":"isaacs","message":"oh, man, this bug wth EMFILE and ulimit -n is just fucking amazeballs","date":"2013-07-11T00:24:05.713Z","type":"message"}
{"nick":"isaacs","message":"so, for some silly reason, `npm outdated` is adding tarballs to the cache instead fo just reading the metadata like a gentleman.  whatever.","date":"2013-07-11T00:24:44.472Z","type":"message"}
{"nick":"isaacs","message":"but, what happens is this:","date":"2013-07-11T00:24:48.008Z","type":"message"}
{"nick":"isaacs","message":"it tries to fetch, let's say, 500 tarballs, at once","date":"2013-07-11T00:25:08.523Z","type":"message"}
{"nick":"isaacs","message":"for each one of those, what it's going to do then is write them to disk","date":"2013-07-11T00:25:17.933Z","type":"message"}
{"nick":"isaacs","message":"then, for each one of the ones written to disk, it opens them, and pipes them through the parser, creating files and dirs and such","date":"2013-07-11T00:25:51.612Z","type":"message"}
{"nick":"isaacs","message":"but, somehow, i'm ending up in a situation where it can't open the next file to write to it, until some other tarball closes, and we end up with a loop in the queue","date":"2013-07-11T00:26:36.408Z","type":"message"}
{"nick":"this_is_bert","date":"2013-07-11T00:27:04.169Z","type":"join"}
{"nick":"tjfontaine","message":"this_is_bert: I don't believe you","date":"2013-07-11T00:28:18.701Z","type":"message"}
{"nick":"tjfontaine","message":"isaacs: ugh.","date":"2013-07-11T00:28:32.264Z","type":"message"}
{"nick":"tjfontaine","message":"LeftWing: also see, amazeballs is the word of the day.","date":"2013-07-11T00:28:42.426Z","type":"message"}
{"nick":"isaacs","message":"was something else amazeballs?","date":"2013-07-11T00:29:02.699Z","type":"message"}
{"nick":"LeftWing","message":"hahaha","date":"2013-07-11T00:29:26.717Z","type":"message"}
{"nick":"tjfontaine","message":"isaacs: well, the &1 issue was the first node issue with amazeballs, and then he used it aloud in the office","date":"2013-07-11T00:29:27.777Z","type":"message"}
{"nick":"isaacs","message":"oh, right","date":"2013-07-11T00:31:20.898Z","type":"message"}
{"nick":"TooTallNate","reason":"Quit: Computer has gone to sleep.","date":"2013-07-11T00:32:49.517Z","type":"quit"}
{"nick":"bradleymeck","date":"2013-07-11T00:35:33.249Z","type":"join"}
{"nick":"isaacs","message":"it'd be nice if there was a mode to open(2) that would say \"If you get an EMFILE, just try again once something closes.  take all the time you need\"","date":"2013-07-11T00:35:46.495Z","type":"message"}
{"nick":"LeftWing","message":"What, blocking open(2)?","date":"2013-07-11T00:37:43.390Z","type":"message"}
{"nick":"LeftWing","message":"The application should really just manage the number of fds it uses.","date":"2013-07-11T00:38:23.291Z","type":"message"}
{"nick":"julianduque","reason":"Quit: leaving","date":"2013-07-11T00:39:48.268Z","type":"quit"}
{"nick":"loladiro","date":"2013-07-11T00:40:37.785Z","type":"join"}
{"nick":"kazupon","reason":"Remote host closed the connection","date":"2013-07-11T00:47:34.548Z","type":"quit"}
{"nick":"kazupon","date":"2013-07-11T00:48:01.895Z","type":"join"}
{"nick":"kazupon","reason":"Ping timeout: 240 seconds","date":"2013-07-11T00:52:23.779Z","type":"quit"}
{"nick":"this_is_bert","message":"gyp is so amazing","date":"2013-07-11T00:57:37.247Z","type":"message"}
{"nick":"this_is_bert","message":"I thought I'd try eclipse output for a change and it works","date":"2013-07-11T00:57:51.504Z","type":"message"}
{"nick":"tjfontaine","message":"I don't believe you","date":"2013-07-11T00:57:52.083Z","type":"message"}
{"nick":"tjfontaine","message":"oh","date":"2013-07-11T00:57:57.972Z","type":"message"}
{"nick":"tjfontaine","message":"right that part works fine, it also works with xcode :P","date":"2013-07-11T00:58:05.972Z","type":"message"}
{"nick":"tjfontaine","message":"anyway, /me goes home","date":"2013-07-11T00:58:25.137Z","type":"message"}
{"nick":"this_is_bert","message":"I know but I xcode drives me nuts","date":"2013-07-11T00:58:27.444Z","type":"message"}
{"nick":"this_is_bert","message":"and yes go!","date":"2013-07-11T00:58:30.724Z","type":"message"}
{"nick":"brson","reason":"Ping timeout: 240 seconds","date":"2013-07-11T01:08:23.849Z","type":"quit"}
{"nick":"this_is_bert","reason":"Quit: Page closed","date":"2013-07-11T01:13:15.453Z","type":"quit"}
{"nick":"abraxas","date":"2013-07-11T01:27:56.952Z","type":"join"}
{"nick":"defunctzombie_zz","new_nick":"defunctzombie","date":"2013-07-11T01:30:48.678Z","type":"nick"}
{"nick":"kazupon","date":"2013-07-11T02:06:52.180Z","type":"join"}
{"nick":"wavded","date":"2013-07-11T02:34:13.180Z","type":"join"}
{"nick":"trevnorris_","date":"2013-07-11T02:36:37.220Z","type":"join"}
{"nick":"groundwa_","date":"2013-07-11T02:36:42.900Z","type":"join"}
{"nick":"txdv","date":"2013-07-11T02:37:35.081Z","type":"join"}
{"nick":"kenperkins_","date":"2013-07-11T02:38:31.713Z","type":"join"}
{"nick":"isaacs_","date":"2013-07-11T02:38:38.199Z","type":"join"}
{"nick":"isaacs_","new_nick":"Guest87102","date":"2013-07-11T02:39:11.078Z","type":"nick"}
{"nick":"trevnorris","reason":"*.net *.split","date":"2013-07-11T02:43:45.368Z","type":"quit"}
{"nick":"groundwater","reason":"*.net *.split","date":"2013-07-11T02:43:45.618Z","type":"quit"}
{"nick":"txdv_","reason":"*.net *.split","date":"2013-07-11T02:43:45.738Z","type":"quit"}
{"nick":"isaacs","reason":"*.net *.split","date":"2013-07-11T02:43:45.978Z","type":"quit"}
{"nick":"kenperkins","reason":"*.net *.split","date":"2013-07-11T02:43:46.098Z","type":"quit"}
{"nick":"Denmad","reason":"*.net *.split","date":"2013-07-11T02:43:46.218Z","type":"quit"}
{"nick":"trevnorris_","new_nick":"trevnorris","date":"2013-07-11T02:43:50.267Z","type":"nick"}
{"nick":"c4milo_","date":"2013-07-11T02:51:16.395Z","type":"join"}
{"nick":"TooTallNate","date":"2013-07-11T02:52:13.234Z","type":"join"}
{"nick":"c4milo_","reason":"Read error: Connection reset by peer","date":"2013-07-11T02:52:28.625Z","type":"quit"}
{"nick":"c4milo_","date":"2013-07-11T02:53:09.234Z","type":"join"}
{"nick":"c4milo","reason":"Ping timeout: 240 seconds","date":"2013-07-11T02:54:23.800Z","type":"quit"}
{"nick":"c4milo_","reason":"Read error: Connection reset by peer","date":"2013-07-11T02:55:14.130Z","type":"quit"}
{"nick":"c4milo","date":"2013-07-11T02:55:24.383Z","type":"join"}
{"nick":"c4milo","reason":"Read error: Connection reset by peer","date":"2013-07-11T02:56:53.431Z","type":"quit"}
{"nick":"c4milo","date":"2013-07-11T02:57:10.293Z","type":"join"}
{"nick":"c4milo","reason":"Read error: Connection reset by peer","date":"2013-07-11T02:58:11.371Z","type":"quit"}
{"nick":"c4milo","date":"2013-07-11T03:00:40.971Z","type":"join"}
{"nick":"c4milo_","date":"2013-07-11T03:07:14.759Z","type":"join"}
{"nick":"defunctzombie","new_nick":"defunctzombie_zz","date":"2013-07-11T03:09:25.350Z","type":"nick"}
{"nick":"Denmad","date":"2013-07-11T03:09:27.168Z","type":"join"}
{"nick":"c4milo","reason":"Ping timeout: 260 seconds","date":"2013-07-11T03:10:55.829Z","type":"quit"}
{"nick":"c4milo_","reason":"Remote host closed the connection","date":"2013-07-11T03:37:54.093Z","type":"quit"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2013-07-11T03:44:08.340Z","type":"quit"}
{"nick":"ik_","message":"DAYCHANGE!","date":"2013-07-11T04:00:58.933Z","type":"message"}
{"nick":"hz","reason":"Read error: Connection reset by peer","date":"2013-07-11T04:01:24.914Z","type":"quit"}
{"nick":"hz","date":"2013-07-11T04:01:37.089Z","type":"join"}
{"nick":"abraxas","reason":"Remote host closed the connection","date":"2013-07-11T04:02:29.608Z","type":"quit"}
{"nick":"bradleymeck","reason":"Quit: bradleymeck","date":"2013-07-11T04:26:30.848Z","type":"quit"}
{"nick":"wavded","reason":"Quit: Hasta la pasta","date":"2013-07-11T04:30:18.545Z","type":"quit"}
{"nick":"bradleymeck","date":"2013-07-11T04:34:15.509Z","type":"join"}
{"nick":"hz","date":"2013-07-11T04:41:57.842Z","type":"quit"}
{"nick":"loladiro","date":"2013-07-11T04:42:10.812Z","type":"join"}
{"nick":"mcavage","reason":"Remote host closed the connection","date":"2013-07-11T04:42:32.489Z","type":"quit"}
{"nick":"bradleymeck","reason":"Quit: bradleymeck","date":"2013-07-11T04:45:05.614Z","type":"quit"}
{"nick":"st_luke","date":"2013-07-11T04:55:12.192Z","type":"join"}
{"nick":"loladiro_","date":"2013-07-11T04:58:47.245Z","type":"join"}
{"nick":"loladiro","reason":"Ping timeout: 240 seconds","date":"2013-07-11T05:01:23.804Z","type":"quit"}
{"nick":"loladiro_","new_nick":"loladiro","date":"2013-07-11T05:01:25.053Z","type":"nick"}
{"nick":"abraxas","date":"2013-07-11T05:12:07.195Z","type":"join"}
{"nick":"Guest87102","new_nick":"isaacs","date":"2013-07-11T05:18:19.986Z","type":"nick"}
{"nick":"rendar","date":"2013-07-11T05:23:53.401Z","type":"join"}
{"nick":"st_luke","reason":"Remote host closed the connection","date":"2013-07-11T05:30:13.809Z","type":"quit"}
{"nick":"hueniverse","reason":"Ping timeout: 246 seconds","date":"2013-07-11T05:35:19.765Z","type":"quit"}
{"nick":"hueniverse","date":"2013-07-11T05:38:07.976Z","type":"join"}
{"nick":"mcavage","date":"2013-07-11T05:43:10.304Z","type":"join"}
{"nick":"paddybyers","date":"2013-07-11T05:45:48.292Z","type":"join"}
{"nick":"mcavage","reason":"Read error: Connection reset by peer","date":"2013-07-11T05:45:56.609Z","type":"quit"}
{"nick":"mcavage","date":"2013-07-11T05:46:07.171Z","type":"join"}
{"nick":"isaacs","message":"Hm.  ok, so the problem I'm facing is that npm uses a lockfile to prevent opening the same file multiple times in some case.","date":"2013-07-11T05:48:57.767Z","type":"message"}
{"nick":"isaacs","message":"but, if you try to do 128 things, and your ulimit is 128, then now you have taken up all the slots, and all your attempts to do whatever the thing was that the lockfile was locking, will fail.","date":"2013-07-11T05:49:43.322Z","type":"message"}
{"nick":"isaacs","action":"sign","date":"2013-07-11T05:49:51.236Z","type":"action"}
{"nick":"isaacs","action":"sigh","date":"2013-07-11T05:49:54.339Z","type":"action"}
{"nick":"loladiro","reason":"Ping timeout: 246 seconds","date":"2013-07-11T05:50:00.130Z","type":"quit"}
{"nick":"mcavage","reason":"Ping timeout: 245 seconds","date":"2013-07-11T05:50:35.045Z","type":"quit"}
{"nick":"isaacs","message":"which wouldn't be much of a problem, of course, except that graceful-fs is setting up a retry queue for EMFILE error handling.","date":"2013-07-11T05:51:01.911Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: so, since we already support it, think we should throw in latin1 to our supported character encodings?","date":"2013-07-11T05:59:30.450Z","type":"message"}
{"nick":"bajtos","date":"2013-07-11T06:03:03.412Z","type":"join"}
{"nick":"trevnorris","message":"indutny: you around?","date":"2013-07-11T06:08:24.925Z","type":"message"}
{"nick":"trevnorris","message":"isaacs, indutny: fyi. in 4488a69 looks like net.Server deprecated some properties in v0.9. That mean we can remove them in master?","date":"2013-07-11T06:09:23.934Z","type":"message"}
{"nick":"TooTallNate","reason":"Quit: Computer has gone to sleep.","date":"2013-07-11T06:10:04.866Z","type":"quit"}
{"nick":"toothrot","reason":"Ping timeout: 252 seconds","date":"2013-07-11T06:13:19.852Z","type":"quit"}
{"nick":"kazupon","reason":"Remote host closed the connection","date":"2013-07-11T06:14:52.720Z","type":"quit"}
{"nick":"kazupon","date":"2013-07-11T06:15:19.404Z","type":"join"}
{"nick":"toothr","date":"2013-07-11T06:17:52.571Z","type":"join"}
{"nick":"kazupon","reason":"Ping timeout: 245 seconds","date":"2013-07-11T06:19:43.348Z","type":"quit"}
{"nick":"isaacs","message":"trevnorris: meh","date":"2013-07-11T06:20:23.762Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: only if they're actually in the way for some reason.","date":"2013-07-11T06:20:36.053Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: you mean for the removal? honestly it's just ugly. Doing a Object.defineProperty on every server instantiation","date":"2013-07-11T06:21:13.068Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: meh.  we don't instantiate THAT many servers.","date":"2013-07-11T06:22:13.422Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: what is that, like 10 defineProperty calls at most, ever?","date":"2013-07-11T06:22:25.531Z","type":"message"}
{"nick":"kazupon","date":"2013-07-11T06:23:05.432Z","type":"join"}
{"nick":"isaacs","message":"trevnorris: compared with someone complaining that they have to update all sorts of code in random modules in production to upgrade to 0.12, i think that's worth it.","date":"2013-07-11T06:23:06.362Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: more about not feeling icky when I look at the code ;) also there's just some other code cleanup stuff like not using arguments[].","date":"2013-07-11T06:23:31.125Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: that icky feeling is karma","date":"2013-07-11T06:23:56.425Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: it is inescapable :)","date":"2013-07-11T06:24:05.381Z","type":"message"}
{"nick":"trevnorris","message":"hah","date":"2013-07-11T06:24:10.619Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: i feel the same way about sys vs util","date":"2013-07-11T06:24:11.200Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: purity and an empty sack is worth the sack","date":"2013-07-11T06:24:27.051Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: mother. I didn't even realize sys was still around :P","date":"2013-07-11T06:24:59.337Z","type":"message"}
{"nick":"isaacs","message":"oh, man, this lockfile bug is kind of killing me","date":"2013-07-11T06:25:54.677Z","type":"message"}
{"nick":"isaacs","message":"i've made a terrible mistake","date":"2013-07-11T06:26:02.929Z","type":"message"}
{"nick":"trevnorris","message":"still at it?","date":"2013-07-11T06:26:09.708Z","type":"message"}
{"nick":"isaacs","message":"yeah","date":"2013-07-11T06:26:31.348Z","type":"message"}
{"nick":"isaacs","message":"it's tricky","date":"2013-07-11T06:26:33.922Z","type":"message"}
{"nick":"trevnorris","message":"i've only partially been following what's going on. have a ticket open or something?","date":"2013-07-11T06:27:31.934Z","type":"message"}
{"nick":"isaacs","message":"nah","date":"2013-07-11T06:29:14.027Z","type":"message"}
{"nick":"isaacs","message":"well, a few","date":"2013-07-11T06:29:17.197Z","type":"message"}
{"nick":"isaacs","message":"people talking about getting EMFILE errors","date":"2013-07-11T06:29:22.067Z","type":"message"}
{"nick":"isaacs","message":"what happens is that npm uses a lockfile in the cache to prevent it from trying to unpack the same file in multiple processes","date":"2013-07-11T06:29:56.366Z","type":"message"}
{"nick":"isaacs","message":"add to this that graceful-fs will queue up on EMFILE errors","date":"2013-07-11T06:30:21.317Z","type":"message"}
{"nick":"isaacs","message":"if your ulimit is 128, say","date":"2013-07-11T06:30:29.966Z","type":"message"}
{"nick":"isaacs","message":"and you try to do 200 operations","date":"2013-07-11T06:30:37.297Z","type":"message"}
{"nick":"isaacs","message":"you'll open up 128 lock files","date":"2013-07-11T06:30:46.318Z","type":"message"}
{"nick":"isaacs","message":"the other 72 lockfiles will get EMFILE, and queue up","date":"2013-07-11T06:30:57.386Z","type":"message"}
{"nick":"isaacs","message":"then you'll try to do 128 actual file ops","date":"2013-07-11T06:31:07.406Z","type":"message"}
{"nick":"isaacs","message":"and those will also queue up","date":"2013-07-11T06:31:11.214Z","type":"message"}
{"nick":"trevnorris","message":"...","date":"2013-07-11T06:31:20.598Z","type":"message"}
{"nick":"isaacs","message":"but you never give up the lock until the operation finishes","date":"2013-07-11T06:31:23.743Z","type":"message"}
{"nick":"isaacs","message":"but it can't proceed","date":"2013-07-11T06:31:28.722Z","type":"message"}
{"nick":"trevnorris","message":"wow, quite the issue. ulimit of 128?","date":"2013-07-11T06:31:51.971Z","type":"message"}
{"nick":"isaacs","message":"or whatever","date":"2013-07-11T06:32:43.152Z","type":"message"}
{"nick":"isaacs","message":"say its 256","date":"2013-07-11T06:32:48.537Z","type":"message"}
{"nick":"isaacs","message":"but you try to do 500 things","date":"2013-07-11T06:32:53.309Z","type":"message"}
{"nick":"isaacs","message":"still gonna fail","date":"2013-07-11T06:32:55.694Z","type":"message"}
{"nick":"trevnorris","message":"yeah.","date":"2013-07-11T06:33:01.773Z","type":"message"}
{"nick":"isaacs","message":"ock up and never proceed","date":"2013-07-11T06:33:06.401Z","type":"message"}
{"nick":"isaacs","message":"i need to close the lockfile, but just not delete it","date":"2013-07-11T06:33:16.303Z","type":"message"}
{"nick":"isaacs","message":"derp","date":"2013-07-11T06:33:19.401Z","type":"message"}
{"nick":"trevnorris","message":"well. on a less painful note, i've resorted to working with a zero length return http server to figure out the rewrite https://gist.github.com/trevnorris/5972854","date":"2013-07-11T06:35:11.599Z","type":"message"}
{"nick":"trevnorris","message":"there's so many layers going on I get lost","date":"2013-07-11T06:35:20.017Z","type":"message"}
{"nick":"isaacs","message":"nice","date":"2013-07-11T06:39:22.228Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: so getting the EMFILE is fine, since they're queue up for later. but why would the first set of file ops also queue up?","date":"2013-07-11T06:45:58.082Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: but that's fine, because then those fds will close, and their actual operations will proceed","date":"2013-07-11T06:52:45.165Z","type":"message"}
{"nick":"isaacs","message":"the open() call just creates the file, and then lockfile closes","date":"2013-07-11T06:52:58.062Z","type":"message"}
{"nick":"isaacs","message":"now the file exists, so another call to open(path, 'wx') will fail","date":"2013-07-11T06:53:10.624Z","type":"message"}
{"nick":"isaacs","message":"becuse the file already exists, so exclusivity can't be guaranteed","date":"2013-07-11T06:53:27.662Z","type":"message"}
{"nick":"defunctzombie_zz","new_nick":"defunctzombie","date":"2013-07-11T06:55:16.336Z","type":"nick"}
{"nick":"trevnorris","message":"hm.","date":"2013-07-11T06:57:32.137Z","type":"message"}
{"nick":"M28","reason":"Read error: Connection reset by peer","date":"2013-07-11T06:57:48.456Z","type":"quit"}
{"nick":"defunctzombie","new_nick":"defunctzombie_zz","date":"2013-07-11T07:05:27.604Z","type":"nick"}
{"nick":"trevnorris","message":"wtf!? error: no member named 'Use' in namespace 'node::Buffer'","date":"2013-07-11T07:14:31.706Z","type":"message"}
{"nick":"isaacs","message":"ircretary: tell TooTallNate I just pushed a very minor change to node-gyp, to use graceful-fs 2.0.  works around this awful EMFILE bug.","date":"2013-07-11T07:18:53.377Z","type":"message"}
{"nick":"ircretary","message":"isaacs: I'll be sure to tell tootallnate","date":"2013-07-11T07:18:53.540Z","type":"message"}
{"nick":"trevnorris","message":"how is it I can't use node::Buffer::Use in this freakin module? oy.","date":"2013-07-11T07:20:24.845Z","type":"message"}
{"nick":"trevnorris","message":"oh, hell. i must be tired...","date":"2013-07-11T07:30:27.936Z","type":"message"}
{"nick":"juliangruber_","new_nick":"juliangruber","date":"2013-07-11T07:34:01.983Z","type":"nick"}
{"nick":"mcavage","date":"2013-07-11T07:47:25.231Z","type":"join"}
{"nick":"mcavage","reason":"Ping timeout: 240 seconds","date":"2013-07-11T07:51:46.117Z","type":"quit"}
{"nick":"bajtos","reason":"Quit: bajtos","date":"2013-07-11T07:56:09.187Z","type":"quit"}
{"nick":"bajtos","date":"2013-07-11T07:58:37.181Z","type":"join"}
