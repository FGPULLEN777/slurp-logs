{"nick":"ircretary","reason":"Remote host closed the connection","date":"2013-02-01T00:00:00.834Z","type":"quit"}
{"nick":"ircretary","date":"2013-02-01T00:00:07.684Z","type":"join"}
{"nick":"hz","reason":"Disconnected by services","date":"2013-02-01T00:00:37.324Z","type":"quit"}
{"nick":"hz","date":"2013-02-01T00:00:44.434Z","type":"join"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-01T00:07:20.909Z","type":"quit"}
{"nick":"AvianFlu","reason":"Remote host closed the connection","date":"2013-02-01T00:11:52.906Z","type":"quit"}
{"nick":"isaacs","message":"so, i had this idea that it'd be faster if Readable.push() could detect if it's piping, and just write the data to the dests.","date":"2013-02-01T00:17:08.426Z","type":"message"}
{"nick":"isaacs","message":"turns out, that's quite a bit slower.","date":"2013-02-01T00:17:20.076Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: really? know why?","date":"2013-02-01T00:17:34.157Z","type":"message"}
{"nick":"isaacs","message":"inorite?","date":"2013-02-01T00:18:15.085Z","type":"message"}
{"nick":"c4milo","date":"2013-02-01T00:18:19.048Z","type":"join"}
{"nick":"isaacs","message":"without the shortcut: min:2.78 avg:2.87 max:2.99 median:2.84","date":"2013-02-01T00:18:20.935Z","type":"message"}
{"nick":"isaacs","message":"with the shortcut:min:2.20 avg:2.76 max:2.94 median:2.83","date":"2013-02-01T00:18:27.365Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: hm. can you paste your change set? like to see it.","date":"2013-02-01T00:19:26.371Z","type":"message"}
{"nick":"tjfontaine","message":"oh I thought you we were going to see 50% drops :)","date":"2013-02-01T00:19:32.996Z","type":"message"}
{"nick":"isaacs","message":"https://gist.github.com/4688017","date":"2013-02-01T00:19:44.194Z","type":"message"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-01T00:19:50.968Z","type":"quit"}
{"nick":"isaacs","message":"no, more like 5%","date":"2013-02-01T00:20:00.414Z","type":"message"}
{"nick":"isaacs","message":"or less, even","date":"2013-02-01T00:20:07.244Z","type":"message"}
{"nick":"isaacs","message":"but still!  relevant!","date":"2013-02-01T00:20:11.314Z","type":"message"}
{"nick":"isaacs","message":"and very reproducible","date":"2013-02-01T00:20:17.264Z","type":"message"}
{"nick":"isaacs","message":"it's not just function length or checks, either","date":"2013-02-01T00:20:26.984Z","type":"message"}
{"nick":"tjfontaine","message":"ya clearly","date":"2013-02-01T00:20:39.051Z","type":"message"}
{"nick":"isaacs","message":"the \"without the shortcut\" just puts the same onread() call in both conditionals","date":"2013-02-01T00:20:39.177Z","type":"message"}
{"nick":"isaacs","message":"(i thought about that)","date":"2013-02-01T00:20:49.473Z","type":"message"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-01T00:20:56.152Z","type":"quit"}
{"nick":"isaacs","message":"i guess that idea is just not a good idea","date":"2013-02-01T00:21:13.893Z","type":"message"}
{"nick":"trevnorris","message":"yeah. I think onread is what's kicking us.","date":"2013-02-01T00:21:28.977Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: it was hardly ever calling onread, though!  and it was slower!","date":"2013-02-01T00:21:46.883Z","type":"message"}
{"nick":"isaacs","message":"i tried adding a tracker to see how often it's doing the shortcut.  it's like 99% or more!","date":"2013-02-01T00:22:00.013Z","type":"message"}
{"nick":"isaacs","message":"that is calling onread basically never!","date":"2013-02-01T00:22:06.312Z","type":"message"}
{"nick":"isaacs","message":"sometimes working with a JIT is lovely.  and then sometimes it's maddening :)","date":"2013-02-01T00:22:21.743Z","type":"message"}
{"nick":"TooTallNate","date":"2013-02-01T00:22:29.256Z","type":"join"}
{"nick":"trevnorris","message":"seriously? hm. strange. this will be a fun one to debug.","date":"2013-02-01T00:22:31.847Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: think I verified the error thing. If you push data too quickly then it can't keep up writing it all out to buffers and crashes w/ out of mem errors.","date":"2013-02-01T00:23:22.357Z","type":"message"}
{"nick":"trevnorris","message":"check this: https://gist.github.com/4687602","date":"2013-02-01T00:23:26.291Z","type":"message"}
{"nick":"trevnorris","message":"was using 3.25GB when it crashed. the process dies at 1GB. so there was a lot of buffer there.","date":"2013-02-01T00:24:10.490Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: what's tmp.js?","date":"2013-02-01T00:24:20.481Z","type":"message"}
{"nick":"trevnorris","message":"tmp.js is the file i'm running this in.","date":"2013-02-01T00:24:32.587Z","type":"message"}
{"nick":"trevnorris","message":"i'll include that too","date":"2013-02-01T00:24:41.415Z","type":"message"}
{"nick":"isaacs","message":"k","date":"2013-02-01T00:24:43.531Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: updated. though that version uses my benchmark api.","date":"2013-02-01T00:26:09.942Z","type":"message"}
{"nick":"mikeal","date":"2013-02-01T00:26:24.954Z","type":"join"}
{"nick":"trevnorris","message":"if you just run the for loop until it crashes should get the same effect","date":"2013-02-01T00:26:30.505Z","type":"message"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2013-02-01T00:29:15.571Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-01T00:29:48.993Z","type":"join"}
{"nick":"c4milo","date":"2013-02-01T00:33:06.601Z","type":"join"}
{"nick":"isaacs","message":"trevnorris: yeah, this is not allowed:","date":"2013-02-01T00:33:29.585Z","type":"message"}
{"nick":"isaacs","message":"  for (var i = 0; i < ITER; i++) {","date":"2013-02-01T00:33:29.995Z","type":"message"}
{"nick":"isaacs","message":"    rs.push(buff);","date":"2013-02-01T00:33:30.121Z","type":"message"}
{"nick":"isaacs","message":"  }","date":"2013-02-01T00:33:30.121Z","type":"message"}
{"nick":"isaacs","message":"rs.push() returns false sometimes.","date":"2013-02-01T00:33:37.375Z","type":"message"}
{"nick":"isaacs","message":"if it returns false, you have to stop pushing until rs._read() is called again","date":"2013-02-01T00:33:47.275Z","type":"message"}
{"nick":"trevnorris","message":"oh yeah. I realize that.","date":"2013-02-01T00:33:58.035Z","type":"message"}
{"nick":"jmar777","reason":"Ping timeout: 248 seconds","date":"2013-02-01T00:34:11.917Z","type":"quit"}
{"nick":"trevnorris","message":"was wondering what happens if you're piping data in from on place and out the other. then the connection is disrupted so you can't push out the data you're receiving. is that a possible scenario?","date":"2013-02-01T00:35:06.616Z","type":"message"}
{"nick":"isaacs","message":"no","date":"2013-02-01T00:37:08.033Z","type":"message"}
{"nick":"isaacs","message":"the correct behavior there is to buffer until the program crashes","date":"2013-02-01T00:37:16.063Z","type":"message"}
{"nick":"isaacs","message":"which, as you point out, we're doing a nice job of :)","date":"2013-02-01T00:37:22.783Z","type":"message"}
{"nick":"trevnorris","message":"heh","date":"2013-02-01T00:37:34.326Z","type":"message"}
{"nick":"isaacs","message":"if you're calling rs.push(), it's your responsibility to respect the return value","date":"2013-02-01T00:37:47.473Z","type":"message"}
{"nick":"isaacs","message":"you can swap out any writable stream, and call ws.write() without respecting the return value.  same issue.","date":"2013-02-01T00:38:03.172Z","type":"message"}
{"nick":"isaacs","message":"buffer until crash.","date":"2013-02-01T00:38:06.652Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: guess I was thinking there should be a failsafe or something. if the gc could keep up then the system would run out of memory.","date":"2013-02-01T00:39:04.562Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: the os will shoot your process before that happens.","date":"2013-02-01T00:39:34.221Z","type":"message"}
{"nick":"isaacs","message":"it's fine.","date":"2013-02-01T00:39:36.901Z","type":"message"}
{"nick":"isaacs","message":"you'll start getting malloc failures and whatnot.","date":"2013-02-01T00:39:42.232Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: try with --expose_gc and call gc() in your loop.  you'll see.","date":"2013-02-01T00:39:53.321Z","type":"message"}
{"nick":"isaacs","message":"those things cant be gc'ed anyway, because there's a reference to them","date":"2013-02-01T00:40:01.101Z","type":"message"}
{"nick":"isaacs","message":"srsly, there's no failsafe.  it's just, \"Don't do that\"","date":"2013-02-01T00:40:11.641Z","type":"message"}
{"nick":"isaacs","message":"the failsafe is to respect the return value.","date":"2013-02-01T00:40:22.441Z","type":"message"}
{"nick":"trevnorris","message":"heh, that's cool. I just remember running something like `var a = []; while (true) a.push(new Buffer(1024);` and my system crashed before the process was killed.","date":"2013-02-01T00:42:09.491Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: weird.","date":"2013-02-01T00:43:18.989Z","type":"message"}
{"nick":"EhevuTov","reason":"Quit: This computer has gone to sleep","date":"2013-02-01T00:43:42.646Z","type":"quit"}
{"nick":"loladiro","date":"2013-02-01T00:44:48.466Z","type":"join"}
{"nick":"trevnorris","message":"i'll try that just before I head out and let you know how it goes. =)","date":"2013-02-01T00:45:49.850Z","type":"message"}
{"nick":"qmx","new_nick":"qmx|away","date":"2013-02-01T00:46:52.287Z","type":"nick"}
{"nick":"bradleymeck","date":"2013-02-01T00:48:23.963Z","type":"join"}
{"nick":"trevnorris","message":"isaacs: when net receives data, does it go directly to a buffer? can't figure out why so much gc'ing is going on.","date":"2013-02-01T00:49:42.079Z","type":"message"}
{"nick":"isaacs","message":"handle.ondata gets a buffer with start and length","date":"2013-02-01T00:52:30.132Z","type":"message"}
{"nick":"isaacs","message":"it does seem a bit inefficient that the tcp_wrap has a single ondata callback, which is *sometimes* called with bufer,start,end and sometimes just called with no arguments.","date":"2013-02-01T00:54:30.981Z","type":"message"}
{"nick":"isaacs","message":"a lot of deopts from that.","date":"2013-02-01T00:54:34.861Z","type":"message"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-01T01:00:04.800Z","type":"quit"}
{"nick":"stagas_","date":"2013-02-01T01:00:43.327Z","type":"join"}
{"nick":"c4milo","date":"2013-02-01T01:00:46.517Z","type":"join"}
{"nick":"stagas","reason":"Ping timeout: 240 seconds","date":"2013-02-01T01:02:08.251Z","type":"quit"}
{"nick":"stagas_","new_nick":"stagas","date":"2013-02-01T01:02:23.091Z","type":"nick"}
{"nick":"trevnorris","message":"isaacs: net.js has `if (!writeReq || typeof writeReq !== 'object')`, but above calls createWriteReq which appears to force return an object.","date":"2013-02-01T01:03:34.206Z","type":"message"}
{"nick":"trevnorris","message":"only way it'd fail is if this._handle was not a handle, right?","date":"2013-02-01T01:03:53.645Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: it returns the result of handle.writeWhatever()","date":"2013-02-01T01:04:01.285Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: which might not be an object.","date":"2013-02-01T01:04:07.375Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: src/stream_wrap.cc, line 462:     return scope.Close(v8::Null(node_isolate));","date":"2013-02-01T01:05:56.124Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: if there's an error writing, it'll return null","date":"2013-02-01T01:06:07.474Z","type":"message"}
{"nick":"trevnorris","message":"ah ok. thanks.","date":"2013-02-01T01:06:27.092Z","type":"message"}
{"nick":"trevnorris","message":"was trying to trace that back.","date":"2013-02-01T01:06:41.638Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: i guess the typeof check is unnecessary","date":"2013-02-01T01:09:27.461Z","type":"message"}
{"nick":"googol","date":"2013-02-01T01:09:58.563Z","type":"join"}
{"nick":"trevnorris","message":"isaacs: ok, so WriteBuffer is malloc'ing every call. so writing out a massive number of small buffers just to be immediately cleaned up could be hurting the gc?","date":"2013-02-01T01:16:33.972Z","type":"message"}
{"nick":"TooTallNate","reason":"Quit: Computer has gone to sleep.","date":"2013-02-01T01:16:44.991Z","type":"quit"}
{"nick":"isaacs","message":"not sure","date":"2013-02-01T01:16:45.767Z","type":"message"}
{"nick":"trevnorris","message":"well. i'm confused. now time to see if I can crash my machine and head home.","date":"2013-02-01T01:18:57.629Z","type":"message"}
{"nick":"trevnorris","reason":"Ping timeout: 245 seconds","date":"2013-02-01T01:25:51.829Z","type":"quit"}
{"nick":"lohkey","date":"2013-02-01T01:29:44.198Z","type":"part"}
{"nick":"TooTallNate","date":"2013-02-01T01:37:40.570Z","type":"join"}
{"nick":"stagas","reason":"Ping timeout: 252 seconds","date":"2013-02-01T01:38:12.229Z","type":"quit"}
{"nick":"hz","date":"2013-02-01T01:39:29.016Z","type":"quit"}
{"nick":"abraxas","date":"2013-02-01T01:44:48.427Z","type":"join"}
{"nick":"Benvie","reason":"Read error: Connection reset by peer","date":"2013-02-01T01:55:12.763Z","type":"quit"}
{"nick":"Benvie","date":"2013-02-01T01:55:28.324Z","type":"join"}
{"nick":"qmx|away","reason":"Ping timeout: 260 seconds","date":"2013-02-01T02:18:34.985Z","type":"quit"}
{"nick":"piscisaureus_","reason":"Quit: ~ Trillian Astra - www.trillian.im ~","date":"2013-02-01T02:22:21.667Z","type":"quit"}
{"nick":"qmx|away","date":"2013-02-01T02:29:08.924Z","type":"join"}
{"nick":"pooya","reason":"Read error: Connection reset by peer","date":"2013-02-01T02:29:09.056Z","type":"quit"}
{"nick":"pooya","date":"2013-02-01T02:29:31.355Z","type":"join"}
{"nick":"qmx|away","reason":"Ping timeout: 248 seconds","date":"2013-02-01T02:33:39.971Z","type":"quit"}
{"nick":"dap","reason":"Quit: Leaving.","date":"2013-02-01T02:36:30.969Z","type":"quit"}
{"nick":"qmx|away","date":"2013-02-01T02:40:49.714Z","type":"join"}
{"nick":"jmar777","date":"2013-02-01T02:43:35.029Z","type":"join"}
{"nick":"qmx|away","reason":"Ping timeout: 252 seconds","date":"2013-02-01T02:48:36.288Z","type":"quit"}
{"nick":"qmx|away","date":"2013-02-01T02:51:49.731Z","type":"join"}
{"nick":"stagas","date":"2013-02-01T02:52:07.284Z","type":"join"}
{"nick":"qmx|away","reason":"Ping timeout: 248 seconds","date":"2013-02-01T02:56:35.942Z","type":"quit"}
{"nick":"pooya","reason":"Quit: pooya","date":"2013-02-01T02:59:36.055Z","type":"quit"}
{"nick":"sblom","reason":"Ping timeout: 264 seconds","date":"2013-02-01T02:59:36.411Z","type":"quit"}
{"nick":"stagas","reason":"Quit: ChatZilla 0.9.89-rdmsoft [XULRunner 1.9.0.17/2009122204]","date":"2013-02-01T03:01:53.150Z","type":"quit"}
{"nick":"dap","date":"2013-02-01T03:07:20.730Z","type":"join"}
{"nick":"stagas","date":"2013-02-01T03:09:02.219Z","type":"join"}
{"nick":"loladiro","date":"2013-02-01T03:13:33.186Z","type":"part"}
{"nick":"qmx|away","date":"2013-02-01T03:18:38.839Z","type":"join"}
{"nick":"TooTallNate","reason":"Quit: [\"Textual IRC Client: www.textualapp.com\"]","date":"2013-02-01T03:19:09.594Z","type":"quit"}
{"nick":"trevnorris","date":"2013-02-01T04:07:05.669Z","type":"join"}
{"nick":"trevnorris","message":"isaacs: so... `var a = []; while (true) a.push(new Buffer(1024);` doesn't cause the process to die. just brought my system to a hault.","date":"2013-02-01T04:08:26.259Z","type":"message"}
{"nick":"trevnorris","action":"&","date":"2013-02-01T04:12:27.479Z","type":"action"}
{"nick":"LOUDBOT","message":"IS THAT PADRE ON YOUR LAUNCH BAR? I BELIEVE IT IS","date":"2013-02-01T04:12:27.838Z","type":"message"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2013-02-01T04:15:08.062Z","type":"quit"}
{"nick":"mraleph","date":"2013-02-01T04:15:44.708Z","type":"join"}
{"nick":"mraleph1","reason":"Ping timeout: 276 seconds","date":"2013-02-01T04:19:20.264Z","type":"quit"}
{"nick":"CoverSlide","date":"2013-02-01T04:23:41.532Z","type":"join"}
{"nick":"pooya","date":"2013-02-01T04:26:50.170Z","type":"join"}
{"nick":"brson","reason":"Ping timeout: 264 seconds","date":"2013-02-01T04:30:12.416Z","type":"quit"}
{"nick":"tjfontaine","message":"trevnorris: by halt, do you mean swapping itself to death? :)","date":"2013-02-01T04:33:34.967Z","type":"message"}
{"nick":"trevnorris","message":"tjfontaine: what's strange is I was monitoring my system, and it never reached swap.","date":"2013-02-01T04:35:41.325Z","type":"message"}
{"nick":"trevnorris","message":"my system just completely stopped responding.","date":"2013-02-01T04:36:17.201Z","type":"message"}
{"nick":"tjfontaine","message":"ah interesting","date":"2013-02-01T04:36:21.379Z","type":"message"}
{"nick":"isaacs","message":"anyone know what this means? Deferred TaggedToI: not a heap number","date":"2013-02-01T04:43:40.503Z","type":"message"}
{"nick":"isaacs","message":"trevnorris, tjfontaine, indutny: ^","date":"2013-02-01T04:43:50.503Z","type":"message"}
{"nick":"isaacs","message":"?","date":"2013-02-01T04:43:51.323Z","type":"message"}
{"nick":"tjfontaine","message":"er wha","date":"2013-02-01T04:48:08.077Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: it's coming from deps/v8/src/ia32/lithium-codegen-ia32.cc:4532","date":"2013-02-01T04:50:08.360Z","type":"message"}
{"nick":"tjfontaine","message":"ya but","date":"2013-02-01T04:50:41.865Z","type":"message"}
{"nick":"trevnorris","message":"i'm tracing back and seeing what condition causes that message to appear. one min","date":"2013-02-01T04:51:33.917Z","type":"message"}
{"nick":"indutny","message":"isaacs: I'm not sure","date":"2013-02-01T04:55:48.364Z","type":"message"}
{"nick":"indutny","message":"how are you getting this?","date":"2013-02-01T04:56:01.330Z","type":"message"}
{"nick":"indutny","message":"ah, well","date":"2013-02-01T04:57:18.797Z","type":"message"}
{"nick":"indutny","message":"its just deoptimizing","date":"2013-02-01T04:57:23.111Z","type":"message"}
{"nick":"indutny","message":"so it has expected heap number","date":"2013-02-01T04:57:32.777Z","type":"message"}
{"nick":"indutny","message":"and received something else","date":"2013-02-01T04:57:36.772Z","type":"message"}
{"nick":"indutny","message":"that's all","date":"2013-02-01T04:57:38.264Z","type":"message"}
{"nick":"indutny","message":"I guess some variable isn't monomorphic","date":"2013-02-01T04:57:47.356Z","type":"message"}
{"nick":"indutny","message":"isaacs: ^^","date":"2013-02-01T04:57:49.837Z","type":"message"}
{"nick":"tjfontaine","message":"sure, but I'm guessing he's expecting it to be?","date":"2013-02-01T04:58:00.289Z","type":"message"}
{"nick":"indutny","message":"he = v8, yes","date":"2013-02-01T04:58:17.693Z","type":"message"}
{"nick":"tjfontaine","message":"no I mean, I presumed he was looking for a reason he was deopt'ing","date":"2013-02-01T04:58:33.842Z","type":"message"}
{"nick":"indutny","message":"probably because you're doing some operation on integers","date":"2013-02-01T04:58:36.917Z","type":"message"}
{"nick":"indutny","message":"well, the reason for deopt is simple","date":"2013-02-01T04:58:49.615Z","type":"message"}
{"nick":"indutny","message":"v8 has received oddball instead of heap number","date":"2013-02-01T04:59:00.148Z","type":"message"}
{"nick":"indutny","message":"like null, undefined","date":"2013-02-01T04:59:08.775Z","type":"message"}
{"nick":"indutny","message":"or just string","date":"2013-02-01T04:59:10.403Z","type":"message"}
{"nick":"tjfontaine","message":"or object","date":"2013-02-01T04:59:13.535Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-01T04:59:16.285Z","type":"message"}
{"nick":"tjfontaine","message":"again","date":"2013-02-01T04:59:21.276Z","type":"message"}
{"nick":"tjfontaine","message":"I was thinking he was looking for more information than that","date":"2013-02-01T04:59:29.447Z","type":"message"}
{"nick":"indutny","message":"well, I need to see code where it happens","date":"2013-02-01T04:59:46.246Z","type":"message"}
{"nick":"indutny","message":"i.e. I need more information too","date":"2013-02-01T04:59:55.402Z","type":"message"}
{"nick":"isaacs","message":"indutny: the function is so tiny...","date":"2013-02-01T05:01:02.842Z","type":"message"}
{"nick":"isaacs","message":"indutny: it's this:","date":"2013-02-01T05:01:06.272Z","type":"message"}
{"nick":"isaacs","message":"function pipeOnDrain(src, dest) {","date":"2013-02-01T05:01:18.602Z","type":"message"}
{"nick":"isaacs","message":"  var state = src._readableState;","date":"2013-02-01T05:01:18.734Z","type":"message"}
{"nick":"isaacs","message":"  state.awaitDrain--;","date":"2013-02-01T05:01:18.734Z","type":"message"}
{"nick":"isaacs","message":"  if (state.awaitDrain === 0)","date":"2013-02-01T05:01:18.734Z","type":"message"}
{"nick":"isaacs","message":"    flow(src);","date":"2013-02-01T05:01:18.734Z","type":"message"}
{"nick":"isaacs","message":"}","date":"2013-02-01T05:01:21.122Z","type":"message"}
{"nick":"isaacs","message":"and awaitDrain is always an integer","date":"2013-02-01T05:01:26.412Z","type":"message"}
{"nick":"indutny","message":"I guess awaitDrain isn't always heap number","date":"2013-02-01T05:01:32.847Z","type":"message"}
{"nick":"indutny","message":"integer != heap number","date":"2013-02-01T05:01:37.932Z","type":"message"}
{"nick":"isaacs","message":"ah.","date":"2013-02-01T05:01:41.492Z","type":"message"}
{"nick":"isaacs","message":"intersting","date":"2013-02-01T05:01:43.682Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-01T05:01:55.274Z","type":"message"}
{"nick":"indutny","message":"are you always just incrementing/decrementing it?","date":"2013-02-01T05:02:05.331Z","type":"message"}
{"nick":"trevnorris","message":"indutny: think there may be a problem that it's expecting an Smi, but gets something else?","date":"2013-02-01T05:02:08.726Z","type":"message"}
{"nick":"indutny","message":"seems like so","date":"2013-02-01T05:02:24.753Z","type":"message"}
{"nick":"isaacs","message":"yeah","date":"2013-02-01T05:02:30.591Z","type":"message"}
{"nick":"indutny","message":"trevnorris: no, not really","date":"2013-02-01T05:02:49.613Z","type":"message"}
{"nick":"indutny","message":"at least that's not what comment tells us","date":"2013-02-01T05:02:59.375Z","type":"message"}
{"nick":"bradleymeck","reason":"Quit: bradleymeck","date":"2013-02-01T05:03:28.465Z","type":"quit"}
{"nick":"indutny","message":"isaacs: looks like it shouldn't be heap number at any time","date":"2013-02-01T05:03:43.277Z","type":"message"}
{"nick":"indutny","message":"so this deoptimization is pretty strange","date":"2013-02-01T05:03:50.883Z","type":"message"}
{"nick":"indutny","message":"is it happening only once?","date":"2013-02-01T05:04:03.301Z","type":"message"}
{"nick":"indutny","message":"or periodically","date":"2013-02-01T05:04:08.240Z","type":"message"}
{"nick":"trevnorris","message":"it's being called from DoDeferredTaggedToI","date":"2013-02-01T05:04:19.527Z","type":"message"}
{"nick":"brson","date":"2013-02-01T05:04:21.067Z","type":"join"}
{"nick":"isaacs","message":"indutny: a few times","date":"2013-02-01T05:04:36.840Z","type":"message"}
{"nick":"trevnorris","message":"but i'm having a hard time figuring out how it gets there","date":"2013-02-01T05:04:44.292Z","type":"message"}
{"nick":"indutny","message":"isaacs: ok, so that's probably not a serious thing","date":"2013-02-01T05:04:47.739Z","type":"message"}
{"nick":"indutny","message":"trevnorris: me too","date":"2013-02-01T05:04:49.988Z","type":"message"}
{"nick":"indutny","message":"but if you want to really figure it out - it'll be probably better to file issue","date":"2013-02-01T05:05:02.608Z","type":"message"}
{"nick":"indutny","message":"on v8's tracker","date":"2013-02-01T05:05:06.693Z","type":"message"}
{"nick":"indutny","message":"describing what we have","date":"2013-02-01T05:05:10.370Z","type":"message"}
{"nick":"indutny","message":"and what we see","date":"2013-02-01T05:05:12.705Z","type":"message"}
{"nick":"indutny","message":"they'll either answer it","date":"2013-02-01T05:05:17.816Z","type":"message"}
{"nick":"indutny","message":"or fix it","date":"2013-02-01T05:05:19.434Z","type":"message"}
{"nick":"indutny","message":":)","date":"2013-02-01T05:05:20.375Z","type":"message"}
{"nick":"trevnorris","message":"here's the comment right above the error:","date":"2013-02-01T05:05:22.873Z","type":"message"}
{"nick":"trevnorris","message":"\"\"Check for undefined. Undefined is converted to zero for truncating conversions\"","date":"2013-02-01T05:05:28.866Z","type":"message"}
{"nick":"indutny","message":"trevnorris: there're other places with this deopt","date":"2013-02-01T05:05:41.676Z","type":"message"}
{"nick":"trevnorris","message":"nope. this is the only place","date":"2013-02-01T05:05:49.943Z","type":"message"}
{"nick":"indutny","message":"ah no","date":"2013-02-01T05:05:53.364Z","type":"message"}
{"nick":"indutny","message":"well, where can you see this comment?","date":"2013-02-01T05:06:00.912Z","type":"message"}
{"nick":"indutny","message":"I'm looking at lithium-ia32-codegen","date":"2013-02-01T05:06:13.744Z","type":"message"}
{"nick":"indutny","message":"err","date":"2013-02-01T05:06:15.906Z","type":"message"}
{"nick":"indutny","message":"lithium-codegen-ia32","date":"2013-02-01T05:06:19.043Z","type":"message"}
{"nick":"trevnorris","message":"src/ia32/lithium-codegen-ia32.cc","date":"2013-02-01T05:06:21.179Z","type":"message"}
{"nick":"isaacs","message":"hm.","date":"2013-02-01T05:06:22.419Z","type":"message"}
{"nick":"trevnorris","message":"indutny: yeah, but x64/lithium-codegen-x64.cc depends on it","date":"2013-02-01T05:06:39.749Z","type":"message"}
{"nick":"indutny","message":"    // Deoptimize if we don't have a heap number.","date":"2013-02-01T05:06:46.292Z","type":"message"}
{"nick":"indutny","message":"    __ RecordComment(\"Deferred TaggedToI: not a heap number\");","date":"2013-02-01T05:06:46.440Z","type":"message"}
{"nick":"indutny","message":"can't see this comment","date":"2013-02-01T05:06:53.506Z","type":"message"}
{"nick":"indutny","message":"ah, you're looking at another case","date":"2013-02-01T05:07:09.669Z","type":"message"}
{"nick":"trevnorris","message":"suck, sorry. talking w/ my wife and doing this doesn't have good results.","date":"2013-02-01T05:07:24.490Z","type":"message"}
{"nick":"trevnorris","message":"indutny: x64/lithium-x64.h:1810","date":"2013-02-01T05:09:38.968Z","type":"message"}
{"nick":"trevnorris","message":"\"Truncating conversion from a tagged value to an int32\"","date":"2013-02-01T05:09:44.912Z","type":"message"}
{"nick":"indutny","message":"it's not truncating in our case","date":"2013-02-01T05:10:00.181Z","type":"message"}
{"nick":"trevnorris","message":"indutny: that's exactly it","date":"2013-02-01T05:10:08.170Z","type":"message"}
{"nick":"trevnorris","message":"there's an if statement \"if (instr->truncating())\"","date":"2013-02-01T05:10:22.450Z","type":"message"}
{"nick":"trevnorris","message":"and the first thing in the else is the message","date":"2013-02-01T05:10:29.240Z","type":"message"}
{"nick":"indutny","message":"so I guess what's really happening here","date":"2013-02-01T05:12:02.096Z","type":"message"}
{"nick":"indutny","message":"is that v8 compiles this function without enough type information","date":"2013-02-01T05:12:11.339Z","type":"message"}
{"nick":"indutny","message":"and thoughts that it is a heap number","date":"2013-02-01T05:12:17.581Z","type":"message"}
{"nick":"indutny","message":"then it encounters it and see that it's actually as SMI","date":"2013-02-01T05:12:28.028Z","type":"message"}
{"nick":"indutny","message":"and stops doing this shit","date":"2013-02-01T05:12:31.202Z","type":"message"}
{"nick":"indutny","message":"ok","date":"2013-02-01T05:12:31.855Z","type":"message"}
{"nick":"indutny","message":"gtg","date":"2013-02-01T05:12:34.334Z","type":"message"}
{"nick":"indutny","message":"ttyl","date":"2013-02-01T05:12:34.820Z","type":"message"}
{"nick":"isaacs","message":"k, have fun","date":"2013-02-01T05:12:37.544Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: having a function in a closure like pipeOnDrain causes v8 to try to recompile the function every time it's returned","date":"2013-02-01T05:14:49.311Z","type":"message"}
{"nick":"trevnorris","message":"and every time it mis judges the type info","date":"2013-02-01T05:15:04.970Z","type":"message"}
{"nick":"trevnorris","message":"isaacs: you'll see something similar with \"marking writeReq.oncomplete\"","date":"2013-02-01T05:16:29.053Z","type":"message"}
{"nick":"isaacs","message":"yeah, fixed that already","date":"2013-02-01T05:16:46.311Z","type":"message"}
{"nick":"trevnorris","message":"it has to recompile every callback that's called.","date":"2013-02-01T05:16:46.436Z","type":"message"}
{"nick":"trevnorris","message":"cool","date":"2013-02-01T05:16:52.975Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: pushed to my fork, branch=stream-pipe-refactor, if you're curious","date":"2013-02-01T05:20:53.093Z","type":"message"}
{"nick":"isaacs","message":"trevnorris: i'm off for the night","date":"2013-02-01T05:20:56.509Z","type":"message"}
{"nick":"trevnorris","message":"cool. i'll take a look. thanks.","date":"2013-02-01T05:21:06.105Z","type":"message"}
{"nick":"dap","reason":"Quit: Leaving.","date":"2013-02-01T05:23:08.021Z","type":"quit"}
{"nick":"wolfeidau","reason":"Remote host closed the connection","date":"2013-02-01T05:27:59.231Z","type":"quit"}
{"nick":"AvianFlu","date":"2013-02-01T05:47:44.622Z","type":"join"}
{"nick":"pooya","reason":"Quit: pooya","date":"2013-02-01T05:58:21.800Z","type":"quit"}
{"nick":"bradleymeck","date":"2013-02-01T06:02:33.115Z","type":"join"}
{"nick":"AvianFlu","reason":"Ping timeout: 276 seconds","date":"2013-02-01T06:13:36.414Z","type":"quit"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2013-02-01T06:19:18.099Z","type":"quit"}
{"nick":"stagas","reason":"Ping timeout: 245 seconds","date":"2013-02-01T06:24:11.085Z","type":"quit"}
{"nick":"wolfeidau","date":"2013-02-01T06:25:40.014Z","type":"join"}
{"nick":"pooya","date":"2013-02-01T06:27:37.323Z","type":"join"}
{"nick":"paddybyers","date":"2013-02-01T06:29:57.901Z","type":"join"}
{"nick":"AvianFlu","date":"2013-02-01T06:33:37.560Z","type":"join"}
{"nick":"abraxas","reason":"Ping timeout: 245 seconds","date":"2013-02-01T06:34:11.826Z","type":"quit"}
{"nick":"abraxas","date":"2013-02-01T07:14:50.481Z","type":"join"}
{"nick":"trevnorris","message":"freaking a. so between v8 versions of v0.8 and v0.9, parseInt changed.","date":"2013-02-01T07:25:34.680Z","type":"message"}
{"nick":"trevnorris","message":"couldn't figure out why a test would pass with one and not the other","date":"2013-02-01T07:25:52.599Z","type":"message"}
{"nick":"pooya","reason":"Quit: pooya","date":"2013-02-01T07:26:28.395Z","type":"quit"}
{"nick":"paddybyers","reason":"Read error: Connection reset by peer","date":"2013-02-01T07:27:53.344Z","type":"quit"}
{"nick":"paddybyers","date":"2013-02-01T07:28:08.166Z","type":"join"}
{"nick":"rendar","date":"2013-02-01T07:28:52.695Z","type":"join"}
{"nick":"pooya","date":"2013-02-01T07:34:08.562Z","type":"join"}
{"nick":"`3rdEden","date":"2013-02-01T07:42:50.428Z","type":"join"}
{"nick":"abraxas","reason":"Remote host closed the connection","date":"2013-02-01T07:51:08.822Z","type":"quit"}
{"nick":"abraxas","date":"2013-02-01T07:51:42.364Z","type":"join"}
{"nick":"paddybyers","reason":"Ping timeout: 264 seconds","date":"2013-02-01T07:56:30.154Z","type":"quit"}
{"nick":"trevnorris","message":"tjfontaine: oh, meant to say. When I say DEOPT, I mean bailout. (e.g. \"**** DEOPT: <fn> at bailout\")","date":"2013-02-01T07:57:15.971Z","type":"message"}
{"nick":"brson","reason":"Ping timeout: 245 seconds","date":"2013-02-01T07:57:31.109Z","type":"quit"}
{"nick":"trevnorris","message":"but guess that's confusing. i'll start saying bailout. ;-)","date":"2013-02-01T07:57:34.308Z","type":"message"}
{"nick":"brson","date":"2013-02-01T07:59:21.804Z","type":"join"}
{"nick":"indutny","message":"yeah","date":"2013-02-01T08:01:29.467Z","type":"message"}
{"nick":"indutny","message":"please do not mess with namings","date":"2013-02-01T08:01:33.745Z","type":"message"}
{"nick":"felixge","date":"2013-02-01T08:05:21.018Z","type":"join"}
{"nick":"felixge","reason":"Changing host","date":"2013-02-01T08:05:23.229Z","type":"quit"}
{"nick":"felixge","date":"2013-02-01T08:05:23.358Z","type":"join"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2013-02-01T08:07:30.220Z","type":"quit"}
{"nick":"EhevuTov","date":"2013-02-01T08:08:51.437Z","type":"join"}
{"nick":"mikeal","date":"2013-02-01T08:11:16.175Z","type":"join"}
{"nick":"paddybyers","date":"2013-02-01T08:19:58.605Z","type":"join"}
{"nick":"pooya","reason":"Quit: pooya","date":"2013-02-01T08:48:42.534Z","type":"quit"}
{"nick":"trevnorris","message":"indutny: guess I started using them interchangeably because can't remember seeing a DEOPT w/ a bailout after it.","date":"2013-02-01T08:52:15.794Z","type":"message"}
{"nick":"indutny","message":"well, bailout and deopt are kind of different things","date":"2013-02-01T08:52:32.505Z","type":"message"}
{"nick":"indutny","message":"deopt happens in runtime","date":"2013-02-01T08:52:41.157Z","type":"message"}
{"nick":"indutny","message":"when some odd inputs received","date":"2013-02-01T08:52:44.654Z","type":"message"}
{"nick":"indutny","message":"bailout happens during optimization","date":"2013-02-01T08:52:48.916Z","type":"message"}
{"nick":"indutny","message":"therefore bailouts are usually happens at program start","date":"2013-02-01T08:53:03.887Z","type":"message"}
{"nick":"indutny","message":"and don't happening afterwards","date":"2013-02-01T08:53:15.443Z","type":"message"}
{"nick":"indutny","message":"and deopts are happening through whole execution time","date":"2013-02-01T08:53:23.511Z","type":"message"}
{"nick":"pooya","date":"2013-02-01T08:55:01.995Z","type":"join"}
{"nick":"trevnorris","message":"interesting. thanks.","date":"2013-02-01T08:55:14.128Z","type":"message"}
{"nick":"indutny","message":"np","date":"2013-02-01T08:55:42.200Z","type":"message"}
{"nick":"trevnorris","message":"don't know why i'm so obsessed with this optimization thing.","date":"2013-02-01T08:56:06.912Z","type":"message"}
{"nick":"indutny","message":"well, its good thing to do","date":"2013-02-01T08:56:20.702Z","type":"message"}
{"nick":"indutny","message":"but you should measure things first","date":"2013-02-01T08:56:24.780Z","type":"message"}
{"nick":"indutny","message":"sometimes it isn't that important","date":"2013-02-01T08:56:31.022Z","type":"message"}
{"nick":"indutny","message":"and also","date":"2013-02-01T08:56:33.319Z","type":"message"}
{"nick":"indutny","message":"v8 is changing","date":"2013-02-01T08:56:38.646Z","type":"message"}
{"nick":"indutny","message":"so eventually some deopts might disappear","date":"2013-02-01T08:56:47.665Z","type":"message"}
{"nick":"indutny","message":"or some might appear","date":"2013-02-01T08:56:51.073Z","type":"message"}
{"nick":"indutny","message":"we should change code carefully, ideally the fastest JS code looks a bit like C","date":"2013-02-01T08:57:11.845Z","type":"message"}
{"nick":"pooya","reason":"Client Quit","date":"2013-02-01T08:57:19.306Z","type":"quit"}
{"nick":"trevnorris","message":"true. guess I see this as more a hobby then part of my programming.","date":"2013-02-01T08:57:19.466Z","type":"message"}
{"nick":"indutny","message":"there're no reason to step beyond this, since quirks won't work forever","date":"2013-02-01T08:57:35.906Z","type":"message"}
{"nick":"trevnorris","message":"just spent 2 hours figuring out the best way to check arguments based on expected inputs (e.g. optional argument types)","date":"2013-02-01T08:58:05.880Z","type":"message"}
{"nick":"trevnorris","message":"yeah. I can't believe how well v8 can inline code.","date":"2013-02-01T08:58:21.633Z","type":"message"}
{"nick":"trevnorris","message":"their handling of Smi's is incredible.","date":"2013-02-01T08:58:34.460Z","type":"message"}
{"nick":"brson","reason":"Remote host closed the connection","date":"2013-02-01T08:59:17.385Z","type":"quit"}
{"nick":"trevnorris","message":"indutny: so what do you think about this approach:","date":"2013-02-01T09:02:33.995Z","type":"message"}
{"nick":"trevnorris","message":"user facing functions basically handle arguments checking, since they're the most likely to slow things down.","date":"2013-02-01T09:02:41.833Z","type":"message"}
{"nick":"trevnorris","message":"then return another function passing the good values, so v8 always knows what to expect.","date":"2013-02-01T09:02:45.692Z","type":"message"}
{"nick":"trevnorris","message":"sort of what I did here: http://git.io/TJkNsQ","date":"2013-02-01T09:05:03.578Z","type":"message"}
{"nick":"indutny","message":"my opinion, benchmark first","date":"2013-02-01T09:07:23.686Z","type":"message"}
{"nick":"indutny","message":"optimize later","date":"2013-02-01T09:07:27.290Z","type":"message"}
{"nick":"indutny","message":"I don't want to touch code that isn't relevant to our performance problems","date":"2013-02-01T09:07:37.877Z","type":"message"}
{"nick":"indutny","message":"because usually time is spent in user-land anyway","date":"2013-02-01T09:07:49.776Z","type":"message"}
{"nick":"trevnorris","message":"true true.","date":"2013-02-01T09:08:53.985Z","type":"message"}
{"nick":"wolfeida_","date":"2013-02-01T09:09:10.979Z","type":"join"}
{"nick":"trevnorris","message":"and definitely understand my micro-performance obsessive side is not my programmer side.","date":"2013-02-01T09:10:08.431Z","type":"message"}
{"nick":"trevnorris","message":"just find it relaxing to pick apart the little things sometimes.","date":"2013-02-01T09:10:22.555Z","type":"message"}
{"nick":"wolfeid__","date":"2013-02-01T09:10:48.428Z","type":"join"}
{"nick":"wolfeidau","reason":"Ping timeout: 276 seconds","date":"2013-02-01T09:11:25.028Z","type":"quit"}
{"nick":"wolfeida_","reason":"Ping timeout: 245 seconds","date":"2013-02-01T09:13:46.814Z","type":"quit"}
{"nick":"EhevuTov","reason":"Quit: This computer has gone to sleep","date":"2013-02-01T09:17:09.894Z","type":"quit"}
{"nick":"EhevuTov","date":"2013-02-01T09:17:43.925Z","type":"join"}
{"nick":"Ralt","reason":"Remote host closed the connection","date":"2013-02-01T09:37:01.277Z","type":"quit"}
{"nick":"trevnorris","message":"indutny: want your opinion. isaacs mentioned something like `var a = []; while (true) a.push(Buffer(1024));` should crash the process before the system runs out of memory.","date":"2013-02-01T09:41:33.848Z","type":"message"}
{"nick":"trevnorris","message":"but it caused my system to halt.","date":"2013-02-01T09:41:46.210Z","type":"message"}
{"nick":"trevnorris","message":"think there should be a failsafe for a process to kill itself if it detects the system is running low?","date":"2013-02-01T09:42:09.237Z","type":"message"}
{"nick":"indutny","message":"wut? :)","date":"2013-02-01T09:42:21.274Z","type":"message"}
{"nick":"indutny","message":"well, you basically want to emulate OOM","date":"2013-02-01T09:42:29.009Z","type":"message"}
{"nick":"indutny","message":"the best way to do it","date":"2013-02-01T09:42:33.987Z","type":"message"}
{"nick":"indutny","message":"is to compile 32bit version of node","date":"2013-02-01T09:42:39.476Z","type":"message"}
{"nick":"indutny","message":"and run this code","date":"2013-02-01T09:42:41.920Z","type":"message"}
{"nick":"indutny","message":"running x64 version will halt your system","date":"2013-02-01T09:42:50.294Z","type":"message"}
{"nick":"indutny","message":"because it'll allocate all available virtual memory too","date":"2013-02-01T09:42:57.270Z","type":"message"}
{"nick":"indutny","message":"and will start swapping out everything you've in RAM","date":"2013-02-01T09:43:09.134Z","type":"message"}
{"nick":"trevnorris","message":"yeah, i'm curious about that. i was monitoring my system while doing that and it halted at 6.3GB of RAM usage, even though I have 8.","date":"2013-02-01T09:43:56.026Z","type":"message"}
{"nick":"trevnorris","message":"maybe it wasn't telling me everything...","date":"2013-02-01T09:44:17.958Z","type":"message"}
{"nick":"trevnorris","message":"well, i'll be jumping off soon, so i'll try the 32bit thing and let you know how it goes.","date":"2013-02-01T09:44:37.484Z","type":"message"}
{"nick":"indutny","message":"ok","date":"2013-02-01T09:45:23.013Z","type":"message"}
{"nick":"trevnorris","message":"well, here we go...","date":"2013-02-01T09:51:58.012Z","type":"message"}
{"nick":"trevnorris","message":"still going, but just got \"terminate called after throwing an instance of 'std::bad_alloc'\"","date":"2013-02-01T09:52:50.726Z","type":"message"}
{"nick":"trevnorris","message":"nice. just died with \"Aborted (core dumped)\"","date":"2013-02-01T09:54:08.118Z","type":"message"}
{"nick":"indutny","message":"yep","date":"2013-02-01T09:54:08.766Z","type":"message"}
{"nick":"indutny","message":"OOM","date":"2013-02-01T09:54:12.421Z","type":"message"}
{"nick":"trevnorris","message":"much better than halting my system.","date":"2013-02-01T09:54:25.714Z","type":"message"}
{"nick":"indutny","message":"yep, that's because 32bit processes are limited to 2gb heap","date":"2013-02-01T09:57:04.029Z","type":"message"}
{"nick":"trevnorris","message":"cool. so think i'd be good to build in a self checker to prevent 64bit systems from blowing up?","date":"2013-02-01T09:58:38.656Z","type":"message"}
{"nick":"googol","reason":"Ping timeout: 264 seconds","date":"2013-02-01T09:59:00.432Z","type":"quit"}
{"nick":"indutny","message":"trevnorris: huh?","date":"2013-02-01T10:00:15.088Z","type":"message"}
{"nick":"indutny","message":"trevnorris: you want to make checker patch for node.js?","date":"2013-02-01T10:00:25.107Z","type":"message"}
{"nick":"trevnorris","message":"indutny: i dunno. just thought that there might be a time a script has memory leak, and since externally allocated memory won't cause the process to die automatically it might be good to have the process check the system/itself and die if a limit was reached.","date":"2013-02-01T10:04:11.340Z","type":"message"}
{"nick":"trevnorris","message":"just a nicety to prevent from having to restart a server if it halted on accident.","date":"2013-02-01T10:04:41.728Z","type":"message"}
{"nick":"indutny","message":"that's OS' work","date":"2013-02-01T10:04:43.437Z","type":"message"}
{"nick":"indutny","message":"you can limit memory available for process","date":"2013-02-01T10:05:02.639Z","type":"message"}
{"nick":"indutny","message":"if you want to","date":"2013-02-01T10:05:04.766Z","type":"message"}
{"nick":"trevnorris","message":"indutny: so we could just tell the OS to not allow a script to allocate more than X MB of external memory?","date":"2013-02-01T10:06:06.751Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-01T10:06:13.916Z","type":"message"}
{"nick":"indutny","message":"well","date":"2013-02-01T10:06:20.833Z","type":"message"}
{"nick":"trevnorris","message":"ah, well that's easy.","date":"2013-02-01T10:06:21.321Z","type":"message"}
{"nick":"indutny","message":"sort of","date":"2013-02-01T10:06:24.188Z","type":"message"}
{"nick":"indutny","message":"but I don't want to do this from node","date":"2013-02-01T10:06:30.305Z","type":"message"}
{"nick":"indutny","message":"this should be done by separate utilities","date":"2013-02-01T10:06:38.337Z","type":"message"}
{"nick":"trevnorris","message":"how do you mean?","date":"2013-02-01T10:06:49.280Z","type":"message"}
{"nick":"indutny","message":"ulimit -m","date":"2013-02-01T10:07:30.174Z","type":"message"}
{"nick":"indutny","message":"ulimit -d","date":"2013-02-01T10:07:31.636Z","type":"message"}
{"nick":"trevnorris","message":"ah, ok.","date":"2013-02-01T10:09:41.732Z","type":"message"}
{"nick":"abraxas","reason":"*.net *.split","date":"2013-02-01T10:10:12.361Z","type":"quit"}
{"nick":"rvagg","reason":"*.net *.split","date":"2013-02-01T10:10:12.623Z","type":"quit"}
{"nick":"abraxas","date":"2013-02-01T10:10:42.460Z","type":"join"}
{"nick":"indutny","message":"ulimit -m seems to be borked","date":"2013-02-01T10:10:43.836Z","type":"message"}
{"nick":"indutny","message":"but ulimit -d should work","date":"2013-02-01T10:10:49.540Z","type":"message"}
{"nick":"trevnorris","message":"so, for example, on a server the node process should run as it's own user with it's own resource limits?","date":"2013-02-01T10:13:03.728Z","type":"message"}
{"nick":"rvagg","date":"2013-02-01T10:13:11.949Z","type":"join"}
{"nick":"indutny","message":"ulimit is not user wide","date":"2013-02-01T10:15:47.853Z","type":"message"}
{"nick":"indutny","message":"its session wide","date":"2013-02-01T10:15:50.962Z","type":"message"}
{"nick":"indutny","message":"but yeah, limits can be applied on user level too","date":"2013-02-01T10:15:59.917Z","type":"message"}
{"nick":"indutny","message":"anyway, I'm not going to teach you this :)","date":"2013-02-01T10:16:05.494Z","type":"message"}
{"nick":"indutny","message":"all this information is pretty easy googlable","date":"2013-02-01T10:16:15.380Z","type":"message"}
{"nick":"trevnorris","message":"man, even with the work on improving streams. still behind ~17%","date":"2013-02-01T10:21:53.094Z","type":"message"}
{"nick":"trevnorris","message":"thanks for the info.","date":"2013-02-01T10:23:37.897Z","type":"message"}
{"nick":"trevnorris","reason":"\"off to bed\"","date":"2013-02-01T10:23:45.403Z","type":"part"}
{"nick":"indutny","message":"ttyl","date":"2013-02-01T10:23:50.504Z","type":"message"}
{"nick":"abraxas","reason":"Remote host closed the connection","date":"2013-02-01T10:31:46.336Z","type":"quit"}
{"nick":"abraxas","date":"2013-02-01T10:32:19.451Z","type":"join"}
{"nick":"abraxas","reason":"Ping timeout: 248 seconds","date":"2013-02-01T10:36:36.734Z","type":"quit"}
{"nick":"EhevuTov","reason":"Quit: This computer has gone to sleep","date":"2013-02-01T10:38:38.152Z","type":"quit"}
{"nick":"AvianFlu","reason":"Read error: Connection reset by peer","date":"2013-02-01T10:52:07.055Z","type":"quit"}
{"nick":"AvianFlu","date":"2013-02-01T10:52:45.880Z","type":"join"}
{"nick":"bnoordhuis","date":"2013-02-01T11:04:09.584Z","type":"join"}
{"nick":"bradleymeck","reason":"Quit: bradleymeck","date":"2013-02-01T11:19:21.704Z","type":"quit"}
{"nick":"indutny","message":"bnoordhuis: morning","date":"2013-02-01T11:24:49.021Z","type":"message"}
{"nick":"bnoordhuis","message":"indutny: hi","date":"2013-02-01T12:02:08.351Z","type":"message"}
{"nick":"indutny","message":"howdy?","date":"2013-02-01T12:02:12.905Z","type":"message"}
{"nick":"indutny","action":"is still fighting with streams2","date":"2013-02-01T12:05:10.270Z","type":"action"}
{"nick":"bnoordhuis","message":"ah, streams2...","date":"2013-02-01T12:22:39.677Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2013-02-01T12:22:49.526Z","type":"message"}
{"nick":"indutny","message":"pretty painful thing","date":"2013-02-01T12:22:56.391Z","type":"message"}
{"nick":"indutny","message":"but I'm starting to believe that it's generally good","date":"2013-02-01T12:23:08.121Z","type":"message"}
{"nick":"bnoordhuis","message":"yes? how come?","date":"2013-02-01T12:23:15.703Z","type":"message"}
{"nick":"bnoordhuis","message":"also, i'm kind of pissed off at the v8 people that they won't accept this patch: https://codereview.chromium.org/11418101","date":"2013-02-01T12:23:30.291Z","type":"message"}
{"nick":"bnoordhuis","message":"it makes the python binary configurable","date":"2013-02-01T12:23:44.110Z","type":"message"}
{"nick":"bnoordhuis","message":"seems innocent enough to me","date":"2013-02-01T12:23:51.377Z","type":"message"}
{"nick":"bnoordhuis","message":"but there's this obstructionist that's blocking it for no good reason afaict","date":"2013-02-01T12:24:07.674Z","type":"message"}
{"nick":"bnoordhuis","message":"maybe we should just fork v8 and be done with it :)","date":"2013-02-01T12:24:20.341Z","type":"message"}
{"nick":"bnoordhuis","message":"okay, back to streams2. what's good about it?","date":"2013-02-01T12:24:32.121Z","type":"message"}
{"nick":"sgallagh","date":"2013-02-01T12:25:26.787Z","type":"join"}
{"nick":"indutny","message":":)","date":"2013-02-01T12:25:47.579Z","type":"message"}
{"nick":"indutny","message":"well, back pressure","date":"2013-02-01T12:25:55.661Z","type":"message"}
{"nick":"indutny","message":"and multiplexing","date":"2013-02-01T12:25:59.285Z","type":"message"}
{"nick":"indutny","message":"well, not multiplexing","date":"2013-02-01T12:26:04.148Z","type":"message"}
{"nick":"indutny","message":"multipiping","date":"2013-02-01T12:26:06.272Z","type":"message"}
{"nick":"indutny","message":"right now it doesn't work at all","date":"2013-02-01T12:26:12.058Z","type":"message"}
{"nick":"indutny","message":"also, I think we might eventually end up emitting 'readable'/'drain' events from libuv","date":"2013-02-01T12:26:30.633Z","type":"message"}
{"nick":"indutny","message":"directly after kevent()/epoll_wait() call","date":"2013-02-01T12:26:42.108Z","type":"message"}
{"nick":"bnoordhuis","message":"why?","date":"2013-02-01T12:26:48.585Z","type":"message"}
{"nick":"indutny","message":"well, why not?","date":"2013-02-01T12:26:55.003Z","type":"message"}
{"nick":"indutny","message":":)","date":"2013-02-01T12:26:55.532Z","type":"message"}
{"nick":"bnoordhuis","message":"why not not?","date":"2013-02-01T12:27:05.447Z","type":"message"}
{"nick":"indutny","message":"well, because its more natural","date":"2013-02-01T12:27:22.933Z","type":"message"}
{"nick":"indutny","message":"don't you think so?","date":"2013-02-01T12:27:25.372Z","type":"message"}
{"nick":"indutny","message":"what do you like more washing hands from firehose","date":"2013-02-01T12:27:47.205Z","type":"message"}
{"nick":"indutny","message":"or washing them in sink","date":"2013-02-01T12:27:50.993Z","type":"message"}
{"nick":"bnoordhuis","message":"'more natural' is not really a convincing argument, fedor :)","date":"2013-02-01T12:27:57.107Z","type":"message"}
{"nick":"indutny","message":"I mean faucet","date":"2013-02-01T12:28:01.795Z","type":"message"}
{"nick":"indutny","message":"ok, it might be too radical :)","date":"2013-02-01T12:28:14.131Z","type":"message"}
{"nick":"indutny","message":"but the idea behind streams2 is pretty good","date":"2013-02-01T12:28:23.021Z","type":"message"}
{"nick":"indutny","message":"and, for example, tls is going to be a way more better","date":"2013-02-01T12:28:36.029Z","type":"message"}
{"nick":"indutny","message":"because of it","date":"2013-02-01T12:28:39.787Z","type":"message"}
{"nick":"indutny","message":"so, before streams2, we was only aware of push-streams","date":"2013-02-01T12:29:08.330Z","type":"message"}
{"nick":"indutny","message":"now we support pull-streams too","date":"2013-02-01T12:29:14.773Z","type":"message"}
{"nick":"indutny","message":"which is very useful too","date":"2013-02-01T12:29:20.290Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: ok, lets turn it around. why do you think its bad?","date":"2013-02-01T12:30:26.414Z","type":"message"}
{"nick":"indutny","message":"I can point few things myself","date":"2013-02-01T12:30:34.552Z","type":"message"}
{"nick":"indutny","message":"(not saying its 100% perfect)","date":"2013-02-01T12:30:39.807Z","type":"message"}
{"nick":"indutny","message":"1) Complex internal logic","date":"2013-02-01T12:30:45.870Z","type":"message"}
{"nick":"indutny","message":"2) Hard to wrap in mind","date":"2013-02-01T12:30:55.529Z","type":"message"}
{"nick":"benoitc","reason":"Excess Flood","date":"2013-02-01T12:33:46.934Z","type":"quit"}
{"nick":"indutny","message":"bnoordhuis: any comments? :)","date":"2013-02-01T12:34:14.015Z","type":"message"}
{"nick":"benoitc","date":"2013-02-01T12:39:02.879Z","type":"join"}
{"nick":"bnoordhuis","message":"indutny: yes, in a minute","date":"2013-02-01T12:40:43.508Z","type":"message"}
{"nick":"qmx|away","new_nick":"qmx","date":"2013-02-01T12:42:55.020Z","type":"nick"}
{"nick":"AvianFlu","reason":"Remote host closed the connection","date":"2013-02-01T13:03:39.479Z","type":"quit"}
{"nick":"indutny","message":"bnoordhuis: delay :)","date":"2013-02-01T13:03:55.023Z","type":"message"}
{"nick":"indutny","message":"i think you hang up","date":"2013-02-01T13:03:58.383Z","type":"message"}
{"nick":"bnoordhuis","message":"such is family life: all delay, all the time","date":"2013-02-01T13:04:24.387Z","type":"message"}
{"nick":"indutny","message":"oh good","date":"2013-02-01T13:04:53.769Z","type":"message"}
{"nick":"indutny","message":"s/oo/o/","date":"2013-02-01T13:05:00.212Z","type":"message"}
{"nick":"bnoordhuis","message":"re events, libuv has a 'not needed? not added' policy","date":"2013-02-01T13:05:03.385Z","type":"message"}
{"nick":"indutny","message":"ok, lets pretend I wasn't saying that kevent/epoll_wait thing","date":"2013-02-01T13:07:16.703Z","type":"message"}
{"nick":"indutny","message":"any other objections against streams2?","date":"2013-02-01T13:07:22.916Z","type":"message"}
{"nick":"bnoordhuis","message":"from me? no","date":"2013-02-01T13:23:35.596Z","type":"message"}
{"nick":"indutny","message":"k","date":"2013-02-01T13:24:36.880Z","type":"message"}
{"nick":"indutny","message":"ok, gtg","date":"2013-02-01T13:31:30.467Z","type":"message"}
{"nick":"hz","date":"2013-02-01T13:32:24.422Z","type":"join"}
{"nick":"sgallagh","reason":"Remote host closed the connection","date":"2013-02-01T13:33:44.083Z","type":"quit"}
{"nick":"sgallagh","date":"2013-02-01T13:42:59.981Z","type":"join"}
{"nick":"rendar","reason":"Ping timeout: 245 seconds","date":"2013-02-01T13:52:56.826Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-01T13:53:17.387Z","type":"join"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2013-02-01T13:55:30.961Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-01T13:56:07.596Z","type":"join"}
{"nick":"rendar","date":"2013-02-01T13:57:05.505Z","type":"join"}
{"nick":"jmar777","reason":"Ping timeout: 264 seconds","date":"2013-02-01T14:00:48.430Z","type":"quit"}
{"nick":"jmar777","date":"2013-02-01T14:02:20.303Z","type":"join"}
{"nick":"stagas","date":"2013-02-01T14:15:05.237Z","type":"join"}
{"nick":"hz","reason":"Read error: Connection reset by peer","date":"2013-02-01T14:35:26.473Z","type":"quit"}
{"nick":"hz","date":"2013-02-01T14:35:56.419Z","type":"join"}
{"nick":"bradleymeck","date":"2013-02-01T15:11:12.320Z","type":"join"}
{"nick":"c4milo","date":"2013-02-01T15:19:19.456Z","type":"join"}
{"nick":"isaacs","message":"good morning","date":"2013-02-01T15:22:33.011Z","type":"message"}
{"nick":"isaacs","message":"indutny, trevnorris: We're not going to check for OOM errors in node.  that is the operating system's job.  run your node in a vm or zone and limit the whole operating system, or throw it away if it blows up.","date":"2013-02-01T15:27:36.417Z","type":"message"}
{"nick":"isaacs","message":"indutny: i had an idea as i was waking up this morning, actually, about multipiping.","date":"2013-02-01T15:28:04.361Z","type":"message"}
{"nick":"isaacs","message":"indutny: right now, we pipe() to multiple places, then we keep track of how many need to drain, and wait for them all.","date":"2013-02-01T15:28:33.947Z","type":"message"}
{"nick":"isaacs","message":"indutny: but it means more complicated logic.","date":"2013-02-01T15:28:38.427Z","type":"message"}
{"nick":"isaacs","message":"indutny: with streams1, we just resume() on *any* drain event.","date":"2013-02-01T15:28:49.477Z","type":"message"}
{"nick":"isaacs","message":"indutny: so, if you do s.pipe(fast);s.pipe(slow)","date":"2013-02-01T15:29:01.937Z","type":"message"}
{"nick":"isaacs","message":"let's say they both return false.","date":"2013-02-01T15:29:10.546Z","type":"message"}
{"nick":"isaacs","message":"indutny: then fast.emit('drain')","date":"2013-02-01T15:29:16.086Z","type":"message"}
{"nick":"isaacs","message":"but slow hasn't","date":"2013-02-01T15:29:18.016Z","type":"message"}
{"nick":"isaacs","message":"indutny: now you write another chunk to both of them.  and slow returns false again, and you pause again","date":"2013-02-01T15:29:32.966Z","type":"message"}
{"nick":"isaacs","message":"indutny: the only way that's a problem is if they're both repeatedly returning false, and one of them emits drain much faster every time.","date":"2013-02-01T15:29:52.736Z","type":"message"}
{"nick":"isaacs","message":"then slow will blow up","date":"2013-02-01T15:29:55.776Z","type":"message"}
{"nick":"isaacs","message":"indutny: but with high/low watermarks, that won't usually happen.  fast will be empty, and slow won't so slow will be the only one returning false.","date":"2013-02-01T15:30:26.246Z","type":"message"}
{"nick":"isaacs","message":"indutny:  so... i think we can get rid of the awaitDrain counter entirely.  it just means that multipipe will be a bit more aggressive.","date":"2013-02-01T15:30:43.606Z","type":"message"}
{"nick":"isaacs","message":"indutny: the current setup is slowing down the common case in favor of an uncommon edge case","date":"2013-02-01T15:31:54.265Z","type":"message"}
{"nick":"mmalecki","new_nick":"mmalecki[out]","date":"2013-02-01T15:34:46.062Z","type":"nick"}
{"nick":"isaacs","message":"nevermind, it doesn't make a difference at all.","date":"2013-02-01T15:39:48.070Z","type":"message"}
{"nick":"isaacs","message":"optimizing code that runs on a vm is hard.","date":"2013-02-01T15:39:58.539Z","type":"message"}
{"nick":"pooya","date":"2013-02-01T15:42:48.385Z","type":"join"}
{"nick":"AvianFlu","date":"2013-02-01T15:57:21.628Z","type":"join"}
{"nick":"piscisaureus_","date":"2013-02-01T15:57:56.358Z","type":"join"}
