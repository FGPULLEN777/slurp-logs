{"nick":"ircretary","reason":"Remote host closed the connection","date":"2012-12-12T00:00:00.617Z","type":"quit"}
{"nick":"isaacs","message":"piscisaureus_: sorry, the last two \"update libuv\" in node.","date":"2012-12-12T00:00:03.798Z","type":"message"}
{"nick":"ircretary","date":"2012-12-12T00:00:07.697Z","type":"join"}
{"nick":"piscisaureus_","message":"ah","date":"2012-12-12T00:00:14.819Z","type":"message"}
{"nick":"piscisaureus_","message":"could be related to the rm-ev stuff","date":"2012-12-12T00:00:27.097Z","type":"message"}
{"nick":"piscisaureus_","message":"you should talk to ben about that","date":"2012-12-12T00:00:31.371Z","type":"message"}
{"nick":"piscisaureus_","message":"a test case would help very much I think :-)","date":"2012-12-12T00:00:40.066Z","type":"message"}
{"nick":"isaacs","message":"* bbc3af4 isaacs Revert \"deps: upgrade libuv to fc5984f\" (31 hours ago)","date":"2012-12-12T00:00:41.194Z","type":"message"}
{"nick":"isaacs","message":"* a8a12ff isaacs Revert \"deps: upgrade libuv to 665a316\" (32 hours ago)","date":"2012-12-12T00:00:41.327Z","type":"message"}
{"nick":"isaacs","message":"* 8ba1bec Ben Noordhuis deps: upgrade libuv to fc5984f (3 weeks ago)","date":"2012-12-12T00:00:41.456Z","type":"message"}
{"nick":"isaacs","message":"* b6a3b0a Ben Noordhuis deps: upgrade libuv to 665a316 (4 weeks ago)","date":"2012-12-12T00:00:41.457Z","type":"message"}
{"nick":"isaacs","message":"* a7ac1a1 Ben Noordhuis deps: upgrade libuv to 0ddf9d6 (5 weeks ago)","date":"2012-12-12T00:00:41.684Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: yeah, i'm working on a more minimal test case.","date":"2012-12-12T00:00:56.664Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: right now, only simple/test-tls-pause fails as a result of it, because it's the only case where we do a huge write.","date":"2012-12-12T00:01:16.503Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: but also the benchmark/net-pipe.js breaks","date":"2012-12-12T00:01:25.066Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: the rm-ev stuff is pretty invasive (but important) so bugs are not entirely unexpected in that area","date":"2012-12-12T00:01:37.158Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: so I think we should release 0.10 as soon as streams2 plus some openssl stuff stabilizes","date":"2012-12-12T00:02:31.921Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: yeah, i'm guessing that there's a bug in libuv that is being triggered by streams2 but not by master, so we should work that out","date":"2012-12-12T00:02:40.579Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: agreed.  0.10 will be streams2 plus whatever else we finish by then.","date":"2012-12-12T00:02:51.285Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: but we need to either sort out the libev removal breakage, or roll it back.","date":"2012-12-12T00:03:12.307Z","type":"message"}
{"nick":"isaacs","message":"i'd much MUCH prefer to actually remove it, and just fix the bug","date":"2012-12-12T00:03:19.985Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: not roll back. Just fix","date":"2012-12-12T00:03:26.527Z","type":"message"}
{"nick":"piscisaureus_","message":"it's very close to being good","date":"2012-12-12T00:03:31.211Z","type":"message"}
{"nick":"isaacs","message":"(ie, actually remove libev, not remove the removal)","date":"2012-12-12T00:03:34.104Z","type":"message"}
{"nick":"isaacs","message":"right","date":"2012-12-12T00:03:41.134Z","type":"message"}
{"nick":"isaacs","message":"i feel that we are of a similar mind on this","date":"2012-12-12T00:03:46.806Z","type":"message"}
{"nick":"piscisaureus_","message":"in libuv not much needs to change otherwise except improve the new thread pool","date":"2012-12-12T00:03:48.314Z","type":"message"}
{"nick":"isaacs","message":"right","date":"2012-12-12T00:03:55.083Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: I discussed this with ben today, it's pretty clear on a detailed level what needs to be done","date":"2012-12-12T00:04:08.916Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: for the treadpool, or for libev removal?","date":"2012-12-12T00:06:07.524Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: threadpool","date":"2012-12-12T00:06:18.243Z","type":"message"}
{"nick":"piscisaureus_","message":"that's the \"other\" thing","date":"2012-12-12T00:06:21.642Z","type":"message"}
{"nick":"isaacs","message":"ah, right.","date":"2012-12-12T00:06:39.606Z","type":"message"}
{"nick":"isaacs","message":"ok","date":"2012-12-12T00:06:40.142Z","type":"message"}
{"nick":"isaacs","message":"that sounds great :)","date":"2012-12-12T00:06:42.904Z","type":"message"}
{"nick":"ArmyOfBruce","reason":"Excess Flood","date":"2012-12-12T00:20:13.686Z","type":"quit"}
{"nick":"ArmyOfBruce","date":"2012-12-12T00:20:41.628Z","type":"join"}
{"nick":"brson","reason":"Remote host closed the connection","date":"2012-12-12T00:20:44.860Z","type":"quit"}
{"nick":"brson","date":"2012-12-12T00:23:13.849Z","type":"join"}
{"nick":"isaacs","message":"piscisaureus_: so... i took this tcp-raw.js thing, and i changed it so that it's using a net.js client","date":"2012-12-12T00:58:48.533Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: and, what's really weird, the client ends up in the activeHandles, and the program hangs open","date":"2012-12-12T00:59:33.238Z","type":"message"}
{"nick":"isaacs","message":"even calling client.unref() doesn't make it stop..","date":"2012-12-12T01:00:03.933Z","type":"message"}
{"nick":"warz","date":"2012-12-12T01:00:29.510Z","type":"join"}
{"nick":"warz","reason":"Changing host","date":"2012-12-12T01:00:29.913Z","type":"quit"}
{"nick":"warz","date":"2012-12-12T01:00:30.048Z","type":"join"}
{"nick":"piscisaureus_","message":"isaacs: weird that unref() doesn't work.","date":"2012-12-12T01:09:47.522Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: yeah","date":"2012-12-12T01:10:04.804Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: what does process._getActiveHandles() and process._getActiveRequests show?","date":"2012-12-12T01:10:05.637Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: also, if you call client.close() does it stop","date":"2012-12-12T01:11:05.754Z","type":"message"}
{"nick":"piscisaureus_","message":"?","date":"2012-12-12T01:11:06.556Z","type":"message"}
{"nick":"isaacs","message":"i'm calling client.close()","date":"2012-12-12T01:11:28.207Z","type":"message"}
{"nick":"isaacs","message":"oh, wait, no, i'm not","date":"2012-12-12T01:11:45.054Z","type":"message"}
{"nick":"isaacs","message":"and yes, it does","date":"2012-12-12T01:11:46.506Z","type":"message"}
{"nick":"isaacs","message":"{ oncomplete: [Function: afterShutdown] }","date":"2012-12-12T01:11:48.155Z","type":"message"}
{"nick":"isaacs","message":"that's the diff, it looks like ^","date":"2012-12-12T01:11:54.684Z","type":"message"}
{"nick":"isaacs","message":"  this._handle.close();","date":"2012-12-12T01:12:18.223Z","type":"message"}
{"nick":"isaacs","message":"that closes it","date":"2012-12-12T01:12:21.463Z","type":"message"}
{"nick":"piscisaureus_","message":"so it should also exit if you unref it","date":"2012-12-12T01:12:40.389Z","type":"message"}
{"nick":"piscisaureus_","message":"there may be a bug in that code path somehow","date":"2012-12-12T01:12:55.732Z","type":"message"}
{"nick":"piscisaureus_","message":"in node 0.8, process.stdin._handle.close() makes node exit","date":"2012-12-12T01:13:30.807Z","type":"message"}
{"nick":"piscisaureus_","message":"as does process.stdin._handle.unref()","date":"2012-12-12T01:13:54.096Z","type":"message"}
{"nick":"piscisaureus_","message":"so at least it works sometimes ;-)","date":"2012-12-12T01:14:00.015Z","type":"message"}
{"nick":"isaacs","message":"right","date":"2012-12-12T01:14:40.442Z","type":"message"}
{"nick":"isaacs","message":"this is just a plain old tcp client","date":"2012-12-12T01:14:49.522Z","type":"message"}
{"nick":"isaacs","message":"not stdin","date":"2012-12-12T01:14:50.982Z","type":"message"}
{"nick":"isaacs","message":"but yeah, it looks like client._handle.close() is being called by master, but not by streams2-net","date":"2012-12-12T01:15:06.129Z","type":"message"}
{"nick":"piscisaureus_","message":"well, that's a problem :-)","date":"2012-12-12T01:15:17.935Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: if you would readStop() then it would also exit I think","date":"2012-12-12T01:15:31.787Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: but as long as there is a tcp handle that is reading or writing, it wont exit","date":"2012-12-12T01:15:52.146Z","type":"message"}
{"nick":"isaacs","message":"right","date":"2012-12-12T01:19:07.469Z","type":"message"}
{"nick":"isaacs","message":"yeah, it's weird.  so, i'm calling handle.close(), but then later, it seems to want that to be called again","date":"2012-12-12T01:19:22.340Z","type":"message"}
{"nick":"piscisaureus_","message":"that's wonly","date":"2012-12-12T01:19:34.313Z","type":"message"}
{"nick":"piscisaureus_","message":"*wonky","date":"2012-12-12T01:19:40.430Z","type":"message"}
{"nick":"piscisaureus_","message":"calling close() twice would most likely crash node, not make it work :-)","date":"2012-12-12T01:20:00.432Z","type":"message"}
{"nick":"piscisaureus_","message":"it'd be really nice if there was a reduced test case that we can use to debug libuv","date":"2012-12-12T01:20:18.891Z","type":"message"}
{"nick":"deoxxa","message":"isaacs: is that your kitty in your avatar on github? :3","date":"2012-12-12T01:20:31.171Z","type":"message"}
{"nick":"isaacs","message":"deoxxa: yessir","date":"2012-12-12T01:21:15.092Z","type":"message"}
{"nick":"deoxxa","message":"meow :3","date":"2012-12-12T01:21:19.065Z","type":"message"}
{"nick":"deoxxa","message":"i miss my cats now","date":"2012-12-12T01:21:33.520Z","type":"message"}
{"nick":"lohkey","date":"2012-12-12T01:29:21.573Z","type":"part"}
{"nick":"isaacs","message":"piscisaureus_: interesting.  i'm calling shutdown() twice.","date":"2012-12-12T01:31:18.011Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: that's the problem.","date":"2012-12-12T01:31:20.921Z","type":"message"}
{"nick":"piscisaureus_","message":"'ah","date":"2012-12-12T01:31:30.516Z","type":"message"}
{"nick":"piscisaureus_","message":"sounds like a libuv bug","date":"2012-12-12T01:31:35.991Z","type":"message"}
{"nick":"piscisaureus_","message":"or a bug in the binding layer","date":"2012-12-12T01:31:40.826Z","type":"message"}
{"nick":"piscisaureus_","message":"most likely libuv (by itself) would trigger an assertion fail if you did that","date":"2012-12-12T01:32:03.990Z","type":"message"}
{"nick":"isaacs","message":"yep, that's the thing","date":"2012-12-12T01:32:25.398Z","type":"message"}
{"nick":"piscisaureus_","message":"the second shutdown() probably would never actually happen, but as it is a req it keeps the lop alive","date":"2012-12-12T01:32:27.669Z","type":"message"}
{"nick":"isaacs","message":"yes.","date":"2012-12-12T01:32:34.924Z","type":"message"}
{"nick":"isaacs","message":"ok, well, this is a bug.  tracked it down.  all in a day's work :)","date":"2012-12-12T01:32:53.675Z","type":"message"}
{"nick":"isaacs","message":"now how to write a test for it...","date":"2012-12-12T01:32:57.703Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: the binding layer is pretty fragile atm, e.g. if you use it incorrectly weird stuff happens","date":"2012-12-12T01:33:00.357Z","type":"message"}
{"nick":"isaacs","message":"yeah","date":"2012-12-12T01:33:04.478Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: that's why people should not :-)","date":"2012-12-12T01:33:08.564Z","type":"message"}
{"nick":"isaacs","message":"oh, for sure","date":"2012-12-12T01:33:14.193Z","type":"message"}
{"nick":"isaacs","message":"it's undocumented and awful.","date":"2012-12-12T01:33:17.925Z","type":"message"}
{"nick":"piscisaureus_","message":"(and possibly a good reason to harden the binding layer)","date":"2012-12-12T01:33:20.929Z","type":"message"}
{"nick":"isaacs","message":"and insanely verbose","date":"2012-12-12T01:33:23.645Z","type":"message"}
{"nick":"isaacs","message":"we can make it nice later.","date":"2012-12-12T01:33:28.704Z","type":"message"}
{"nick":"erickt","date":"2012-12-12T01:33:31.470Z","type":"join"}
{"nick":"isaacs","message":"it'd be nice if it was prettier","date":"2012-12-12T01:33:33.052Z","type":"message"}
{"nick":"isaacs","message":"if only to make the node internals easier to read","date":"2012-12-12T01:33:39.151Z","type":"message"}
{"nick":"piscisaureus_","message":"what is so verbose about that?","date":"2012-12-12T01:33:41.463Z","type":"message"}
{"nick":"piscisaureus_","message":"s/that/it/?","date":"2012-12-12T01:33:47.432Z","type":"message"}
{"nick":"pquerna","reason":"Read error: Operation timed out","date":"2012-12-12T01:34:22.004Z","type":"quit"}
{"nick":"isaacs","message":"compared with using require('net')?","date":"2012-12-12T01:35:09.390Z","type":"message"}
{"nick":"isaacs","message":"you're... joking, right?","date":"2012-12-12T01:35:12.748Z","type":"message"}
{"nick":"mjr_","reason":"Quit: mjr_","date":"2012-12-12T01:35:26.017Z","type":"quit"}
{"nick":"isaacs","message":"it's beer time.  thanks for your help, piscisaureus_.","date":"2012-12-12T01:38:28.397Z","type":"message"}
{"nick":"pquerna","date":"2012-12-12T01:39:58.732Z","type":"join"}
{"nick":"pquerna","reason":"Changing host","date":"2012-12-12T01:39:59.170Z","type":"quit"}
{"nick":"pquerna","date":"2012-12-12T01:39:59.305Z","type":"join"}
{"nick":"dap","reason":"Quit: Leaving.","date":"2012-12-12T01:44:23.875Z","type":"quit"}
{"nick":"piscisaureus_","message":"isaacs: ah, yeah compare to net it's verbose :-)","date":"2012-12-12T01:46:47.785Z","type":"message"}
{"nick":"piscisaureus_","message":"but it's nice compared to what happens under the hood","date":"2012-12-12T01:47:02.316Z","type":"message"}
{"nick":"abraxas","date":"2012-12-12T01:47:08.291Z","type":"join"}
{"nick":"piscisaureus_","message":"that's why I do a talk about require('net').connect(80, 'nyan.cat').pipe(process.stdout), and just superficially discuss the public libuv interface","date":"2012-12-12T01:48:02.741Z","type":"message"}
{"nick":"piscisaureus_","message":"and, what libuv has to do is still nice compared to what the kernel actually does","date":"2012-12-12T01:48:21.385Z","type":"message"}
{"nick":"piscisaureus_","message":"welcome to vertical economies :-)","date":"2012-12-12T01:48:39.305Z","type":"message"}
{"nick":"jmar777","date":"2012-12-12T01:50:09.800Z","type":"join"}
{"nick":"lohkey_","date":"2012-12-12T01:52:10.649Z","type":"join"}
{"nick":"lohkey_","reason":"Client Quit","date":"2012-12-12T01:52:10.649Z","type":"quit"}
{"nick":"indexzero","date":"2012-12-12T01:53:04.189Z","type":"join"}
{"nick":"piscisaureus_","reason":"Ping timeout: 250 seconds","date":"2012-12-12T02:04:46.621Z","type":"quit"}
{"nick":"mjr_","date":"2012-12-12T02:10:01.459Z","type":"join"}
{"nick":"joshthecoder","reason":"Quit: Leaving...","date":"2012-12-12T02:16:23.676Z","type":"quit"}
{"nick":"rje`mac","reason":"Ping timeout: 240 seconds","date":"2012-12-12T02:18:14.641Z","type":"quit"}
{"nick":"mjr_","reason":"Ping timeout: 255 seconds","date":"2012-12-12T02:18:29.485Z","type":"quit"}
{"nick":"rje","reason":"Ping timeout: 240 seconds","date":"2012-12-12T02:20:14.643Z","type":"quit"}
{"nick":"rje`mac","date":"2012-12-12T02:30:58.013Z","type":"join"}
{"nick":"rje","date":"2012-12-12T02:31:27.302Z","type":"join"}
{"nick":"ArmyOfBruce","new_nick":"brucem","date":"2012-12-12T02:35:18.117Z","type":"nick"}
{"nick":"erickt","reason":"Quit: erickt","date":"2012-12-12T02:38:14.139Z","type":"quit"}
{"nick":"erickt","date":"2012-12-12T02:39:37.848Z","type":"join"}
{"nick":"abraxas","reason":"Remote host closed the connection","date":"2012-12-12T02:44:16.660Z","type":"quit"}
{"nick":"abraxas","date":"2012-12-12T02:56:57.287Z","type":"join"}
{"nick":"brson","reason":"Ping timeout: 265 seconds","date":"2012-12-12T03:05:38.810Z","type":"quit"}
{"nick":"sblom","date":"2012-12-12T03:07:20.411Z","type":"quit"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2012-12-12T03:16:26.168Z","type":"quit"}
{"nick":"dap","date":"2012-12-12T03:23:57.418Z","type":"join"}
{"nick":"warz","date":"2012-12-12T03:39:50.386Z","type":"quit"}
{"nick":"kazupon","date":"2012-12-12T03:49:38.153Z","type":"join"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-12-12T04:12:34.765Z","type":"quit"}
{"nick":"erickt","reason":"Quit: erickt","date":"2012-12-12T04:14:33.958Z","type":"quit"}
{"nick":"loladiro","date":"2012-12-12T04:16:51.797Z","type":"join"}
{"nick":"lohkey","date":"2012-12-12T04:24:34.587Z","type":"join"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-12-12T04:24:57.007Z","type":"quit"}
{"nick":"TooTallNate","reason":"Quit: [\"Textual IRC Client: www.textualapp.com\"]","date":"2012-12-12T04:34:53.642Z","type":"quit"}
{"nick":"mmalecki","new_nick":"mmalecki[away]","date":"2012-12-12T04:37:11.014Z","type":"nick"}
{"nick":"loladiro","date":"2012-12-12T04:40:10.380Z","type":"join"}
{"nick":"ryah","date":"2012-12-12T04:51:16.725Z","type":"join"}
{"nick":"Benvie","date":"2012-12-12T05:27:18.458Z","type":"quit"}
{"nick":"joshthecoder","date":"2012-12-12T05:27:23.164Z","type":"join"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2012-12-12T05:54:15.097Z","type":"quit"}
{"nick":"dap","reason":"Quit: Leaving.","date":"2012-12-12T05:58:01.339Z","type":"quit"}
{"nick":"abraxas","reason":"Read error: Connection reset by peer","date":"2012-12-12T06:00:03.413Z","type":"quit"}
{"nick":"abraxas","date":"2012-12-12T06:00:28.592Z","type":"join"}
{"nick":"lohkey","reason":"Quit: lohkey","date":"2012-12-12T06:08:45.817Z","type":"quit"}
{"nick":"`3rdEden","date":"2012-12-12T07:44:52.775Z","type":"join"}
{"nick":"stagas","date":"2012-12-12T07:52:21.612Z","type":"join"}
{"nick":"bnoordhuis","date":"2012-12-12T07:54:25.288Z","type":"join"}
{"nick":"joshthecoder","reason":"Quit: Linkinus - http://linkinus.com","date":"2012-12-12T07:55:15.052Z","type":"quit"}
{"nick":"rendar","date":"2012-12-12T07:58:25.129Z","type":"join"}
{"nick":"bnoordhuis","message":"morning all","date":"2012-12-12T08:12:05.168Z","type":"message"}
{"nick":"ryah","reason":"Quit: Lost terminal","date":"2012-12-12T08:29:25.685Z","type":"quit"}
{"nick":"Benvie","date":"2012-12-12T08:36:33.876Z","type":"join"}
{"nick":"Benvie","date":"2012-12-12T08:41:32.141Z","type":"quit"}
{"nick":"bnoordhuis","message":"isaacs: still around?","date":"2012-12-12T08:41:51.440Z","type":"message"}
{"nick":"Benvie","date":"2012-12-12T08:42:47.539Z","type":"join"}
{"nick":"isaacs","message":"bnoordhuis: just barely","date":"2012-12-12T08:53:36.650Z","type":"message"}
{"nick":"bnoordhuis","message":"isaacs: hey. so about streams2","date":"2012-12-12T08:53:47.063Z","type":"message"}
{"nick":"bnoordhuis","message":"did you manage to get some kind of reduced test case going?","date":"2012-12-12T08:54:11.660Z","type":"message"}
{"nick":"isaacs","message":"i got close to one","date":"2012-12-12T08:54:17.943Z","type":"message"}
{"nick":"isaacs","message":"in the process i figured out that i'm calling shutdown() two times in the client, which is wrong","date":"2012-12-12T08:54:29.074Z","type":"message"}
{"nick":"isaacs","message":"but i don't think that's the core issue","date":"2012-12-12T08:54:34.542Z","type":"message"}
{"nick":"bnoordhuis","message":"did you see that test case i posted?","date":"2012-12-12T08:54:47.271Z","type":"message"}
{"nick":"isaacs","message":"https://gist.github.com/4263245","date":"2012-12-12T08:54:47.493Z","type":"message"}
{"nick":"isaacs","message":"no, where is it?","date":"2012-12-12T08:54:57.166Z","type":"message"}
{"nick":"bnoordhuis","message":"one sec, i'll dig it up","date":"2012-12-12T08:55:24.159Z","type":"message"}
{"nick":"bnoordhuis","message":"isaacs: https://gist.github.com/c9c968b1d8c7579bdff6","date":"2012-12-12T08:55:36.310Z","type":"message"}
{"nick":"isaacs","message":"so, i'm testing just the raw tcp_wrap interface client and server, and then the tcp_wrap server with net client, adn next i'm going to test the raw client vs net server.","date":"2012-12-12T08:55:42.434Z","type":"message"}
{"nick":"isaacs","message":"awesome.","date":"2012-12-12T08:56:16.903Z","type":"message"}
{"nick":"isaacs","message":"that's effectively what i'm doing with the raw business","date":"2012-12-12T08:56:26.466Z","type":"message"}
{"nick":"bnoordhuis","message":"okay, neat","date":"2012-12-12T08:56:31.174Z","type":"message"}
{"nick":"bnoordhuis","message":"so it works fine with master but it hangs at n=0 with streams2","date":"2012-12-12T08:56:41.095Z","type":"message"}
{"nick":"bnoordhuis","message":"for reasons i don't quite comprehend - but hopefully you do","date":"2012-12-12T08:56:54.846Z","type":"message"}
{"nick":"isaacs","message":"yes.","date":"2012-12-12T08:57:06.432Z","type":"message"}
{"nick":"isaacs","message":"i don't comprehend them either :)","date":"2012-12-12T08:57:11.159Z","type":"message"}
{"nick":"isaacs","message":"but hopefully i'll have something reduced more by tomorrow","date":"2012-12-12T08:57:19.261Z","type":"message"}
{"nick":"isaacs","message":"0.8.16 tomorrow, 0.9.4 thursday","date":"2012-12-12T08:57:36.885Z","type":"message"}
{"nick":"bnoordhuis","message":"sweet","date":"2012-12-12T08:57:43.528Z","type":"message"}
{"nick":"bnoordhuis","message":"if i have some time today, i'll look some more at streams2","date":"2012-12-12T08:57:51.575Z","type":"message"}
{"nick":"isaacs","message":"probably sans-streams2-net, unless we figure it out and it's easy","date":"2012-12-12T08:57:52.300Z","type":"message"}
{"nick":"isaacs","message":"kk","date":"2012-12-12T08:57:55.251Z","type":"message"}
{"nick":"MI6","message":"\u0002joyent/node:\u0002 \u00033Ben Noordhuis\u000f \u00037v0.8\u000f * \u0002d65832c\u0002 : fs: fix WriteStream fd leak  Close the file descriptor when a write opera (+2 more commits) - http://git.io/n_MfXw","date":"2012-12-12T08:58:22.943Z","type":"message"}
{"nick":"MI6","message":"\u0002joyent/node:\u0002 \u00033isaacs\u000f \u00037streams2-stdin-wip\u000f * \u00026a2ea26\u0002 : streams2: Call read(0) on resume()  Otherwise (especially with stdin) you (+2 more commits) - http://git.io/UkwdkA","date":"2012-12-12T08:59:02.989Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: that branch has the current state of things. commit history is a godawful mess ^","date":"2012-12-12T08:59:10.700Z","type":"message"}
{"nick":"bnoordhuis","message":"hah","date":"2012-12-12T08:59:15.660Z","type":"message"}
{"nick":"MI6","message":"\u0002joyent/node:\u0002 \u00033isaacs\u000f \u00037streams2-stdin-wip\u000f * \u0002249af3b\u0002 : net: Don't call shutdown more than once - http://git.io/Dy05lg","date":"2012-12-12T09:00:10.036Z","type":"message"}
{"nick":"sergim","date":"2012-12-12T09:01:30.710Z","type":"join"}
{"nick":"isaacs","message":"oh, i guess that has the reverts of the libuv changes.","date":"2012-12-12T09:02:48.882Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: ohhh....","date":"2012-12-12T09:03:30.442Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: in your test, you need to do conn.resume()","date":"2012-12-12T09:03:36.281Z","type":"message"}
{"nick":"isaacs","message":"bnoordhuis: the server is backed up because it's trying to write, and the client isn't reading it","date":"2012-12-12T09:03:50.221Z","type":"message"}
{"nick":"bnoordhuis","message":"isn't that a change from the old net api?","date":"2012-12-12T09:03:55.502Z","type":"message"}
{"nick":"isaacs","message":"yes, it is a change.","date":"2012-12-12T09:04:01.841Z","type":"message"}
{"nick":"bnoordhuis","message":"i thought the idea was to be backwards compatible","date":"2012-12-12T09:04:03.160Z","type":"message"}
{"nick":"isaacs","message":"yes, that is the idea.","date":"2012-12-12T09:04:08.931Z","type":"message"}
{"nick":"isaacs","message":"but i'm not sure how that's possible in this case.","date":"2012-12-12T09:04:15.376Z","type":"message"}
{"nick":"isaacs","message":"we can't solve the \"data events come right away ready or not\" problem without introducing the \"you have to do something to get the flow to happen\" problem","date":"2012-12-12T09:04:43.803Z","type":"message"}
{"nick":"bnoordhuis","message":"ah... that sounds like a pretty big change","date":"2012-12-12T09:05:10.332Z","type":"message"}
{"nick":"bnoordhuis","message":"the subject of many future angry blog posts","date":"2012-12-12T09:05:34.128Z","type":"message"}
{"nick":"isaacs","message":"perhaps","date":"2012-12-12T09:05:44.112Z","type":"message"}
{"nick":"isaacs","message":"all the more reason to get a 0.9 out asap with the change","date":"2012-12-12T09:05:52.212Z","type":"message"}
{"nick":"isaacs","message":"while we can still cheaply change it","date":"2012-12-12T09:06:03.789Z","type":"message"}
{"nick":"isaacs","message":"i *suspect* that it's rare that you make a request somewhere, and then don't care about the results.","date":"2012-12-12T09:07:06.779Z","type":"message"}
{"nick":"bnoordhuis","message":"what if i add a 'data' event listener?","date":"2012-12-12T09:07:29.820Z","type":"message"}
{"nick":"bnoordhuis","message":"should that auto-trigger resume()?","date":"2012-12-12T09:07:44.555Z","type":"message"}
{"nick":"isaacs","message":"that'd do it","date":"2012-12-12T09:07:46.101Z","type":"message"}
{"nick":"isaacs","message":"yes","date":"2012-12-12T09:07:47.398Z","type":"message"}
{"nick":"isaacs","message":".pipe() will also make it read() repeatedly until the end","date":"2012-12-12T09:07:55.332Z","type":"message"}
{"nick":"isaacs","message":"  net.createConnection(1234, function() { write(this) ; this.resume() });","date":"2012-12-12T09:08:08.833Z","type":"message"}
{"nick":"bnoordhuis","message":"right","date":"2012-12-12T09:08:20.458Z","type":"message"}
{"nick":"isaacs","message":"with that, i get up to 99, and then EPIPE","date":"2012-12-12T09:08:29.666Z","type":"message"}
{"nick":"isaacs","message":"the EPIPE seems wrong","date":"2012-12-12T09:08:39.875Z","type":"message"}
{"nick":"bnoordhuis","message":"so i don't know how common that usage pattern is but i've used it in the past for fire-and-forget things","date":"2012-12-12T09:08:47.573Z","type":"message"}
{"nick":"isaacs","message":"oh, master epipe's a bit, too","date":"2012-12-12T09:08:49.569Z","type":"message"}
{"nick":"bnoordhuis","message":"the EPIPE is in the server, because the client's closed the connection","date":"2012-12-12T09:09:05.508Z","type":"message"}
{"nick":"bnoordhuis","message":"so that's okay","date":"2012-12-12T09:09:16.221Z","type":"message"}
{"nick":"isaacs","message":"also, we have a special case for http.request().  if you don't add a 'response' handler, then it'll resume() it for you, since there's no way you could ever reead it","date":"2012-12-12T09:09:21.478Z","type":"message"}
{"nick":"isaacs","message":"ok","date":"2012-12-12T09:09:29.760Z","type":"message"}
{"nick":"isaacs","message":"awesome.  with the libuv changes, it hangs forever.","date":"2012-12-12T09:10:24.387Z","type":"message"}
{"nick":"isaacs","message":"(and with the conn.resume())","date":"2012-12-12T09:10:40.196Z","type":"message"}
{"nick":"isaacs","message":"so this is a good test.","date":"2012-12-12T09:11:25.356Z","type":"message"}
{"nick":"bnoordhuis","message":"okay, i'll look into it","date":"2012-12-12T09:11:41.778Z","type":"message"}
{"nick":"isaacs","message":"here's the tcp-raw.js file using the net.js client: https://gist.github.com/4266289","date":"2012-12-12T09:11:49.027Z","type":"message"}
{"nick":"isaacs","message":"with a bunch of debuggery as well","date":"2012-12-12T09:12:30.175Z","type":"message"}
{"nick":"isaacs","message":"both this and tcp-raw.js work fine in streams2.","date":"2012-12-12T09:13:58.294Z","type":"message"}
{"nick":"isaacs","message":"oh, actually, nvm","date":"2012-12-12T09:14:19.614Z","type":"message"}
{"nick":"isaacs","message":"this fails with the libuv changes","date":"2012-12-12T09:14:26.363Z","type":"message"}
{"nick":"isaacs","message":"nvm.","date":"2012-12-12T09:14:39.064Z","type":"message"}
{"nick":"isaacs","action":"is up past his bedtime","date":"2012-12-12T09:14:45.791Z","type":"action"}
{"nick":"isaacs","message":"it works, just hanging because of the extra shutdown req","date":"2012-12-12T09:14:52.731Z","type":"message"}
{"nick":"isaacs","message":"so, i think the problem is on the server side, not the client","date":"2012-12-12T09:15:19.371Z","type":"message"}
{"nick":"isaacs","action":"zzzzZZzzz","date":"2012-12-12T09:16:07.270Z","type":"action"}
{"nick":"mmalecki[away]","new_nick":"mmalecki","date":"2012-12-12T09:17:53.811Z","type":"nick"}
{"nick":"indutny","message":"bnoordhuis: hi","date":"2012-12-12T09:19:54.293Z","type":"message"}
{"nick":"indutny","message":"bnoordhuis: have you seen latest graceful shutdown pull request https://github.com/joyent/node/pull/4347/files ?","date":"2012-12-12T09:20:25.890Z","type":"message"}
{"nick":"kazupon","reason":"Ping timeout: 244 seconds","date":"2012-12-12T09:49:39.055Z","type":"quit"}
{"nick":"kazupon","date":"2012-12-12T09:54:41.316Z","type":"join"}
{"nick":"sergim","reason":"Quit: Textual IRC Client: http://www.textualapp.com/","date":"2012-12-12T09:55:55.738Z","type":"quit"}
{"nick":"kazupon","reason":"Remote host closed the connection","date":"2012-12-12T09:58:40.358Z","type":"quit"}
{"nick":"kazupon","date":"2012-12-12T11:05:22.633Z","type":"join"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-12-12T11:05:33.225Z","type":"quit"}
{"nick":"hz","date":"2012-12-12T11:08:55.419Z","type":"join"}
{"nick":"roxlu","reason":"Ping timeout: 264 seconds","date":"2012-12-12T11:10:18.177Z","type":"quit"}
{"nick":"bnoordhuis","message":"indutny: haven't seen it yet","date":"2012-12-12T11:30:22.281Z","type":"message"}
{"nick":"indutny","message":"ok, np","date":"2012-12-12T11:33:02.702Z","type":"message"}
{"nick":"indutny","message":"it should be on my desk by the end of day","date":"2012-12-12T11:35:03.329Z","type":"message"}
{"nick":"indutny","message":"bad joking","date":"2012-12-12T11:44:52.582Z","type":"message"}
{"nick":"bnoordhuis","message":"it's a pretty good joke though","date":"2012-12-12T11:57:43.418Z","type":"message"}
{"nick":"abraxas","reason":"Remote host closed the connection","date":"2012-12-12T12:23:42.501Z","type":"quit"}
{"nick":"bradleymeck","date":"2012-12-12T12:29:45.666Z","type":"join"}
{"nick":"bnoordhuis","message":"indutny: what are you working on?","date":"2012-12-12T12:30:08.149Z","type":"message"}
{"nick":"sgallagh","date":"2012-12-12T12:30:58.625Z","type":"join"}
{"nick":"indutny","message":"tlsnappy","date":"2012-12-12T12:31:14.923Z","type":"message"}
{"nick":"indutny","message":"getting it back in action","date":"2012-12-12T12:31:18.640Z","type":"message"}
{"nick":"indutny","message":"right now it's a little bit fucked","date":"2012-12-12T12:31:25.037Z","type":"message"}
{"nick":"indutny","message":"but...","date":"2012-12-12T12:31:28.029Z","type":"message"}
{"nick":"bnoordhuis","message":"watch your language, young man","date":"2012-12-12T12:31:35.521Z","type":"message"}
{"nick":"indutny","message":"if you want to point me on something else - I'll be ok","date":"2012-12-12T12:31:37.281Z","type":"message"}
{"nick":"bnoordhuis","message":"no, i was just curious","date":"2012-12-12T12:31:45.785Z","type":"message"}
{"nick":"indutny","message":"ah, ok","date":"2012-12-12T12:31:49.407Z","type":"message"}
{"nick":"indutny","message":"so you're on HN again?","date":"2012-12-12T12:31:53.773Z","type":"message"}
{"nick":"bnoordhuis","message":"what's tlsnappy's issue?","date":"2012-12-12T12:31:56.889Z","type":"message"}
{"nick":"bnoordhuis","message":"hah no, reworking uv_cancel","date":"2012-12-12T12:32:06.648Z","type":"message"}
{"nick":"indutny","message":"I think race + incorrect SSL_shutdown","date":"2012-12-12T12:32:18.796Z","type":"message"}
{"nick":"indutny","message":"or, I've implemented BIO incorrectly","date":"2012-12-12T12:32:26.319Z","type":"message"}
{"nick":"indutny","message":"it's hard to guess","date":"2012-12-12T12:32:33.022Z","type":"message"}
{"nick":"indutny","message":"sometimes SSL_read success reading the same sequence","date":"2012-12-12T12:32:44.881Z","type":"message"}
{"nick":"indutny","message":"multiple times","date":"2012-12-12T12:32:45.780Z","type":"message"}
{"nick":"indutny","message":"from one BIO","date":"2012-12-12T12:32:52.550Z","type":"message"}
{"nick":"bnoordhuis","message":"right","date":"2012-12-12T12:33:27.733Z","type":"message"}
{"nick":"indutny","message":"seems to be a race","date":"2012-12-12T12:33:48.685Z","type":"message"}
{"nick":"indutny","message":"though, it's pretty hard to debug","date":"2012-12-12T12:33:50.725Z","type":"message"}
{"nick":"indutny","message":"especially, considering that drd doesn't work on lion","date":"2012-12-12T12:34:11.352Z","type":"message"}
{"nick":"kazupon","reason":"Remote host closed the connection","date":"2012-12-12T12:34:50.157Z","type":"quit"}
{"nick":"sgallagh","reason":"Remote host closed the connection","date":"2012-12-12T12:35:11.684Z","type":"quit"}
{"nick":"bnoordhuis","message":"time to switch to a real OS, fedor","date":"2012-12-12T12:35:12.886Z","type":"message"}
{"nick":"sgallagh","date":"2012-12-12T12:35:33.523Z","type":"join"}
{"nick":"bnoordhuis","message":"i hear good things about windows","date":"2012-12-12T12:35:41.200Z","type":"message"}
{"nick":"indutny","message":"hahahaha","date":"2012-12-12T12:45:32.393Z","type":"message"}
{"nick":"kazupon","date":"2012-12-12T13:11:13.534Z","type":"join"}
{"nick":"sgallagh","reason":"Remote host closed the connection","date":"2012-12-12T13:28:32.200Z","type":"quit"}
{"nick":"jmar777","date":"2012-12-12T13:40:25.681Z","type":"join"}
{"nick":"sgallagh","date":"2012-12-12T13:42:01.400Z","type":"join"}
{"nick":"stagas","reason":"Ping timeout: 252 seconds","date":"2012-12-12T13:51:35.510Z","type":"quit"}
{"nick":"bradleymeck","reason":"Quit: bradleymeck","date":"2012-12-12T13:56:54.197Z","type":"quit"}
{"nick":"loladiro","date":"2012-12-12T13:57:12.358Z","type":"join"}
{"nick":"philips_","reason":"Excess Flood","date":"2012-12-12T13:59:48.688Z","type":"quit"}
{"nick":"philips_","date":"2012-12-12T14:02:10.409Z","type":"join"}
{"nick":"Ralt","reason":"Remote host closed the connection","date":"2012-12-12T14:17:48.458Z","type":"quit"}
{"nick":"brucem","reason":"Ping timeout: 240 seconds","date":"2012-12-12T14:39:35.285Z","type":"quit"}
{"nick":"brucem","date":"2012-12-12T14:40:03.454Z","type":"join"}
{"nick":"kazupon","reason":"Remote host closed the connection","date":"2012-12-12T14:40:06.269Z","type":"quit"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-12-12T14:57:02.358Z","type":"quit"}
{"nick":"bradleymeck","date":"2012-12-12T15:21:28.784Z","type":"join"}
{"nick":"loladiro","date":"2012-12-12T15:24:09.469Z","type":"join"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-12-12T15:31:08.441Z","type":"quit"}
{"nick":"`3rdEden","reason":"Quit: banana's","date":"2012-12-12T15:32:17.647Z","type":"quit"}
{"nick":"indexzero","date":"2012-12-12T15:34:00.908Z","type":"join"}
{"nick":"kazupon","date":"2012-12-12T15:37:23.596Z","type":"join"}
{"nick":"roxlu","date":"2012-12-12T15:38:35.060Z","type":"join"}
{"nick":"warz","date":"2012-12-12T15:39:24.955Z","type":"join"}
{"nick":"warz","reason":"Changing host","date":"2012-12-12T15:39:25.261Z","type":"quit"}
{"nick":"warz","date":"2012-12-12T15:39:25.395Z","type":"join"}
{"nick":"loladiro","date":"2012-12-12T15:40:32.549Z","type":"join"}
{"nick":"piscisaureus_","date":"2012-12-12T15:40:49.326Z","type":"join"}
{"nick":"bnoordhuis","message":"piscisaureus_: mogge bertje","date":"2012-12-12T15:45:48.273Z","type":"message"}
{"nick":"sblom","date":"2012-12-12T15:57:37.496Z","type":"join"}
{"nick":"lohkey","date":"2012-12-12T15:58:58.626Z","type":"join"}
{"nick":"sblom","date":"2012-12-12T16:02:30.730Z","type":"part"}
{"nick":"joshthecoder","date":"2012-12-12T16:04:08.687Z","type":"join"}
{"nick":"brett_","date":"2012-12-12T16:05:22.146Z","type":"join"}
{"nick":"bnoordhuis","reason":"Ping timeout: 276 seconds","date":"2012-12-12T16:07:27.470Z","type":"quit"}
{"nick":"brett_","message":"@bnoordhuis Sven and Brett from Fog Creek (Trello) here on the issues we're having load balancing with Cluster in issue https://github.com/joyent/node/issues/3241, and recent mitigating libuv change commit be2a2176ce25d6a4190b10acd1de9fd53f7a6275 not helping in our case","date":"2012-12-12T16:10:30.234Z","type":"message"}
{"nick":"brett_","message":"oops, but it looks like you just left","date":"2012-12-12T16:10:53.801Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2012-12-12T16:11:42.018Z","type":"quit"}
{"nick":"AvianFlu","reason":"Remote host closed the connection","date":"2012-12-12T16:21:23.912Z","type":"quit"}
{"nick":"indexzero","date":"2012-12-12T16:22:40.456Z","type":"join"}
{"nick":"dap","date":"2012-12-12T16:27:44.439Z","type":"join"}
{"nick":"stagas","date":"2012-12-12T16:27:50.303Z","type":"join"}
{"nick":"hz","date":"2012-12-12T16:36:35.818Z","type":"quit"}
{"nick":"piscisaureus_","reason":"Read error: Connection reset by peer","date":"2012-12-12T16:47:03.985Z","type":"quit"}
{"nick":"piscisaureus_","date":"2012-12-12T16:47:47.804Z","type":"join"}
{"nick":"joshthecoder","reason":"Quit: Leaving...","date":"2012-12-12T16:47:52.058Z","type":"quit"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2012-12-12T16:50:14.709Z","type":"quit"}
{"nick":"lohkey","reason":"Quit: lohkey","date":"2012-12-12T16:57:02.358Z","type":"quit"}
{"nick":"AvianFlu","date":"2012-12-12T17:13:55.625Z","type":"join"}
{"nick":"joshthecoder","date":"2012-12-12T17:23:17.658Z","type":"join"}
{"nick":"bradleymeck","reason":"Quit: bradleymeck","date":"2012-12-12T17:27:27.790Z","type":"quit"}
{"nick":"kazupon","reason":"Remote host closed the connection","date":"2012-12-12T17:27:32.475Z","type":"quit"}
{"nick":"indexzero","date":"2012-12-12T17:47:27.666Z","type":"join"}
{"nick":"txdv","message":"that uv_cancel","date":"2012-12-12T17:50:22.387Z","type":"message"}
{"nick":"txdv","message":"who is using it?","date":"2012-12-12T17:50:27.778Z","type":"message"}
{"nick":"`3rdEden","date":"2012-12-12T17:53:52.613Z","type":"join"}
{"nick":"kazupon","date":"2012-12-12T17:57:55.951Z","type":"join"}
{"nick":"dap","reason":"Quit: Leaving.","date":"2012-12-12T18:05:07.154Z","type":"quit"}
{"nick":"indutny","message":"everyone :)","date":"2012-12-12T18:05:19.814Z","type":"message"}
{"nick":"indutny","message":"it's cool","date":"2012-12-12T18:05:24.695Z","type":"message"}
{"nick":"txdv","message":"I wan't to see a few scenarios","date":"2012-12-12T18:06:05.884Z","type":"message"}
{"nick":"txdv","message":"Because I want to extend my api","date":"2012-12-12T18:06:10.187Z","type":"message"}
{"nick":"txdv","message":"This seems like functionality that the user should use","date":"2012-12-12T18:06:23.770Z","type":"message"}
{"nick":"txdv","message":"And I do not expose request api","date":"2012-12-12T18:06:31.801Z","type":"message"}
{"nick":"kazupon","reason":"Ping timeout: 265 seconds","date":"2012-12-12T18:07:32.853Z","type":"quit"}
{"nick":"piscisaureus_","message":"txdv: nobody uses it yet; it's brand new and it'll have to change :-)","date":"2012-12-12T18:09:26.986Z","type":"message"}
{"nick":"indutny","message":"especially when bert will start doing windows part","date":"2012-12-12T18:10:51.956Z","type":"message"}
{"nick":"indutny","message":"why people are using C++1","date":"2012-12-12T18:32:41.471Z","type":"message"}
{"nick":"indutny","message":"C++11*","date":"2012-12-12T18:32:43.621Z","type":"message"}
{"nick":"indutny","message":"I can hardly look at it for more than 15 minutes","date":"2012-12-12T18:32:53.764Z","type":"message"}
{"nick":"roxlu","message":"hi ","date":"2012-12-12T18:39:52.210Z","type":"message"}
{"nick":"indutny","message":"hi","date":"2012-12-12T18:40:15.431Z","type":"message"}
{"nick":"piscisaureus_","message":"I have to say, it is pretty amazing that this works: https://github.com/joyent/libuv/issues/645","date":"2012-12-12T18:40:16.638Z","type":"message"}
{"nick":"roxlu","message":"I'm looking into an application where I want to stream 3D coordinates/vertices + a image/texture to about 400 clients","date":"2012-12-12T18:40:18.198Z","type":"message"}
{"nick":"roxlu","message":"I'm wondering if I need to go for tcp or udp.... someone who can give me some advise?","date":"2012-12-12T18:40:47.340Z","type":"message"}
{"nick":"indutny","message":"depends","date":"2012-12-12T18:41:08.299Z","type":"message"}
{"nick":"indutny","message":"how often will it change","date":"2012-12-12T18:41:17.047Z","type":"message"}
{"nick":"indutny","message":"and how realtime you want it to be","date":"2012-12-12T18:41:24.984Z","type":"message"}
{"nick":"indutny","message":"tcp is simplier, and works","date":"2012-12-12T18:41:30.648Z","type":"message"}
{"nick":"indutny","message":"udp is harder, and works a little bit less :)","date":"2012-12-12T18:41:41.705Z","type":"message"}
{"nick":"roxlu","message":"I want it to be as real time as possible","date":"2012-12-12T18:42:00.854Z","type":"message"}
{"nick":"roxlu","message":"at least within 500ms delay","date":"2012-12-12T18:42:11.408Z","type":"message"}
{"nick":"roxlu","message":"it;s on a local wireless network","date":"2012-12-12T18:42:20.067Z","type":"message"}
{"nick":"roxlu","message":"and the texture is dynamicaly created so to say.. so each X-millis a new line of texture is created","date":"2012-12-12T18:42:41.950Z","type":"message"}
{"nick":"roxlu","message":"with line of texture, I mean one row of pixels ","date":"2012-12-12T18:42:55.862Z","type":"message"}
{"nick":"roxlu","message":"(a bit like a scanner)","date":"2012-12-12T18:43:00.012Z","type":"message"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-12-12T18:43:25.336Z","type":"quit"}
{"nick":"indutny","message":"use udp","date":"2012-12-12T18:43:28.773Z","type":"message"}
{"nick":"indutny","message":"but read about jitter","date":"2012-12-12T18:43:35.569Z","type":"message"}
{"nick":"indutny","message":"and rdp","date":"2012-12-12T18:43:36.773Z","type":"message"}
{"nick":"indutny","message":"basically, you need to ensure that packets are getting in right order","date":"2012-12-12T18:43:49.077Z","type":"message"}
{"nick":"indutny","message":"and reorder them otherwise","date":"2012-12-12T18:43:54.733Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: oh shit, node.js code in C++","date":"2012-12-12T18:44:19.520Z","type":"message"}
{"nick":"roxlu","message":"indutny: udp has packet loss too right?","date":"2012-12-12T18:44:42.850Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2012-12-12T18:44:46.607Z","type":"message"}
{"nick":"indutny","message":"and out-of-order possibility","date":"2012-12-12T18:44:51.116Z","type":"message"}
{"nick":"roxlu","message":"yeah","date":"2012-12-12T18:44:56.018Z","type":"message"}
{"nick":"roxlu","message":"so I need to do a lot of management on that.. ","date":"2012-12-12T18:45:03.870Z","type":"message"}
{"nick":"roxlu","message":"would it be doable with tcp?","date":"2012-12-12T18:45:11.125Z","type":"message"}
{"nick":"indutny","message":"I think yes","date":"2012-12-12T18:45:47.617Z","type":"message"}
{"nick":"roxlu","message":"the amount of data is not that much, about 640*3 = 1920 bytes","date":"2012-12-12T18:45:53.325Z","type":"message"}
{"nick":"indutny","message":"sure","date":"2012-12-12T18:45:59.493Z","type":"message"}
{"nick":"indutny","message":"it'll work just fine","date":"2012-12-12T18:46:06.645Z","type":"message"}
{"nick":"indutny","message":"especially, considering that you want to fit in 500ms","date":"2012-12-12T18:46:13.166Z","type":"message"}
{"nick":"roxlu","message":"   but I need to send it to 400 clients;  soo hmm ~750kb p/s","date":"2012-12-12T18:46:25.352Z","type":"message"}
{"nick":"roxlu","message":"ok","date":"2012-12-12T18:46:38.111Z","type":"message"}
{"nick":"roxlu","message":"indutny:  so to send it to everyone with tcp, I would need to keep a list of clients and loop over them, right?","date":"2012-12-12T18:47:02.608Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2012-12-12T18:47:11.317Z","type":"message"}
{"nick":"roxlu","message":"(when sending data)","date":"2012-12-12T18:47:11.448Z","type":"message"}
{"nick":"indutny","message":"or","date":"2012-12-12T18:47:15.428Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2012-12-12T18:47:28.621Z","type":"message"}
{"nick":"indutny","message":":)","date":"2012-12-12T18:47:32.227Z","type":"message"}
{"nick":"roxlu","message":"haha ","date":"2012-12-12T18:47:36.706Z","type":"message"}
{"nick":"roxlu","message":"thanks ","date":"2012-12-12T18:47:38.006Z","type":"message"}
{"nick":"roxlu","message":"or","date":"2012-12-12T18:47:40.305Z","type":"message"}
{"nick":"roxlu","message":"thanks","date":"2012-12-12T18:47:43.541Z","type":"message"}
{"nick":"roxlu","message":";-)","date":"2012-12-12T18:47:44.785Z","type":"message"}
{"nick":"MI6","message":"\u0002joyent/node:\u0002 \u00033isaacs\u000f \u00037streams2-stdin-wip\u000f * \u0002b86f2e9\u0002 : streams2: Writable only emit 'finish' once - http://git.io/3UJ4vw","date":"2012-12-12T18:48:14.607Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: https://github.com/cocaine/cocaine-core/blob/master/include/cocaine/context.hpp#L145","date":"2012-12-12T18:48:43.745Z","type":"message"}
{"nick":"indutny","action":"you feel misery when looking at this code too?","date":"2012-12-12T18:48:59.481Z","type":"action"}
{"nick":"piscisaureus_","message":"variadic templates","date":"2012-12-12T18:49:32.861Z","type":"message"}
{"nick":"piscisaureus_","action":"drools","date":"2012-12-12T18:49:35.780Z","type":"action"}
{"nick":"indutny","message":"yeeees","date":"2012-12-12T18:49:41.275Z","type":"message"}
{"nick":"indutny","message":"and not only this","date":"2012-12-12T18:49:46.860Z","type":"message"}
{"nick":"indutny","message":"traits","date":"2012-12-12T18:49:48.330Z","type":"message"}
{"nick":"indutny","message":"std::forward","date":"2012-12-12T18:49:50.955Z","type":"message"}
{"nick":"indutny","message":"look below https://github.com/cocaine/cocaine-core/blob/master/include/cocaine/context.hpp#L185","date":"2012-12-12T18:50:00.657Z","type":"message"}
{"nick":"indutny","message":"and these guys are complaining that their code isn't compiling everywhere","date":"2012-12-12T18:50:21.730Z","type":"message"}
{"nick":"piscisaureus_","message":"hahaha","date":"2012-12-12T18:50:43.933Z","type":"message"}
{"nick":"piscisaureus_","message":"I actually like templates","date":"2012-12-12T18:50:49.480Z","type":"message"}
{"nick":"indutny","message":"well","date":"2012-12-12T18:50:56.941Z","type":"message"}
{"nick":"indutny","message":"I hate std","date":"2012-12-12T18:50:59.360Z","type":"message"}
{"nick":"indutny","message":":)","date":"2012-12-12T18:51:01.649Z","type":"message"}
{"nick":"indutny","message":"and variadic stuff kills my brain","date":"2012-12-12T18:51:08.095Z","type":"message"}
{"nick":"piscisaureus_","message":"and variadic arguments were a big hole in the feature set","date":"2012-12-12T18:51:12.172Z","type":"message"}
{"nick":"piscisaureus_","message":"(as was the lack of \"typename\" btw)","date":"2012-12-12T18:51:21.717Z","type":"message"}
{"nick":"indutny","message":"you know","date":"2012-12-12T18:51:21.903Z","type":"message"}
{"nick":"indutny","message":"better having big hole","date":"2012-12-12T18:51:28.522Z","type":"message"}
{"nick":"indutny","message":"that syntax that hard to fit it brain","date":"2012-12-12T18:51:34.813Z","type":"message"}
{"nick":"indutny","message":"also... I don't think they really need it","date":"2012-12-12T18:51:50.564Z","type":"message"}
{"nick":"indutny","message":"it can be done in much simplier, ANSI-C way","date":"2012-12-12T18:52:02.101Z","type":"message"}
{"nick":"TooTallNate","date":"2012-12-12T18:52:10.665Z","type":"join"}
{"nick":"indutny","message":"and work on more platforms, and do things that're easy to track and understand","date":"2012-12-12T18:52:33.754Z","type":"message"}
{"nick":"indutny","message":"probably, I'm getting old...","date":"2012-12-12T18:53:08.210Z","type":"message"}
{"nick":"indutny","message":"idk","date":"2012-12-12T18:53:08.951Z","type":"message"}
{"nick":"indutny","message":"I like simplicty","date":"2012-12-12T18:55:25.683Z","type":"message"}
{"nick":"indutny","message":"it makes me feel like I had a good day","date":"2012-12-12T18:55:34.880Z","type":"message"}
{"nick":"dap","date":"2012-12-12T18:59:14.647Z","type":"join"}
{"nick":"kazupon","date":"2012-12-12T19:03:26.650Z","type":"join"}
{"nick":"stagas_","date":"2012-12-12T19:03:29.815Z","type":"join"}
{"nick":"stagas","reason":"Ping timeout: 244 seconds","date":"2012-12-12T19:04:33.095Z","type":"quit"}
{"nick":"stagas_","new_nick":"stagas","date":"2012-12-12T19:04:40.146Z","type":"nick"}
{"nick":"isaacs","message":"ircretary: So, using my tcp-raw.js it works with the libuv changes, and using the net client is fine, but when I use the net server, it fails.","date":"2012-12-12T19:06:25.776Z","type":"message"}
{"nick":"dap","reason":"Quit: Leaving.","date":"2012-12-12T19:06:26.274Z","type":"quit"}
{"nick":"ircretary","message":"isaacs: the was last seen at 2012-09-24T18:13:50.839Z, joining #Node.js","date":"2012-12-12T19:06:26.796Z","type":"message"}
{"nick":"isaacs","message":"ircretary: tell bnoordhuis So, using my tcp-raw.js it works with the libuv changes, and using the net client is fine, but when I use the net server, it fails.","date":"2012-12-12T19:06:34.111Z","type":"message"}
{"nick":"ircretary","message":"isaacs: I'll be sure to tell bnoordhuis","date":"2012-12-12T19:06:35.217Z","type":"message"}
{"nick":"isaacs","message":"ircretary: tell bnoordhuis I'm going to dig into the changes now and try to track it down.","date":"2012-12-12T19:06:51.065Z","type":"message"}
{"nick":"ircretary","message":"isaacs: I'll be sure to tell bnoordhuis","date":"2012-12-12T19:06:51.853Z","type":"message"}
{"nick":"kazupon","reason":"Ping timeout: 255 seconds","date":"2012-12-12T19:08:17.445Z","type":"quit"}
{"nick":"brett_","message":"Is anyone here familiar enough with multi_accept issues to give the test case I posted at https://github.com/joyent/node/issues/3241#issuecomment-11302935 a once-over and make sure it makes sense?","date":"2012-12-12T19:08:49.843Z","type":"message"}
{"nick":"brett_","message":"I'm hoping to NOT have bnoordhuis wake up in the morning, check it out, and say 'this is just silly', and not be able to get back to him for several hours.","date":"2012-12-12T19:09:30.621Z","type":"message"}
{"nick":"brson","date":"2012-12-12T19:10:04.824Z","type":"join"}
{"nick":"brett_","message":"@piscisaureus_ I see that you initially opened that issue (https://github.com/joyent/node/issues/3241), and I'm wondering what led you to do that (someone else must have been seeing imbalances?)","date":"2012-12-12T19:12:13.023Z","type":"message"}
{"nick":"piscisaureus_","message":"brett_: yes, we had this problem at cloud9","date":"2012-12-12T19:12:57.102Z","type":"message"}
{"nick":"piscisaureus_","message":"on smartos servers","date":"2012-12-12T19:13:02.415Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2012-12-12T19:13:31.570Z","type":"quit"}
{"nick":"brett_","message":"does the the libuv fix mitigate the issue for you?","date":"2012-12-12T19:14:12.710Z","type":"message"}
{"nick":"piscisaureus_","message":"brett_: we're not using that in production, so I don't know","date":"2012-12-12T19:14:27.813Z","type":"message"}
{"nick":"piscisaureus_","message":"brett_: we are still using an \"older\" version of that patch that works for us but (apparently) doesn't work for everyone","date":"2012-12-12T19:14:51.112Z","type":"message"}
{"nick":"brett_","message":"Got it. And that fix worked with really high traffic like the multi_accept benchmark, or lower traffic more like the siege test at https://github.com/joyent/node/issues/3241#issuecomment-11302935 ?","date":"2012-12-12T19:16:15.083Z","type":"message"}
{"nick":"brett_","message":"Or some secret option 3?","date":"2012-12-12T19:16:44.670Z","type":"message"}
{"nick":"piscisaureus_","message":"brett_: eh, it fixed it in production :-)","date":"2012-12-12T19:17:00.773Z","type":"message"}
{"nick":"bradleymeck","date":"2012-12-12T19:17:07.124Z","type":"join"}
{"nick":"piscisaureus_","message":"and also when benchmarking with ab","date":"2012-12-12T19:17:15.336Z","type":"message"}
{"nick":"piscisaureus_","message":"I think it is harder to fix under low-traffic conditions, but it may also not be necessary to fix it then","date":"2012-12-12T19:17:46.910Z","type":"message"}
{"nick":"brett_","message":"interesting! do you happen to know which commit you are running, or is it a patch that i can see?","date":"2012-12-12T19:18:08.937Z","type":"message"}
{"nick":"piscisaureus_","message":"it's not a problem if one node process handles all the traffic as long as this node process can keep up","date":"2012-12-12T19:18:09.475Z","type":"message"}
{"nick":"piscisaureus_","message":"yeah, a sec","date":"2012-12-12T19:18:24.819Z","type":"message"}
{"nick":"brett_","message":"well, it's a problem for us because we can connect a bunch of websockets, which hang out idle for a long time then can go active simultaneously.","date":"2012-12-12T19:19:03.910Z","type":"message"}
{"nick":"piscisaureus_","message":"brett_: receiving a call now, will talk back in 15 minutes or so","date":"2012-12-12T19:19:08.283Z","type":"message"}
{"nick":"brett_","message":"thanks!","date":"2012-12-12T19:19:13.893Z","type":"message"}
{"nick":"KiNgMaR","reason":"Quit: ZNC - http://znc.sourceforge.net","date":"2012-12-12T19:25:50.464Z","type":"quit"}
{"nick":"loladiro","date":"2012-12-12T19:29:28.009Z","type":"join"}
{"nick":"KiNgMaR","date":"2012-12-12T19:31:01.857Z","type":"join"}
{"nick":"piscisaureus_","message":"brett_: we are running https://github.com/ajaxorg/node/compare/balance","date":"2012-12-12T19:32:27.132Z","type":"message"}
{"nick":"piscisaureus_","message":"brett_: that is 0.6, btw","date":"2012-12-12T19:32:42.226Z","type":"message"}
{"nick":"piscisaureus_","message":"a similar patch exists for 0.8, lemme see","date":"2012-12-12T19:32:51.222Z","type":"message"}
{"nick":"piscisaureus_","message":"brett_: https://github.com/bnoordhuis/libuv/commit/6f77e4597769c80ce43c3c1992a0e3c318cadb5d <-- that may work against 0.8, too","date":"2012-12-12T19:34:22.846Z","type":"message"}
{"nick":"brett_","message":"piscisaureus_: Thanks, checking it out now!","date":"2012-12-12T19:38:03.862Z","type":"message"}
{"nick":"txdv","message":"master make test is failing","date":"2012-12-12T19:39:23.869Z","type":"message"}
{"nick":"txdv","message":"no it isn't","date":"2012-12-12T19:39:53.137Z","type":"message"}
{"nick":"txdv","message":"i am failing","date":"2012-12-12T19:39:54.949Z","type":"message"}
{"nick":"isaacs","message":"ohhhhhh","date":"2012-12-12T19:42:29.533Z","type":"message"}
{"nick":"isaacs","message":"i think i found the issue with streams2-net","date":"2012-12-12T19:42:38.138Z","type":"message"}
{"nick":"TooTallNate","message":"isaacs: do tell","date":"2012-12-12T19:43:31.841Z","type":"message"}
{"nick":"isaacs","message":"well... there's a case where i'm checking if state.reading is false (meaning \"i should not be reading\"), but handle.reading is true (meaning \"i am in a readStart() state\")","date":"2012-12-12T19:44:25.138Z","type":"message"}
{"nick":"isaacs","message":"and in that situation, I call handle.readStop()","date":"2012-12-12T19:44:33.321Z","type":"message"}
{"nick":"isaacs","message":"reasonable, right?","date":"2012-12-12T19:44:37.043Z","type":"message"}
{"nick":"isaacs","message":"this worked perfectly until the latest libuv changes.","date":"2012-12-12T19:44:53.568Z","type":"message"}
{"nick":"isaacs","message":"and now, a nextTick makes it work properly.","date":"2012-12-12T19:45:00.839Z","type":"message"}
{"nick":"isaacs","message":"so, there's a timing issue somewhere.","date":"2012-12-12T19:45:15.484Z","type":"message"}
{"nick":"isaacs","message":"but i think this is probably just an inconsistency with tcp_wrap binding, and not likely to be something that will pwn other libuv users.","date":"2012-12-12T19:45:49.370Z","type":"message"}
{"nick":"hz","date":"2012-12-12T19:48:57.469Z","type":"join"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2012-12-12T19:52:45.502Z","type":"quit"}
{"nick":"indexzero","date":"2012-12-12T19:56:31.116Z","type":"join"}
{"nick":"txdv","message":"Do I have to use IPV6AnyAddress when dual stacking?","date":"2012-12-12T19:57:43.586Z","type":"message"}
{"nick":"kazupon","date":"2012-12-12T20:04:15.822Z","type":"join"}
{"nick":"piscisaureus_","message":"txdv: yes","date":"2012-12-12T20:04:16.483Z","type":"message"}
{"nick":"isaacs","message":"ohh... wait, no there's a bug in my test.","date":"2012-12-12T20:08:03.369Z","type":"message"}
{"nick":"isaacs","message":"i was jsut reading too much.","date":"2012-12-12T20:08:06.258Z","type":"message"}
{"nick":"isaacs","message":"arg.","date":"2012-12-12T20:08:07.562Z","type":"message"}
{"nick":"kazupon","reason":"Ping timeout: 260 seconds","date":"2012-12-12T20:08:54.704Z","type":"quit"}
{"nick":"isaacs","message":"hm.  so it's still a mystery as to why the writeReq.oncomplete is not being called by the net.js code, but IS being called by the raw code...","date":"2012-12-12T20:19:13.820Z","type":"message"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-12-12T20:34:59.723Z","type":"quit"}
{"nick":"isaacs","message":"bnoordhuis, piscisaureus: Wow src/unix/stream.c changed a lot since last i looked at it.","date":"2012-12-12T20:44:33.982Z","type":"message"}
{"nick":"roxlu","message":"would libuv work on ios?","date":"2012-12-12T20:50:56.190Z","type":"message"}
{"nick":"TooTallNate","message":"roxlu: last i checked, yes","date":"2012-12-12T20:53:36.089Z","type":"message"}
{"nick":"roxlu","message":"TooTallNate: thanks, that's great!","date":"2012-12-12T20:54:15.268Z","type":"message"}
{"nick":"joshthecoder","reason":"Quit: Linkinus - http://linkinus.com","date":"2012-12-12T20:55:35.910Z","type":"quit"}
{"nick":"joshthecoder","date":"2012-12-12T20:55:50.263Z","type":"join"}
{"nick":"piscisaureus_","message":"brett_: about your problem. The cluster load balancing is not really designed to distribute requests evenly. The idea is that a node process that is currently less busy has a higher probability of accepting a new connection.","date":"2012-12-12T21:01:10.582Z","type":"message"}
{"nick":"piscisaureus_","message":"brett_: in your case you may want to do some actual round-robin proxying, but node can't really assist much in that atm","date":"2012-12-12T21:01:45.592Z","type":"message"}
{"nick":"jmar777","date":"2012-12-12T21:01:48.476Z","type":"join"}
{"nick":"kazupon","date":"2012-12-12T21:05:04.814Z","type":"join"}
{"nick":"brett_","message":"@piscisaureus: That's fair enough, can you speak to why the option for built-in approximate round robin would not be a goal of Cluster? From my (terribly biased) perspective, it seems like it would be a fairly natural and common preference.","date":"2012-12-12T21:06:09.912Z","type":"message"}
{"nick":"brett_","message":"For such common cases as lowering latency of a stateless web head, for instance.","date":"2012-12-12T21:06:41.962Z","type":"message"}
{"nick":"kazupon","reason":"Ping timeout: 260 seconds","date":"2012-12-12T21:10:09.650Z","type":"quit"}
{"nick":"brett_","message":"@piscisaureus_: Interestingly enough, it looks like the ajaxorg/node balance branch does about the same thing as vanilla joyent/node master on my test setup with the script from https://github.com/joyent/node/issues/3241#issuecomment-11302935","date":"2012-12-12T21:14:32.439Z","type":"message"}
{"nick":"brett_","message":"Different OS and all","date":"2012-12-12T21:15:03.550Z","type":"message"}
{"nick":"Ralt","date":"2012-12-12T21:15:48.973Z","type":"join"}
{"nick":"warz","date":"2012-12-12T21:18:00.445Z","type":"quit"}
{"nick":"piscisaureus_","message":"brett_: it has to do with the overall implementation; cluster works by making all node processes \"compete\" to accept incoming connections. When a process is busy it is less likely to win the race, because it is busy other things","date":"2012-12-12T21:18:25.761Z","type":"message"}
{"nick":"loladiro","date":"2012-12-12T21:18:38.306Z","type":"join"}
{"nick":"loladiro","reason":"Client Quit","date":"2012-12-12T21:18:48.243Z","type":"quit"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2012-12-12T21:18:56.640Z","type":"quit"}
{"nick":"piscisaureus_","message":"brett_: in theory it *is* possible to get round-robin behaviour with node, but you'd have to understand the node internals fairly well","date":"2012-12-12T21:18:56.819Z","type":"message"}
{"nick":"`3rdEden","reason":"Remote host closed the connection","date":"2012-12-12T21:19:23.675Z","type":"quit"}
{"nick":"piscisaureus_","message":"brett_: for that you'd have to set up a listening socket in the \"master\" process, and send accepted sockets over the IPC pipe to child processes","date":"2012-12-12T21:19:45.455Z","type":"message"}
{"nick":"txdv","message":"would you know how I set ipaddr6_any on c?","date":"2012-12-12T21:20:23.847Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: uv_ip6_addr(\"::1\") ? :-)","date":"2012-12-12T21:20:51.345Z","type":"message"}
{"nick":"piscisaureus_","message":"er","date":"2012-12-12T21:21:04.978Z","type":"message"}
{"nick":"piscisaureus_","message":"that'd be loopback.","date":"2012-12-12T21:21:30.327Z","type":"message"}
{"nick":"piscisaureus_","message":"uv_ip6_addr(\"::\")","date":"2012-12-12T21:21:36.509Z","type":"message"}
{"nick":"txdv","message":"and a port","date":"2012-12-12T21:21:47.109Z","type":"message"}
{"nick":"bradleymeck","reason":"Quit: bradleymeck","date":"2012-12-12T21:21:50.979Z","type":"quit"}
{"nick":"piscisaureus_","message":"txdv: but I think in6addr_any is just specified","date":"2012-12-12T21:22:25.435Z","type":"message"}
{"nick":"txdv","message":"i fucking hate c","date":"2012-12-12T21:24:15.807Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: see http://uw714doc.sco.com/en/SDK_netapi/sockC.TheIPv6sockaddrstructure.html \"System selection of source addresses\"","date":"2012-12-12T21:24:20.384Z","type":"message"}
{"nick":"txdv","message":"i can't do anything with this freaking error","date":"2012-12-12T21:24:27.358Z","type":"message"}
{"nick":"txdv","message":"src/unix/tcp.c:57:12: error: conflicting types for ‘uv__bind’","date":"2012-12-12T21:25:00.076Z","type":"message"}
{"nick":"txdv","message":"src/uv-common.h:83:5: note: previous declaration of ‘uv__bind’ was here","date":"2012-12-12T21:25:00.206Z","type":"message"}
{"nick":"brett_","message":"@piscisaureus_: Yes, all of that makes good sense and matches my understanding of the current implementation. I guess that what I would add is that from a Cluster user's perspective (that is, someone writing a Node.js server looking at the interface of Cluster rather than its implementaion), I think it's easy to want \"exactly Cluster, except doing round-robin among child processes.\"","date":"2012-12-12T21:25:27.135Z","type":"message"}
{"nick":"piscisaureus_","message":"yeah, I  get that","date":"2012-12-12T21:25:55.975Z","type":"message"}
{"nick":"loladiro","date":"2012-12-12T21:26:02.840Z","type":"join"}
{"nick":"loladiro","reason":"Client Quit","date":"2012-12-12T21:26:21.343Z","type":"quit"}
{"nick":"loladiro","date":"2012-12-12T21:29:16.270Z","type":"join"}
{"nick":"txdv","message":"ok","date":"2012-12-12T21:30:08.571Z","type":"message"}
{"nick":"txdv","message":"i got a proposition for the api","date":"2012-12-12T21:30:12.828Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: Aha.  it seems like the writeReq.oncomplete doesn't get called if there's only one write in proress.","date":"2012-12-12T21:32:14.140Z","type":"message"}
{"nick":"isaacs","message":"*progress","date":"2012-12-12T21:32:17.101Z","type":"message"}
{"nick":"brett_","message":"@piscisaureus_: I'm headed out, Sven just got better results running our test with a 3.7 kernel he built (only about a 3x difference in process page serves over 12 cores), so that's a lot better than the 10x we're seeing in 3.2.0, so we're going to keep cranking on kernel versions and build options for now.","date":"2012-12-12T21:32:18.699Z","type":"message"}
{"nick":"brett_","message":"Thank you for your help!","date":"2012-12-12T21:32:29.205Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: heuh?","date":"2012-12-12T21:32:48.982Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: if that's true, it's a bug","date":"2012-12-12T21:33:09.611Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: yes.","date":"2012-12-12T21:33:12.089Z","type":"message"}
{"nick":"isaacs","message":"it's a bug alright :)","date":"2012-12-12T21:33:14.320Z","type":"message"}
{"nick":"isaacs","message":"that's the difference between what streams2 is ddoing and what master is doing.","date":"2012-12-12T21:33:27.284Z","type":"message"}
{"nick":"isaacs","message":"master calls handle.writeBuffer() whenever you do a write()","date":"2012-12-12T21:33:36.610Z","type":"message"}
{"nick":"piscisaureus_","message":"only one write in progress at the same time?","date":"2012-12-12T21:33:40.205Z","type":"message"}
{"nick":"isaacs","message":"streams2 calls handle.writeBuffer(buf) and then waits for the completion callback before calling it again","date":"2012-12-12T21:33:54.680Z","type":"message"}
{"nick":"piscisaureus_","message":"that doesn't sound terribly efficient","date":"2012-12-12T21:33:56.762Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: why is that?","date":"2012-12-12T21:34:01.883Z","type":"message"}
{"nick":"isaacs","message":"yeah, it's not","date":"2012-12-12T21:34:03.630Z","type":"message"}
{"nick":"isaacs","message":":)","date":"2012-12-12T21:34:05.162Z","type":"message"}
{"nick":"isaacs","message":"but it's still a bug.","date":"2012-12-12T21:34:10.310Z","type":"message"}
{"nick":"piscisaureus_","message":"true","date":"2012-12-12T21:34:13.759Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: the reason why it does that is because it manages the water levels itself in js","date":"2012-12-12T21:34:41.215Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: could you not just look at _writeQueueSize instead of managing water levels in js?","date":"2012-12-12T21:35:10.772Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: and Socket.prototype._write(buf, cb) does effectively this._handle.writeBuffer(buf, cb)","date":"2012-12-12T21:35:11.759Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: yes.","date":"2012-12-12T21:35:15.854Z","type":"message"}
{"nick":"isaacs","message":"but tha'ts a further optimization","date":"2012-12-12T21:35:22.578Z","type":"message"}
{"nick":"piscisaureus_","message":"ach so","date":"2012-12-12T21:35:27.366Z","type":"message"}
{"nick":"isaacs","message":"priority atm is correctness","date":"2012-12-12T21:35:32.531Z","type":"message"}
{"nick":"isaacs","message":"i got it to fail with my tcp-raw.js self-pipe, but i don't think it even has to do with piping","date":"2012-12-12T21:36:25.437Z","type":"message"}
{"nick":"isaacs","message":"i'm going to trim it down even more.","date":"2012-12-12T21:36:32.902Z","type":"message"}
{"nick":"txdv","message":"ACH NE","date":"2012-12-12T21:37:01.405Z","type":"message"}
{"nick":"txdv","message":"https://github.com/joyent/libuv/pull/651 my proposition on how to rewrite the bind api","date":"2012-12-12T21:37:25.308Z","type":"message"}
{"nick":"isaacs","message":"oh, wild, so the \"one write at a time\" only seems to affect the server.","date":"2012-12-12T21:37:51.634Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: I don't doubt you have a problem, but it all seems increasingly unlikely","date":"2012-12-12T21:39:02.742Z","type":"message"}
{"nick":"TooTallNate","reason":"Ping timeout: 250 seconds","date":"2012-12-12T21:39:06.627Z","type":"quit"}
{"nick":"isaacs","message":"piscisaureus_: run this: https://gist.github.com/4271867","date":"2012-12-12T21:39:18.166Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: there is no streamy js code in that at all.","date":"2012-12-12T21:39:26.094Z","type":"message"}
{"nick":"isaacs","message":"and it should not hang.","date":"2012-12-12T21:39:28.976Z","type":"message"}
{"nick":"isaacs","message":"but it hangs.","date":"2012-12-12T21:39:31.303Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: the client calls writeBuffer(bigBuf) and then gets the oncomplete","date":"2012-12-12T21:39:53.593Z","type":"message"}
{"nick":"isaacs","message":"but the server writes the same buffers back, and never gets oncomplete called.","date":"2012-12-12T21:40:04.054Z","type":"message"}
{"nick":"rendar","date":"2012-12-12T21:40:19.715Z","type":"quit"}
{"nick":"piscisaureus_","message":"isaacs: joyent/node@master?","date":"2012-12-12T21:40:33.354Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: yessir","date":"2012-12-12T21:40:59.215Z","type":"message"}
{"nick":"jmar777","reason":"Remote host closed the connection","date":"2012-12-12T21:41:24.400Z","type":"quit"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-12-12T21:41:29.468Z","type":"quit"}
{"nick":"stagas","reason":"Ping timeout: 255 seconds","date":"2012-12-12T21:41:44.523Z","type":"quit"}
{"nick":"TooTallNate","date":"2012-12-12T21:43:04.798Z","type":"join"}
{"nick":"txdv","message":"i can't figure out why I do get this conflicting type","date":"2012-12-12T21:43:52.314Z","type":"message"}
{"nick":"txdv","message":"o now I do","date":"2012-12-12T21:44:58.410Z","type":"message"}
{"nick":"loladiro","date":"2012-12-12T21:46:17.847Z","type":"join"}
{"nick":"isaacs","message":"piscisaureus_: it looks like it's working when we do writev() but not when we do write()","date":"2012-12-12T21:47:19.414Z","type":"message"}
{"nick":"txdv","message":"yeah now it even compiles","date":"2012-12-12T21:49:12.818Z","type":"message"}
{"nick":"sgallagh","reason":"Ping timeout: 260 seconds","date":"2012-12-12T21:59:59.305Z","type":"quit"}
{"nick":"benoitc","reason":"Excess Flood","date":"2012-12-12T22:02:47.925Z","type":"quit"}
{"nick":"piscisaureus_","message":"isaacs: dunno, I can't really confirm.","date":"2012-12-12T22:03:03.437Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: it seems that the server stops reading it pulled all the data off the socket, which sort of explains why the write never completes","date":"2012-12-12T22:03:39.693Z","type":"message"}
{"nick":"txdv","message":"piscisaureus_: https://github.com/joyent/libuv/pull/651 <- the tcp binding api would look the same","date":"2012-12-12T22:04:00.866Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: why is this a significant improvement?","date":"2012-12-12T22:04:34.587Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: so, previously tcp-raw.js was this: https://gist.github.com/4263245","date":"2012-12-12T22:04:44.659Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: in the pipeSelf, it does:","date":"2012-12-12T22:04:54.247Z","type":"message"}
{"nick":"isaacs","message":"  if (handle.writeQueueSize >= writeWaterMark)","date":"2012-12-12T22:04:54.557Z","type":"message"}
{"nick":"isaacs","message":"    handle.readStop();","date":"2012-12-12T22:04:54.686Z","type":"message"}
{"nick":"isaacs","message":"and then in afterWrite:","date":"2012-12-12T22:04:59.771Z","type":"message"}
{"nick":"isaacs","message":"function selfPipeAfterWrite(handle, req) {","date":"2012-12-12T22:05:04.428Z","type":"message"}
{"nick":"isaacs","message":"  if (handle.writeQueueSize < writeWaterMark)","date":"2012-12-12T22:05:04.548Z","type":"message"}
{"nick":"isaacs","message":"    handle.readStart();","date":"2012-12-12T22:05:04.548Z","type":"message"}
{"nick":"isaacs","message":"}","date":"2012-12-12T22:05:04.548Z","type":"message"}
{"nick":"isaacs","message":"var writeWaterMark = 1024 * 16;","date":"2012-12-12T22:05:24.177Z","type":"message"}
{"nick":"isaacs","message":"so... all that I did was remove the if's","date":"2012-12-12T22:05:32.845Z","type":"message"}
{"nick":"kazupon","date":"2012-12-12T22:05:52.686Z","type":"join"}
{"nick":"indexzero","date":"2012-12-12T22:05:55.316Z","type":"join"}
{"nick":"isaacs","message":"piscisaureus_: what happens is that the selfPipe function calls handle.writeBuffer()","date":"2012-12-12T22:05:56.257Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: it also calls readStop()","date":"2012-12-12T22:06:03.129Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: then, it calls readStart in the afterWrite handler","date":"2012-12-12T22:06:11.347Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: but!  the afterWrite handler *never happens* if you only have one write in process.","date":"2012-12-12T22:06:21.756Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: the client never calls readStop(0","date":"2012-12-12T22:06:37.269Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: so it *should* always flow through to the client relatively quickly","date":"2012-12-12T22:07:36.389Z","type":"message"}
{"nick":"txdv","message":"the default behaviour uv_bind6 is to bind in dual stack mode","date":"2012-12-12T22:08:51.902Z","type":"message"}
{"nick":"txdv","message":"a useless attribute gets removed","date":"2012-12-12T22:08:59.801Z","type":"message"}
{"nick":"txdv","message":"not significant, but it makes the api clearer","date":"2012-12-12T22:09:14.143Z","type":"message"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-12-12T22:09:21.886Z","type":"quit"}
{"nick":"txdv","message":"this is exactly how I modeled my wrapper api, it was much more sane imo","date":"2012-12-12T22:09:31.340Z","type":"message"}
{"nick":"txdv","message":"+ no need for UV_UDP_FLAGS any more","date":"2012-12-12T22:09:42.980Z","type":"message"}
{"nick":"indexzero","reason":"Client Quit","date":"2012-12-12T22:10:08.957Z","type":"quit"}
{"nick":"txdv","message":"and it would be an excuse to make addrr to pointers","date":"2012-12-12T22:10:16.299Z","type":"message"}
{"nick":"kazupon","reason":"Ping timeout: 250 seconds","date":"2012-12-12T22:10:18.532Z","type":"quit"}
{"nick":"benoitc","date":"2012-12-12T22:11:12.044Z","type":"join"}
{"nick":"Ralt","reason":"Ping timeout: 256 seconds","date":"2012-12-12T22:11:52.431Z","type":"quit"}
{"nick":"piscisaureus_","message":"txdv: I am not sure I agree... dualstack is essentially a feature of the ipv6 stack; it allows you to create a fully capable ipv6 server and handle ipv4 clients as an afterthought.","date":"2012-12-12T22:12:25.753Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: here's where it stalls: the client writes a big chunk, so the server gets ondata","date":"2012-12-12T22:13:11.205Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: but the server doesn't get *all* client data","date":"2012-12-12T22:13:23.057Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: because the chunk is too big","date":"2012-12-12T22:13:28.170Z","type":"message"}
{"nick":"txdv","message":"then at least there should be a UV_UDP_DUALSTACK instead of UV_UDP_IPV6ONLY","date":"2012-12-12T22:13:57.010Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: but the server immediately calls readStop when it gets an ondata callback","date":"2012-12-12T22:13:58.313Z","type":"message"}
{"nick":"txdv","message":"+ uv_bind for now as an flag argument which is always 0","date":"2012-12-12T22:14:16.712Z","type":"message"}
{"nick":"txdv","message":"has*","date":"2012-12-12T22:14:22.453Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: so the client is never be able to flush all data to the kernel buffer","date":"2012-12-12T22:14:28.805Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: so afterWrite is never called, *because* the write never actually completes","date":"2012-12-12T22:14:44.847Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: it's not the client's afterWrite that isn't getting called.","date":"2012-12-12T22:15:04.827Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: it's the server","date":"2012-12-12T22:15:11.709Z","type":"message"}
{"nick":"isaacs","message":"s","date":"2012-12-12T22:15:11.958Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: no, it stalls at the client for me","date":"2012-12-12T22:15:18.737Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: right, because the server has stopped reading.","date":"2012-12-12T22:15:43.641Z","type":"message"}
{"nick":"piscisaureus_","message":"yes","date":"2012-12-12T22:15:49.686Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: because the server's clientHandle has never called readStart()","date":"2012-12-12T22:15:54.983Z","type":"message"}
{"nick":"piscisaureus_","message":"listening","date":"2012-12-12T22:16:06.876Z","type":"message"}
{"nick":"piscisaureus_","message":"onconnection","date":"2012-12-12T22:16:07.002Z","type":"message"}
{"nick":"piscisaureus_","message":"client readstart","date":"2012-12-12T22:16:07.002Z","type":"message"}
{"nick":"piscisaureus_","message":"CLIENT connect r=true w=true","date":"2012-12-12T22:16:07.002Z","type":"message"}
{"nick":"piscisaureus_","message":"CLIENT readstart","date":"2012-12-12T22:16:07.002Z","type":"message"}
{"nick":"piscisaureus_","message":"client write","date":"2012-12-12T22:16:07.636Z","type":"message"}
{"nick":"piscisaureus_","message":"SERVER ondata 49152 49152 16777216","date":"2012-12-12T22:16:07.770Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: because the server's writeReq.oncomplete (where it calls handle.readStart()) was never called","date":"2012-12-12T22:16:08.513Z","type":"message"}
{"nick":"piscisaureus_","message":"SERVER readstop","date":"2012-12-12T22:16:08.654Z","type":"message"}
{"nick":"piscisaureus_","message":"CLIENT ondata 49152 49152 16777216","date":"2012-12-12T22:16:08.790Z","type":"message"}
{"nick":"piscisaureus_","message":"CLIENT 49152","date":"2012-12-12T22:16:09.632Z","type":"message"}
{"nick":"LOUDBOT","message":"BEER AND VAGINAS HAHAHA, BALD EAGLES AND SHIT, FUCK YES!","date":"2012-12-12T22:16:10.231Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: like how i tricked you into louding? ;)","date":"2012-12-12T22:16:19.979Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: I do agree that opt-in dualstack makes for a nicer api","date":"2012-12-12T22:16:31.153Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: so.  if the server's writeReq completes, then the server will call readStart() again","date":"2012-12-12T22:16:52.059Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: the client is never readStop()ing, so it should continue to flow without problems.","date":"2012-12-12T22:17:07.190Z","type":"message"}
{"nick":"piscisaureus_","message":"but the server doesn't write","date":"2012-12-12T22:17:08.265Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: I don't see the server writing here...","date":"2012-12-12T22:17:16.556Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: yeah, it does: https://gist.github.com/4271867#file-tcp-raw-js-L84-L97","date":"2012-12-12T22:17:42.909Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: the server writes back whatever it reads","date":"2012-12-12T22:18:02.763Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: every time it gets a chunk, it stops reading, writes it, and when the write is completed, it readStart()s again","date":"2012-12-12T22:18:18.430Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: otherwise it'd fail with the libuv changes reverted, and it succeeds there.","date":"2012-12-12T22:18:36.712Z","type":"message"}
{"nick":"isaacs","message":"serverHandle.onconnection = onconnection;","date":"2012-12-12T22:18:48.087Z","type":"message"}
{"nick":"loladiro","date":"2012-12-12T22:19:22.803Z","type":"join"}
{"nick":"isaacs","message":"then in the connection handler, it does: clientHandle.onread = onread(selfPipe)","date":"2012-12-12T22:19:36.247Z","type":"message"}
{"nick":"isaacs","message":"onread() returns a function that checks if it's a valid chunk, blah blah blah, then calls the supplied function","date":"2012-12-12T22:19:57.224Z","type":"message"}
{"nick":"isaacs","message":"in this case, the supplied function is selfPipe, which calls writeBuffer(chunk), calls handle.readStop(), and in the writeReq.oncomplete, calls handle.readStart()","date":"2012-12-12T22:20:35.222Z","type":"message"}
{"nick":"txdv","message":"but if you use dualstack, you use always ip6addrany ","date":"2012-12-12T22:21:00.796Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: yes","date":"2012-12-12T22:21:10.392Z","type":"message"}
{"nick":"txdv","message":"perfect scenario","date":"2012-12-12T22:21:17.086Z","type":"message"}
{"nick":"txdv","message":"so if I want to add UV_TCP_DUALSTACK I will have to create yet another enum","date":"2012-12-12T22:26:18.415Z","type":"message"}
{"nick":"txdv","message":"as opposed to just a function","date":"2012-12-12T22:26:22.932Z","type":"message"}
{"nick":"isaacs","message":"txdv: you're stealing my piscisaureus_ time ;P","date":"2012-12-12T22:27:45.932Z","type":"message"}
{"nick":"txdv","message":"well then finish your buissness first and release the resource then by pming me","date":"2012-12-12T22:28:17.958Z","type":"message"}
{"nick":"isaacs","message":"hahah","date":"2012-12-12T22:28:24.188Z","type":"message"}
{"nick":"isaacs","message":"txdv: but i only have one issue, so i don't think the afterWrite will ever get called.","date":"2012-12-12T22:28:37.814Z","type":"message"}
{"nick":"isaacs","message":"(luckily for us bertje doesn't run on libuv)","date":"2012-12-12T22:28:55.862Z","type":"message"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-12-12T22:29:03.883Z","type":"quit"}
{"nick":"txdv","message":"you meant to address that to someone else, or didn't you?","date":"2012-12-12T22:29:49.263Z","type":"message"}
{"nick":"isaacs","message":"txdv: bertje == piscisaureus_","date":"2012-12-12T22:31:47.631Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: well your design criteria may be different but I think fewer functions is better.","date":"2012-12-12T22:35:47.895Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: what's wrong with enum?","date":"2012-12-12T22:35:55.901Z","type":"message"}
{"nick":"txdv","message":"it is one additional function which makes it even easier to use dualstack mode because it has only a port","date":"2012-12-12T22:36:30.826Z","type":"message"}
{"nick":"txdv","message":"as an argument","date":"2012-12-12T22:36:36.463Z","type":"message"}
{"nick":"isaacs","action":"got pre-empted","date":"2012-12-12T22:39:23.803Z","type":"action"}
{"nick":"isaacs","action":":(","date":"2012-12-12T22:39:26.673Z","type":"action"}
{"nick":"LOUDBOT","message":"I CAN DRINK IF I WANT TO, I CAN LEAVE BEER BOTTLES BEHIND","date":"2012-12-12T22:39:27.392Z","type":"message"}
{"nick":"isaacs","message":"LOUDBOT: TRYING TO CHEER ME UP?  I THOUGHT YOU GAVE UP USELESS TASKS FOR LOUDMAS","date":"2012-12-12T22:39:58.914Z","type":"message"}
{"nick":"LOUDBOT","message":"isaacs: OH GOD YOU EAT ORGANS AND BONE MARROW RIGHT\" ","date":"2012-12-12T22:39:59.499Z","type":"message"}
{"nick":"isaacs","message":"mmmmm bone marrow","date":"2012-12-12T22:40:07.013Z","type":"message"}
{"nick":"indexzero","date":"2012-12-12T22:41:08.049Z","type":"join"}
{"nick":"roxlu","reason":"Quit: Page closed","date":"2012-12-12T22:41:17.929Z","type":"quit"}
{"nick":"piscisaureus_","message":"isaacs: right, I think I am on to something","date":"2012-12-12T22:42:48.903Z","type":"message"}
{"nick":"isaacs","message":"starting 0.8.16","date":"2012-12-12T22:43:02.431Z","type":"message"}
{"nick":"isaacs","message":"releasing tomorrow","date":"2012-12-12T22:43:04.467Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: well, you should probably do what we do when we deal with windows/linux/blablaos","date":"2012-12-12T22:43:13.053Z","type":"message"}
{"nick":"txdv","message":"what","date":"2012-12-12T22:43:25.682Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: swear a lot, call those guys idiots and plaster it over with the api that we like","date":"2012-12-12T22:43:36.454Z","type":"message"}
{"nick":"txdv","message":"xD","date":"2012-12-12T22:43:52.236Z","type":"message"}
{"nick":"MI6","message":"\u0002joyent/node:\u0002 \u00033isaacs\u000f created branch v0.8.16-release - http://git.io/5RMPZQ","date":"2012-12-12T22:45:14.939Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: is it possible that it's trying to call the writeReq.oncomplete before I've added it?","date":"2012-12-12T22:45:50.891Z","type":"message"}
{"nick":"loladiro","date":"2012-12-12T22:45:51.287Z","type":"join"}
{"nick":"piscisaureus_","message":"isaacs: that shouldn't happen","date":"2012-12-12T22:46:00.797Z","type":"message"}
{"nick":"piscisaureus_","message":"that would also be a bug","date":"2012-12-12T22:46:03.179Z","type":"message"}
{"nick":"isaacs","message":"ok","date":"2012-12-12T22:46:05.799Z","type":"message"}
{"nick":"isaacs","message":"i'm not sure i could even test that","date":"2012-12-12T22:46:09.513Z","type":"message"}
{"nick":"joshthecoder","reason":"Quit: Leaving...","date":"2012-12-12T22:46:36.268Z","type":"quit"}
{"nick":"isaacs","message":"piscisaureus_: even in the tcp-raw that works (by doing multiple writes) many of the oncompletes dont' get called.","date":"2012-12-12T22:49:10.097Z","type":"message"}
{"nick":"loladiro","reason":"Ping timeout: 256 seconds","date":"2012-12-12T22:50:24.462Z","type":"quit"}
{"nick":"isaacs","message":"heh, actually no oncompletes are called.","date":"2012-12-12T22:50:34.007Z","type":"message"}
{"nick":"isaacs","message":"it's just that it isn't waiting for htem","date":"2012-12-12T22:50:40.067Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2012-12-12T22:52:08.914Z","type":"quit"}
{"nick":"isaacs","message":"i take that back.","date":"2012-12-12T22:54:48.664Z","type":"message"}
{"nick":"isaacs","message":"operator error.","date":"2012-12-12T22:54:53.264Z","type":"message"}
{"nick":"txdv","message":"piscisaureus_: (flags & UV_UDP_DUALSTACK) == 0 or !(flags & UV_UDP_DUALSTACK)","date":"2012-12-12T22:56:38.130Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: the latter","date":"2012-12-12T22:57:31.518Z","type":"message"}
{"nick":"kazupon","date":"2012-12-12T23:07:10.857Z","type":"join"}
{"nick":"piscisaureus_","message":"isaacs: yeah, i can confirm something odd is going on. The uv tcp handle is placed in the pending queue after the write completes, but then somehow disappears","date":"2012-12-12T23:07:47.631Z","type":"message"}
{"nick":"indexzero","date":"2012-12-12T23:08:18.106Z","type":"join"}
{"nick":"isaacs","message":"piscisaureus_: that's so validating to hear.","date":"2012-12-12T23:09:09.847Z","type":"message"}
{"nick":"txdv","message":"IPV6_V6ONLY is only defined if the system supports dual stack?","date":"2012-12-12T23:09:14.502Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: in the meantime, i'm going to refactor to push more than just one write to libuv","date":"2012-12-12T23:09:27.067Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: will that writeQueueBuffer blow up at some point?","date":"2012-12-12T23:09:38.881Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: you mean, is there a limit to how much you can write?","date":"2012-12-12T23:10:01.639Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: ie, how many bytes can i shove into libuv before i start having problems?","date":"2012-12-12T23:10:03.003Z","type":"message"}
{"nick":"isaacs","message":"yeah","date":"2012-12-12T23:10:06.013Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: just do it :-0","date":"2012-12-12T23:10:12.986Z","type":"message"}
{"nick":"isaacs","message":"k :)","date":"2012-12-12T23:10:18.833Z","type":"message"}
{"nick":"isaacs","message":"i figure it's bound by process operating system whatever whatever.","date":"2012-12-12T23:10:27.633Z","type":"message"}
{"nick":"isaacs","message":"and that's limiting Buffers anyway, so meh","date":"2012-12-12T23:10:32.955Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: no, it's not limited by the OS","date":"2012-12-12T23:10:38.817Z","type":"message"}
{"nick":"piscisaureus_","message":"it's limited by how much memory one has","date":"2012-12-12T23:10:52.925Z","type":"message"}
{"nick":"isaacs","message":"right","date":"2012-12-12T23:11:00.818Z","type":"message"}
{"nick":"isaacs","message":"limited by the system","date":"2012-12-12T23:11:02.805Z","type":"message"}
{"nick":"kazupon","reason":"Ping timeout: 248 seconds","date":"2012-12-12T23:11:48.778Z","type":"quit"}
{"nick":"txdv","message":"this V6ONLY is so stupid, they should have made a V6DUALSTACK option instead","date":"2012-12-12T23:14:09.444Z","type":"message"}
{"nick":"txdv","message":"dafuq is wrong with these people","date":"2012-12-12T23:14:17.545Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2012-12-12T23:14:23.145Z","type":"quit"}
{"nick":"piscisaureus_","message":"txdv: THAT'S THE SPIRIT","date":"2012-12-12T23:14:36.312Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: ok, I know what happens","date":"2012-12-12T23:14:43.484Z","type":"message"}
{"nick":"txdv","message":"now I have to write a shitload of ifdefs","date":"2012-12-12T23:14:54.028Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: the problem occurs when you (a) write something that fits in the kernel buffer immediately and (b) call readStop immediately after","date":"2012-12-12T23:15:16.991Z","type":"message"}
{"nick":"txdv","message":"I don't but it was confusing to figure how it would behave on different platforms","date":"2012-12-12T23:16:49.407Z","type":"message"}
{"nick":"indexzero","date":"2012-12-12T23:17:15.292Z","type":"join"}
{"nick":"isaacs","message":"piscisaureus_: now a race to see whether you can fix it before i work around it :)","date":"2012-12-12T23:18:51.133Z","type":"message"}
{"nick":"indexzero","reason":"Client Quit","date":"2012-12-12T23:18:54.639Z","type":"quit"}
{"nick":"isaacs","message":"piscisaureus_: but 0.9.4 goes out tomorrow (along with 0.8.16)","date":"2012-12-12T23:19:04.378Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: actually, i dunno, maybe friday","date":"2012-12-12T23:19:14.837Z","type":"message"}
{"nick":"isaacs","message":"or monday","date":"2012-12-12T23:19:19.918Z","type":"message"}
{"nick":"piscisaureus_","message":"isaacs: I know how to fix it, but I'm going to need Ben's second opinion on it","date":"2012-12-12T23:19:29.829Z","type":"message"}
{"nick":"piscisaureus_","message":"since he wrote all that stuff","date":"2012-12-12T23:19:33.952Z","type":"message"}
{"nick":"isaacs","message":"we should land streams2-net asap even if it's a bit sloppy","date":"2012-12-12T23:19:37.097Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: understood","date":"2012-12-12T23:19:39.409Z","type":"message"}
{"nick":"isaacs","message":"piscisaureus_: you might still beat me to it :)","date":"2012-12-12T23:19:49.778Z","type":"message"}
{"nick":"indexzero","date":"2012-12-12T23:20:38.221Z","type":"join"}
{"nick":"isaacs","action":"away for a bit","date":"2012-12-12T23:23:21.205Z","type":"action"}
{"nick":"piscisaureus_","message":"isaacs: ok, have fix :-)","date":"2012-12-12T23:26:27.782Z","type":"message"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2012-12-12T23:27:47.496Z","type":"quit"}
{"nick":"warz","date":"2012-12-12T23:27:50.520Z","type":"join"}
{"nick":"warz","reason":"Changing host","date":"2012-12-12T23:27:50.647Z","type":"quit"}
{"nick":"warz","date":"2012-12-12T23:27:50.647Z","type":"join"}
{"nick":"loladiro","date":"2012-12-12T23:30:48.459Z","type":"join"}
{"nick":"MI6","message":"\u0002joyent/libuv:\u0002 \u00033piscisaureus\u000f created branch reviewme - http://git.io/ijIKow","date":"2012-12-12T23:35:04.993Z","type":"message"}
{"nick":"txdv","message":"piscisaureus_: https://github.com/joyent/libuv/pull/652","date":"2012-12-12T23:36:14.341Z","type":"message"}
{"nick":"txdv","message":"A wip","date":"2012-12-12T23:36:40.263Z","type":"message"}
{"nick":"travis-ci","date":"2012-12-12T23:36:53.308Z","type":"join"}
{"nick":"travis-ci","message":"[travis-ci] joyent/libuv#945 (reviewme - bf6f302 : Bert Belder): The build passed.","date":"2012-12-12T23:36:53.444Z","type":"message"}
{"nick":"travis-ci","message":"[travis-ci] Change view : https://github.com/joyent/libuv/commit/bf6f30218a23","date":"2012-12-12T23:36:53.444Z","type":"message"}
{"nick":"travis-ci","message":"[travis-ci] Build details : http://travis-ci.org/joyent/libuv/builds/3637444","date":"2012-12-12T23:36:53.444Z","type":"message"}
{"nick":"travis-ci","date":"2012-12-12T23:36:53.444Z","type":"part"}
{"nick":"piscisaureus_","message":"txdv: okay, i think I agree with the change in principle","date":"2012-12-12T23:40:30.494Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: I have to find out what the default behaviour is for different unices. Maybe we should just always try to enable or disable it explicitly","date":"2012-12-12T23:41:17.483Z","type":"message"}
{"nick":"txdv","message":"imo my other API proposal is better","date":"2012-12-12T23:43:23.983Z","type":"message"}
{"nick":"txdv","message":"but that can be pushed later","date":"2012-12-12T23:43:32.380Z","type":"message"}
{"nick":"txdv","message":"this thing is better than the default behaviour anyway","date":"2012-12-12T23:43:40.722Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: http://stackoverflow.com/questions/2693709/what-was-the-motivation-for-adding-the-ipv6-v6only-flag","date":"2012-12-12T23:44:22.025Z","type":"message"}
{"nick":"brucem","reason":"Excess Flood","date":"2012-12-12T23:45:20.677Z","type":"quit"}
{"nick":"brucem","date":"2012-12-12T23:45:51.660Z","type":"join"}
{"nick":"jmar777","date":"2012-12-12T23:46:01.800Z","type":"join"}
{"nick":"txdv","message":"to piss entire generations yet to come off","date":"2012-12-12T23:46:31.639Z","type":"message"}
{"nick":"txdv","message":"i found that one but it has no good answe","date":"2012-12-12T23:47:03.623Z","type":"message"}
{"nick":"txdv","message":"adding that options doesn't break code, if they added it together with the entire ipv6","date":"2012-12-12T23:47:58.345Z","type":"message"}
{"nick":"txdv","message":"and since bsd has ipv6 and it doesn't have this option, it breaks code that was written for linux and someone tried to port it to bsd","date":"2012-12-12T23:48:59.641Z","type":"message"}
{"nick":"txdv","message":"bsd doesn't have ipv6","date":"2012-12-12T23:49:06.263Z","type":"message"}
{"nick":"txdv","message":"no bsd has ipv6, but it doesnt have this option","date":"2012-12-12T23:50:18.556Z","type":"message"}
{"nick":"txdv","message":"it's a brainfuck option","date":"2012-12-12T23:50:39.959Z","type":"message"}
{"nick":"piscisaureus_","message":"txdv: don't worry about it too much. People don't use it anyway ;-)","date":"2012-12-12T23:51:05.619Z","type":"message"}
{"nick":"txdv","message":"I use it","date":"2012-12-12T23:51:11.999Z","type":"message"}
{"nick":"txdv","message":"I think it is an awesome option","date":"2012-12-12T23:51:19.357Z","type":"message"}
{"nick":"txdv","message":"my bindings support it","date":"2012-12-12T23:51:25.277Z","type":"message"}
{"nick":"piscisaureus_","message":"well but you are building a platform","date":"2012-12-12T23:51:28.108Z","type":"message"}
{"nick":"piscisaureus_","message":"do you actually have a use for it?","date":"2012-12-12T23:51:37.539Z","type":"message"}
{"nick":"txdv","message":"no","date":"2012-12-12T23:52:39.394Z","type":"message"}
{"nick":"txdv","message":"i don't have a server with an ipv6 address","date":"2012-12-12T23:53:05.478Z","type":"message"}
{"nick":"txdv","message":"only the testcase","date":"2012-12-12T23:53:16.594Z","type":"message"}
{"nick":"piscisaureus_","message":"haha","date":"2012-12-12T23:53:19.979Z","type":"message"}
{"nick":"txdv","message":"so what about adding dualstack to uv_tcp","date":"2012-12-12T23:53:47.442Z","type":"message"}
{"nick":"txdv","message":"either I add an argument to uv_tcp_bind just like in uv_udp_bind or we do it like in my first proposal with the 3 functions","date":"2012-12-12T23:54:26.988Z","type":"message"}
{"nick":"deoxxa","new_nick":"[mlg]d30xx4[mlg]","date":"2012-12-12T23:54:41.001Z","type":"nick"}
{"nick":"indexzero","date":"2012-12-12T23:56:18.666Z","type":"join"}
{"nick":"indexzero","reason":"Client Quit","date":"2012-12-12T23:57:42.890Z","type":"quit"}
{"nick":"txdv","message":"in languages with overloads you can hide everything away into one function name","date":"2012-12-12T23:57:49.183Z","type":"message"}
{"nick":"txdv","message":"so the I don't care too much how the c code looks like","date":"2012-12-12T23:58:24.459Z","type":"message"}
{"nick":"txdv","message":"just tell me for what option to go","date":"2012-12-12T23:58:30.928Z","type":"message"}
