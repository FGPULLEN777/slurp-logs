{"nick":"isaacs","message":"usually because of assumptions that you don't even know you have.","date":"2012-06-17T00:00:03.805Z","type":"message"}
{"nick":"isaacs","message":"you can try as hard as possible to be completely honest and reasonable, and still fuck up.","date":"2012-06-17T00:00:13.335Z","type":"message"}
{"nick":"isaacs","message":"in fact, it's almost impossible NOT to fuck up in that case.","date":"2012-06-17T00:00:22.874Z","type":"message"}
{"nick":"einaros","message":"I'll be eagerly awaiting the results all the same, though. regardless of how ws matches up against the others, I'll have good reason to make further improvements.","date":"2012-06-17T00:01:04.561Z","type":"message"}
{"nick":"isaacs","message":"yes","date":"2012-06-17T00:01:22.514Z","type":"message"}
{"nick":"isaacs","message":"benchmarks are not for finding out how fast you are, they're for finding out where yor'e slow","date":"2012-06-17T00:01:32.215Z","type":"message"}
{"nick":"einaros","message":"exactly","date":"2012-06-17T00:01:39.170Z","type":"message"}
{"nick":"isaacs","message":"that's why bad benchmarks are so frustrating! they tell you nothing!","date":"2012-06-17T00:01:40.914Z","type":"message"}
{"nick":"einaros","message":"I've already started rewriting bigger chunks of my websocket code to work against libuv directly .. which should improve memory handling perf","date":"2012-06-17T00:03:10.872Z","type":"message"}
{"nick":"einaros","message":"but overall it feels like a bad idea","date":"2012-06-17T00:03:15.905Z","type":"message"}
{"nick":"dshaw_","reason":"Quit: Leaving.","date":"2012-06-17T00:03:51.283Z","type":"quit"}
{"nick":"isaacs","message":"hm","date":"2012-06-17T00:04:40.171Z","type":"message"}
{"nick":"isaacs","message":"yeah, that sounds kind of suspect to me","date":"2012-06-17T00:04:49.731Z","type":"message"}
{"nick":"isaacs","message":"i mean, unless you wantit to be portable to luvit and julia and whatnot","date":"2012-06-17T00:05:03.266Z","type":"message"}
{"nick":"isaacs","message":"but if you want it to be specifically a node thing, then i usually find doing it in JS is best.","date":"2012-06-17T00:05:18.524Z","type":"message"}
{"nick":"einaros","message":"what's killing websocket perf at the moment is 'new Buffer' and js<->native transition. so I'm just pushing as much as I can over to native to see if it improves anything which would make it be worth the extra work.","date":"2012-06-17T00:06:56.327Z","type":"message"}
{"nick":"isaacs","topic":"4 more! https://github.com/joyent/node/issues?milestone=10&state=open","date":"2012-06-17T00:06:59.813Z","type":"topic"}
{"nick":"einaros","message":"I don't think it will be, but doesn't hurt to give it a go","date":"2012-06-17T00:07:09.951Z","type":"message"}
{"nick":"isaacs","message":"einaros: you're creating these buffers in C or JS?","date":"2012-06-17T00:08:09.459Z","type":"message"}
{"nick":"einaros","message":"right now - js","date":"2012-06-17T00:09:01.520Z","type":"message"}
{"nick":"Raynos","date":"2012-06-17T00:10:14.346Z","type":"join"}
{"nick":"mmalecki","reason":"Ping timeout: 246 seconds","date":"2012-06-17T00:11:43.406Z","type":"quit"}
{"nick":"isaacs","message":"i see","date":"2012-06-17T00:11:58.786Z","type":"message"}
{"nick":"isaacs","message":"hm.  that shouldn't be terrible, then","date":"2012-06-17T00:12:04.446Z","type":"message"}
{"nick":"einaros","message":"for a websocket.send(someBuffer) there are a few special cases where I can avoid making a buffer of size someBuffer.length, but in most instances I have to copy that data over to another buffer which is headerLength + someBuffer.length and then mask each byte of the payload by some value","date":"2012-06-17T00:12:36.190Z","type":"message"}
{"nick":"einaros","message":"the masking I hand off to native code, that improves perf for larger payloads","date":"2012-06-17T00:13:04.736Z","type":"message"}
{"nick":"einaros","message":"in cases where I do not have to touch the someBuffer data, I merely create a new buffer big enough to hold the header (typically 2-6 bytes long in that case), then do to separate socket writes of the header and payload","date":"2012-06-17T00:14:09.741Z","type":"message"}
{"nick":"einaros","message":"since the nagle algo is off, that will most often result in two separate packets (with an added tcp header etc as overhead)","date":"2012-06-17T00:14:58.689Z","type":"message"}
{"nick":"ryah","date":"2012-06-17T00:15:09.764Z","type":"join"}
{"nick":"ryah","message":"meh, i really don't want to do this but this benchmark is annoying me","date":"2012-06-17T00:15:22.641Z","type":"message"}
{"nick":"ryah","message":"has anyone gotten his load generator to run?","date":"2012-06-17T00:15:31.668Z","type":"message"}
{"nick":"ryah","message":"i'm getting ","date":"2012-06-17T00:15:40.620Z","type":"message"}
{"nick":"ryah","message":"~/src/wsdemo% erl -pa ebin deps/*/ebin -s wsdemo","date":"2012-06-17T00:15:42.606Z","type":"message"}
{"nick":"ryah","message":"Erlang R14B04 (erts-5.8.5) [source] [64-bit] [smp:4:4] [rq:4] [async-threads:0] [kernel-poll:false]","date":"2012-06-17T00:15:42.811Z","type":"message"}
{"nick":"ryah","message":"{\"init terminating in do_boot\",{undef,[{wsdemo,start,[]},{init,start_it,1},{init,start_em,1}]}}","date":"2012-06-17T00:15:45.620Z","type":"message"}
{"nick":"ryah","message":"init terminating in do_boot ()","date":"2012-06-17T00:15:48.681Z","type":"message"}
{"nick":"einaros","message":"everything runs fine here, but his websocket client is broken","date":"2012-06-17T00:16:02.178Z","type":"message"}
{"nick":"ryah","message":"einaros: have you run the benchmark?","date":"2012-06-17T00:16:02.333Z","type":"message"}
{"nick":"einaros","message":"I haven't bothered fixing it, since it's his thing to deal with","date":"2012-06-17T00:16:26.926Z","type":"message"}
{"nick":"ryah","message":"sure, but i want to see if 'ws' is actually faster than 'websocket' or it's something else entirely","date":"2012-06-17T00:16:50.770Z","type":"message"}
{"nick":"ryah","message":"einaros: have you done benchmarks between the two?","date":"2012-06-17T00:17:03.983Z","type":"message"}
{"nick":"einaros","message":"well at the moment you can't run ws against it, since the benchmark's client code doesn't work with incomplete payloads (https://github.com/Weltschmerz/wsdemo/blob/master/src/websocket_client.erl#L170-190)","date":"2012-06-17T00:17:52.215Z","type":"message"}
{"nick":"einaros","message":"in terms of ws vs websocket-node, ws is faster for all use cases .. how much, however, varies","date":"2012-06-17T00:18:19.624Z","type":"message"}
{"nick":"ryah","message":"einaros: by an order of magnitude?","date":"2012-06-17T00:18:51.035Z","type":"message"}
{"nick":"einaros","message":"added you to a repo at https://github.com/einaros/websocket-benchmark","date":"2012-06-17T00:19:44.305Z","type":"message"}
{"nick":"einaros","message":"I've yet to do latency benchmarks, which would be more interesting here","date":"2012-06-17T00:19:56.989Z","type":"message"}
{"nick":"sh1mmer","date":"2012-06-17T00:21:42.409Z","type":"join"}
{"nick":"sh1mmer","reason":"Client Quit","date":"2012-06-17T00:21:42.409Z","type":"quit"}
{"nick":"isaacs","message":"einaros: yeah, i recall","date":"2012-06-17T00:22:36.351Z","type":"message"}
{"nick":"isaacs","message":"haven't had a chance to play with it yet","date":"2012-06-17T00:22:40.588Z","type":"message"}
{"nick":"ryah","reason":"Quit: bbl","date":"2012-06-17T00:23:33.455Z","type":"quit"}
{"nick":"loladiro","reason":"Ping timeout: 246 seconds","date":"2012-06-17T01:16:40.614Z","type":"quit"}
{"nick":"sh1mmer","date":"2012-06-17T01:50:58.321Z","type":"join"}
{"nick":"dshaw_","date":"2012-06-17T01:52:05.712Z","type":"join"}
{"nick":"dshaw_","reason":"Quit: Leaving.","date":"2012-06-17T01:57:18.528Z","type":"quit"}
{"nick":"sh1mmer","reason":"Quit: sh1mmer","date":"2012-06-17T02:01:47.235Z","type":"quit"}
{"nick":"sh1mmer","date":"2012-06-17T02:16:09.735Z","type":"join"}
{"nick":"brson","reason":"Ping timeout: 245 seconds","date":"2012-06-17T02:22:20.001Z","type":"quit"}
{"nick":"sh1mmer","reason":"Quit: sh1mmer","date":"2012-06-17T02:23:09.669Z","type":"quit"}
{"nick":"AvianFlu","message":"man, these centOS failures are batshit weird","date":"2012-06-17T03:03:34.180Z","type":"message"}
{"nick":"brson","date":"2012-06-17T03:25:33.105Z","type":"join"}
{"nick":"dshaw_","date":"2012-06-17T03:58:09.813Z","type":"join"}
{"nick":"isaacs","message":"AvianFlu: oh, you're looking at em?","date":"2012-06-17T04:05:16.325Z","type":"message"}
{"nick":"isaacs","message":"AvianFlu: which ones, the dgrams?","date":"2012-06-17T04:05:21.875Z","type":"message"}
{"nick":"mmalecki","date":"2012-06-17T04:23:28.099Z","type":"join"}
{"nick":"AvianFlu","message":"isaacs, I got shanghai'd into devops for most of the day, but I've been poking at the dgram ones","date":"2012-06-17T04:24:12.665Z","type":"message"}
{"nick":"AvianFlu","message":"they don't make any sense to me","date":"2012-06-17T04:24:15.922Z","type":"message"}
{"nick":"AvianFlu","message":"the parent's send socket closes quickly, but I don't see a cause","date":"2012-06-17T04:24:52.541Z","type":"message"}
{"nick":"mmalecki","message":"lol, shanghai'd","date":"2012-06-17T04:29:47.519Z","type":"message"}
{"nick":"AvianFlu","message":"mmalecki: trying to statically link an outdated opencv version counts as shanghai'd.","date":"2012-06-17T04:34:32.159Z","type":"message"}
{"nick":"mmalecki","message":"AvianFlu: yeah it does","date":"2012-06-17T04:36:03.651Z","type":"message"}
{"nick":"mmalecki","message":"AvianFlu: also, I recall you telling me about it yesterday","date":"2012-06-17T04:36:13.671Z","type":"message"}
{"nick":"mmalecki","message":"fuck yeah, I remember something from last night!","date":"2012-06-17T04:36:28.170Z","type":"message"}
{"nick":"sh1mmer","date":"2012-06-17T05:16:51.849Z","type":"join"}
{"nick":"dshaw_","reason":"Quit: Leaving.","date":"2012-06-17T05:29:24.585Z","type":"quit"}
{"nick":"dshaw_","date":"2012-06-17T05:36:12.273Z","type":"join"}
{"nick":"rendar","date":"2012-06-17T05:47:31.051Z","type":"join"}
{"nick":"sh1mmer","reason":"Quit: sh1mmer","date":"2012-06-17T06:31:15.943Z","type":"quit"}
{"nick":"logicalparadox","date":"2012-06-17T06:53:43.840Z","type":"join"}
{"nick":"logicalparadox","reason":"Client Quit","date":"2012-06-17T06:54:16.437Z","type":"quit"}
{"nick":"paddybyers","date":"2012-06-17T07:05:18.134Z","type":"join"}
{"nick":"perezd","reason":"Quit: perezd","date":"2012-06-17T07:21:06.785Z","type":"quit"}
{"nick":"dshaw_","reason":"Quit: Leaving.","date":"2012-06-17T07:28:22.034Z","type":"quit"}
{"nick":"indutny","message":"isaacs: what stdio[2] stuff were you guys talking about? :)","date":"2012-06-17T07:32:11.630Z","type":"message"}
{"nick":"indutny","message":"isaacs: looks I didn't get that on the call (because I don't seem to get it even now :P )","date":"2012-06-17T07:32:31.681Z","type":"message"}
{"nick":"indutny","message":"isaacs: btw, forks do not have stdin atm","date":"2012-06-17T07:33:46.498Z","type":"message"}
{"nick":"TheJH","date":"2012-06-17T07:44:39.613Z","type":"join"}
{"nick":"bnoordhuis_","date":"2012-06-17T07:50:37.467Z","type":"join"}
{"nick":"bnoordhuis__","date":"2012-06-17T08:11:35.338Z","type":"join"}
{"nick":"paddybyers","reason":"Quit: paddybyers","date":"2012-06-17T08:13:30.870Z","type":"quit"}
{"nick":"bnoordhuis_","reason":"Ping timeout: 265 seconds","date":"2012-06-17T08:15:30.276Z","type":"quit"}
{"nick":"bnoordhuis__","reason":"Ping timeout: 246 seconds","date":"2012-06-17T08:19:16.141Z","type":"quit"}
{"nick":"mraleph","date":"2012-06-17T08:20:12.337Z","type":"join"}
{"nick":"paddybyers","date":"2012-06-17T08:20:55.149Z","type":"join"}
{"nick":"hz","date":"2012-06-17T08:33:55.169Z","type":"join"}
{"nick":"hz","reason":"Client Quit","date":"2012-06-17T08:36:43.967Z","type":"quit"}
{"nick":"hz","date":"2012-06-17T08:37:08.374Z","type":"join"}
{"nick":"mmalecki","reason":"Ping timeout: 244 seconds","date":"2012-06-17T08:40:10.545Z","type":"quit"}
{"nick":"mmalecki","date":"2012-06-17T09:06:23.906Z","type":"join"}
{"nick":"mraleph","reason":"Quit: Leaving.","date":"2012-06-17T09:09:27.181Z","type":"quit"}
{"nick":"brson","reason":"Remote host closed the connection","date":"2012-06-17T09:19:47.933Z","type":"quit"}
{"nick":"TheJH","reason":"Read error: Connection reset by peer","date":"2012-06-17T10:19:43.424Z","type":"quit"}
{"nick":"loladiro","date":"2012-06-17T10:30:44.307Z","type":"join"}
{"nick":"loladiro_","date":"2012-06-17T10:50:43.213Z","type":"join"}
{"nick":"loladiro","reason":"Ping timeout: 265 seconds","date":"2012-06-17T10:53:04.257Z","type":"quit"}
{"nick":"loladiro_","new_nick":"loladiro","date":"2012-06-17T10:53:04.455Z","type":"nick"}
{"nick":"hz","message":"hey guys","date":"2012-06-17T11:05:21.327Z","type":"message"}
{"nick":"hz","message":"in generated project for visual studio","date":"2012-06-17T11:05:43.897Z","type":"message"}
{"nick":"hz","message":"in compiler command line i get /TP","date":"2012-06-17T11:06:02.267Z","type":"message"}
{"nick":"hz","message":"it means the code is compiled as c++","date":"2012-06-17T11:06:15.885Z","type":"message"}
{"nick":"hz","message":"is this wanted? or not?","date":"2012-06-17T11:06:35.206Z","type":"message"}
{"nick":"hij1nx","date":"2012-06-17T11:45:26.356Z","type":"join"}
{"nick":"hij1nx","reason":"Remote host closed the connection","date":"2012-06-17T11:45:32.493Z","type":"quit"}
{"nick":"hij1nx","date":"2012-06-17T11:46:05.296Z","type":"join"}
{"nick":"hij1nx","reason":"Client Quit","date":"2012-06-17T11:46:27.559Z","type":"quit"}
{"nick":"mmalecki","message":"where is Ben when you need him.","date":"2012-06-17T12:42:07.350Z","type":"message"}
{"nick":"mmalecki","message":"anyway, is running the same event loop twice safe?","date":"2012-06-17T12:42:46.171Z","type":"message"}
{"nick":"c4milo","date":"2012-06-17T12:43:17.374Z","type":"join"}
{"nick":"hz","reason":"Disconnected by services","date":"2012-06-17T13:50:06.739Z","type":"quit"}
{"nick":"hz","date":"2012-06-17T13:50:10.294Z","type":"join"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2012-06-17T14:15:35.674Z","type":"quit"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-06-17T14:31:08.027Z","type":"quit"}
{"nick":"indutny","message":"mmalecki: AFAIK no","date":"2012-06-17T14:31:57.829Z","type":"message"}
{"nick":"mmalecki","message":"indutny: thanks","date":"2012-06-17T14:43:52.316Z","type":"message"}
{"nick":"AvianFlu","message":"indutny, wait, you said forks don't have stdin before?","date":"2012-06-17T14:43:56.575Z","type":"message"}
{"nick":"AvianFlu","message":"like, it's broken?","date":"2012-06-17T14:44:27.724Z","type":"message"}
{"nick":"indutny","message":"AvianFlu: em... not sure about before","date":"2012-06-17T14:46:33.729Z","type":"message"}
{"nick":"indutny","message":"AvianFlu: but now they don't AFAIK","date":"2012-06-17T14:46:43.190Z","type":"message"}
{"nick":"AvianFlu","message":"that's probably not a good thing.","date":"2012-06-17T14:47:03.384Z","type":"message"}
{"nick":"AvianFlu","action":"goes to poke it with a stick","date":"2012-06-17T14:47:07.669Z","type":"action"}
{"nick":"indutny","message":"AvianFlu: indeed, stdin is an IPC channel atm","date":"2012-06-17T14:47:31.893Z","type":"message"}
{"nick":"indutny","message":"AvianFlu: but it's like one-line change to fix it","date":"2012-06-17T14:47:41.789Z","type":"message"}
{"nick":"AvianFlu","message":"the best kind :D","date":"2012-06-17T14:48:02.298Z","type":"message"}
{"nick":"loladiro","date":"2012-06-17T14:55:42.726Z","type":"join"}
{"nick":"einaros","message":"that websocket benchmark node took part in should be run against 0.7, not 0.6","date":"2012-06-17T15:01:36.130Z","type":"message"}
{"nick":"AvianFlu","message":"do we even know which node version was used?","date":"2012-06-17T15:04:04.303Z","type":"message"}
{"nick":"AvianFlu","message":"(I agree with you though, lol)","date":"2012-06-17T15:04:31.584Z","type":"message"}
{"nick":"einaros","message":"I haven't seen any mention of it","date":"2012-06-17T15:05:15.236Z","type":"message"}
{"nick":"einaros","message":"but the benchmark is ridiculous: the suite is broken and the data is wrong.","date":"2012-06-17T15:05:40.793Z","type":"message"}
{"nick":"mmalecki","reason":"Ping timeout: 240 seconds","date":"2012-06-17T15:18:54.906Z","type":"quit"}
{"nick":"piscisaureus_","date":"2012-06-17T15:23:57.282Z","type":"join"}
{"nick":"mmalecki","date":"2012-06-17T15:30:32.710Z","type":"join"}
{"nick":"mmalecki","reason":"Ping timeout: 246 seconds","date":"2012-06-17T15:36:46.125Z","type":"quit"}
{"nick":"milani","date":"2012-06-17T15:41:13.389Z","type":"join"}
{"nick":"milani","reason":"Quit: Ex-Chat","date":"2012-06-17T15:46:58.275Z","type":"quit"}
