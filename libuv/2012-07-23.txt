{"nick":"loladiro","reason":"Ping timeout: 248 seconds","date":"2012-07-23T00:02:17.986Z","type":"quit"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2012-07-23T00:14:24.528Z","type":"quit"}
{"nick":"felixge","reason":"Quit: felixge","date":"2012-07-23T00:28:51.753Z","type":"quit"}
{"nick":"paddybyers","reason":"Read error: Network is unreachable","date":"2012-07-23T00:33:38.477Z","type":"quit"}
{"nick":"paddybyers","date":"2012-07-23T00:33:53.883Z","type":"join"}
{"nick":"erickt","reason":"Quit: erickt","date":"2012-07-23T00:54:53.005Z","type":"quit"}
{"nick":"c4milo","date":"2012-07-23T00:56:16.170Z","type":"join"}
{"nick":"deoxxa","new_nick":"doexxa","date":"2012-07-23T01:05:17.225Z","type":"nick"}
{"nick":"paddybyers","reason":"Quit: paddybyers","date":"2012-07-23T01:06:12.813Z","type":"quit"}
{"nick":"doexxa","message":"so i take it the gyp file for libuv is stable and recommended for use?","date":"2012-07-23T01:08:22.495Z","type":"message"}
{"nick":"mitsuhiko","message":"i noticed that a uv_close as part of the shutdown often no longer happens","date":"2012-07-23T01:12:08.322Z","type":"message"}
{"nick":"mitsuhiko","message":"what i think happens is that the refcount drops to zero and the looping stops","date":"2012-07-23T01:12:28.875Z","type":"message"}
{"nick":"mitsuhiko","message":"any idea how i can deal with that?","date":"2012-07-23T01:13:51.384Z","type":"message"}
{"nick":"mitsuhiko","message":"(i would prefer my callbacks to still be callde)","date":"2012-07-23T01:13:59.937Z","type":"message"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2012-07-23T01:20:23.909Z","type":"quit"}
{"nick":"mikeal","date":"2012-07-23T01:20:37.164Z","type":"join"}
{"nick":"abraxas","date":"2012-07-23T01:36:46.775Z","type":"join"}
{"nick":"theCole","reason":"Quit: theCole","date":"2012-07-23T01:47:53.148Z","type":"quit"}
{"nick":"theCole","date":"2012-07-23T01:51:29.251Z","type":"join"}
{"nick":"theCole","reason":"Client Quit","date":"2012-07-23T01:51:51.158Z","type":"quit"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2012-07-23T02:35:52.033Z","type":"quit"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2012-07-23T02:44:20.222Z","type":"quit"}
{"nick":"mikeal","date":"2012-07-23T02:44:40.927Z","type":"join"}
{"nick":"indexzero","date":"2012-07-23T03:07:59.553Z","type":"join"}
{"nick":"Aria","reason":"Remote host closed the connection","date":"2012-07-23T03:25:14.807Z","type":"quit"}
{"nick":"indexzero","reason":"Quit: indexzero","date":"2012-07-23T03:50:06.078Z","type":"quit"}
{"nick":"mmalecki","reason":"Ping timeout: 240 seconds","date":"2012-07-23T03:51:30.628Z","type":"quit"}
{"nick":"lohkey","date":"2012-07-23T03:54:03.918Z","type":"join"}
{"nick":"AvianFlu","reason":"Quit: Leaving","date":"2012-07-23T04:01:49.037Z","type":"quit"}
{"nick":"pfox___","reason":"Remote host closed the connection","date":"2012-07-23T04:33:26.821Z","type":"quit"}
{"nick":"beachdog","reason":"Quit: beachdog","date":"2012-07-23T04:37:52.450Z","type":"quit"}
{"nick":"lohkey","reason":"Quit: lohkey","date":"2012-07-23T04:44:23.985Z","type":"quit"}
{"nick":"pfox__","date":"2012-07-23T04:45:27.262Z","type":"join"}
{"nick":"pfox__","reason":"Client Quit","date":"2012-07-23T04:46:27.365Z","type":"quit"}
{"nick":"dshaw_","date":"2012-07-23T04:55:08.914Z","type":"join"}
{"nick":"rendar","date":"2012-07-23T06:24:21.535Z","type":"join"}
{"nick":"felixge","date":"2012-07-23T06:26:17.537Z","type":"join"}
{"nick":"felixge","reason":"Changing host","date":"2012-07-23T06:26:17.777Z","type":"quit"}
{"nick":"felixge","date":"2012-07-23T06:26:17.777Z","type":"join"}
{"nick":"stephank","reason":"Quit: *Poof!*","date":"2012-07-23T06:54:13.705Z","type":"quit"}
{"nick":"hz","date":"2012-07-23T07:33:45.216Z","type":"join"}
{"nick":"`3rdEden","date":"2012-07-23T07:40:51.912Z","type":"join"}
{"nick":"paddybyers","date":"2012-07-23T08:03:29.906Z","type":"join"}
{"nick":"mikeal","reason":"Quit: Leaving.","date":"2012-07-23T08:09:16.483Z","type":"quit"}
{"nick":"charliesome","date":"2012-07-23T08:09:35.066Z","type":"join"}
{"nick":"theCole","date":"2012-07-23T08:09:46.158Z","type":"join"}
{"nick":"ryah","date":"2012-07-23T08:10:16.088Z","type":"join"}
{"nick":"mikeal","date":"2012-07-23T08:13:28.112Z","type":"join"}
{"nick":"loladiro","date":"2012-07-23T08:17:20.287Z","type":"join"}
{"nick":"loladiro","reason":"Quit: loladiro","date":"2012-07-23T08:22:53.833Z","type":"quit"}
{"nick":"paddybyers","reason":"Quit: paddybyers","date":"2012-07-23T08:26:11.551Z","type":"quit"}
{"nick":"loladiro","date":"2012-07-23T08:28:35.334Z","type":"join"}
{"nick":"V1","date":"2012-07-23T08:30:27.511Z","type":"join"}
{"nick":"`3rdEden","reason":"Read error: Connection reset by peer","date":"2012-07-23T08:30:56.448Z","type":"quit"}
{"nick":"theCole","reason":"Quit: theCole","date":"2012-07-23T08:32:51.762Z","type":"quit"}
{"nick":"loladiro","reason":"Client Quit","date":"2012-07-23T08:32:58.915Z","type":"quit"}
{"nick":"V1","new_nick":"`3rdEden","date":"2012-07-23T08:36:54.750Z","type":"nick"}
{"nick":"TheJH","date":"2012-07-23T08:37:58.567Z","type":"join"}
{"nick":"piscisaureus_","date":"2012-07-23T08:42:07.231Z","type":"join"}
{"nick":"piscisaureus_","message":"hello","date":"2012-07-23T08:58:38.543Z","type":"message"}
{"nick":"mitsuhiko","message":"hey","date":"2012-07-23T09:06:03.154Z","type":"message"}
{"nick":"mitsuhiko","message":"valgrind debugging is quite hard with libuv :(","date":"2012-07-23T09:06:46.876Z","type":"message"}
{"nick":"mitsuhiko","message":"looks like my uv_close callbacks are not executed on loop shutdown","date":"2012-07-23T09:06:59.789Z","type":"message"}
{"nick":"mitsuhiko","message":"are there any common workarounds for that","date":"2012-07-23T09:07:30.013Z","type":"message"}
{"nick":"mitsuhiko","message":"+?","date":"2012-07-23T09:07:31.879Z","type":"message"}
{"nick":"hz","reason":"Ping timeout: 272 seconds","date":"2012-07-23T09:12:32.212Z","type":"quit"}
{"nick":"mitsuhiko","message":"i wonder if that is related to this: https://github.com/joyent/libuv/issues/347","date":"2012-07-23T09:17:44.366Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: that's correct","date":"2012-07-23T09:21:00.980Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: it should make the close callbacks if you called uv_close","date":"2012-07-23T09:21:18.471Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: what you can do is call uv_close for all remaining handles after uv_run returns","date":"2012-07-23T09:21:56.021Z","type":"message"}
{"nick":"piscisaureus_","message":"and then call uv_run again","date":"2012-07-23T09:22:01.803Z","type":"message"}
{"nick":"theCole","date":"2012-07-23T09:23:55.128Z","type":"join"}
{"nick":"mitsuhiko","message":"indeed. i can just do that","date":"2012-07-23T09:23:58.319Z","type":"message"}
{"nick":"mitsuhiko","message":"actually not really","date":"2012-07-23T09:25:09.524Z","type":"message"}
{"nick":"mitsuhiko","message":"but that's my fault anyways. shutdown order is undefined right now and i need to have one thing shut down later","date":"2012-07-23T09:25:36.774Z","type":"message"}
{"nick":"mmalecki","date":"2012-07-23T09:25:45.590Z","type":"join"}
{"nick":"CIA-108","message":"\u0002node:\u000f \u000303koichik\u000f \u000307reviewme\u000f * r\u0002bc30c90\u000f \u000310\u000f/ doc/api/cluster.markdown \u0002:\u000f doc: remove duplicate section (+31 more commits...) - http://git.io/Ou4ToA","date":"2012-07-23T09:28:42.437Z","type":"message"}
{"nick":"CIA-108","message":"\u0002node:\u000f \u000303Bert Belder\u000f \u000307reviewme\u000f * r\u00029174e0c\u000f \u000310\u000f/ (lib/fs.js test/simple/test-regress-GH-3739.js)\u0002:\u000f windows: correctly prep long path for fs.exists(Sync) - http://git.io/VlmcJw","date":"2012-07-23T09:30:41.421Z","type":"message"}
{"nick":"piscisaureus_","message":"^-- review anyone?","date":"2012-07-23T09:30:42.625Z","type":"message"}
{"nick":"CIA-108","message":"\u0002node:\u000f \u000303Brian White\u000f \u000307v0.8\u000f * r\u0002e06b5d7\u000f \u000310\u000f/ lib/http.js \u0002:\u000f http: remove duplicate assignments - http://git.io/i4nUYQ","date":"2012-07-23T09:37:54.473Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: well, you can just repeat that trick twice :-)","date":"2012-07-23T09:38:55.100Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: yes :)","date":"2012-07-23T09:39:04.148Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: i have one remainining problem but i am not sure if i can solve it with libuv or if i need to work around it","date":"2012-07-23T09:57:22.649Z","type":"message"}
{"nick":"mitsuhiko","message":"basically i have a connection to redis and n other connections to clients. when a client disconnects it notifies redis","date":"2012-07-23T09:57:35.172Z","type":"message"}
{"nick":"piscisaureus_","message":"yes","date":"2012-07-23T09:57:44.957Z","type":"message"}
{"nick":"mitsuhiko","message":"if all shuts down -> loop ends -> client tells redis -> last ~n disconnecting clients never get response from redis","date":"2012-07-23T09:57:56.565Z","type":"message"}
{"nick":"mitsuhiko","message":"uv_ref on the redis handle is not doing much","date":"2012-07-23T09:58:08.139Z","type":"message"}
{"nick":"piscisaureus_","message":"I think you just need to keep a reference count","date":"2012-07-23T10:00:57.416Z","type":"message"}
{"nick":"piscisaureus_","message":"decrement the count when a client disconnects, and when the counter hits zero close the redis connection","date":"2012-07-23T10:01:18.708Z","type":"message"}
{"nick":"mitsuhiko","message":"i was hoping i could just uv_ref the redis handle :)","date":"2012-07-23T10:01:53.356Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: you can uv_unref it","date":"2012-07-23T10:04:25.980Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: that also works","date":"2012-07-23T10:04:30.201Z","type":"message"}
{"nick":"felixge","reason":"Ping timeout: 264 seconds","date":"2012-07-23T10:05:11.291Z","type":"quit"}
{"nick":"piscisaureus_","message":"mitsuhiko: I think you are confused... uv_ref is the default state, uv_unref makes something not keep the loop alive","date":"2012-07-23T10:05:11.537Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: shouldn't ref -> refcnt++ and unref -> refcnt--?","date":"2012-07-23T10:05:44.357Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: read that issue you posted earlier to understand what it does","date":"2012-07-23T10:06:27.053Z","type":"message"}
{"nick":"mitsuhiko","message":"oh","date":"2012-07-23T10:06:55.207Z","type":"message"}
{"nick":"mitsuhiko","message":"so i need to count myself then","date":"2012-07-23T10:07:17.613Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: just to confirm: does that mean the refcount is [0, 1] and nothing else?","date":"2012-07-23T10:08:22.614Z","type":"message"}
{"nick":"indutny","message":"рш","date":"2012-07-23T10:09:29.051Z","type":"message"}
{"nick":"indutny","message":"hi","date":"2012-07-23T10:09:31.492Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: what did you mean by i can uv_unref it?","date":"2012-07-23T10:18:32.832Z","type":"message"}
{"nick":"ArmyOfBruce","message":"Does anyone do a more Go-like thing on top of libuv? Or most people sticking with callbacks?","date":"2012-07-23T10:21:17.338Z","type":"message"}
{"nick":"TheJH","reason":"Read error: Operation timed out","date":"2012-07-23T10:24:00.546Z","type":"quit"}
{"nick":"mitsuhiko","message":"ArmyOfBruce: what is a \"go like thing\"?","date":"2012-07-23T10:26:19.426Z","type":"message"}
{"nick":"ArmyOfBruce","message":"mitsuhiko: coroutine style code.","date":"2012-07-23T10:27:06.226Z","type":"message"}
{"nick":"mitsuhiko","message":"ArmyOfBruce: i figured as much. but what do you mean with that","date":"2012-07-23T10:27:23.176Z","type":"message"}
{"nick":"mitsuhiko","message":"if someone wrote a programming language?","date":"2012-07-23T10:27:28.294Z","type":"message"}
{"nick":"mitsuhiko","message":"for c there is not much you can do unless you start destroying sanity with setjmp","date":"2012-07-23T10:27:50.649Z","type":"message"}
{"nick":"ArmyOfBruce","message":"mitsuhiko: well, I'm thinking about re-doing the I/O libraries in a language with libuv.","date":"2012-07-23T10:28:00.076Z","type":"message"}
{"nick":"mitsuhiko","message":"ArmyOfBruce: node.js, potentially rust","date":"2012-07-23T10:28:26.506Z","type":"message"}
{"nick":"mitsuhiko","message":"node however is still callback based","date":"2012-07-23T10:28:37.578Z","type":"message"}
{"nick":"ArmyOfBruce","message":"I haven't looked at I/O in Rust, I guess.","date":"2012-07-23T10:28:58.683Z","type":"message"}
{"nick":"mitsuhiko","message":"ArmyOfBruce: as far as i know it's not at all impressive yet","date":"2012-07-23T10:29:17.321Z","type":"message"}
{"nick":"mitsuhiko","message":"it's the part i have not looked into much at all yet","date":"2012-07-23T10:29:27.119Z","type":"message"}
{"nick":"rendar","message":"mitsuhiko: potentially rust? what means?","date":"2012-07-23T10:29:39.361Z","type":"message"}
{"nick":"mitsuhiko","message":"rendar: from the language design, rust could be amazing for async things :)","date":"2012-07-23T10:29:58.543Z","type":"message"}
{"nick":"rendar","message":"hm i see :) better than js?","date":"2012-07-23T10:30:13.468Z","type":"message"}
{"nick":"mitsuhiko","message":"js is not good for async","date":"2012-07-23T10:30:29.980Z","type":"message"}
{"nick":"mitsuhiko","message":"at least not better than $language","date":"2012-07-23T10:30:41.543Z","type":"message"}
{"nick":"rendar","message":"why? isn't js most callback based?","date":"2012-07-23T10:30:45.085Z","type":"message"}
{"nick":"mitsuhiko","message":"rendar: so is c++, python, ruby, php etc.","date":"2012-07-23T10:30:58.086Z","type":"message"}
{"nick":"mitsuhiko","message":"js by itself is not callback based, node js libraries are","date":"2012-07-23T10:31:06.120Z","type":"message"}
{"nick":"ArmyOfBruce","message":"mitsuhiko: ahh, I work with opendylan.org ... I'm suggesting that we / they drop a lot of compat and move into a more modern world, wrt threading, I/O, etc.","date":"2012-07-23T10:31:10.871Z","type":"message"}
{"nick":"rendar","message":"hm, i see, so what offers rust so good for async?","date":"2012-07-23T10:31:20.179Z","type":"message"}
{"nick":"mitsuhiko","message":"rendar: a language design that supports it","date":"2012-07-23T10:31:40.546Z","type":"message"}
{"nick":"rendar","message":"ok","date":"2012-07-23T10:31:58.981Z","type":"message"}
{"nick":"ArmyOfBruce","message":"rendar: there's a lot of nice stuff in Rust for async / concurrent things ... they designed to handle that well. :)","date":"2012-07-23T10:32:12.535Z","type":"message"}
{"nick":"mitsuhiko","message":"it has tasks, the notion of memory ownership and lifetimes, language designed from scratch etc.","date":"2012-07-23T10:32:13.725Z","type":"message"}
{"nick":"mitsuhiko","message":"ArmyOfBruce: it's the first language in a long time which i am really looking forward to :)","date":"2012-07-23T10:34:04.050Z","type":"message"}
{"nick":"ArmyOfBruce","message":"mitsuhiko: it is nice ... just wish it were further along :)","date":"2012-07-23T10:34:31.838Z","type":"message"}
{"nick":"ArmyOfBruce","message":"must run for a while ... nanny leaving for the day.","date":"2012-07-23T10:34:52.533Z","type":"message"}
{"nick":"AndreasMadsen","date":"2012-07-23T10:39:07.975Z","type":"join"}
{"nick":"piscisaureus_","message":"mitsuhiko: yes, refcount = [0, 1]","date":"2012-07-23T10:51:23.672Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: so my naive \"fix\" (which obviously does not work) was refcount ++ in the send and refcount -- in the receive. So I guess i can't do that with uv board tools?","date":"2012-07-23T10:52:17.159Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: indeed","date":"2012-07-23T10:52:42.937Z","type":"message"}
{"nick":"hz","date":"2012-07-23T10:59:45.210Z","type":"join"}
{"nick":"rendar","message":"can rust be bound to C easily?","date":"2012-07-23T11:21:05.995Z","type":"message"}
{"nick":"hz","reason":"Disconnected by services","date":"2012-07-23T11:23:44.108Z","type":"quit"}
{"nick":"CIA-108","message":"\u0002node:\u000f \u000303Peter Rybin\u000f \u000307v0.8\u000f * r\u0002688859a\u000f \u000310\u000f/ src/node.cc \u0002:\u000f debugger: wake up the event loop when a debugger command is dispatched - http://git.io/Wr7J1A","date":"2012-07-23T11:23:45.250Z","type":"message"}
{"nick":"hz","date":"2012-07-23T11:23:47.195Z","type":"join"}
{"nick":"hz","reason":"Remote host closed the connection","date":"2012-07-23T11:26:20.023Z","type":"quit"}
{"nick":"hz","date":"2012-07-23T11:29:10.201Z","type":"join"}
{"nick":"c4milo","date":"2012-07-23T11:33:40.353Z","type":"join"}
{"nick":"c4milo","reason":"Remote host closed the connection","date":"2012-07-23T11:37:06.926Z","type":"quit"}
{"nick":"mitsuhiko","message":"rendar: yes","date":"2012-07-23T11:39:49.830Z","type":"message"}
{"nick":"AndreasMadsen","reason":"Read error: Connection reset by peer","date":"2012-07-23T11:43:18.500Z","type":"quit"}
{"nick":"AndreasMadsen","date":"2012-07-23T11:43:32.969Z","type":"join"}
{"nick":"felixge","date":"2012-07-23T11:44:43.599Z","type":"join"}
{"nick":"felixge","reason":"Changing host","date":"2012-07-23T11:44:43.838Z","type":"quit"}
{"nick":"felixge","date":"2012-07-23T11:44:43.838Z","type":"join"}
{"nick":"piscisaureus_","message":"indutny: hey, yt?","date":"2012-07-23T11:50:12.809Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: hey man","date":"2012-07-23T11:50:34.457Z","type":"message"}
{"nick":"indutny","message":"almost","date":"2012-07-23T11:50:35.581Z","type":"message"}
{"nick":"indutny","message":"well, yes","date":"2012-07-23T11:50:42.512Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: so what part is not there  yet?","date":"2012-07-23T11:50:47.416Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: can you review this? https://github.com/joyent/node/commit/9174e0cb3581fa4f21cd52db46d51845d0413951","date":"2012-07-23T11:50:55.763Z","type":"message"}
{"nick":"indutny","message":"I can, but would I?","date":"2012-07-23T11:51:04.959Z","type":"message"}
{"nick":"indutny","message":":)","date":"2012-07-23T11:51:36.312Z","type":"message"}
{"nick":"indutny","message":"I would","date":"2012-07-23T11:51:38.656Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: yeah, I cannot answer that question :-)","date":"2012-07-23T11:51:39.981Z","type":"message"}
{"nick":"piscisaureus_","message":"can you?","date":"2012-07-23T11:51:44.323Z","type":"message"}
{"nick":"hz","reason":"Read error: Connection reset by peer","date":"2012-07-23T11:51:45.655Z","type":"quit"}
{"nick":"indutny","message":"yes, I can","date":"2012-07-23T11:51:48.400Z","type":"message"}
{"nick":"indutny","message":"one minute","date":"2012-07-23T11:51:50.370Z","type":"message"}
{"nick":"piscisaureus_","message":"Ok, can you?","date":"2012-07-23T11:51:52.530Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: reprise?","date":"2012-07-23T11:52:08.371Z","type":"message"}
{"nick":"piscisaureus_","message":":-p","date":"2012-07-23T11:52:21.723Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: btw, just wondering","date":"2012-07-23T11:52:31.332Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: shoot","date":"2012-07-23T11:52:38.647Z","type":"message"}
{"nick":"indutny","message":"do you know anyone who has experience in CoreAudio stuff?","date":"2012-07-23T11:52:43.619Z","type":"message"}
{"nick":"indutny","message":"especially AudioUnits","date":"2012-07-23T11:52:48.757Z","type":"message"}
{"nick":"indutny","message":"I'm totally f*cked up with that","date":"2012-07-23T11:52:54.062Z","type":"message"}
{"nick":"piscisaureus_","message":"no, not really","date":"2012-07-23T11:52:56.080Z","type":"message"}
{"nick":"indutny","message":"ok","date":"2012-07-23T11:52:58.409Z","type":"message"}
{"nick":"piscisaureus_","message":"really not even","date":"2012-07-23T11:52:59.965Z","type":"message"}
{"nick":"indutny","message":"just saying","date":"2012-07-23T11:53:01.593Z","type":"message"}
{"nick":"hz","date":"2012-07-23T11:53:13.252Z","type":"join"}
{"nick":"piscisaureus_","message":"indutny: I am sure you can just read up on that shit and get it working","date":"2012-07-23T11:53:36.350Z","type":"message"}
{"nick":"piscisaureus_","message":"but why do you care about CoreAudio?","date":"2012-07-23T11:53:44.170Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: <-- https://developer.apple.com/library/mac/#documentation/MusicAudio/Conceptual/AudioUnitProgrammingGuide/Introduction/Introduction.html","date":"2012-07-23T11:54:12.680Z","type":"message"}
{"nick":"indutny","message":"thanks man","date":"2012-07-23T11:54:24.878Z","type":"message"}
{"nick":"indutny","message":"I read that twice","date":"2012-07-23T11:54:27.542Z","type":"message"}
{"nick":"indutny","message":"the thing is that I need to do one thing","date":"2012-07-23T11:54:37.797Z","type":"message"}
{"nick":"indutny","message":"which even has an example in apple's documentation","date":"2012-07-23T11:54:46.687Z","type":"message"}
{"nick":"indutny","message":"but it doesn't work for me","date":"2012-07-23T11:54:51.293Z","type":"message"}
{"nick":"indutny","message":"(at least not inside my app, going to build plain example)","date":"2012-07-23T11:55:05.660Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: so, about your patch","date":"2012-07-23T11:55:09.686Z","type":"message"}
{"nick":"piscisaureus_","message":"yes","date":"2012-07-23T11:55:13.731Z","type":"message"}
{"nick":"piscisaureus_","message":"my patch \\o/","date":"2012-07-23T11:55:18.578Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: basically, you just wrapped path with _makeLong in places where it wasn't wrapped yet","date":"2012-07-23T11:55:29.089Z","type":"message"}
{"nick":"indutny","message":"right/","date":"2012-07-23T11:55:30.159Z","type":"message"}
{"nick":"piscisaureus_","message":"yes","date":"2012-07-23T11:55:34.663Z","type":"message"}
{"nick":"indutny","message":"ok","date":"2012-07-23T11:55:36.311Z","type":"message"}
{"nick":"indutny","message":"lgtm","date":"2012-07-23T11:55:37.066Z","type":"message"}
{"nick":"indutny","message":":D","date":"2012-07-23T11:55:37.716Z","type":"message"}
{"nick":"piscisaureus_","message":":-)","date":"2012-07-23T11:55:39.856Z","type":"message"}
{"nick":"piscisaureus_","message":"I expected as much","date":"2012-07-23T11:55:44.811Z","type":"message"}
{"nick":"piscisaureus_","message":"but we have to stick to the rules","date":"2012-07-23T11:55:49.079Z","type":"message"}
{"nick":"indutny","message":"yeah","date":"2012-07-23T11:55:53.262Z","type":"message"}
{"nick":"indutny","message":"rules are good","date":"2012-07-23T11:55:55.758Z","type":"message"}
{"nick":"indutny","message":"have you seen my RST patch for libuv?","date":"2012-07-23T11:56:05.985Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: https://github.com/joyent/libuv/pull/498","date":"2012-07-23T11:56:24.787Z","type":"message"}
{"nick":"indutny","message":"Does windows has the same problem?","date":"2012-07-23T11:56:47.457Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: the same \"problem\" yeah","date":"2012-07-23T11:57:05.663Z","type":"message"}
{"nick":"indutny","message":"well, not a problem","date":"2012-07-23T11:57:12.000Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: this is just part of the tcp protocol","date":"2012-07-23T11:57:13.672Z","type":"message"}
{"nick":"indutny","message":"but a protocol itself","date":"2012-07-23T11:57:15.924Z","type":"message"}
{"nick":"indutny","message":":D","date":"2012-07-23T11:57:16.380Z","type":"message"}
{"nick":"indutny","message":"yeah","date":"2012-07-23T11:57:17.648Z","type":"message"}
{"nick":"CIA-108","message":"\u0002node:\u000f \u000303Bert Belder\u000f \u000307v0.8\u000f * r\u000243a0c88\u000f \u000310\u000f/ (lib/fs.js test/simple/test-regress-GH-3739.js)\u0002:\u000f windows: correctly prep long path for fs.exists(Sync) - http://git.io/UKI2qg","date":"2012-07-23T11:57:35.396Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: if a tcp client doesn't send a FIN then after a while the server will just time out tho","date":"2012-07-23T11:58:45.008Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: why exactly do you need that, unless you really *want* to send a RST packet?","date":"2012-07-23T11:59:05.348Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: btw, you should really call that api uv_tcp_set_linger","date":"2012-07-23T11:59:34.445Z","type":"message"}
{"nick":"piscisaureus_","message":"because that is how people know that option :-)","date":"2012-07-23T11:59:41.703Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: i think i will just add a dummy handle for the duration of the callback","date":"2012-07-23T11:59:42.065Z","type":"message"}
{"nick":"mitsuhiko","message":"can a timer do that?","date":"2012-07-23T11:59:51.701Z","type":"message"}
{"nick":"TheJH","date":"2012-07-23T12:00:11.245Z","type":"join"}
{"nick":"piscisaureus_","message":"ehhh","date":"2012-07-23T12:00:12.481Z","type":"message"}
{"nick":"mitsuhiko","message":":D","date":"2012-07-23T12:00:15.987Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: what do you mean?","date":"2012-07-23T12:00:19.195Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: and why would you do X for the duration of a callback? That makes very little sense","date":"2012-07-23T12:00:40.998Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: basically when i send a request to redis i don't want the refcount of the loop to drop","date":"2012-07-23T12:00:53.901Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: idle :)","date":"2012-07-23T12:00:57.010Z","type":"message"}
{"nick":"mitsuhiko","message":"waiting for the redis response","date":"2012-07-23T12:01:01.454Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: don't do a idle, it will make your  loop spin","date":"2012-07-23T12:01:13.304Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: yes, set_linger is better","date":"2012-07-23T12:01:18.100Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: it's supposed to wait for the redis response","date":"2012-07-23T12:01:28.516Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: well, there's an issue for node","date":"2012-07-23T12:01:32.844Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: just uv_ref the thing when you make a request to redis, then unref when it comes back","date":"2012-07-23T12:01:36.724Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: but it is already ref","date":"2012-07-23T12:01:44.524Z","type":"message"}
{"nick":"indutny","message":"user is complaining about a lot of FIN_WAIT2 connections","date":"2012-07-23T12:01:45.775Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: what issue is that","date":"2012-07-23T12:01:46.614Z","type":"message"}
{"nick":"indutny","message":"btw, Apple's example does work","date":"2012-07-23T12:01:59.480Z","type":"message"}
{"nick":"indutny","message":"crap","date":"2012-07-23T12:02:02.174Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: yeah, that's why you need to implement your  own refcount I think","date":"2012-07-23T12:02:04.882Z","type":"message"}
{"nick":"indutny","message":"what am I doing wrong","date":"2012-07-23T12:02:06.882Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: init the library first? :-)","date":"2012-07-23T12:02:18.300Z","type":"message"}
{"nick":"indutny","message":"haha","date":"2012-07-23T12:02:21.369Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: unfortunately easier said than done","date":"2012-07-23T12:02:27.780Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: https://github.com/joyent/node/issues/3613","date":"2012-07-23T12:02:29.105Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: can i dump the refcount of the loop somehow?","date":"2012-07-23T12:05:44.400Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: uv_walk.","date":"2012-07-23T12:06:24.460Z","type":"message"}
{"nick":"mitsuhiko","message":"<3","date":"2012-07-23T12:06:37.150Z","type":"message"}
{"nick":"TheJH","reason":"*.net *.split","date":"2012-07-23T12:10:31.583Z","type":"quit"}
{"nick":"rendar","reason":"*.net *.split","date":"2012-07-23T12:10:31.823Z","type":"quit"}
{"nick":"dshaw_","reason":"*.net *.split","date":"2012-07-23T12:10:31.824Z","type":"quit"}
{"nick":"toothrot","reason":"*.net *.split","date":"2012-07-23T12:10:32.064Z","type":"quit"}
{"nick":"einaros","reason":"*.net *.split","date":"2012-07-23T12:10:32.303Z","type":"quit"}
{"nick":"voodootikigod","reason":"*.net *.split","date":"2012-07-23T12:10:32.784Z","type":"quit"}
{"nick":"TheJH","date":"2012-07-23T12:11:03.187Z","type":"join"}
{"nick":"rendar","date":"2012-07-23T12:11:03.424Z","type":"join"}
{"nick":"dshaw_","date":"2012-07-23T12:11:03.424Z","type":"join"}
{"nick":"toothrot","date":"2012-07-23T12:11:03.424Z","type":"join"}
{"nick":"einaros","date":"2012-07-23T12:11:03.424Z","type":"join"}
{"nick":"voodootikigod","date":"2012-07-23T12:11:03.424Z","type":"join"}
{"nick":"rendar","reason":"Max SendQ exceeded","date":"2012-07-23T12:11:17.404Z","type":"quit"}
{"nick":"TheJH","reason":"Max SendQ exceeded","date":"2012-07-23T12:11:17.405Z","type":"quit"}
{"nick":"TheJH","date":"2012-07-23T12:11:55.394Z","type":"join"}
{"nick":"rendar","date":"2012-07-23T12:16:41.972Z","type":"join"}
{"nick":"piscisaureus_","message":"indutny: I am +1 for uv_tcp_set_linger but I am not sure that it is what we need to fix this node issue","date":"2012-07-23T12:17:20.782Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: if you disable linger and then close then the tcp stack might discard data from the kernel send buffer ....","date":"2012-07-23T12:18:02.842Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: situations like this make me appreciate threads","date":"2012-07-23T12:20:58.757Z","type":"message"}
{"nick":"mitsuhiko","message":"pthread_join :P","date":"2012-07-23T12:21:05.693Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: use threads when you want threads","date":"2012-07-23T12:21:41.896Z","type":"message"}
{"nick":"mitsuhiko","message":"i was joking :)","date":"2012-07-23T12:21:52.167Z","type":"message"}
{"nick":"mitsuhiko","message":"but libuv's shutdown support could need some love","date":"2012-07-23T12:22:28.133Z","type":"message"}
{"nick":"TheJH","reason":"*.net *.split","date":"2012-07-23T12:22:28.919Z","type":"quit"}
{"nick":"dshaw_","reason":"*.net *.split","date":"2012-07-23T12:22:29.160Z","type":"quit"}
{"nick":"toothrot","reason":"*.net *.split","date":"2012-07-23T12:22:29.409Z","type":"quit"}
{"nick":"einaros","reason":"*.net *.split","date":"2012-07-23T12:22:29.409Z","type":"quit"}
{"nick":"voodootikigod","reason":"*.net *.split","date":"2012-07-23T12:22:29.890Z","type":"quit"}
{"nick":"indutny","message":"piscisaureus_: it'll discard","date":"2012-07-23T12:22:36.059Z","type":"message"}
{"nick":"TheJH","date":"2012-07-23T12:23:19.955Z","type":"join"}
{"nick":"dshaw_","date":"2012-07-23T12:23:20.190Z","type":"join"}
{"nick":"toothrot","date":"2012-07-23T12:23:20.190Z","type":"join"}
{"nick":"einaros","date":"2012-07-23T12:23:20.191Z","type":"join"}
{"nick":"voodootikigod","date":"2012-07-23T12:23:20.191Z","type":"join"}
{"nick":"piscisaureus_","message":"indutny: that's not really nice unless you really don't care about delivering all the data","date":"2012-07-23T12:23:32.158Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: well, that's it","date":"2012-07-23T12:23:41.901Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: actually","date":"2012-07-23T12:23:46.656Z","type":"message"}
{"nick":"indutny","message":"in almost every case - it'll deliver it","date":"2012-07-23T12:23:57.047Z","type":"message"}
{"nick":"indutny","message":"because .write() is async in node","date":"2012-07-23T12:24:05.152Z","type":"message"}
{"nick":"indutny","message":"but","date":"2012-07-23T12:24:13.239Z","type":"message"}
{"nick":"indutny","message":"if packet will be lost and other side will ask to send it again - no way","date":"2012-07-23T12:24:23.453Z","type":"message"}
{"nick":"indutny","message":":P","date":"2012-07-23T12:24:27.964Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: not really. write() will drop it into the kernel send buffer","date":"2012-07-23T12:24:55.730Z","type":"message"}
{"nick":"indutny","message":"well, yes","date":"2012-07-23T12:25:12.710Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: buf if you turn off linger and then close() the socket the kernel send buffer is deleted","date":"2012-07-23T12:25:13.639Z","type":"message"}
{"nick":"indutny","message":"I understand","date":"2012-07-23T12:25:20.620Z","type":"message"}
{"nick":"indutny","message":"key point: \"in most of the cases\"","date":"2012-07-23T12:25:30.860Z","type":"message"}
{"nick":"philips_","reason":"Excess Flood","date":"2012-07-23T12:36:50.220Z","type":"quit"}
{"nick":"philips_","date":"2012-07-23T12:38:18.711Z","type":"join"}
{"nick":"piscisaureus_","message":"indutny: I think people should just set the linger to a shorter time if they are concerned about this attack","date":"2012-07-23T12:42:54.402Z","type":"message"}
{"nick":"indutny","message":"no","date":"2012-07-23T12:43:00.671Z","type":"message"}
{"nick":"indutny","message":"that works in other way","date":"2012-07-23T12:43:03.898Z","type":"message"}
{"nick":"indutny","message":"non-zero linger and zero linger","date":"2012-07-23T12:43:09.530Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: oh wait nonzero linger means that close() blocks right?","date":"2012-07-23T12:43:32.306Z","type":"message"}
{"nick":"piscisaureus_","message":"hmm","date":"2012-07-23T12:43:32.937Z","type":"message"}
{"nick":"indutny","message":"yes","date":"2012-07-23T12:43:39.183Z","type":"message"}
{"nick":"indutny","message":"and behaviour is different","date":"2012-07-23T12:43:43.870Z","type":"message"}
{"nick":"piscisaureus_","message":"in that case people should do something like","date":"2012-07-23T12:44:38.147Z","type":"message"}
{"nick":"piscisaureus_","message":"socket.end()","date":"2012-07-23T12:44:41.561Z","type":"message"}
{"nick":"piscisaureus_","message":"setTimeout(function() { socket.forceClose() }, 1000)","date":"2012-07-23T12:44:53.679Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: but I think that this pattern:","date":"2012-07-23T12:45:33.341Z","type":"message"}
{"nick":"piscisaureus_","message":"linger_off()","date":"2012-07-23T12:45:33.581Z","type":"message"}
{"nick":"piscisaureus_","message":"write(sock, \"bla\")","date":"2012-07-23T12:45:33.581Z","type":"message"}
{"nick":"piscisaureus_","message":"close(sock)","date":"2012-07-23T12:45:33.581Z","type":"message"}
{"nick":"piscisaureus_","message":"will almost certainly discard data","date":"2012-07-23T12:45:41.931Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: ^--","date":"2012-07-23T12:45:44.905Z","type":"message"}
{"nick":"piscisaureus_","message":"unless people also disable nagle","date":"2012-07-23T12:46:03.894Z","type":"message"}
{"nick":"indutny","message":"well, the thing is","date":"2012-07-23T12:46:05.548Z","type":"message"}
{"nick":"indutny","message":"if linger is disabled","date":"2012-07-23T12:46:09.901Z","type":"message"}
{"nick":"indutny","message":"and it's diabled by default","date":"2012-07-23T12:46:13.056Z","type":"message"}
{"nick":"indutny","message":"calling close() should discard data too","date":"2012-07-23T12:46:18.387Z","type":"message"}
{"nick":"piscisaureus_","message":"no","date":"2012-07-23T12:46:23.094Z","type":"message"}
{"nick":"indutny","message":"the only real difference is that RST packet will be sent","date":"2012-07-23T12:46:26.321Z","type":"message"}
{"nick":"indutny","message":"no? read source","date":"2012-07-23T12:46:29.991Z","type":"message"}
{"nick":"indutny","message":"that's how it works","date":"2012-07-23T12:46:32.159Z","type":"message"}
{"nick":"piscisaureus_","message":"the default mode is that close() doesn't discard data","date":"2012-07-23T12:46:37.141Z","type":"message"}
{"nick":"indutny","message":"nono","date":"2012-07-23T12:46:43.389Z","type":"message"}
{"nick":"mitsuhiko","message":"FIGHT","date":"2012-07-23T12:46:47.990Z","type":"message"}
{"nick":"indutny","message":"default mode is to discard data","date":"2012-07-23T12:46:48.900Z","type":"message"}
{"nick":"indutny","message":"that's why linger was introduced","date":"2012-07-23T12:46:54.221Z","type":"message"}
{"nick":"piscisaureus_","message":"it may discard data, but only after 60 s or so","date":"2012-07-23T12:46:54.983Z","type":"message"}
{"nick":"indutny","message":"it allows close() to wait for acceptance","date":"2012-07-23T12:47:06.195Z","type":"message"}
{"nick":"indutny","message":"and send all remaining data","date":"2012-07-23T12:47:12.525Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: there are a couple of modes:","date":"2012-07-23T12:48:01.766Z","type":"message"}
{"nick":"piscisaureus_","message":"* linger off","date":"2012-07-23T12:48:04.252Z","type":"message"}
{"nick":"piscisaureus_","message":"* linger on, in the background (timeout 0)","date":"2012-07-23T12:48:10.438Z","type":"message"}
{"nick":"piscisaureus_","message":"* linger on, foreground (timeout > 0)","date":"2012-07-23T12:48:19.323Z","type":"message"}
{"nick":"indutny","message":"huh","date":"2012-07-23T12:48:22.415Z","type":"message"}
{"nick":"indutny","message":"where have you read this?","date":"2012-07-23T12:48:26.279Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: the default mode is linger on, background","date":"2012-07-23T12:48:28.042Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: I just know, but I think man 7 socket will tell you too :-)","date":"2012-07-23T12:48:41.942Z","type":"message"}
{"nick":"indutny","message":"SO_LINGER controls the action taken when unsent messages are queued on socket and a close(2) is performed.  If the socket promises reliable delivery of data and SO_LINGER is","date":"2012-07-23T12:49:13.758Z","type":"message"}
{"nick":"indutny","message":"     set, the system will block the process on the close attempt until it is able to transmit the data or until it decides it is unable to deliver the information (a timeout period,","date":"2012-07-23T12:49:13.996Z","type":"message"}
{"nick":"indutny","message":"     termed the linger interval, is specified in the setsockopt() call when SO_LINGER is requested).  If SO_LINGER is disabled and a close is issued, the system will process the","date":"2012-07-23T12:49:13.996Z","type":"message"}
{"nick":"indutny","message":"     close in a manner that allows the process to continue as quickly as possible.","date":"2012-07-23T12:49:13.996Z","type":"message"}
{"nick":"indutny","message":"so basically, last sentence states that it'll do it in any way :P","date":"2012-07-23T12:49:59.960Z","type":"message"}
{"nick":"indutny","message":"without guarantee","date":"2012-07-23T12:50:05.274Z","type":"message"}
{"nick":"indutny","message":"though it may work in some cases","date":"2012-07-23T12:50:10.722Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: so the thing is, in the default mode close() doesn't discard","date":"2012-07-23T12:50:48.407Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: but if it is unable to deliver data, it will after some timeout","date":"2012-07-23T12:51:02.463Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: but if you completely turn it off, it will immediately discard everything","date":"2012-07-23T12:51:21.129Z","type":"message"}
{"nick":"indutny","message":"oh, ok","date":"2012-07-23T12:51:33.541Z","type":"message"}
{"nick":"indutny","message":"I trust you","date":"2012-07-23T12:51:35.408Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: manual refcounting works. not very nice though, had to wrap all redis calls :(","date":"2012-07-23T12:51:50.119Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: that's why destroySoon() works for http in node :-)","date":"2012-07-23T12:51:54.115Z","type":"message"}
{"nick":"indutny","message":":)","date":"2012-07-23T12:52:26.690Z","type":"message"}
{"nick":"chobi_e_","new_nick":"chobi_e","date":"2012-07-23T12:52:32.393Z","type":"nick"}
{"nick":"piscisaureus_","message":"mitsuhiko: yeah, well, this case is too specific to fix in libuv","date":"2012-07-23T12:52:42.334Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: do you think? i mean, that problem comes up with any more involved loop shutdown","date":"2012-07-23T12:53:09.616Z","type":"message"}
{"nick":"mitsuhiko","message":"(eg: on disconnect do io operation)","date":"2012-07-23T12:53:27.601Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: this has all the info -> http://msdn.microsoft.com/en-us/library/windows/desktop/ms738547%28v=vs.85%29.aspx","date":"2012-07-23T12:54:51.735Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: that page is correct (note that windows actually does not implement it correctly, but that's another issue)","date":"2012-07-23T12:54:51.973Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: oooh","date":"2012-07-23T12:55:33.817Z","type":"message"}
{"nick":"indutny","message":"ok","date":"2012-07-23T12:56:17.944Z","type":"message"}
{"nick":"indutny","message":"how that audio stuff works?!","date":"2012-07-23T12:56:23.082Z","type":"message"}
{"nick":"indutny","message":"I'm just trying to record some sound","date":"2012-07-23T12:56:27.484Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: loop shutdown could use some love, sure. But what you want - a connection only keeps the loop alive when a particular condition is true - something you need to implement yourself","date":"2012-07-23T12:58:46.461Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: close callbacks should be made before the loop exits - if that doesn't work then that's a bug","date":"2012-07-23T13:02:19.322Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: but only if you called uv_close","date":"2012-07-23T13:02:34.119Z","type":"message"}
{"nick":"chobi_e","new_nick":"chobi_e_","date":"2012-07-23T13:04:34.848Z","type":"nick"}
{"nick":"mitsuhiko","message":"piscisaureus_: i call uv_close","date":"2012-07-23T13:07:26.018Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: ok, report that as a bug, them","date":"2012-07-23T13:07:47.903Z","type":"message"}
{"nick":"piscisaureus_","message":"*then","date":"2012-07-23T13:07:49.891Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: as a workaround, you could uv_ref() just before calling uv_close, maybe that's going wrong somehow","date":"2012-07-23T13:08:10.910Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: i will try to make a testcase later","date":"2012-07-23T13:08:35.814Z","type":"message"}
{"nick":"piscisaureus_","message":"cool","date":"2012-07-23T13:08:39.543Z","type":"message"}
{"nick":"indutny","message":"ooooh","date":"2012-07-23T13:10:30.912Z","type":"message"}
{"nick":"indutny","message":"looks like I got it","date":"2012-07-23T13:10:37.690Z","type":"message"}
{"nick":"indutny","message":"I was asking AudioUnit to emit data in specific format","date":"2012-07-23T13:10:48.613Z","type":"message"}
{"nick":"indutny","message":"but it was unable to do that","date":"2012-07-23T13:10:54.476Z","type":"message"}
{"nick":"indutny","message":"and wasn't returning any error","date":"2012-07-23T13:11:08.644Z","type":"message"}
{"nick":"indutny","message":"crap, how is that possible","date":"2012-07-23T13:11:12.585Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: i wonder if it's because the redis connection is a uv_poll_t","date":"2012-07-23T13:11:43.791Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: why do you do that, anyway?","date":"2012-07-23T13:12:05.222Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: having a uv_poll_t?","date":"2012-07-23T13:12:13.764Z","type":"message"}
{"nick":"piscisaureus_","message":"mitsuhiko: yeah. You can just uv_write() redis commands right? Or are you using a library?","date":"2012-07-23T13:12:31.270Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: i'm using hiredis and the async shim","date":"2012-07-23T13:12:49.647Z","type":"message"}
{"nick":"piscisaureus_","message":"right, ok.","date":"2012-07-23T13:13:02.535Z","type":"message"}
{"nick":"piscisaureus_","message":"I don't know that, then","date":"2012-07-23T13:13:06.275Z","type":"message"}
{"nick":"mitsuhiko","message":"it looked easier to start with, maybe it was not the best decision","date":"2012-07-23T13:13:21.938Z","type":"message"}
{"nick":"piscisaureus_","message":"It's surprising to me that uv_poll would need to be unref'ed at all","date":"2012-07-23T13:13:25.082Z","type":"message"}
{"nick":"mitsuhiko","message":"piscisaureus_: i never unref it, but i uv_close it","date":"2012-07-23T13:13:45.495Z","type":"message"}
{"nick":"piscisaureus_","message":"oh","date":"2012-07-23T13:13:52.022Z","type":"message"}
{"nick":"mitsuhiko","message":"i tried to ref it though to extend its lifetime","date":"2012-07-23T13:14:07.216Z","type":"message"}
{"nick":"piscisaureus_","message":"that doesn't work","date":"2012-07-23T13:14:25.643Z","type":"message"}
{"nick":"piscisaureus_","message":"uv_close() just closes it","date":"2012-07-23T13:14:37.151Z","type":"message"}
{"nick":"mitsuhiko","message":"yeah, that much was obvious :)","date":"2012-07-23T13:14:42.662Z","type":"message"}
{"nick":"piscisaureus_","message":"that never worked btw","date":"2012-07-23T13:14:48.447Z","type":"message"}
{"nick":"mitsuhiko","message":"it should not get to to that close in the first place","date":"2012-07-23T13:15:31.464Z","type":"message"}
{"nick":"mitsuhiko","message":"what happens is that i start the server, it connects to redis, gets clients etc. when the server shuts down it disconnects all clients and writes something to redis","date":"2012-07-23T13:15:53.541Z","type":"message"}
{"nick":"mitsuhiko","message":"*then* the redis connection closes","date":"2012-07-23T13:15:57.743Z","type":"message"}
{"nick":"mitsuhiko","message":"so i was expecting uv_run to block until the only remaining thing in there was my redis connection","date":"2012-07-23T13:16:25.623Z","type":"message"}
{"nick":"mitsuhiko","message":"but as it turns out, uv_run aborts early","date":"2012-07-23T13:16:32.225Z","type":"message"}
{"nick":"piscisaureus_","message":"have to run, bbl","date":"2012-07-23T13:17:35.010Z","type":"message"}
{"nick":"mitsuhiko","message":"i will look further into that to find out what's really happening here","date":"2012-07-23T13:17:37.033Z","type":"message"}
{"nick":"piscisaureus_","message":"good","date":"2012-07-23T13:17:48.540Z","type":"message"}
{"nick":"mitsuhiko","message":"unrelated: does anyone know which side is at fault if os x decides to no longer accept tcp connections to my thing after ~5000 requests?","date":"2012-07-23T13:20:05.551Z","type":"message"}
{"nick":"mitsuhiko","message":"i already raised the port range","date":"2012-07-23T13:20:10.024Z","type":"message"}
{"nick":"dshaw_","reason":"Quit: Leaving.","date":"2012-07-23T13:37:49.149Z","type":"quit"}
{"nick":"dshaw_","date":"2012-07-23T13:38:02.963Z","type":"join"}
{"nick":"c4milo","date":"2012-07-23T13:44:04.130Z","type":"join"}
{"nick":"AvianFlu","date":"2012-07-23T13:49:01.757Z","type":"join"}
{"nick":"`3rdEden","reason":"Quit: rebooting","date":"2012-07-23T13:50:06.877Z","type":"quit"}
{"nick":"`3rdEden","date":"2012-07-23T13:53:52.879Z","type":"join"}
{"nick":"chobi_e_","new_nick":"chobi_e","date":"2012-07-23T13:58:52.664Z","type":"nick"}
{"nick":"hz","date":"2012-07-23T14:13:41.531Z","type":"quit"}
{"nick":"chobi_e","new_nick":"chobi_e_","date":"2012-07-23T14:15:53.159Z","type":"nick"}
{"nick":"EhevuTov","date":"2012-07-23T14:35:09.530Z","type":"join"}
{"nick":"piscisaureus_","message":"Hmm, cloud9 is also seeing a lot of close_wait / fin_wait2 sockets","date":"2012-07-23T14:36:07.138Z","type":"message"}
{"nick":"piscisaureus_","message":"I think we are leaking sockets, or libuv is","date":"2012-07-23T14:36:16.346Z","type":"message"}
{"nick":"indutny","message":"well","date":"2012-07-23T14:39:24.592Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: http://www.moko.ru/doc/apache/misc/fin_wait_2.html","date":"2012-07-23T14:39:55.080Z","type":"message"}
{"nick":"indutny","message":"basically, what OS is c9 using?","date":"2012-07-23T14:40:12.233Z","type":"message"}
{"nick":"piscisaureus_","message":"linux","date":"2012-07-23T14:41:12.520Z","type":"message"}
{"nick":"chobi_e_","new_nick":"chobi_e","date":"2012-07-23T14:41:47.880Z","type":"nick"}
{"nick":"indutny","message":"ok, that's nice","date":"2012-07-23T14:41:58.898Z","type":"message"}
{"nick":"indutny","message":"what kernel version","date":"2012-07-23T14:42:01.744Z","type":"message"}
{"nick":"piscisaureus_","message":"Ubuntu 12.04 LTS (GNU/Linux 3.2.0-23-virtual x86_64)","date":"2012-07-23T14:42:26.361Z","type":"message"}
{"nick":"indutny","message":"oh, quite new","date":"2012-07-23T14:42:52.114Z","type":"message"}
{"nick":"indutny","message":"the thing is","date":"2012-07-23T14:43:32.960Z","type":"message"}
{"nick":"cryogen","date":"2012-07-23T14:44:05.781Z","type":"join"}
{"nick":"indutny","message":"something is happening here","date":"2012-07-23T14:44:23.721Z","type":"message"}
{"nick":"indutny","message":"and it involves black TCP magic","date":"2012-07-23T14:44:31.689Z","type":"message"}
{"nick":"indutny","message":"I'm quite sure that close() was called on every connection","date":"2012-07-23T14:45:13.429Z","type":"message"}
{"nick":"piscisaureus_","message":"it's weird","date":"2012-07-23T14:45:15.486Z","type":"message"}
{"nick":"indutny","message":"since we're using .destroySoon() for TCP","date":"2012-07-23T14:45:19.410Z","type":"message"}
{"nick":"piscisaureus_","message":"maybe we are just not doing that","date":"2012-07-23T14:45:23.910Z","type":"message"}
{"nick":"indutny","message":"em...","date":"2012-07-23T14:45:29.982Z","type":"message"}
{"nick":"piscisaureus_","message":"since this is a websocket proxy","date":"2012-07-23T14:45:30.713Z","type":"message"}
{"nick":"indutny","message":"why is in FIN_WAIT2 state?","date":"2012-07-23T14:45:35.586Z","type":"message"}
{"nick":"indutny","message":"oh","date":"2012-07-23T14:45:39.857Z","type":"message"}
{"nick":"indutny","message":"websocket proxy","date":"2012-07-23T14:45:42.039Z","type":"message"}
{"nick":"indutny","message":"is it opensource?","date":"2012-07-23T14:45:47.929Z","type":"message"}
{"nick":"piscisaureus_","message":"maybe we just forgot to close() it :-)","date":"2012-07-23T14:45:49.170Z","type":"message"}
{"nick":"piscisaureus_","message":"no","date":"2012-07-23T14:45:50.773Z","type":"message"}
{"nick":"cryogen","message":"howdys folk, i'm having an issue where when i do uv_close(), there are pending_write_reqs so my close_cb is never called","date":"2012-07-23T14:46:19.095Z","type":"message"}
{"nick":"indutny","message":"well, it's the only real way","date":"2012-07-23T14:46:21.525Z","type":"message"}
{"nick":"indutny","message":"piscisaureus_: ^^","date":"2012-07-23T14:46:30.439Z","type":"message"}
{"nick":"indutny","message":"pending write reqs","date":"2012-07-23T14:46:35.235Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: yeah, I think the sockets may not be closed. If I look at them with `netstat -ae` they all have an associated inode","date":"2012-07-23T14:47:36.773Z","type":"message"}
{"nick":"piscisaureus_","message":"so prolly they're still open","date":"2012-07-23T14:47:42.841Z","type":"message"}
{"nick":"indutny","message":"oh, great","date":"2012-07-23T14:48:42.487Z","type":"message"}
{"nick":"indutny","message":"well, if uv_close was called - they should be definitely closed","date":"2012-07-23T14:49:00.618Z","type":"message"}
{"nick":"piscisaureus_","message":"yeah","date":"2012-07-23T14:49:06.338Z","type":"message"}
{"nick":"indutny","message":"that means the bug is node.js","date":"2012-07-23T14:49:14.338Z","type":"message"}
{"nick":"indutny","message":"if it's present","date":"2012-07-23T14:49:16.964Z","type":"message"}
{"nick":"erickt","date":"2012-07-23T14:50:04.414Z","type":"join"}
{"nick":"indutny","message":"we can try adding dtrace probe into HandleWrap::Close","date":"2012-07-23T14:51:11.824Z","type":"message"}
{"nick":"indutny","message":"and we should already have a probe for incoming connection","date":"2012-07-23T14:51:29.874Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: well, it could be that we are creating persistent connections","date":"2012-07-23T14:53:21.000Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: with allowHalfOpen: true","date":"2012-07-23T14:53:29.842Z","type":"message"}
{"nick":"piscisaureus_","message":"but no 'end' handler or something","date":"2012-07-23T14:53:36.210Z","type":"message"}
{"nick":"piscisaureus_","message":"where we == cloud9","date":"2012-07-23T14:53:43.760Z","type":"message"}
{"nick":"piscisaureus_","message":"indutny: dtrace doesn't really work any more since we're  now on linux","date":"2012-07-23T14:54:52.580Z","type":"message"}
{"nick":"indutny","message":"well, yes","date":"2012-07-23T14:55:05.531Z","type":"message"}
{"nick":"indutny","message":"but voxer is on smartos :P","date":"2012-07-23T14:55:09.667Z","type":"message"}
{"nick":"hz","date":"2012-07-23T14:56:26.187Z","type":"join"}
{"nick":"mmalecki","message":"indutny: well, we're too","date":"2012-07-23T14:58:07.491Z","type":"message"}
{"nick":"indutny","message":"are we experiencing that problems?","date":"2012-07-23T14:58:18.495Z","type":"message"}
{"nick":"mmalecki","message":"kind-if-ish. ask AvianFlu for details - some connections are not getting closed when they should be","date":"2012-07-23T14:58:48.309Z","type":"message"}
{"nick":"mmalecki","message":"I didn't really look tho, I was hangover when email came","date":"2012-07-23T14:58:58.036Z","type":"message"}
{"nick":"indutny","message":"ok","date":"2012-07-23T15:03:45.252Z","type":"message"}
{"nick":"mmalecki","message":"actually, now that I read the convo, we're dealing with websocket proxy too","date":"2012-07-23T15:05:03.978Z","type":"message"}
{"nick":"indutny","message":"well, indeed","date":"2012-07-23T15:07:18.005Z","type":"message"}
{"nick":"mmalecki","message":"indutny: sec, I'll fwd you the mail","date":"2012-07-23T15:08:14.724Z","type":"message"}
{"nick":"mmalecki","message":"piscisaureus_: hey, what's your email? thought I'd share that one with you too","date":"2012-07-23T15:09:55.291Z","type":"message"}
{"nick":"TheJH","reason":"Ping timeout: 240 seconds","date":"2012-07-23T15:10:00.848Z","type":"quit"}
{"nick":"charliesome","reason":"Quit: Textual IRC Client: www.textualapp.com","date":"2012-07-23T15:12:18.470Z","type":"quit"}
{"nick":"dap","date":"2012-07-23T15:18:33.021Z","type":"join"}
{"nick":"piscisaureus_","message":"mmalecki: bert@c9.io","date":"2012-07-23T15:19:03.040Z","type":"message"}
{"nick":"piscisaureus_","message":"mmalecki: or bertbelder@gmail.com","date":"2012-07-23T15:19:25.862Z","type":"message"}
{"nick":"mmalecki","message":"piscisaureus_: thanks. are you guys using node-http-proxy, per chance?","date":"2012-07-23T15:20:36.540Z","type":"message"}
{"nick":"piscisaureus_","message":"mmalecki: yeah, but it's heavily modified","date":"2012-07-23T15:20:48.477Z","type":"message"}
{"nick":"piscisaureus_","message":"I don't know if it comes with ws builtin","date":"2012-07-23T15:20:58.353Z","type":"message"}
{"nick":"mmalecki","message":"piscisaureus_: can you push some changes somewhere?","date":"2012-07-23T15:21:13.913Z","type":"message"}
{"nick":"mmalecki","message":"we think that we might know the reason for http-proxy leaking sockets like that","date":"2012-07-23T15:21:29.243Z","type":"message"}
{"nick":"piscisaureus_","message":"mmalecki: maybe, depends","date":"2012-07-23T15:21:35.785Z","type":"message"}
{"nick":"piscisaureus_","message":"mmalecki: do you have a patch?","date":"2012-07-23T15:21:39.312Z","type":"message"}
{"nick":"mmalecki","message":"piscisaureus_: yeah, sec, looking","date":"2012-07-23T15:22:44.838Z","type":"message"}
{"nick":"mmalecki","message":"piscisaureus_, indutny: sent","date":"2012-07-23T15:25:38.724Z","type":"message"}
{"nick":"theCole","reason":"Quit: theCole","date":"2012-07-23T15:26:27.062Z","type":"quit"}
{"nick":"mmalecki","message":"piscisaureus_: I think that this might work https://gist.github.com/20e92ded767c2cce3886","date":"2012-07-23T15:27:27.519Z","type":"message"}
{"nick":"indutny","message":"oh, very rough :P","date":"2012-07-23T15:27:46.939Z","type":"message"}
{"nick":"indutny","message":"but that's error handling - then ok","date":"2012-07-23T15:28:03.701Z","type":"message"}
{"nick":"cryogen","message":"im having an issue with uv_close not calling my callback, but it doesn't happen all the time so it seems a bit like a race, it's probably something i'm doing wrong but i'm  not really sure what","date":"2012-07-23T15:28:53.807Z","type":"message"}
{"nick":"cryogen","message":"from what i can tell it seems to be something to do with doing writes inside my read callback","date":"2012-07-23T15:29:08.585Z","type":"message"}
{"nick":"xaq","date":"2012-07-23T15:31:38.516Z","type":"join"}
{"nick":"mmalecki","message":"piscisaureus_: we'll be rolling this to load balancers as soon as we deal with DNS problems","date":"2012-07-23T15:31:53.416Z","type":"message"}
{"nick":"piscisaureus_","message":"cryogen: writing from a read callback is fine.","date":"2012-07-23T15:31:57.034Z","type":"message"}
{"nick":"piscisaureus_","message":"cryogen: sounds like you are clobbering memory","date":"2012-07-23T15:32:13.583Z","type":"message"}
{"nick":"cryogen","message":"that is plausible, from the debugging i've done, the code to decrement pending_write_reqs/call the write callback sometimes isn't called","date":"2012-07-23T15:35:53.044Z","type":"message"}
{"nick":"pfox__","date":"2012-07-23T15:37:14.044Z","type":"join"}
{"nick":"erickt","reason":"Quit: erickt","date":"2012-07-23T15:48:20.847Z","type":"quit"}
