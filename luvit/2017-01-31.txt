{"nick":"DarkGod","reason":"Quit: Leaving","date":"2017-01-31T02:00:49.082Z","type":"quit"}
{"nick":"SkyRocknRoll","date":"2017-01-31T04:37:15.241Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 264 seconds","date":"2017-01-31T07:25:35.367Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T07:31:53.289Z","type":"join"}
{"nick":"inex","reason":"Quit: oh","date":"2017-01-31T07:48:37.988Z","type":"quit"}
{"nick":"^v","reason":"Ping timeout: 264 seconds","date":"2017-01-31T08:11:47.314Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T08:15:23.902Z","type":"join"}
{"nick":"inex","date":"2017-01-31T08:23:02.839Z","type":"join"}
{"nick":"DarkGod","date":"2017-01-31T08:24:02.063Z","type":"join"}
{"nick":"rendar","date":"2017-01-31T08:38:27.434Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 255 seconds","date":"2017-01-31T08:45:23.917Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T08:45:53.690Z","type":"join"}
{"nick":"rendar","reason":"Ping timeout: 240 seconds","date":"2017-01-31T09:08:36.566Z","type":"quit"}
{"nick":"^v","reason":"Ping timeout: 252 seconds","date":"2017-01-31T09:09:54.706Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T09:10:27.291Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 264 seconds","date":"2017-01-31T09:36:59.269Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T09:37:32.533Z","type":"join"}
{"nick":"rendar","date":"2017-01-31T09:39:16.699Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 276 seconds","date":"2017-01-31T09:43:03.527Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T09:44:34.115Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 240 seconds","date":"2017-01-31T09:51:47.111Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T10:01:47.117Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 255 seconds","date":"2017-01-31T10:09:30.077Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T10:10:33.686Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 258 seconds","date":"2017-01-31T10:15:42.665Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T10:16:34.778Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 240 seconds","date":"2017-01-31T10:44:49.746Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T10:47:18.697Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 252 seconds","date":"2017-01-31T10:57:09.706Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T11:00:50.809Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 240 seconds","date":"2017-01-31T11:15:09.758Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T11:22:19.781Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 240 seconds","date":"2017-01-31T11:43:49.746Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T11:58:08.910Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 255 seconds","date":"2017-01-31T12:26:17.847Z","type":"quit"}
{"nick":"SkyRocknRoll","reason":"Quit: Ex-Chat","date":"2017-01-31T12:46:40.970Z","type":"quit"}
{"nick":"^v","date":"2017-01-31T15:58:04.920Z","type":"join"}
{"nick":"^v","reason":"Ping timeout: 240 seconds","date":"2017-01-31T16:13:09.760Z","type":"quit"}
{"nick":"whetherever","date":"2017-01-31T16:13:26.127Z","type":"join"}
{"nick":"^v","date":"2017-01-31T16:18:34.181Z","type":"join"}
{"nick":"whetherever72","date":"2017-01-31T16:58:31.748Z","type":"join"}
{"nick":"whetherever","reason":"Read error: Connection reset by peer","date":"2017-01-31T16:58:57.420Z","type":"quit"}
{"nick":"DarkGod","reason":"Remote host closed the connection","date":"2017-01-31T17:19:17.330Z","type":"quit"}
{"nick":"DarkGod","date":"2017-01-31T18:54:06.526Z","type":"join"}
{"nick":"Ulydev","date":"2017-01-31T19:46:06.836Z","type":"join"}
{"nick":"Ulydev","reason":"Quit: Leaving...","date":"2017-01-31T21:02:15.903Z","type":"quit"}
{"nick":"rendar","reason":"Ping timeout: 252 seconds","date":"2017-01-31T21:09:18.678Z","type":"quit"}
{"nick":"Soni","message":"creationix, you should tweak coro-wrapper decoder","date":"2017-01-31T21:14:19.848Z","type":"message"}
{"nick":"Soni","message":"if newindex == #buffer then buffer = nil or something","date":"2017-01-31T21:14:31.222Z","type":"message"}
{"nick":"Soni","message":"(or I can explicitly return data, nil myself >.< but I wanted to use \"return chunk:match(\"^(.-)\\r\\n()\", index)\")","date":"2017-01-31T21:15:29.996Z","type":"message"}
{"nick":"rendar","date":"2017-01-31T21:39:22.284Z","type":"join"}
{"nick":"rendar","reason":"Changing host","date":"2017-01-31T21:39:22.461Z","type":"quit"}
{"nick":"rendar","date":"2017-01-31T21:39:22.461Z","type":"join"}
{"nick":"rendar","reason":"Client Quit","date":"2017-01-31T21:43:45.567Z","type":"quit"}
{"nick":"Soni","message":"creationix, also, you should consider passing the writer function as an extra argument to the encoder","date":"2017-01-31T21:47:14.599Z","type":"message"}
{"nick":"Soni","message":"it'd be slightly more efficient","date":"2017-01-31T21:47:24.613Z","type":"message"}
{"nick":"Soni","message":"(it can be done backwards-compatibly)","date":"2017-01-31T21:47:55.970Z","type":"message"}
{"nick":"Soni","message":"creationix, `return o .. '\\r\\n'` vs `write(o) write('\\r\\n')`","date":"2017-01-31T21:49:33.565Z","type":"message"}
{"nick":"Soni","message":"where o is an string","date":"2017-01-31T21:49:48.230Z","type":"message"}
{"nick":"Soni","message":"(it's called o because it can be any object, but the string case does \"return o .. '\\r\\n'\")","date":"2017-01-31T21:50:14.371Z","type":"message"}
{"nick":"creationix","message":"Soni if I automatically convert empty string to nil then it breaks http keepalive in the http-codec","date":"2017-01-31T21:51:16.021Z","type":"message"}
{"nick":"creationix","message":"there are some tricky edge cases in there","date":"2017-01-31T21:51:22.826Z","type":"message"}
{"nick":"creationix","message":"http itself isn't as clean cut as I would like","date":"2017-01-31T21:51:34.260Z","type":"message"}
{"nick":"Soni","message":"creationix, huh?","date":"2017-01-31T21:51:40.847Z","type":"message"}
{"nick":"creationix","message":"\"if newindex == #buffer then buffer = nil or something\" will break http-codec and I can't figure out a way to make it work","date":"2017-01-31T21:52:23.914Z","type":"message"}
{"nick":"creationix","message":"I tried that for a few hours the other day","date":"2017-01-31T21:52:28.660Z","type":"message"}
{"nick":"Soni","message":"if doing that breaks http-codec, you're doing something wrong... because it makes no sense.","date":"2017-01-31T21:53:13.158Z","type":"message"}
{"nick":"Soni","message":"creationix, are you calling the decode function with nils or something?","date":"2017-01-31T21:53:59.349Z","type":"message"}
{"nick":"creationix","message":"I certain cases I think I might be","date":"2017-01-31T21:54:12.932Z","type":"message"}
{"nick":"Soni","message":"(vs empty string)","date":"2017-01-31T21:54:13.900Z","type":"message"}
{"nick":"creationix","message":"but it is up to the decoder to control that","date":"2017-01-31T21:54:37.112Z","type":"message"}
{"nick":"Soni","message":"(if you get empty string from read(), you should pass empty string. if you get nil from read(), then you should pass nil...)","date":"2017-01-31T21:54:45.680Z","type":"message"}
{"nick":"Soni","message":"(assuming the buffer is empty in both cases)","date":"2017-01-31T21:54:59.170Z","type":"message"}
{"nick":"NiteHawk","message":"creationix: i've just created a PR for the dns stuff i was tinkering with - https://github.com/luvit/luvit/pull/945","date":"2017-01-31T22:02:23.844Z","type":"message"}
{"nick":"Soni","message":"creationix, anyway what about the encoder thing?","date":"2017-01-31T22:03:08.392Z","type":"message"}
{"nick":"Soni","message":"creationix, also, why's `want` a thing?","date":"2017-01-31T22:04:44.046Z","type":"message"}
{"nick":"creationix","message":"NiteHawk thanks","date":"2017-01-31T22:09:24.609Z","type":"message"}
{"nick":"creationix","message":"Soni want was also needed to make http-codec work","date":"2017-01-31T22:09:46.104Z","type":"message"}
{"nick":"creationix","message":"if you want to propose any changes, please test them out with http-codec and ensure that it still works","date":"2017-01-31T22:10:02.552Z","type":"message"}
{"nick":"Soni","message":"creationix, can read() return nil when the socket's not closed? (altho wait that doesn't sound like it'd affect it, unless you're closing the socket on the first nil...)","date":"2017-01-31T22:10:37.920Z","type":"message"}
{"nick":"Soni","message":"uh","date":"2017-01-31T22:10:45.751Z","type":"message"}
{"nick":"Soni","message":"this code confuses me","date":"2017-01-31T22:10:50.603Z","type":"message"}
{"nick":"creationix","message":"no, read blocks while the socket is live","date":"2017-01-31T22:10:50.946Z","type":"message"}
{"nick":"creationix","message":"if you try to read at the wrong time, it will deadlock the stream","date":"2017-01-31T22:11:12.262Z","type":"message"}
{"nick":"creationix","message":"the want flag ensures that we only ever try to read when there is no data left to read and the decoder has had a chance to do everything it needs","date":"2017-01-31T22:11:35.048Z","type":"message"}
{"nick":"Soni","message":"oh","date":"2017-01-31T22:11:48.874Z","type":"message"}
{"nick":"Soni","message":"and uh","date":"2017-01-31T22:11:51.704Z","type":"message"}
{"nick":"Soni","message":"why's being able to parse empty buffers a thing?","date":"2017-01-31T22:12:04.636Z","type":"message"}
{"nick":"Soni","message":"won't that just loop forever?","date":"2017-01-31T22:12:09.184Z","type":"message"}
{"nick":"creationix","message":"it's up to the decoder","date":"2017-01-31T22:12:38.539Z","type":"message"}
{"nick":"creationix","message":"it will loop forever if your decoder is buggy","date":"2017-01-31T22:12:46.825Z","type":"message"}
{"nick":"Soni","message":"assuming well-behaved decoders that don't take external input","date":"2017-01-31T22:12:50.317Z","type":"message"}
{"nick":"creationix","message":"but in the case of http-codec it allows emitting the empty string body required for http requests that don't have a body","date":"2017-01-31T22:13:12.517Z","type":"message"}
{"nick":"Soni","message":"creationix, it'll run with an empty chunk once","date":"2017-01-31T22:13:18.426Z","type":"message"}
{"nick":"Soni","message":"which probably won't do anything","date":"2017-01-31T22:13:30.468Z","type":"message"}
{"nick":"creationix","message":"the http-codec protocol emits one message for head, then chunks for body, then empty string to signify end of body","date":"2017-01-31T22:13:32.461Z","type":"message"}
{"nick":"Soni","message":"and if you return a new index it'll keep looping","date":"2017-01-31T22:13:45.099Z","type":"message"}
{"nick":"creationix","message":"so if it's decoding a request with no body, it needs coro-wrapper to call back into it after it emits the body","date":"2017-01-31T22:14:05.129Z","type":"message"}
{"nick":"creationix","message":"even though there is no more data to parse","date":"2017-01-31T22:14:10.506Z","type":"message"}
{"nick":"Soni","message":"I'll try it in a bit","date":"2017-01-31T22:14:47.627Z","type":"message"}
{"nick":"creationix","message":"notice here that it returns a new index unconditionally https://github.com/luvit/lit/blob/master/deps/http-codec.lua#L229","date":"2017-01-31T22:14:50.788Z","type":"message"}
{"nick":"creationix","message":"if you don't want coro-wrapper to call back into you and expect more data first, then you should return nil for the second arg","date":"2017-01-31T22:15:12.607Z","type":"message"}
{"nick":"creationix","message":"basically returning anything, nil means \"get more data before coming back to me\"","date":"2017-01-31T22:15:37.991Z","type":"message"}
{"nick":"Soni","message":"well, it *shouldn't* make a difference","date":"2017-01-31T22:15:39.030Z","type":"message"}
{"nick":"creationix","message":"but returning an index means, \"I've consumed up to here, call me again with the rest\"","date":"2017-01-31T22:15:54.674Z","type":"message"}
{"nick":"creationix","message":"it's pretty simple and required for the protocol that http-codec implements","date":"2017-01-31T22:16:05.811Z","type":"message"}
{"nick":"creationix","message":"(protocol meaning the outgoing events, not the incoming http data)","date":"2017-01-31T22:16:19.259Z","type":"message"}
{"nick":"Soni","message":"ok","date":"2017-01-31T22:17:03.231Z","type":"message"}
{"nick":"Soni","message":"anyway","date":"2017-01-31T22:17:04.699Z","type":"message"}
{"nick":"Soni","message":"<Soni> creationix, anyway what about the encoder thing?","date":"2017-01-31T22:17:14.263Z","type":"message"}
{"nick":"creationix","message":"what about encoder?  That's pretty straightforward","date":"2017-01-31T22:19:31.531Z","type":"message"}
{"nick":"Soni","message":"creationix, oh I see what you're doing","date":"2017-01-31T22:19:56.675Z","type":"message"}
{"nick":"Soni","message":"you wanted a way to insert arbitrary chunks","date":"2017-01-31T22:20:04.552Z","type":"message"}
{"nick":"creationix","message":"http directly is tricky and has tons of edge cases.  The protocol that http-codec emits is easy to work with.  1 header event, 0 or more body chunks, 1 empty string.","date":"2017-01-31T22:31:23.203Z","type":"message"}
{"nick":"creationix","message":"it doesn't matter if it's a GET request, a HEAD response, an upgrade or anything","date":"2017-01-31T22:31:40.951Z","type":"message"}
{"nick":"creationix","message":"the body can be implied empty, explicitly empty, chunk encoded, length delimited, etc and it all comes out uniformly 1 head, 0-n chunks and 1 empty string","date":"2017-01-31T22:32:18.899Z","type":"message"}
{"nick":"creationix","message":"(also it normalized the body chunks.  Chunked encoding gets removed from chunks)","date":"2017-01-31T22:32:56.342Z","type":"message"}
{"nick":"Soni","message":"alright, I see your use-case","date":"2017-01-31T22:33:24.218Z","type":"message"}
{"nick":"Soni","message":"it's a bit weird imo :P","date":"2017-01-31T22:33:47.324Z","type":"message"}
{"nick":"creationix","message":"http is weird, can't do much about that","date":"2017-01-31T22:40:32.361Z","type":"message"}
{"nick":"creationix","message":"just trying to make it easier to use","date":"2017-01-31T22:40:36.584Z","type":"message"}
{"nick":"Soni","message":"I meant the thing with the decoder","date":"2017-01-31T22:42:14.291Z","type":"message"}
{"nick":"NiteHawk","message":"that was a fast merge! :D thanks","date":"2017-01-31T22:50:51.458Z","type":"message"}
{"nick":"Soni","message":"shitty IRC client ftw https://vgy.me/Zf8XFN","date":"2017-01-31T22:58:32.734Z","type":"message"}
{"nick":"rphillips","message":"Soni: nice!","date":"2017-01-31T23:30:19.429Z","type":"message"}
{"nick":"daurnimator","message":"creationix: hope you might be able to use lua-http somehow","date":"2017-01-31T23:37:15.424Z","type":"message"}
{"nick":"Soni","message":"and yes, I called the IRC client \"bot.lua\" .-.","date":"2017-01-31T23:38:28.397Z","type":"message"}
